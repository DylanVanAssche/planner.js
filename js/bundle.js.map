{"version":3,"sources":["webpack://PlannerJS/webpack/universalModuleDefinition","webpack://PlannerJS/webpack/bootstrap","webpack://PlannerJS/./node_modules/inversify/lib/inversify.js","webpack://PlannerJS/./src/types.ts","webpack://PlannerJS/./node_modules/inversify/lib/constants/metadata_keys.js","webpack://PlannerJS/./src/events/EventType.ts","webpack://PlannerJS/./src/events/EventBus.ts","webpack://PlannerJS/(webpack)/buildin/global.js","webpack://PlannerJS/./node_modules/inversify/lib/constants/error_msgs.js","webpack://PlannerJS/./src/entities/tiles/registry.ts","webpack://PlannerJS/./node_modules/asynciterator/asynciterator.js","webpack://PlannerJS/./node_modules/jsonld/lib/util.js","webpack://PlannerJS/./node_modules/process/browser.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/metadata.js","webpack://PlannerJS/./node_modules/jsonld/lib/types.js","webpack://PlannerJS/./node_modules/inversify/lib/constants/literal_types.js","webpack://PlannerJS/./src/Catalog.ts","webpack://PlannerJS/./src/enums/TravelMode.ts","webpack://PlannerJS/./node_modules/jsonld/lib/graphTypes.js","webpack://PlannerJS/./node_modules/jsonld/lib/JsonLdError.js","webpack://PlannerJS/./src/entities/tiles/coordinate.ts","webpack://PlannerJS/./src/enums/RoutingPhase.ts","webpack://PlannerJS/./node_modules/inversify/lib/annotation/decorator_utils.js","webpack://PlannerJS/./node_modules/inherits/inherits_browser.js","webpack://PlannerJS/./src/pathfinding/PathfinderProvider.ts","webpack://PlannerJS/./node_modules/inversify/lib/utils/id.js","webpack://PlannerJS/./src/enums/ReachableStopsSearchPhase.ts","webpack://PlannerJS/./node_modules/buffer/index.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/util.js","webpack://PlannerJS/./node_modules/jsonld/lib/context.js","webpack://PlannerJS/./src/loader/ldloader.ts","webpack://PlannerJS/./src/util/Geo.ts","webpack://PlannerJS/./src/util/Units.ts","webpack://PlannerJS/./node_modules/events/events.js","webpack://PlannerJS/./node_modules/readable-stream/lib/_stream_duplex.js","webpack://PlannerJS/./src/uri/constants.ts","webpack://PlannerJS/./src/uri/uri.ts","webpack://PlannerJS/./src/util/Tiles.ts","webpack://PlannerJS/./src/fetcher/profiles/ProfileProviderDefault.ts","webpack://PlannerJS/./src/fetcher/tiles/RoutableTileProviderDefault.ts","webpack://PlannerJS/./src/planner/Path.ts","webpack://PlannerJS/./node_modules/inversify/lib/utils/serialization.js","webpack://PlannerJS/./src/catalog.nmbs.ts","webpack://PlannerJS/./src/Context.ts","webpack://PlannerJS/./src/fetcher/connections/ConnectionsFetcherRaw.ts","webpack://PlannerJS/./node_modules/timers-browserify/main.js","webpack://PlannerJS/./node_modules/ldfetch/lib/ldfetch.js","webpack://PlannerJS/./node_modules/core-util-is/lib/util.js","webpack://PlannerJS/./webpack/mockModule.js","webpack://PlannerJS/./node_modules/node-forge/lib/forge.js","webpack://PlannerJS/./node_modules/jsonld/lib/constants.js","webpack://PlannerJS/./node_modules/jsonld/lib/url.js","webpack://PlannerJS/./src/fetcher/LDFetch.ts","webpack://PlannerJS/./src/fetcher/profiles/ProfileFetcherDefault.ts","webpack://PlannerJS/./src/fetcher/stops/StopsProviderDefault.ts","webpack://PlannerJS/./src/fetcher/tiles/RoutableTileFetcherRaw.ts","webpack://PlannerJS/./src/fetcher/tiles/RoutableTileProviderTransit.ts","webpack://PlannerJS/./src/pathfinding/dijkstra-tree/DijkstraTree.ts","webpack://PlannerJS/./src/planner/public-transport/CSAEarliestArrival.ts","webpack://PlannerJS/./src/planner/Leg.ts","webpack://PlannerJS/./src/planner/public-transport/JourneyExtractorProfile.ts","webpack://PlannerJS/./src/planner/stops/ReachableStopsFinderDelaunay.ts","webpack://PlannerJS/./src/query-runner/LocationResolverConvenience.ts","webpack://PlannerJS/./src/fetcher/connections/ConnectionsProviderDefault.ts","webpack://PlannerJS/./node_modules/process-nextick-args/index.js","webpack://PlannerJS/./node_modules/safe-buffer/index.js","webpack://PlannerJS/./node_modules/jsonld/lib/nodeMap.js","webpack://PlannerJS/./src/pathfinding/graph.ts","webpack://PlannerJS/./node_modules/tinyqueue/index.js","webpack://PlannerJS/./src/planner/road/RoadPlannerPathfinding.ts","webpack://PlannerJS/./src/fetcher/stops/StopsFetcherRaw.ts","webpack://PlannerJS/./src/planner/configurations/Planner.ts","webpack://PlannerJS/./node_modules/tiles-in-bbox/index.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_on_syntax.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_when_syntax.js","webpack://PlannerJS/./node_modules/url/url.js","webpack://PlannerJS/./node_modules/jsonld/lib/jsonld.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/index.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/IdentifierIssuer.js","webpack://PlannerJS/./node_modules/node-forge/lib/md.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/NQuads.js","webpack://PlannerJS/./node_modules/jsonld/lib/RequestQueue.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/index.js","webpack://PlannerJS/./src/planner/Step.ts","webpack://PlannerJS/./src/planner/stops/ReachableStopsFinderFootpaths.ts","webpack://PlannerJS/./src/pathfinding/bidirdijkstra/BidirDijkstra.ts","webpack://PlannerJS/./src/query-runner/QueryRunnerDefault.ts","webpack://PlannerJS/./src/index.ts","webpack://PlannerJS/./node_modules/isomorphic-fetch/fetch-npm-browserify.js","webpack://PlannerJS/./node_modules/reflect-metadata/Reflect.js","webpack://PlannerJS/./src/analytics/isochrones/main.ts","webpack://PlannerJS/./node_modules/inversify/lib/planning/metadata_reader.js","webpack://PlannerJS/./node_modules/inversify/lib/utils/exceptions.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/inject.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/target.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_when_on_syntax.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/constraint_helpers.js","webpack://PlannerJS/./src/inversify.config.ts","webpack://PlannerJS/./node_modules/cross-fetch/dist/browser-ponyfill.js","webpack://PlannerJS/./src/fetcher/footpaths/FootpathsProviderDefault.ts","webpack://PlannerJS/./node_modules/util/util.js","webpack://PlannerJS/./webpack/shimQ.js","webpack://PlannerJS/./node_modules/stream-http/index.js","webpack://PlannerJS/./node_modules/isarray/index.js","webpack://PlannerJS/./node_modules/stream-http/lib/capability.js","webpack://PlannerJS/./node_modules/stream-http/lib/response.js","webpack://PlannerJS/./node_modules/readable-stream/readable-browser.js","webpack://PlannerJS/./node_modules/readable-stream/lib/_stream_readable.js","webpack://PlannerJS/./node_modules/readable-stream/lib/internal/streams/stream-browser.js","webpack://PlannerJS/./node_modules/readable-stream/lib/internal/streams/destroy.js","webpack://PlannerJS/./node_modules/readable-stream/lib/_stream_writable.js","webpack://PlannerJS/./node_modules/string_decoder/lib/string_decoder.js","webpack://PlannerJS/./node_modules/readable-stream/lib/_stream_transform.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/URDNA2015.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/MessageDigest-browser.js","webpack://PlannerJS/./node_modules/node-forge/lib/util.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/Permutator.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/URDNA2015Sync.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/default-graph.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/named-node.js","webpack://PlannerJS/./src/entities/footpaths/footpath.ts","webpack://PlannerJS/./src/loader/views/single.ts","webpack://PlannerJS/./src/entities/tiles/tile.ts","webpack://PlannerJS/./src/pathfinding/dijkstra/Dijkstra.ts","webpack://PlannerJS/./src/enums/DropOffType.ts","webpack://PlannerJS/./src/enums/ReachableStopsFinderMode.ts","webpack://PlannerJS/./src/util/iterators/MergeIterator.ts","webpack://PlannerJS/./src/util/Iterators.ts","webpack://PlannerJS/./src/query-runner/exponential/QueryRunnerExponential.ts","webpack://PlannerJS/./node_modules/asynciterator-promiseproxy/index.js","webpack://PlannerJS/./src/Defaults.ts","webpack://PlannerJS/./src/errors/InvalidQueryError.ts","webpack://PlannerJS/./src/errors/LocationResolverError.ts","webpack://PlannerJS/./node_modules/robust-orientation/orientation.js","webpack://PlannerJS/./node_modules/two-product/two-product.js","webpack://PlannerJS/./src/planner/configurations/BasicTrainPlanner.ts","webpack://PlannerJS/./src/planner/stops/ReachableStopsFinderOnlySelf.ts","webpack://PlannerJS/./src/planner/configurations/DissectPlanner.ts","webpack://PlannerJS/./src/fetcher/connections/ConnectionsProviderMerge.ts","webpack://PlannerJS/./src/fetcher/footpaths/FootpathsProviderRaw.ts","webpack://PlannerJS/./src/planner/configurations/TransitCarPlanner.ts","webpack://PlannerJS/./src/planner/configurations/TriangleDemoPlanner.ts","webpack://PlannerJS/./node_modules/delaunator/index.js","webpack://PlannerJS/./node_modules/d3-delaunay/src/path.js","webpack://PlannerJS/./node_modules/d3-delaunay/src/polygon.js","webpack://PlannerJS/./node_modules/d3-delaunay/src/voronoi.js","webpack://PlannerJS/./node_modules/d3-delaunay/src/delaunay.js","webpack://PlannerJS/./node_modules/d3-delaunay/src/index.js","webpack://PlannerJS/./node_modules/whatwg-fetch/fetch.js","webpack://PlannerJS/./node_modules/inversify/lib/container/container.js","webpack://PlannerJS/./node_modules/inversify/lib/bindings/binding.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/planner.js","webpack://PlannerJS/./node_modules/inversify/lib/bindings/binding_count.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/context.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/plan.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/reflection_utils.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/queryable_string.js","webpack://PlannerJS/./node_modules/inversify/lib/planning/request.js","webpack://PlannerJS/./node_modules/inversify/lib/resolution/resolver.js","webpack://PlannerJS/./node_modules/inversify/lib/resolution/instantiation.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_to_syntax.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_in_when_on_syntax.js","webpack://PlannerJS/./node_modules/inversify/lib/syntax/binding_in_syntax.js","webpack://PlannerJS/./node_modules/inversify/lib/container/container_snapshot.js","webpack://PlannerJS/./node_modules/inversify/lib/container/lookup.js","webpack://PlannerJS/./node_modules/inversify/lib/container/container_module.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/injectable.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/tagged.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/named.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/optional.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/unmanaged.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/multi_inject.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/target_name.js","webpack://PlannerJS/./node_modules/inversify/lib/annotation/post_construct.js","webpack://PlannerJS/./node_modules/inversify/lib/utils/binding_utils.js","webpack://PlannerJS/./src/entities/connections/page.ts","webpack://PlannerJS/./src/fetcher/connections/BackwardConnectionIterator.ts","webpack://PlannerJS/./node_modules/setimmediate/setImmediate.js","webpack://PlannerJS/./src/fetcher/connections/ForwardConnectionIterator.ts","webpack://PlannerJS/./node_modules/util/support/isBufferBrowser.js","webpack://PlannerJS/./node_modules/ldfetch/lib/BrowserHttpFetcher.js","webpack://PlannerJS/./node_modules/stream-http/lib/request.js","webpack://PlannerJS/./node_modules/base64-js/index.js","webpack://PlannerJS/./node_modules/ieee754/index.js","webpack://PlannerJS/./node_modules/readable-stream/lib/internal/streams/BufferList.js","webpack://PlannerJS/./node_modules/util-deprecate/browser.js","webpack://PlannerJS/./node_modules/readable-stream/lib/_stream_passthrough.js","webpack://PlannerJS/./node_modules/to-arraybuffer/index.js","webpack://PlannerJS/./node_modules/xtend/immutable.js","webpack://PlannerJS/./node_modules/builtin-status-codes/browser.js","webpack://PlannerJS/./node_modules/node-libs-browser/node_modules/punycode/punycode.js","webpack://PlannerJS/(webpack)/buildin/module.js","webpack://PlannerJS/./node_modules/url/util.js","webpack://PlannerJS/./node_modules/querystring-es3/index.js","webpack://PlannerJS/./node_modules/querystring-es3/decode.js","webpack://PlannerJS/./node_modules/querystring-es3/encode.js","webpack://PlannerJS/./node_modules/https-browserify/index.js","webpack://PlannerJS/./node_modules/ldfetch/lib/JsonldToRDF.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/AsyncAlgorithm.js","webpack://PlannerJS/./node_modules/node-forge/lib/sha1.js","webpack://PlannerJS/./node_modules/node-forge/lib/baseN.js","webpack://PlannerJS/./node_modules/node-forge/lib/sha256.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/URGNA2012.js","webpack://PlannerJS/./node_modules/rdf-canonize/lib/URGNA2012Sync.js","webpack://PlannerJS/./node_modules/jsonld/lib/NQuads.js","webpack://PlannerJS/./node_modules/jsonld/lib/Rdfa.js","webpack://PlannerJS/./node_modules/jsonld/lib/expand.js","webpack://PlannerJS/./node_modules/jsonld/lib/ActiveContextCache.js","webpack://PlannerJS/./node_modules/jsonld/lib/flatten.js","webpack://PlannerJS/./node_modules/jsonld/lib/fromRdf.js","webpack://PlannerJS/./node_modules/jsonld/lib/toRdf.js","webpack://PlannerJS/./node_modules/jsonld/lib/frame.js","webpack://PlannerJS/./node_modules/jsonld/lib/compact.js","webpack://PlannerJS/./node_modules/jsonld/lib/documentLoaders/node.js","webpack://PlannerJS/./node_modules/jsonld/lib/documentLoaders/xhr.js","webpack://PlannerJS/./node_modules/jsonld/lib/JsonLdProcessor.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/data-factory.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/blank-node.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/literal.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/quad.js","webpack://PlannerJS/./node_modules/@rdfjs/data-model/lib/variable.js","webpack://PlannerJS/./node_modules/ldfetch/lib/RDFaToRDF.js","webpack://PlannerJS/./node_modules/ldfetch/lib/BrowserHTMLParser.js","webpack://PlannerJS/./src/loader/views/index.ts","webpack://PlannerJS/./src/loader/results/index.ts","webpack://PlannerJS/./src/loader/results/single.ts","webpack://PlannerJS/./src/entities/profile/CharacteresticProfile.ts","webpack://PlannerJS/./src/entities/profile/DynamicProfile.ts","webpack://PlannerJS/./src/enums/OSMTags.ts","webpack://PlannerJS/./node_modules/haversine/haversine.js","webpack://PlannerJS/./src/entities/profile/Profile.ts","webpack://PlannerJS/./src/entities/profile/ProfileConclusion.ts","webpack://PlannerJS/./src/entities/profile/ProfileCondition.ts","webpack://PlannerJS/./src/entities/profile/ProfileRule.ts","webpack://PlannerJS/./src/fetcher/stops/ld-fetch/StopsFetcherLDFetch.ts","webpack://PlannerJS/./src/util/Rdf.ts","webpack://PlannerJS/./src/entities/tiles/node.ts","webpack://PlannerJS/./src/entities/tiles/way.ts","webpack://PlannerJS/./src/entities/tiles/set.ts","webpack://PlannerJS/./src/pathfinding/dijkstra-tree/DijkstraTreeInstance.ts","webpack://PlannerJS/./src/pathfinding/dijkstra/DijkstraInstance.ts","webpack://PlannerJS/./src/enums/PickupType.ts","webpack://PlannerJS/./src/planner/public-transport/CSA/FootpathQueue.ts","webpack://PlannerJS/./src/planner/public-transport/JourneyExtractorEarliestArrival.ts","webpack://PlannerJS/./src/planner/public-transport/CSA/util/ProfileUtil.ts","webpack://PlannerJS/./node_modules/asynciterator-promiseproxy/lib/PromiseProxyIterator.js","webpack://PlannerJS/./src/util/iterators/FilterUniqueIterator.ts","webpack://PlannerJS/./src/util/iterators/FlatMapIterator.ts","webpack://PlannerJS/./src/query-runner/exponential/ExponentialQueryIterator.ts","webpack://PlannerJS/./src/query-runner/LocationResolverDefault.ts","webpack://PlannerJS/./src/analytics/isochrones/visualize.ts","webpack://PlannerJS/./node_modules/concaveman/index.js","webpack://PlannerJS/./node_modules/rbush/index.js","webpack://PlannerJS/./node_modules/quickselect/quickselect.js","webpack://PlannerJS/./node_modules/monotone-convex-hull-2d/index.js","webpack://PlannerJS/./node_modules/robust-sum/robust-sum.js","webpack://PlannerJS/./node_modules/robust-scale/robust-scale.js","webpack://PlannerJS/./node_modules/two-sum/two-sum.js","webpack://PlannerJS/./node_modules/robust-subtract/robust-diff.js","webpack://PlannerJS/./node_modules/concaveman/node_modules/tinyqueue/index.js","webpack://PlannerJS/./node_modules/point-in-polygon/index.js","webpack://PlannerJS/./src/util/UnionFind.ts","webpack://PlannerJS/./src/configs/basic_train.ts","webpack://PlannerJS/./src/pathfinding/bidirdijkstra/BidirDijkstraInstance.ts","webpack://PlannerJS/./src/configs/dissect.ts","webpack://PlannerJS/./src/catalog.delijn.oostvlaanderen.ts","webpack://PlannerJS/./src/catalog.mivb.ts","webpack://PlannerJS/./src/configs/transit_car.ts","webpack://PlannerJS/./src/planner/road/RoadPlannerPathfindingExperimental.ts","webpack://PlannerJS/./src/configs/triangle_demo.ts","webpack://PlannerJS/./src/catalog.delijn.vlaenderen.ts","webpack://PlannerJS/./src/planner/public-transport/CSAEarliestArrivalVerbose.ts","webpack://PlannerJS/./src/planner/stops/ReachableStopsFinderFootpathsVerbose.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","keys","METADATA_KEY","container_1","Container","literal_types_1","BindingScopeEnum","BindingTypeEnum","TargetTypeEnum","container_module_1","AsyncContainerModule","ContainerModule","injectable_1","injectable","tagged_1","tagged","named_1","named","inject_1","inject","LazyServiceIdentifer","optional_1","optional","unmanaged_1","unmanaged","multi_inject_1","multiInject","target_name_1","targetName","post_construct_1","postConstruct","metadata_reader_1","MetadataReader","id_1","id","decorator_utils_1","decorate","constraint_helpers_1","traverseAncerstors","taggedConstraint","namedConstraint","typeConstraint","serialization_1","getServiceIdentifierAsString","binding_utils_1","multiBindToService","TYPES","EventBus","Context","QueryRunner","LocationResolver","ConnectionsProvider","ConnectionsFetcher","ConnectionsFetcherFactory","StopsProvider","StopsFetcher","StopsFetcherFactory","RoutableTileProvider","RoutableTileFetcher","RoutableTileRegistry","FootpathsProvider","PublicTransportPlanner","PublicTransportPlannerFactory","ProfileFetcher","ProfileProvider","RoadPlanner","RoadPlannerFactory","PathfinderProvider","ShortestPathAlgorithm","ShortestPathTreeAlgorithm","ReachableStopsFinder","JourneyExtractor","LDFetch","LDLoader","Catalog","NAMED_TAG","NAME_TAG","UNMANAGED_TAG","OPTIONAL_TAG","INJECT_TAG","MULTI_INJECT_TAG","TAGGED","TAGGED_PROP","PARAM_TYPES","DESIGN_PARAM_TYPES","POST_CONSTRUCT","EventType","this","emitter","EventEmitter","instance","eventNames","event","rawListeners","getMaxListeners","listener","off","prependOnceListener","prependListener","type","addListener","args","emit","listenerCount","listeners","on","once","removeAllListeners","removeListener","setMaxListeners","g","Function","e","DUPLICATED_INJECTABLE_DECORATOR","DUPLICATED_METADATA","NULL_ARGUMENT","KEY_NOT_FOUND","AMBIGUOUS_MATCH","CANNOT_UNBIND","NOT_REGISTERED","MISSING_INJECTABLE_ANNOTATION","MISSING_INJECT_ANNOTATION","UNDEFINED_INJECT_ANNOTATION","CIRCULAR_DEPENDENCY","NOT_IMPLEMENTED","INVALID_BINDING_TYPE","NO_MORE_SNAPSHOTS_AVAILABLE","INVALID_MIDDLEWARE_RETURN","INVALID_FUNCTION_BINDING","INVALID_TO_SELF_VALUE","INVALID_DECORATOR_OPERATION","ARGUMENTS_LENGTH_MISMATCH","values","_i","arguments","length","CONTAINER_OPTIONS_MUST_BE_AN_OBJECT","CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE","CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE","CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK","MULTIPLE_POST_CONSTRUCT_METHODS","POST_CONSTRUCT_ERROR","CIRCULAR_DEPENDENCY_IN_FACTORY","STACK_OVERFLOW","nodes","ways","node","way","mergeDefinitions","STATES","AsyncIterator","INIT","OPEN","ENDED","waitForDataListener","_state","_readable","self","eventName","end","destroy","_end","endAsync","setImmediate","_addSingleListener","emitData","readable","item","_hasListeners","read","done","func","copyProperty","source","destination","propertyName","getProperty","setProperty","EmptyIterator","_changeState","SingletonIterator","_item","close","ArrayIterator","items","_buffer","Array","slice","IntegerIterator","options","limit","step","last","next","start","_step","isFinite","Infinity","_last","_next","BufferedIterator","maxBufferSize","autoStart","_pushedCount","_reading","init","_init","fillBufferAsync","fillBufferAsyncCallback","_fillBuffer","TransformIterator","isFunction","_optional","_destroySource","destroySource","getSource","_source","destinationEmitError","error","_destination","destinationCloseWhenDone","_closeWhenDone","destinationFillBuffer","readAndTransform","ended","optionalTransform","_transform","pushedCount","_push","SimpleTransformIterator","offset","filter","map","transform","prepend","append","_limit","_offset","Math","max","_filter","_map","_prepender","_appender","readAndTransformSimple","count","closed","mappedItem","MultiTransformIterator","_transformerQueue","ClonedIterator","_readPosition","getSourceProperty","clone","callback","_properties","HistoryReader","clones","history","readAt","pos","endsAt","register","push","unregister","cloneIndex","indexOf","splice","clonesMakeReadable","clonesEmitError","clonesEnd","forEach","state","subclass","Constructor","constructor","configurable","writable","newState","eventAsync","valid","each","_events","cause","_destroy","set","propertyCallbacks","properties","_propertyCallbacks","callbacks","getProperties","copy","setProperties","copyProperties","propertyNames","toString","details","_toStringDetails","buffer","shift","current","range","_maxBufferSize","_begin","Error","_read","neededItems","_completeClose","min","_flush","_validateSource","allowDestination","wrap","_insert","inserter","mapper","surround","skip","take","head","transformer","transformerQueue","_createTransformer","hasProperty","base","empty","single","fromArray","graphTypes","types","IdentifierIssuer","JsonLdError","REGEX_LINK_HEADERS","REGEX_LINK_HEADER","REGEX_LINK_HEADER_PARAMS","DEFAULTS","accept","api","_setImmediate","_delay","fn","setTimeout","_invokeCallback","err","result","nextTick","process","rval","isArray","Map","k","v","Set","add","isObject","asArray","buildHeaders","headers","some","h","toLowerCase","RangeError","assign","Accept","parseLinkHeader","header","entries","match","target","params","exec","undefined","rel","validateTypeValue","isString","isEmptyObject","isValid","code","subject","hasValue","val","isList","compareValues","addValue","propertyIsArray","allowDuplicate","getValues","concat","removeProperty","removeValue","relabelBlankNodes","input","_labelBlankNodes","issuer","element","isBlankNode","getId","sort","ki","v1","v2","isValue","compareShortestLeast","a","b","normalizeDocumentLoader","callbackify","async","url","Promise","resolve","reject","remoteDoc","pop","apply","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","binding","cwd","chdir","dir","umask","Metadata","isBoolean","isDouble","isNumber","String","isNumeric","isNaN","parseFloat","isUndefined","Request","Singleton","Transient","ConstantValue","DynamicValue","Factory","Instance","Invalid","Provider","ClassProperty","ConstructorArgument","Variable","stopsSourceConfigs","connectionsSourceConfigs","catalogs","combinedCatalog","sourceCatalog","accessUrl","travelMode","TravelMode","isSubject","isSubjectReference","isGraph","isSimpleGraph","message","super","zoom","x","y","other","pow","otherX","floor","otherY","RoutingPhase","ERROR_MSGS","_tagParameterOrProperty","metadataKey","annotationTarget","metadata","parameterIndex","paramsOrPropertiesMetadata","isParameterDecorator","Reflect","hasOwnMetadata","getMetadata","paramOrPropertyMetadata","paramOrPropertyMetadata_1","defineMetadata","_decorate","decorators","_param","paramIndex","decorator","tagParameter","tagProperty","ctor","superCtor","super_","TempCtor","shortestPathTree","pointToPoint","routableTileRegistry","profileProvider","shortestPath","graphs","profile","graph","getGraphForProfile","createInstance","profileId","getProfile","hasAccess","edge","getParts","from","to","isObstacle","addEdge","distance","isOneWay","tileset","invert","getProfiles","bestEmbedding","bestDistance","wayId","getWays","getWay","reachable","segment","segments","nodeA","getNode","nodeB","intersection","segmentDistToPoint","point","segA","segB","getID","getDistance","duration","getDuration","cost","getCost","sx1","longitude","sx2","px","sy1","latitude","sy2","px2","py2","u","getDistanceBetweenLocations","idCounter","ReachableStopsSearchPhase","base64","ieee754","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","ArrayBuffer","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","obj","isBuffer","checked","data","fromObject","assertSize","size","isView","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","arrayIndexOf","lastIndexOf","arr","indexSize","arrLength","valLength","buf","readUInt16BE","foundIndex","found","j","hexWrite","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","fill","allocUnsafeSlow","_isBuffer","compare","list","swap16","swap32","swap64","equals","inspect","join","thisStart","thisEnd","thisCopy","targetCopy","includes","toJSON","_arr","ret","out","toHex","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","leadSurrogate","toByteArray","trim","replace","stringtrim","base64clean","src","dst","unhandledError","util","ActiveContextCache","_isArray","_isObject","_isString","_isUndefined","isAbsolute","_isAbsoluteIri","isRelative","_isRelativeIri","prependBase","parse","parseUrl","_asArray","_compareShortestLeast","MAX_CONTEXT_URLS","INITIAL_CONTEXT_CACHE","_expandIri","activeCtx","relativeTo","localCtx","defined","isKeyword","createTermDefinition","isPropertyTermScoped","previousContext","vocab","mapping","mappings","colon","prefix","suffix","has","_findContextUrls","urls","ctx","_ctx","prepended","resolved","cache","isPropertyTermScopedContext","isTypeScopedContext","ctxs","protected","protectedMode","console","warn","oldActiveCtx","getInitialContext","term","_protected","context","cached","processingMode","href","previousMapping","delete","simpleTerm","reverse","validKeys","kw","_termHasColon","_prefix","container","validContainers","hasSet","every","language","nest","_deepCompare","x1","x2","x1Array","k1s","k2s","k1","expandIri","JSON","stringify","initialContext","inverse","getInverse","fastCurieMap","irisToTerms","defaultLanguage","terms","ids","iri","entry","fastCurieEntry","_addPreferredTerm","_buildIriMap","child","revertTypeScopedContext","clear","iriMap","idx","letter","typeOrLanguageValue","getContextValue","getAllContexts","documentLoader","retrieve","doc","cycles","all","_cycles","document","contextUrl","_retrieveContextUrls","collectionFields","field","triples","views","entities","_extractEntities","entity","view","mapped","addEntity","getContents","scope","triple","termType","tripleObject","rawValue","valueType","datatype","inNS","XMLS","predicate","parsedValue","_parseValue","fieldData","stop","depLongitude","depLatitude","arrLongitude","arrLatitude","POSITIVE_INFINITY","unit","location","speed","hours","minutes","seconds","ReflectOwnKeys","R","ReflectApply","receiver","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","NumberIsNaN","_eventsCount","_maxListeners","defaultMaxListeners","$getMaxListeners","_addListener","events","existing","warning","newListener","unshift","warned","w","onceWrapper","fired","wrapFn","_onceWrap","wrapped","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","getPrototypeOf","doError","er","handler","position","originalListener","index","spliceOne","pna","objectKeys","Duplex","inherits","Readable","Writable","method","allowHalfOpen","onend","_writableState","onEndNT","highWaterMark","_readableState","destroyed","cb","HYDRA","OSM","GEO","RDF","RDFS","ROUTE","PLANNER","PROFILE","lastChar","substring","lat_to_tile","lat","log","tan","PI","cos","long_to_tile","lon","long","RoutableTileCoordinate","ProfileProviderDefault","fetcher","profiles","developmentProfile","developmentProfileCounter","blob","newProfile","parseProfileBlob","RoutableTileProviderDefault","registry","tiles","coordinate","getIdForTileCoords","lat2tile","long2tile","getByTileCoords","tile","getByUrl","RoutableTileSet","locations","getByLocation","coordinates","Path","legs","path","otherPath","leg","legIndex","otherLeg","compareEquals","getStartLocation","query","acc","getStartTime","Date","getTime","getExpectedDuration","minimumDepartureTime","getStopTime","getTravelTime","reduce","time","getTravelMode","Train","Bus","serviceIdentifier","getFunctionName","name_1","listRegisteredBindingsForServiceIdentifier","getBindings","registeredBindingsList","registeredBindings","implementationType","constraint","metaData","circularDependencyToException","request","childRequests","childRequest","alreadyDependencyChain","parentRequest","services","_createStringArr","req","dependencyChainToString","listMetadataForTarget","serviceIdentifierString","isTagged","isNamed","m_1","namedTag","getNamedTag","otherTags","getCustomTags","tag","catalogNmbs","addStopsSource","addConnectionsSource","ConnectionsFetcherRaw","beginTime","response","responseText","text","status","getInstance","Warning","connections","connectionId","arrivalTime","arrivalStop","arrivalDelay","departureTime","departureStop","departureDelay","nextConnection","tripId","route","dropOffType","pickupType","headsign","connection","pageId","nextPageUrl","previousPageUrl","LDFetchGet","LinkedConnectionsPage","Timeout","clearFn","_id","_clearFn","setInterval","clearInterval","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","clearImmediate","q","Fetcher","N3","RDFXMLParser","DOMParser","JsonldToRDF","RDFaToRDF","NodeHTMLParser","jsonld","DataFactory","prefixes","frame","then","objects","uri","getCacheStats","promise","defer","documentIRI","body","newPrefixes","statusCode","promises","promiseIndex","jsonldscriptelements","querySelectorAll","textContent","promises2","Parser","parseFromString","objectToString","isNull","isNullOrUndefined","isSymbol","isRegExp","re","isDate","isError","isPrimitive","usePureJavaScript","XSD","LINK_HEADER_REL","RDF_LIST","RDF_FIRST","RDF_REST","RDF_NIL","RDF_TYPE","RDF_PLAIN_LITERAL","RDF_XML_LITERAL","RDF_OBJECT","RDF_LANGSTRING","XSD_BOOLEAN","XSD_DOUBLE","XSD_INTEGER","XSD_STRING","parsers","simple","regex","full","parser","scheme","port","authority","normalizedPath","removeDotSegments","protocol","fragment","removeBase","baseSegments","split","iriSegments","output","isAbsoluteRegex","test","ldFetchBase","eventBus","setupEvents","httpStartTimes","ProfileFetcherDefault","ldFetch","ldLoader","defineCollection","toRDF","getView","ThingView","addFilter","addMapping","getRuleView","getConclusionView","getConditionView","StopsProviderDefault","stopsFetcherFactory","catalog","stopsFetchers","cachedStops","stopsFetcher","prefetchStops","stopId","getStopById","results","find","getAllStops","RoutableTileFetcherRaw","pathfinderProvider","createNode","createWay","processTileData","RoutableTile","registerEdges","registerNode","registerWay","RoutableTileNode","fakeExpand","RoutableTileWay","maxSpeed","weights","RoutableTileProviderTransit","DijkstraTree","CSAEarliestArrival","connectionsProvider","locationResolver","transferReachableStopsFinder","initialReachableStopsFinder","finalReachableStopsFinder","finalReachableStops","profilesByStop","enterConnectionByTrip","journeyExtractor","earliestIndex","earliest","lowerBoundDate","maximumArrivalTime","upperBoundDate","footpathsQueue","connectionsIterator","createIterator","connectionsQueue","forwardsConnectionSelector","hasInitialReachableStops","hasFinalReachableStops","initInitialReachableStops","initFinalReachableStops","isDone","extractJourneys","resultIterator","processConnections","arrivalProfile","exitConnection","enterConnection","departureStopId","arrivalStopId","canRemainSeated","canTakeTransfer","NotAvailable","canImprove","updateProfile","scheduleExtraConnections","sourceConnection","reachableStops","findReachableStops","Source","maximumTransferDuration","minimumWalkingSpeed","profileID","reachableStop","transferTentativeArrival","newArrivalTime","transferConnection","Walking","Regular","fromLocation","geoId","maximumWalkingDuration","AbortQuery","InitialReachableStops","toLocation","Target","FinalReachableStops","Transfer","Initial","Final","steps","getSteps","stepIndex","otherStep","getAverageDuration","getMinimumDuration","getMaximumDuration","previous","minimum","average","maximum","startTime","stopTime","startLocation","stopLocation","JourneyExtractorProfile","bestArrivalTime","filteredProfilesByStop","filterInfinity","departureLocation","arrivalLocation","paths","departureLocationProfiles","amountOfTransfers","transferProfiles","transferProfile","checkBestArrivalTime","extractJourney","setBestArrivalTime","bestArrivalTimesOfDepartureStop","transfers","currentTransferProfile","remainingTransfers","currentLocation","enterLocation","exitLocation","transferDepartureTime","timeToSubtract","footpath","footpathLeg","appendLeg","createFromConnections","getStopLocation","currentProfiles","profileIndex","transferArrivalTime","ReachableStopsFinderDelaunay","stopsProvider","roadPlanner","prepare","maximumDuration","minimumSpeed","baseProp","otherProp","baseQuery","stopsNearCell","getNearbyStops","possibleTarget","durationIterator","plan","totalDuration","durations","toArray","shortestDuration","cell","triangles","trianglePoints","stops","Delaunay","LocationResolverConvenience","tileRegistry","defaultLocationResolver","isId","allStops","matchingStop","testString","ConnectionsProviderDefault","connectionsFetcherFactory","pages","date","getIdForTime","toISOString","lowerBound","upperBound","backward","beginUrl","arg1","arg2","arg3","copyProps","SafeBuffer","createMergedNodeMap","createNodeMap","mergeNodeMaps","subjects","pi","referencedNode","reverseMap","reverseProperty","ii","itemName","oi","_list","mergeNodeMapGraphs","merged","mergedNode","defaultGraph","graphNames","graphName","nodeMap","labels","adjacencyList","reverseAdjacencyList","breakPoints","fromIndex","getNodeIndex","toIndex","label","TinyQueue","defaultCompare","_down","_up","top","bottom","parent","halfLength","left","best","right","RoadPlannerPathfinding","tileProvider","reachedTiles","fromLocations","toLocations","newPath","getPathBetweenLocations","embedLocation","_innerPath","pathfinder","getShortestPathAlgorithm","maxDistance","queryPath","Profile","tileId","FetchTile","boundaryNodes","nodeId","getNodes","contains","setBreakPoint","boundaryTileCoordinate","toTileCoordinate","fetchTile","fromBBox","fromTileCoords","tilesInBbox","fromTileset","getMultipleByTileCoords","Base","StopsFetcherRaw","ensureStopsLoaded","loadPromise","loadStops","catch","reason","fetch","latitudeRaw","longitudeRaw","stopTimeRaw","avgStopTimes","Planner","default","setContainer","queryRunner","activeProfileID","completePath","walkingDeparture","walkingDestination","walkingPathIterator","walkingPaths","walkingLeg","Query","iterator","PromiseProxyIterator","eventType","getContainer","prefetchConnections","parseDevelopmentProfile","setProfileID","Units","lonToX","latToY","lat_rad","bbox","xMin","xMax","yMin","yMax","z","binding_when_syntax_1","BindingOnSyntax","_binding","onActivation","BindingWhenSyntax","binding_on_syntax_1","when","whenTargetNamed","whenTargetIsDefault","whenTargetTagged","whenInjectedInto","whenParentNamed","whenParentTagged","whenAnyAncestorIs","ancestor","whenNoAncestorIs","whenAnyAncestorNamed","whenNoAncestorNamed","whenAnyAncestorTagged","whenNoAncestorTagged","whenAnyAncestorMatches","whenNoAncestorMatches","punycode","Url","slashes","auth","host","hostname","hash","search","pathname","urlParse","relative","resolveObject","format","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","unsafeProtocol","hostlessProtocol","slashedProtocol","querystring","parseQueryString","slashesDenoteHost","queryIndex","splitter","uSplit","rest","simplePath","proto","lowerProto","atSign","hostEnd","hec","decodeURIComponent","parseHost","ipv6Hostname","hostparts","part","newpart","validParts","notHost","bit","toASCII","ae","esc","encodeURIComponent","escape","qm","charAt","tkeys","tk","tkey","rkeys","rk","rkey","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","authInHost","hasTrailingSlash","up","canonize","NQuads","Rdfa","expand","_expand","flatten","_flatten","fromRDF","_fromRDF","_toRDF","frameMergedOrDefault","_frameMergedOrDefault","_isSubjectReference","_getInitialContext","_processContext","_getAllContexts","compact","_compact","compactIri","_compactIri","removePreserve","_removePreserve","_createNodeMap","_createMergedNodeMap","_mergeNodeMaps","_nodejs","_browser","wrapper","expanded","_setDefaults","compactArrays","compactToRelative","skipExpansion","link","processContext","compacted","compactionMap","tmp","hasContext","graphAlias","framing","keepFreeFloatingNodes","expansionMap","toResolve","contextsToProcess","expandContext","defaultBase","documentUrl","remoteContext","flattened","embed","explicit","requireAll","omitDefault","pruneBlankNodeIdentifiers","bnodesToClear","frameContext","opts","isFrame","expandedFrame","framed","normalize","algorithm","inputFormat","parsedInput","produceGeneralizedRdf","dataset","parsedDataset","rdfParser","_rdfParsers","legacyDatasetToQuads","serialize","merge","docs","mergeNodes","_graphs","_nodeMap","_documentLoader","loadDocument","load","documentLoaders","xhr","useDocumentLoader","defaults","registerRDFParser","contentType","unregisterRDFParser","RequestQueue","JsonLdProcessor","XMLHttpRequest","URDNA2015","URGNA2012","URDNA2015Sync","URGNA2012Sync","rdfCanonizeNative","_rdfCanonizeNative","canonical","useNative","main","canonizeSync","counter","old","identifier","forge","md","algorithms","REGEX","_compareTriples","t1","t2","eoln","RegExp","quad","lines","lineNumber","line","_unescapeRegex","U","unique","quads","serializeQuad","nquad","_escapeRegex","_escape","termTypeMap","componentName","oldComponent","newComponent","startsWith","_requests","loader","_loader","Step","enterConnectionId","exitConnectionId","compareLocations","ReachableStopsFinderFootpaths","footpathsProvider","sourceOrTargetStop","footpaths","otherStop","toDuration","BidirDijkstra","BidirDijkstraInstance","QueryRunnerDefault","publicTransportPlanner","resolvedQuery","resolveQuery","roadNetworkOnly","endpoint","singleEndpoint","maximumWalkingSpeed","walkingSpeed","maximumWalkingDistance","minimumTransferDuration","maximumTransferDistance","maximumTransfers","newDepartureTime","resolveEndpoint","defaultMinimumWalkingSpeed","defaultMaximumWalkingSpeed","defaultWalkingDuration","defaultMinimumTransferDuration","defaultMaximumTransferDuration","defaultMaximumTransfers","IsochroneGenerator","BasicTrainPlanner","DissectPlanner","TransitCarPlanner","TriangleDemoPlanner","exporter","makeExporter","hasOwn","supportsSymbol","toPrimitiveSymbol","toPrimitive","iteratorSymbol","supportsCreate","supportsProto","downLevel","HashMap","MakeDictionary","functionPrototype","usePolyfill","_Map","cacheSentinel","arraySentinel","MapIterator","selector","_index","_keys","_values","_selector","throw","return","_cacheKey","_cacheIndex","_find","getKey","getValue","getEntry","insert","_","CreateMapPolyfill","_Set","WeakMap","UUID_SIZE","rootKey","CreateUniqueKey","_key","table","GetOrCreateWeakMapTable","CreateUUID","FillRandomBytes","random","crypto","getRandomValues","msCrypto","byte","CreateWeakMapPolyfill","GetOrCreateMetadataMap","O","P","Create","targetMetadata","IsUndefined","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","GetMethod","IsCallable","IsObject","GetIterator","IteratorStep","nextValue","IteratorClose","Type","IsNull","ToPrimitive","PreferredType","hint","exoticToPrim","toString_1","valueOf","toString_2","OrdinaryToPrimitive","ToPropertyKey","argument","ToString","IsArray","IsConstructor","V","f","OrdinaryGetPrototypeOf","prototypeProto","__","propertyKey","attributes","decorated","DecorateConstructor","descriptor","DecorateProperty","metadataValue","IsPropertyKey","OrdinaryHasMetadata","OrdinaryGetMetadata","OrdinaryMetadataKeys","parentKeys","ownKeys_1","_a","parentKeys_1","getTagged","startPoint","showIncremental","showDebugLogs","embedded","activeProfile","maxDuration","reset","embedBeginPoint","loaded","getShortestPathTreeAlgorithm","pathTree","wait","setUseWeightedCost","continue","timeEnd","visualizeConcaveIsochrone","removeBreakPoint","innerNode","PointReached","getConstructorMetadata","constructorFunc","compilerGeneratedMetadata","userGeneratedMetadata","getPropertiesMetadata","isStackOverflowExeption","error_msgs_1","metadata_1","_cb","targetKey","queryable_string_1","namedOrTagged","QueryableString","metadataItem","hasTag","matchesArray","matchesTag","isOptional","matchesNamedTag","_this","BindingWhenOnSyntax","_bindingWhenSyntax","_bindingOnSyntax","bindings","inSingletonScope","toAutoFactory","Dijkstra","toFactory","setTravelMode","setAccessUrl","Transit","toConstantValue","__self__","F","DOMException","support","searchParams","iterable","Blob","formData","arrayBuffer","viewClasses","isArrayBufferView","normalizeName","normalizeValue","iteratorFor","Headers","consumed","bodyUsed","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","FileReader","readAsArrayBuffer","bufferClone","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","DataView","_bodyArrayBuffer","rejected","readAsText","chars","readArrayBufferAsText","decode","json","oldValue","thisArg","methods","upcased","credentials","signal","toUpperCase","referrer","form","Response","bodyInit","ok","statusText","redirectStatuses","redirect","stack","aborted","abortXhr","abort","rawHeaders","getAllResponseHeaders","parts","responseURL","ontimeout","onabort","open","withCredentials","responseType","setRequestHeader","addEventListener","onreadystatechange","readyState","removeEventListener","send","polyfill","FootpathsProviderDefault","getIdForLocation","getPathsView","nodesView","IndexThingView","Footpath","getOwnPropertyDescriptors","descriptors","getOwnPropertyDescriptor","formatRegExp","deprecate","msg","noDeprecation","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","seen","stylize","stylizeNoColor","depth","colors","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styleType","style","styles","recurseTimes","primitive","formatPrimitive","visibleKeys","arrayToHash","formatError","braces","toUTCString","formatProperty","formatArray","prev","cur","numLinesEst","reduceToSingleString","desc","ar","pad","debuglog","NODE_DEBUG","pid","months","timestamp","getHours","getMinutes","getSeconds","getDate","getMonth","prop","origin","kCustomPromisifiedSymbol","callbackifyOnRejected","newReason","promisify","original","promiseResolve","promiseReject","setPrototypeOf","defineProperties","custom","callbackified","maybeCb","rej","deferred","extend","statusCodes","http","defaultProtocol","ClientRequest","IncomingMessage","Agent","defaultMaxSockets","globalAgent","STATUS_CODES","METHODS","writableStream","WritableStream","abortController","AbortController","blobConstructor","getXHR","XDomainRequest","checkTypeSupport","haveArrayBuffer","haveSlice","arraybuffer","msstream","mozchunkedarraybuffer","overrideMimeType","vbArray","VBArray","stream","rStates","readyStates","UNSENT","OPENED","HEADERS_RECEIVED","LOADING","DONE","fetchTimer","_mode","trailers","rawTrailers","_fetchResponse","statusMessage","capability","chunk","_destroyed","_resumeFetch","pipeTo","getReader","_xhr","_pos","matches","_charset","mimeType","charsetMatch","_onXHRProgress","responseBody","newData","MSStreamReader","onprogress","Stream","Transform","PassThrough","ReadableState","EElistenerCount","OurUint8Array","debugUtil","debug","StringDecoder","BufferList","destroyImpl","kProxyEvents","isDuplex","objectMode","readableObjectMode","hwm","readableHwm","readableHighWaterMark","defaultHwm","pipes","pipesCount","flowing","endEmitted","reading","sync","needReadable","emittedReadable","readableListening","resumeScheduled","defaultEncoding","awaitDrain","readingMore","decoder","readableAddChunk","addToFront","skipChunkCheck","emitReadable","onEofChunk","chunkInvalid","_uint8ArrayToBuffer","addChunk","maybeReadMore","needMoreData","_undestroy","undestroy","isPaused","setEncoding","enc","MAX_HWM","howMuchToRead","computeNewHighWaterMark","emitReadable_","flow","maybeReadMore_","nReadingNextTick","resume_","fromList","hasStrings","nb","tail","copyFromBufferString","copyFromBuffer","fromListPartial","endReadable","endReadableNT","xs","nOrig","doRead","pipe","dest","pipeOpts","endFn","stdout","stderr","unpipe","onunpipe","unpipeInfo","hasUnpiped","onclose","onfinish","ondrain","ondata","cleanedUp","needDrain","pipeOnDrain","increasedAwaitDrain","pause","resume","dests","ev","paused","_fromList","emitErrorNT","readableDestroyed","writableDestroyed","errorEmitted","ending","finished","CorkedRequest","finish","corkReq","pendingcb","corkedRequestsFree","onCorkedFinish","asyncWrite","WritableState","internalUtil","realHasInstance","nop","writableObjectMode","writableHwm","writableHighWaterMark","finalCalled","noDecode","decodeStrings","writing","corked","bufferProcessing","onwrite","writecb","writelen","onwriteStateUpdate","finishMaybe","onwriteError","needFinish","bufferedRequest","clearBuffer","afterWrite","lastBufferedRequest","prefinished","bufferedRequestCount","_write","writev","_writev","final","_final","doWrite","onwriteDrain","holder","allBuffers","isBuf","callFinal","need","prefinish","getBuffer","hasInstance","writeAfterEnd","validChunk","newChunk","decodeChunk","writeOrBuffer","cork","uncork","setDefaultEncoding","endWritable","nenc","retried","_normalizeEncoding","normalizeEncoding","utf16Text","utf16End","fillLast","utf8FillLast","base64Text","base64End","simpleWrite","simpleEnd","lastNeed","lastTotal","utf8CheckByte","utf8CheckExtraBytes","total","utf8CheckIncomplete","afterTransform","ts","_transformState","transforming","writechunk","rs","needTransform","writeencoding","flush","_this2","err2","AsyncAlgorithm","MessageDigest","Permutator","POSITIONS","blankNodeInfo","hashToBlankNodes","canonicalIssuer","hashAlgorithm","schedule","now","nonNormalized","waterfall","forEachComponent","component","whilst","hashFirstDegreeQuads","hashes","idList","hashPathList","hasId","hashNDegreeQuads","normalized","info","nquads","modifyFirstDegreeComponent","update","digest","related","getRelatedPredicate","hashToRelated","createHashToRelated","chosenIssuer","chosenPath","permutator","hasNext","nextPermutation","permutation","issuerCopy","recursionList","hashRelatedBlankNode","op","baseN","_checkBitsParam","ByteStringBuffer","isArrayBuffer","putByte","_constructedStringLength","postMessage","stopPropagation","MutationObserver","attr","div","createElement","observe","oldSetImmediate","setAttribute","isNodejs","globalScope","ByteBuffer","_optimizeConstructedString","isEmpty","putBytes","fillWithByte","putString","encodeUtf8","putInt16","putInt24","putInt32","putInt16Le","putInt24Le","putInt32Le","putInt","putSignedInt","putBuffer","getBytes","getByte","getInt16","getInt24","getInt32","getInt16Le","getInt24Le","getInt32Le","getInt","getSignedInt","at","setAt","truncate","decodeUtf8","DataBuffer","readOffset","growSize","writeOffset","accommodate","amount","setUint8","ceil","binary","hex","raw","Uint16Array","utf16","encode","setInt16","setInt8","setInt32","getInt8","getUint8","utf8","fillString","xorBytes","s1","s2","s3","hexToBytes","bytesToHex","int32ToBytes","_base64","_base64Idx","_base58","encode64","maxline","chr1","chr2","chr3","decode64","enc1","enc2","enc3","enc4","unescape","base58","deflate","inflate","_setStorageObject","removeItem","setItem","_getStorageObject","getItem","_setItem","_getItem","_removeItem","_clearItems","_callStorageFunction","exception","localStorage","ex","clearItems","lastIndex","fullHost","_queryVariables","getQueryVariables","kvpairs","parseFragment","fp","fq","pathString","queryString","makeRequest","reqString","frag","getPath","getQuery","getQueryLast","_default","vals","makeLink","jQuery","qstr","param","setPath","deletePath","argi","formatNumber","number","decimals","dec_point","thousands_sep","abs","toFixed","formatSize","bytesFromIP","ip","bytesFromIPv4","bytesFromIPv6","num","blanks","zeros","bytesToIP","bytesToIPv4","bytesToIPv6","zeroGroups","zeroMaxGroup","group","estimateCores","cores","navigator","hardwareConcurrency","Worker","blobUrl","URL","createObjectURL","st","et","sample","samples","numWorkers","avg","revokeObjectURL","workers","worker","terminate","overlaps","r1","overlap","r2","DefaultGraph","NamedNode","entityType","filters","nestedViews","showId","resultObject","createResultObject","SingleThingViewResult","kv","entityValue","valueElementIndex","valueElement","_makeList","_flattenLists","fieldView","destinationField","tile_to_lat","atan","exp","tile_to_long","DijkstraInstance","DropOffType","ReachableStopsFinderMode","sourceIterators","condensed","waitingForFill","addListeners","fillValues","selectedIndex","indexMap","getCondensedValues","waiting","filledValues","filled","sourceIndex","fillValue","waitForValue","originalIndex","iter","QueryRunnerExponential","publicTransportPlannerFactory","resolveBaseQuery","queryIterator","subqueryIterator","runSubquery","SubQuery","planner","__export","Defaults","fromMinutes","InvalidQuery","twoProduct","robustSum","robustScale","robustSubtract","NUM_EXPAND","cofactor","generateSum","expr","determinant","orientation","neg","matrix","posExpr","negExpr","funcName","proc","orientation3Exact","orientation4Exact","CACHED","det","tol","adx","bdx","cdx","ady","bdy","cdy","adz","bdz","cdz","bdxcdy","cdxbdy","cdxady","adxcdy","adxbdy","bdxady","slowOrient","procArgs","generateOrientationProc","SPLITTER","ahi","alo","bhi","blo","ReachableStopsFinderOnlySelf","ConnectionsProviderMerge","defaultProviders","subCatalog","latestIndex","latest","iterators","provider","backwardsConnectionsSelector","FootpathsProviderRaw","EPSILON","Delaunator","points","getX","getY","defaultGetX","defaultGetY","coords","Float64Array","minX","minY","maxX","maxY","Uint32Array","cx","cy","i0","i1","i2","minDist","dist","i0x","i0y","i1x","i1y","minRadius","circumradius","i2x","i2y","orient","center","ax","ay","bx","by","dx","dy","ey","bl","cl","circumcenter","_cx","_cy","quicksort","temp","_hashSize","sqrt","_hash","hull","insertNode","_hashEdge","maxTriangles","halfedges","Int32Array","trianglesLen","_addTriangle","xp","yp","startKey","_hashKey","removed","walkBack","_legalize","removeNode","pseudoAngle","a0","b0","al","p0","pr","pl","p1","py","fx","fy","bp","cp","inCircle","hbl","_link","br","qx","qy","rx","ry","epsilon","_x0","_y0","_x1","_y1","x0","y0","Polygon","delaunay","xmin","ymin","xmax","ymax","circumcenters","vectors","t3","y1","y2","x3","y3","a2","a3","b2","b3","d1","d2","d3","ab","ti","tj","xi","yi","xj","yj","_renderSegment","_project","rect","_clip","moveTo","lineTo","closePath","cellPolygon","polygon","renderCell","S","c0","_regioncode","c1","_clipSegment","inedges","e0","_cell","_clipInfinite","_clipFinite","e1","sx0","sy0","_edgecode","_edge","vx0","vy0","vxn","vyn","vx","vy","tau","pointX","pointY","outedges","node0","node1","bounds","dc","neighbors","dt","renderHull","arc","t0","trianglePolygon","renderTriangle","flatArray","flatIterable","__awaiter","_arguments","generator","fulfilled","__generator","sent","trys","ops","verb","binding_1","planner_1","resolver_1","binding_to_syntax_1","container_snapshot_1","lookup_1","containerOptions","defaultScope","autoBindInjectable","skipBaseClassChecks","_bindingDictionary","Lookup","_snapshots","_middleware","_metadataReader","container1","container2","bindingDictionary","getBindingDictionary","bindingDictionary1","bindingDictionary2","copyDictionary","traverse","getHelpers","_getContainerModuleHelpersFactory","modules_1","currentModule","containerModuleHelpers","bindFunction","unbindFunction","isboundFunction","rebindFunction","loadAsync","modules_2","_b","unload","conditionFactory","expected","condition","removeByCondition","Binding","BindingToSyntax","rebind","unbind","remove","unbindAll","isBound","bound","hasKey","isBoundNamed","isBoundTagged","request_1","createMockRequest","snapshot","ContainerSnapshot","of","restore","middleware","createChild","applyMiddleware","middlewares","initial","_planAndResolve","curr","applyCustomMetadataReader","metadataReader","_get","getNamed","getAll","getAllTagged","getAllNamed","constructorFunction","tempContainer","toSelf","setModuleId","bindingToSyntax","getRebindFunction","_rebind","mId","_bind","_isBound","_unbind","avoidConstraints","isMultiInject","targetType","defaultArgs","contextInterceptor","activated","dynamicValue","binding_count_1","exceptions_1","context_1","plan_1","reflection_utils_1","target_1","cntnr","_getActiveBindings","activeBindings","BindingCount","NoBindingsAvailable","OnlyOneBindingAvailable","MultipleBindingsAvailable","_validateActiveBindingCount","injectMetadata","tagMetadata","_createTarget","_createSubRequests","thePlan","Plan","addPlan","addChildRequest","subChildRequest","dependencies","getDependencies","baseClassDependencyCount","getBaseClassDependencyCount","dependency","rootRequest","setCurrentRequest","currentRequest","parentContext","getTargets","constructorName","isBaseClass","serviceIdentifiers","constructorArgsMetadata","constructorTargets","iterations","targets","getConstructorArgsAsTarget","getConstructorArgsAsTargets","propertyTargets","getClassPropsAsTargets","classPropsMetadata","keys_1","formatTargetMetadata","baseConstructor","baseTargets","isManaged","injectIdentifier","targetMetadataMap","unmanagedCount","dependencyCount","searchString","endsWith","reverseString","reverseSearchString","compareString","requestScope","instantiation_1","invokeFactory","factoryType","_resolveRequest","targetIsAnArray","targetParentIsNotAnArray","_f","isSingleton","isRequestSingleton","resolveInstance","constr","resolveRequest","Func","injections","constructorInjections","propertyInjectionsRequests","propertyInjections","injection","_injectProperties","hasMetadata","_postConstruct","binding_in_when_on_syntax_1","binding_when_on_syntax_1","BindingInWhenOnSyntax","toDynamicValue","toConstructor","toFunction","bindingWhenOnSyntax","toProvider","toService","service","binding_in_syntax_1","_bindingInSyntax","BindingInSyntax","inRequestScope","inTransientScope","getMap","updatedEntries","ERRORS_MSGS","previousPageId","nextPageId","fetchPage","currentPage","currentIndex","getConnections","getPreviousPageId","registerImmediate","html","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","attachTo","handle","runIfPresent","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","documentElement","script","removeChild","appendChild","attachEvent","task","getNextPageId","https","URLParser","HttpFetcher","customHeaders","_accept","_customHeaders","methodName","parsedUrl","settings","executionResponse","responseStream","chunks","totalBytes","onResponse","responseUrl","cancelAll","toArrayBuffer","preferBinary","_opts","_body","_headers","setHeader","useFetch","decideMode","_fetchTimer","_onFinish","lowerName","unsafeHeaders","getHeader","removeHeader","headersObj","headersList","keyName","controller","_fetchAbortController","requestTimeout","_connect","_response","statusValid","flushHeaders","setNoDelay","setSocketKeepAlive","b64","lens","getLens","validLen","placeHoldersLen","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","_classCallCheck","config","arrayCopy","nodeType","freeGlobal","maxInt","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexPunycode","regexNonASCII","regexSeparators","errors","baseMinusTMin","stringFromCharCode","mapDomain","ucs2decode","extra","ucs2encode","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","basic","oldi","baseMinusT","inputLength","bias","handledCPCount","basicLength","currentValue","handledCPCountPlusOne","qMinusT","webpackPolyfill","children","qs","sep","eq","regexp","maxKeys","kstr","vstr","stringifyPrimitive","ks","validateParams","plainTerm","namedNode","blankNode","literal","addEqualsMethodToQuad","maxCallStackDepth","maxTotalCallStackDepth","timeSlice","MAX_DEPTH","MAX_TOTAL_DEPTH","totalDepth","work","running","deadline","iterate","doWork","fns","loop","sha1","_initialized","_padding","_input","_w","blockLength","digestLength","messageLength","fullMessageLength","messageLengthSize","messageLength64","int32s","h0","h1","h2","h3","h4","_update","finalBlock","overflow","bits","_reverseAlphabets","alphabet","first","digits","carry","_encodeWithByteBuffer","sha256","_k","h5","h6","h7","s0","maj","_Node","getXMLSerializerClass","XMLSerializer","Node","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","getSubjects","si","getSubjectTriples","predicates","serializer","serializeToString","nodeValue","_isEmptyObject","_isList","_isValue","_isGraph","_getContextValue","_isKeyword","_addValue","_getValues","_validateTypeValue","_expandLanguageMap","languageMap","expandedKey","_expandIndexMap","activeProperty","asGraph","indexKey","isTypeIndex","insideList","insideIndex","typeScopedContext","unmappedValue","expandedProperty","_expandValue","expandedParent","expandedActiveProperty","mustRevert","_expandObject","nests","expandedValue","unmappedProperty","keyword","termCtx","nextActiveProperty","useArray","nestedValues","nv","validCount","order","level1","_RDFToObject","useNativeTypes","useRdfType","graphMap","referencedOnce","objectIsNode","usages","graphObject","nil","usage","listNodes","nodeKeyCount","listNode","graphSubjects","graphSubject","_graphToRDF","graphTerm","_listToRDF","_objectToRDF","toExponential","_mergeNodeMapGraphs","_createImplicitFrame","flags","_createsCircularReference","subjectToEmbed","subjectStack","_getFrameFlag","_validateFrame","_filterSubject","wildcard","matchesSome","matchThis","nodeValues","tt","thisFrame","hasDefault","_valueMatch","_nodeMatch","listValue","nodeListValues","lv","_removeEmbed","embeds","uniqueEmbeds","removeDependents","_addFrameOutput","pattern","nodeObject","l1","l2","graphStack","bnodeMap","_filterSubjects","recurse","subframe","preserve","reverseProp","_isSimpleGraph","_removeBase","_checkNestProperty","nestProperty","linked","compactValue","insideReverse","typeContext","compactedType","alias","itemActiveProperty","nestResult","expandedItem","inner","compactedItem","mapObject","idKey","typeKey","compactedValue","compactedProperty","isType","valueContext","expandedIri","inverseCtx","containers","typeOrLanguage","commonLanguage","commonType","itemLanguage","itemType","prefs","containerMap","ci","typeOrLanguageValueMap","pref","_selectTerm","choice","partialMatches","maxPartialLength","curie","preserveIndex","keyCount","isValueOnlyKey","hasDefaultLanguage","isValueString","hasNullMapping","idAlias","secure","strictSSL","maxRedirects","wrapLoader","redirects","_request","followRedirect","httpStatusCode","linkHeader","getResponseHeader","BlankNode","Literal","Quad","languageOrDatatype","defaultGraphInstance","variable","nextId","stringDatatype","langStringDatatype","RDFaProcessor","processor","onTriple","baseURI","documentURI","IndexThingViewResult","contents","CharacteristicProfile","accessCache","onewayCache","speedCache","priorityCache","characteristic","getWayCharacteristic","getSpeed","getMultiplier","accessRestrictions","bicycleAccessRestrictions","constructionKind","crossingKind","cyclewayKind","footwayKind","highwayKind","motorVehicleAccessRestrictions","motorcarAccessRestrictions","onewayBicycleKind","onewayKind","smoothnessKind","surfaceKind","trackType","vehicleAccessRestrictions","DynamicProfile","accessRules","onewayRules","speedRules","priorityRules","obstacleRules","obstacleTimeRules","usePublicTransport","rule","conclusion","isOneway","speedLimit","getMaxSpeed","getDefaultSpeed","priority","getObstacleTime","obstacleTime","RADII","toRad","convertCoordinates","haversine","km","mile","meter","nmi","lng","geometry","startCoordinates","endCoordinates","dLat","dLon","lat1","lat2","sin","atan2","threshold","ProfileConclusion","ProfileCondition","ProfileRule","StopsFetcherLDFetch","parseTriples","transformPredicate","stopMap","transformMap","DijkstraTreeInstance","useWeightedCost","maxCost","costs","getAdjacencyList","previousNodes","nextQueue","getBreakPoint","getLabel","previousPosition","previousLabel","previousNode","missingCosts","setCost","currentPosition","nextEdge","nextPositionCost","getReverseAdjacencyList","PickupType","backwards","shouldClose","JourneyExtractorEarliestArrival","currentStopId","currentProfile","prependLeg","maxLegs","trip","transferDuration","getArrivalTimeByTransfers","asynciterator_1","sourceGetter","comparator","store","isUnique","storedObject","isLastResultIterator","currentResultIterator","runQuery","initialTimespan","timespan","LocationResolverDefault","resolveById","hasCoords","resolvedLocation","createTriangulation","clusterNodes","allNodes","relevantNodes","forest","nodeIndex","neighbor","union","clusters","getClusters","pointBetween","node2","nodeCost1","nodeCost2","costDifference1","costDifference2","relDifference1","relDifference2","weight","branch","isochrones","concaveman","internalNodes","externalNodes","internalClusters","externalClusters","cluster","internalCluster","rings","borderLocations","firstNode","ring","currentNode","createPolygon","rbush","convexHull","Queue","pointInPolygon","concavity","lengthThreshold","cull","filtered","indices","fastConvexHull","tree","segTree","updateBBox","sqConcavity","sqLenThreshold","sqLen","getSqDist","maxSqLen","findCandidate","concave","maxDist","compareDist","leaf","sqSegDist","sqSegBoxDist","peek","d0","noIntersections","inside","sqSegSegDist","d4","q1","p2","q2","edges","sc","sN","tc","tN","ux","uy","wx","wy","D","sD","tD","quickselect","maxEntries","_maxEntries","_minEntries","_initFormat","findItem","equalsFn","calcBBox","toBBox","distBBox","destNode","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","intersects","height","multiSelect","mid","_all","childBBox","nodesToSearch","collides","_build","_splitRoot","tmpNode","goingUp","indexes","_condense","compareMinX","compareMinY","fromJSON","N","M","right2","right3","N2","N1","_chooseSubtree","level","targetNode","area","enlargement","minArea","minEnlargement","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","bbox1","bbox2","minOverlap","_allDistMargin","leftBBox","rightBBox","margin","siblings","compareArr","quickselectStep","sd","newLeft","newRight","sorted","lower","upper","ptr","nl","ne","nf","bv","scalarScalar","eptr","fptr","ei","ea","fi","fa","_x","_bv","q0","twoSum","scale","pq","vs","ranks","xRoot","yRoot","StepResultKind","forwardQueue","backwardQueue","forwardCosts","forwardParents","backwardCosts","backwardParents","setForwardCost","setBackwardCost","forwardResult","backwardResult","forwardStep","backwardStep","kind","Break","NodeHandled","constructPath","forwardSteps","backwardSteps","getBackwardCost","getForwardCost","Continue","combined","combine","catalogDeLijn","catalogMivb","RoadPlannerPathfindingExperimental","baseTileProvider","transitTileProvider","localTiles","localTile","local","baseTileId","transitTileId","pickTile","CSAEarliestArrivalVerbose","ReachableStopsFinderFootpathsVerbose","ReachableStop"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlannerJS\"] = factory();\n\telse\n\t\troot[\"PlannerJS\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 85);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar keys = require(\"./constants/metadata_keys\");\nexports.METADATA_KEY = keys;\nvar container_1 = require(\"./container/container\");\nexports.Container = container_1.Container;\nvar literal_types_1 = require(\"./constants/literal_types\");\nexports.BindingScopeEnum = literal_types_1.BindingScopeEnum;\nexports.BindingTypeEnum = literal_types_1.BindingTypeEnum;\nexports.TargetTypeEnum = literal_types_1.TargetTypeEnum;\nvar container_module_1 = require(\"./container/container_module\");\nexports.AsyncContainerModule = container_module_1.AsyncContainerModule;\nexports.ContainerModule = container_module_1.ContainerModule;\nvar injectable_1 = require(\"./annotation/injectable\");\nexports.injectable = injectable_1.injectable;\nvar tagged_1 = require(\"./annotation/tagged\");\nexports.tagged = tagged_1.tagged;\nvar named_1 = require(\"./annotation/named\");\nexports.named = named_1.named;\nvar inject_1 = require(\"./annotation/inject\");\nexports.inject = inject_1.inject;\nexports.LazyServiceIdentifer = inject_1.LazyServiceIdentifer;\nvar optional_1 = require(\"./annotation/optional\");\nexports.optional = optional_1.optional;\nvar unmanaged_1 = require(\"./annotation/unmanaged\");\nexports.unmanaged = unmanaged_1.unmanaged;\nvar multi_inject_1 = require(\"./annotation/multi_inject\");\nexports.multiInject = multi_inject_1.multiInject;\nvar target_name_1 = require(\"./annotation/target_name\");\nexports.targetName = target_name_1.targetName;\nvar post_construct_1 = require(\"./annotation/post_construct\");\nexports.postConstruct = post_construct_1.postConstruct;\nvar metadata_reader_1 = require(\"./planning/metadata_reader\");\nexports.MetadataReader = metadata_reader_1.MetadataReader;\nvar id_1 = require(\"./utils/id\");\nexports.id = id_1.id;\nvar decorator_utils_1 = require(\"./annotation/decorator_utils\");\nexports.decorate = decorator_utils_1.decorate;\nvar constraint_helpers_1 = require(\"./syntax/constraint_helpers\");\nexports.traverseAncerstors = constraint_helpers_1.traverseAncerstors;\nexports.taggedConstraint = constraint_helpers_1.taggedConstraint;\nexports.namedConstraint = constraint_helpers_1.namedConstraint;\nexports.typeConstraint = constraint_helpers_1.typeConstraint;\nvar serialization_1 = require(\"./utils/serialization\");\nexports.getServiceIdentifierAsString = serialization_1.getServiceIdentifierAsString;\nvar binding_utils_1 = require(\"./utils/binding_utils\");\nexports.multiBindToService = binding_utils_1.multiBindToService;\n","import TravelMode from \"./enums/TravelMode\";\nimport IConnectionsFetcher from \"./fetcher/connections/IConnectionsFetcher\";\nimport IStopsFetcher from \"./fetcher/stops/IStopsFetcher\";\nimport IRoutableTileFetcher from \"./fetcher/tiles/IRoutableTileFetcher\";\n\nconst TYPES = {\n  EventBus: Symbol(\"EventBus\"),\n  Context: Symbol(\"Context\"),\n  QueryRunner: Symbol(\"QueryRunner\"),\n  LocationResolver: Symbol(\"LocationResolver\"),\n\n  ConnectionsProvider: Symbol(\"ConnectionsProvider\"),\n  ConnectionsFetcher: Symbol(\"ConnectionsFetcher\"),\n  ConnectionsFetcherFactory: Symbol(\"ConnectionsFetcherFactory\"),\n\n  StopsProvider: Symbol(\"StopsProvider\"),\n  StopsFetcher: Symbol(\"StopsFetcher\"),\n  StopsFetcherFactory: Symbol(\"StopsFetcherFactory\"),\n\n  RoutableTileProvider: Symbol(\"TileProvider\"),\n  RoutableTileFetcher: Symbol(\"TileFetcher\"),\n  RoutableTileRegistry: Symbol(\"RoutableTileRegistry\"),\n\n  FootpathsProvider: Symbol(\"FootpathsProvider\"),\n\n  PublicTransportPlanner: Symbol(\"PublicTransportPlanner\"),\n  PublicTransportPlannerFactory: Symbol(\"PublicTransportPlannerFactory\"),\n\n  ProfileFetcher: Symbol(\"ProfileFetcher\"),\n  ProfileProvider: Symbol(\"ProfileProvider\"),\n  RoadPlanner: Symbol(\"RoadPlanner\"),\n  RoadPlannerFactory: Symbol(\"RoadPlannerFactory\"),\n  PathfinderProvider: Symbol(\"PathfinderProvider\"),\n  ShortestPathAlgorithm: Symbol(\"ShortestPathAlgorithm\"),\n  ShortestPathTreeAlgorithm: Symbol(\"ShortestPathTreeAlgorithm\"),\n\n  ReachableStopsFinder: Symbol(\"ReachableStopsFinder\"),\n  JourneyExtractor: Symbol(\"JourneyExtractor\"),\n  LDFetch: Symbol(\"LDFetch\"),\n  LDLoader: Symbol(\"LDLoader\"),\n  Catalog: Symbol(\"Catalog\"),\n};\n\nexport default TYPES;\n\nexport type StopsFetcherFactory = (accessUrl: string) => IStopsFetcher;\nexport type ConnectionsFetcherFactory = (travelMode: TravelMode) => IConnectionsFetcher;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NAMED_TAG = \"named\";\nexports.NAME_TAG = \"name\";\nexports.UNMANAGED_TAG = \"unmanaged\";\nexports.OPTIONAL_TAG = \"optional\";\nexports.INJECT_TAG = \"inject\";\nexports.MULTI_INJECT_TAG = \"multi_inject\";\nexports.TAGGED = \"inversify:tagged\";\nexports.TAGGED_PROP = \"inversify:tagged_props\";\nexports.PARAM_TYPES = \"inversify:paramtypes\";\nexports.DESIGN_PARAM_TYPES = \"design:paramtypes\";\nexports.POST_CONSTRUCT = \"post_construct\";\n","enum EventType {\n  Query = \"query\",\n  SubQuery = \"sub-query\",\n  AbortQuery = \"abort-query\",\n  InvalidQuery = \"invalid-query\",\n\n  LDFetchGet = \"ldfetch-get\",\n\n  Warning = \"warning\",\n\n  ConnectionPrefetch = \"connection-prefetch\",\n  ConnectionIteratorView = \"connection-iterator-view\",\n\n  FetchTile = \"fetch-tile\",\n  PointReached = \"point-reached\",\n\n  ConnectionScan = \"connection-scan\",\n  FinalReachableStops = \"final-reachable-stops\",\n  InitialReachableStops = \"initial-reachable-stops\",\n  AddedNewTransferProfile = \"added-new-transfer-profile\",\n\n  ReachableStop = \"ReachableStop\",\n  ReachableTile = \"ReachableTile\",\n}\n\nexport default EventType;\n","import { EventEmitter } from \"events\";\nimport { injectable } from \"inversify\";\n\n/**\n * Proxies an internal EventEmitter (instead of extending EventEmitter) because\n * ´decorate(injectable(), EventEmitter)´ causes errors when running tests in Jest\n */\n@injectable()\nexport default class EventBus implements EventEmitter {\n  public static getInstance(): EventBus {\n    if (!EventBus.instance) {\n      EventBus.instance = new EventBus();\n    }\n\n    return EventBus.instance;\n  }\n\n  private static instance: EventBus;\n  private emitter: EventEmitter;\n\n  private constructor() {\n    this.emitter = new EventEmitter();\n  }\n\n  public eventNames(): Array<(string | symbol)> {\n    return this.emitter.eventNames();\n  }\n\n  // tslint:disable-next-line: ban-types\n  public rawListeners(event: string | symbol): Function[] {\n    return this.emitter.rawListeners(event);\n  }\n\n  public getMaxListeners(): number {\n    return this.emitter.getMaxListeners();\n  }\n\n  public off(event: string | symbol, listener: (...args: any[]) => void): this {\n    this.emitter.off(event, listener);\n\n    return this;\n  }\n\n  public prependOnceListener(event: string | symbol, listener: (...args: any[]) => void): this {\n    this.emitter.prependOnceListener(event, listener);\n\n    return this;\n  }\n\n  public prependListener(event: string | symbol, listener: (...args: any[]) => void): this {\n    this.emitter.prependListener(event, listener);\n\n    return this;\n  }\n\n  public addListener(type: string | symbol, listener: any): this {\n    this.emitter.addListener(type, listener);\n\n    return this;\n  }\n\n  public emit(type: string | symbol, ...args: any[]): boolean {\n    return this.emitter.emit(type, ...args);\n  }\n\n  public listenerCount(type: string | symbol): number {\n    return this.emitter.listenerCount(type);\n  }\n\n  public listeners(type: string | symbol): any[] {\n    return this.emitter.listeners(type);\n  }\n\n  public on(type: string | symbol, listener: any): this {\n    this.emitter.on(type, listener);\n\n    return this;\n  }\n\n  public once(type: string | symbol, listener: any): this {\n    this.emitter.once(type, listener);\n\n    return this;\n  }\n\n  public removeAllListeners(type?: string | symbol): this {\n    this.emitter.removeAllListeners(type);\n\n    return this;\n  }\n\n  public removeListener(type: string | symbol, listener: any): this {\n    this.emitter.removeListener(type, listener);\n\n    return this;\n  }\n\n  public setMaxListeners(n: number): this {\n    this.emitter.setMaxListeners(n);\n\n    return this;\n  }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DUPLICATED_INJECTABLE_DECORATOR = \"Cannot apply @injectable decorator multiple times.\";\nexports.DUPLICATED_METADATA = \"Metadata key was used more than once in a parameter:\";\nexports.NULL_ARGUMENT = \"NULL argument\";\nexports.KEY_NOT_FOUND = \"Key Not Found\";\nexports.AMBIGUOUS_MATCH = \"Ambiguous match found for serviceIdentifier:\";\nexports.CANNOT_UNBIND = \"Could not unbind serviceIdentifier:\";\nexports.NOT_REGISTERED = \"No matching bindings found for serviceIdentifier:\";\nexports.MISSING_INJECTABLE_ANNOTATION = \"Missing required @injectable annotation in:\";\nexports.MISSING_INJECT_ANNOTATION = \"Missing required @inject or @multiInject annotation in:\";\nexports.UNDEFINED_INJECT_ANNOTATION = function (name) {\n    return \"@inject called with undefined this could mean that the class \" + name + \" has \" +\n        \"a circular dependency problem. You can use a LazyServiceIdentifer to  \" +\n        \"overcome this limitation.\";\n};\nexports.CIRCULAR_DEPENDENCY = \"Circular dependency found:\";\nexports.NOT_IMPLEMENTED = \"Sorry, this feature is not fully implemented yet.\";\nexports.INVALID_BINDING_TYPE = \"Invalid binding type:\";\nexports.NO_MORE_SNAPSHOTS_AVAILABLE = \"No snapshot available to restore.\";\nexports.INVALID_MIDDLEWARE_RETURN = \"Invalid return type in middleware. Middleware must return!\";\nexports.INVALID_FUNCTION_BINDING = \"Value provided to function binding must be a function!\";\nexports.INVALID_TO_SELF_VALUE = \"The toSelf function can only be applied when a constructor is \" +\n    \"used as service identifier\";\nexports.INVALID_DECORATOR_OPERATION = \"The @inject @multiInject @tagged and @named decorators \" +\n    \"must be applied to the parameters of a class constructor or a class property.\";\nexports.ARGUMENTS_LENGTH_MISMATCH = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"The number of constructor arguments in the derived class \" +\n        (values[0] + \" must be >= than the number of constructor arguments of its base class.\");\n};\nexports.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = \"Invalid Container constructor argument. Container options \" +\n    \"must be an object.\";\nexports.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = \"Invalid Container option. Default scope must \" +\n    \"be a string ('singleton' or 'transient').\";\nexports.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = \"Invalid Container option. Auto bind injectable must \" +\n    \"be a boolean\";\nexports.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = \"Invalid Container option. Skip base check must \" +\n    \"be a boolean\";\nexports.MULTIPLE_POST_CONSTRUCT_METHODS = \"Cannot apply @postConstruct decorator multiple times in the same class\";\nexports.POST_CONSTRUCT_ERROR = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"@postConstruct error in class \" + values[0] + \": \" + values[1];\n};\nexports.CIRCULAR_DEPENDENCY_IN_FACTORY = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"It looks like there is a circular dependency \" +\n        (\"in one of the '\" + values[0] + \"' bindings. Please investigate bindings with\") +\n        (\"service identifier '\" + values[1] + \"'.\");\n};\nexports.STACK_OVERFLOW = \"Maximum call stack size exceeded\";\n","import { injectable } from \"inversify\";\nimport { IRoutableTileNodeIndex, RoutableTileNode } from \"./node\";\nimport { IRoutableTileWayIndex, RoutableTileWay } from \"./way\";\n\n@injectable()\nexport default class RoutableTileRegistry {\n    private nodes: IRoutableTileNodeIndex;\n    private ways: IRoutableTileWayIndex;\n\n    constructor() {\n        this.nodes = {};\n        this.ways = {};\n    }\n\n    public registerNode(node: RoutableTileNode) {\n        this.nodes[node.id] = node;\n    }\n\n    public registerWay(way: RoutableTileWay) {\n        if (!this.ways[way.id]) {\n            this.ways[way.id] = way;\n        } else {\n            // creates a new Way instance\n            // avoids overwriting data from the individual tile definitions\n            // otherwise ways might refer to nodes that aren't in the tile\n            this.ways[way.id] = way.mergeDefinitions(this.ways[way.id]);\n        }\n    }\n\n    public getNode(id: string): RoutableTileNode {\n        return this.nodes[id];\n    }\n\n    public getWay(id: string): RoutableTileWay {\n        return this.ways[id];\n    }\n\n    public getNodes(): RoutableTileNode[] {\n        return Object.values(this.nodes);\n    }\n\n    public getWays(): RoutableTileWay[] {\n        return Object.values(this.ways);\n    }\n}\n","var EventEmitter = require('events').EventEmitter;\n\n/**\n  Names of possible iterator states.\n  The state's position in the array corresponds to its ID.\n\n  @name AsyncIterator.STATES\n  @type String[]\n  @protected\n*/\nvar STATES = AsyncIterator.STATES = ['INIT', 'OPEN', 'CLOSING', 'CLOSED', 'ENDED', 'DESTROYED'];\nvar INIT = 0, OPEN = 1, CLOSING = 2, CLOSED = 3, ENDED = 4, DESTROYED = 5;\nSTATES.forEach(function (state, id) { AsyncIterator[state] = id; });\n\n/**\n  ID of the INIT state.\n  An iterator is initializing if it is preparing main item generation.\n  It can already produce items.\n\n  @name AsyncIterator.INIT\n  @type integer\n  @protected\n*/\n\n/**\n  ID of the OPEN state.\n  An iterator is open if it can generate new items.\n\n  @name AsyncIterator.OPEN\n  @type integer\n  @protected\n*/\n\n/**\n  ID of the CLOSING state.\n  An iterator is closing if item generation is pending but will not be scheduled again.\n\n  @name AsyncIterator.CLOSING\n  @type integer\n  @protected\n*/\n\n/**\n  ID of the CLOSED state.\n  An iterator is closed if it no longer actively generates new items.\n  Items might still be available.\n\n  @name AsyncIterator.CLOSED\n  @type integer\n  @protected\n*/\n\n/**\n  ID of the ENDED state.\n  An iterator has ended if no further items will become available.\n  The 'end' event is guaranteed to have been called when in this state.\n\n  @name AsyncIterator.ENDED\n  @type integer\n  @protected\n*/\n\n/**\n ID of the DESTROYED state.\n An iterator has been destroyed after calling {@link AsyncIterator#destroy}.\n The 'end' event has not been called, as pending elements were voided.\n\n @name AsyncIterator.DESTROYED\n @type integer\n @protected\n */\n\n\n\n\n/**\n  Creates a new `AsyncIterator`.\n\n  @public\n  @constructor\n  @classdesc An asynchronous iterator provides pull-based access to a stream of objects.\n  @extends EventEmitter\n**/\nfunction AsyncIterator() {\n  if (!(this instanceof AsyncIterator))\n    return new AsyncIterator();\n  EventEmitter.call(this);\n  this.on('newListener', waitForDataListener);\n  this._state = OPEN;\n  this._readable = false;\n}\n\n/**\n  Makes the prototype of the current constructor a prototype for the given constructor.\n\n  @protected\n  @function AsyncIterator.subclass\n  @param {Function} Constructor The constructor that should inherit from the current constructor\n  @returns {AsyncIterator} The constructor's prototype\n**/\n(function subclass(Constructor) {\n  Constructor.prototype = Object.create(this.prototype,\n    { constructor: { value: Constructor, configurable: true, writable: true } });\n  Constructor.subclass = subclass;\n}).call(EventEmitter, AsyncIterator);\n\n/**\n  Changes the iterator to the given state if possible and necessary,\n  possibly emitting events to signal that change.\n\n  @protected\n  @param {integer} newState The ID of the new state (from the `STATES` array)\n  @param {boolean} [eventAsync=false] Whether resulting events should be emitted asynchronously\n  @returns {boolean} Whether the state was changed\n  @emits AsyncIterator.end\n**/\nAsyncIterator.prototype._changeState = function (newState, eventAsync) {\n  // Validate the state change\n  var valid = newState > this._state && this._state < ENDED;\n  if (valid) {\n    this._state = newState;\n    // Emit the `end` event when changing to ENDED\n    if (newState === ENDED)\n      eventAsync ? setImmediate(emit, this, 'end') : this.emit('end');\n  }\n  return valid;\n};\n// Emits the event on the given EventEmitter\nfunction emit(self, eventName) { self.emit(eventName); }\n\n/**\n  Tries to read the next item from the iterator.\n\n  This is the main method for reading the iterator in _on-demand mode_,\n  where new items are only created when needed by consumers.\n  If no items are currently available, this methods returns `null`.\n  The {@link AsyncIterator.event:readable} event will then signal when new items might be ready.\n\n  To read all items from the iterator,\n  switch to _flow mode_ by subscribing to the {@link AsyncIterator.event:data} event.\n  When in flow mode, do not use the `read` method.\n\n  @returns {object?} The next item, or `null` if none is available\n**/\nAsyncIterator.prototype.read = function () { return null; };\n\n/**\n  Emitted when the iterator might have new items available\n  after having had no items available right before this event.\n\n  If the iterator is not in flow mode,\n  items can be retrieved by calling {@link AsyncIterator#read}.\n\n  @event AsyncIterator.readable\n**/\n\n/**\n  Invokes the callback for each remaining item in the iterator.\n\n  Switches the iterator to flow mode.\n\n  @param {Function} callback A function that will be called with each item\n  @param {object?} self The `this` pointer for the callback\n**/\nAsyncIterator.prototype.each = function (callback, self) {\n  this.on('data', self ? callback.bind(self) : callback);\n};\n\n/**\n  Verifies whether the iterator has listeners for the given event.\n\n  @private\n  @param {string} eventName The name of the event\n  @returns {boolean} Whether the iterator has listeners\n**/\nAsyncIterator.prototype._hasListeners = function (eventName) {\n  return this._events && (eventName in this._events);\n};\n\n/**\n  Adds the listener to the event, if it has not been added previously.\n\n  @private\n  @param {string} eventName The name of the event\n  @param {Function} listener The listener to add\n**/\nAsyncIterator.prototype._addSingleListener = function (eventName, listener) {\n  var listeners = this._events && this._events[eventName];\n  if (!listeners ||\n      (isFunction(listeners) ? listeners !== listener : listeners.indexOf(listener) < 0))\n    this.on(eventName, listener);\n};\n\n/**\n  Stops the iterator from generating new items.\n\n  Already generated items or terminating items can still be emitted.\n  After this, the iterator will end asynchronously.\n\n  @emits AsyncIterator.end\n**/\nAsyncIterator.prototype.close = function () {\n  if (this._changeState(CLOSED))\n    endAsync(this);\n};\n\n/**\n Destroy the iterator and stop it from generating new items.\n\n This will not do anything if the iterator was already ended or destroyed.\n\n All internal resources will be released an no new items will be emitted,\n even not already generated items.\n\n Implementors should not override this method,\n but instead implement {@link AsyncIterator#_destroy}.\n\n @param {Error} [cause] An optional error to emit.\n @emits AsyncIterator.end\n @emits AsyncIterator.error Only emitted if an error is passed.\n **/\nAsyncIterator.prototype.destroy = function (cause) {\n  if (!this.done) {\n    var self = this;\n    this._destroy(cause, function (error) {\n      cause = cause || error;\n      if (cause)\n        self.emit('error', cause);\n      end(self, true);\n    });\n  }\n};\n\n/**\n Called by {@link AsyncIterator#destroy}.\n Implementers can override this, but this should not be called directly.\n\n @param {?Error} cause The reason why the iterator is destroyed.\n @param {Function} callback A callback function with an optional error argument.\n */\nAsyncIterator.prototype._destroy = function (cause, callback) {\n  callback();\n};\n\n/**\n  Asynchronously ends the iterator and cleans up.\n\n  Should never be called before {@link AsyncIterator#close};\n  typically, `close` is responsible for calling `_end`.\n\n  @param {boolean} [destroy] If the iterator should be forcefully destroyed.\n  @protected\n  @emits AsyncIterator.end\n**/\nAsyncIterator.prototype._end = function (destroy) {\n  if (this._changeState(destroy ? DESTROYED : ENDED)) {\n    this._readable = false;\n    this.removeAllListeners('readable');\n    this.removeAllListeners('data');\n    this.removeAllListeners('end');\n  }\n};\nfunction end(self, destroy) { self._end(destroy); }\nfunction endAsync(self) { setImmediate(end, self); }\n\n/**\n  Emitted after the last item of the iterator has been read.\n\n  @event AsyncIterator.end\n**/\n\n/**\n  Gets or sets whether this iterator might have items available for read.\n\n  A value of `false` means there are _definitely_ no items available;\n  a value of `true` means items _might_ be available.\n\n  @name AsyncIterator#readable\n  @type boolean\n  @emits AsyncIterator.readable\n**/\nObject.defineProperty(AsyncIterator.prototype, 'readable', {\n  get: function () { return this._readable; },\n  set: function (readable) {\n    readable = !!readable && !this.done;\n    // Set the readable value only if it has changed\n    if (this._readable !== readable) {\n      this._readable = readable;\n      // If the iterator became readable, emit the `readable` event\n      if (readable)\n        setImmediate(emit, this, 'readable');\n    }\n  },\n  enumerable: true,\n});\n\n/**\n  Gets whether the iterator has stopped generating new items.\n\n  @name AsyncIterator#closed\n  @type boolean\n  @readonly\n**/\nObject.defineProperty(AsyncIterator.prototype, 'closed', {\n  get: function () { return this._state >= CLOSING; },\n  enumerable: true,\n});\n\n/**\n  Gets whether the iterator has finished emitting items.\n\n  @name AsyncIterator#ended\n  @type boolean\n  @readonly\n**/\nObject.defineProperty(AsyncIterator.prototype, 'ended', {\n  get: function () { return this._state === ENDED; },\n  enumerable: true,\n});\n\n/**\n Gets whether the iterator has been destroyed.\n\n @name AsyncIterator#destroyed\n @type boolean\n @readonly\n **/\nObject.defineProperty(AsyncIterator.prototype, 'destroyed', {\n  get: function () { return this._state === DESTROYED; },\n  enumerable: true,\n});\n\n/**\n Gets whether the iterator will not emit anymore items,\n either due to being closed or due to being destroyed.\n\n @name AsyncIterator#done\n @type boolean\n @readonly\n **/\nObject.defineProperty(AsyncIterator.prototype, 'done', {\n  get: function () { return this._state >= ENDED; },\n  enumerable: true,\n});\n\n/**\n  The iterator emits a `data` event with a new item as soon as it becomes available.\n\n  When one or more listeners are attached to the `data` event,\n  the iterator switches to _flow mode_,\n  generating and emitting new items as fast as possible.\n  This drains the source and might create backpressure on the consumers,\n  so only subscribe to this event if this behavior is intended.\n  In flow mode, don't use the {@link AsyncIterator#read} method.\n\n  To switch back to _on-demand mode_, remove all listeners from the `data` event.\n  You can then obtain items through {@link AsyncIterator#read} again.\n\n  @event AsyncIterator.data\n  @param {object} item The new item\n**/\n\n// Starts emitting `data` events when `data` listeners are added\nfunction waitForDataListener(eventName) {\n  if (eventName === 'data') {\n    this.removeListener('newListener', waitForDataListener);\n    this._addSingleListener('readable', emitData);\n    if (this.readable)\n      setImmediate(call, emitData, this);\n  }\n}\n// Emits new items though `data` events as long as there are `data` listeners\nfunction emitData() {\n  // While there are `data` listeners and items, emit them\n  var item;\n  while (this._hasListeners('data') && (item = this.read()) !== null)\n    this.emit('data', item);\n  // Stop draining the source if there are no more `data` listeners\n  if (!this._hasListeners('data') && !this.done) {\n    this.removeListener('readable', emitData);\n    this._addSingleListener('newListener', waitForDataListener);\n  }\n}\n// Calls the given function with the specified argument as `this` value\nfunction call(func, self) { func.call(self); }\n\n/**\n  Retrieves the property with the given name from the iterator.\n\n  If no callback is passed, it returns the value of the property\n  or `undefined` if the property is not set.\n\n  If a callback is passed, it returns `undefined`\n  and calls the callback with the property the moment it is set.\n\n  @param {string} propertyName The name of the property to retrieve\n  @param {Function} [callback] A one-argument callback to receive the property value\n  @returns {object?} The value of the property (if set and no callback is given)\n**/\nAsyncIterator.prototype.getProperty = function (propertyName, callback) {\n  var properties = this._properties, propertyCallbacks;\n  // If no callback was passed, return the property value\n  if (!callback)\n    return properties && properties[propertyName];\n  // If the value has been set, send it through the callback\n  if (properties && (propertyName in properties))\n    setImmediate(callback, properties[propertyName]);\n  // If the value was not set, store the callback for when the value will be set\n  else {\n    if (!(propertyCallbacks = this._propertyCallbacks))\n      this._propertyCallbacks = propertyCallbacks = Object.create(null);\n    if (propertyName in propertyCallbacks)\n      propertyCallbacks[propertyName].push(callback);\n    else\n      propertyCallbacks[propertyName] = [callback];\n  }\n};\n\n/**\n  Sets the property with the given name to the value.\n\n  @param {string} propertyName The name of the property to set\n  @param {object?} value The new value of the property\n**/\nAsyncIterator.prototype.setProperty = function (propertyName, value) {\n  var properties = this._properties || (this._properties = Object.create(null));\n  properties[propertyName] = value;\n  // Execute getter callbacks that were waiting for this property to be set\n  var propertyCallbacks = this._propertyCallbacks, callbacks;\n  if (callbacks = propertyCallbacks && propertyCallbacks[propertyName]) {\n    delete propertyCallbacks[propertyName];\n    if (callbacks.length === 1)\n      setImmediate(callbacks[0], value);\n    else {\n      setImmediate(function () {\n        for (var i = 0; i < callbacks.length; i++)\n          callbacks[i](value);\n      });\n    }\n    // Remove _propertyCallbacks if no pending callbacks are left\n    for (propertyName in propertyCallbacks) return;\n    delete this._propertyCallbacks;\n  }\n};\n\n/**\n  Retrieves all properties of the iterator.\n\n  @returns {object} An object with property names as keys.\n**/\nAsyncIterator.prototype.getProperties = function () {\n  var properties = this._properties, copy = {};\n  for (var name in properties)\n    copy[name] = properties[name];\n  return copy;\n};\n\n/**\n  Sets all of the given properties.\n\n  @param {object} properties Key/value pairs of properties to set\n**/\nAsyncIterator.prototype.setProperties = function (properties) {\n  for (var propertyName in properties)\n    this.setProperty(propertyName, properties[propertyName]);\n};\n\n/**\n  Copies the given properties from the source iterator.\n\n  @param {AsyncIterator} source The iterator to copy from\n  @param {Array} propertyNames List of property names to copy\n**/\nAsyncIterator.prototype.copyProperties = function (source, propertyNames) {\n  for (var i = 0; i < propertyNames.length; i++)\n    copyProperty(source, this, propertyNames[i]);\n};\nfunction copyProperty(source, destination, propertyName) {\n  source.getProperty(propertyName, function (value) {\n    destination.setProperty(propertyName, value);\n  });\n}\n\n/* Generates a textual representation of the iterator. */\nAsyncIterator.prototype.toString = function () {\n  var details = this._toStringDetails();\n  return '[' + this.constructor.name + (details ? ' ' + details + ']' : ']');\n};\n\n/**\n  Generates details for a textual representation of the iterator.\n\n  @protected\n**/\nAsyncIterator.prototype._toStringDetails = function () { };\n\n\n\n/**\n  Creates a new `EmptyIterator`.\n\n  @constructor\n  @classdesc An iterator that doesn't emit any items.\n  @extends AsyncIterator\n**/\nfunction EmptyIterator() {\n  if (!(this instanceof EmptyIterator))\n    return new EmptyIterator();\n  AsyncIterator.call(this);\n  this._changeState(ENDED, true);\n}\nAsyncIterator.subclass(EmptyIterator);\n\n\n\n/**\n  Creates a new `SingletonIterator`.\n\n  @constructor\n  @classdesc An iterator that emits a single item.\n  @param {object} item The item that will be emitted.\n  @extends AsyncIterator\n**/\nfunction SingletonIterator(item) {\n  if (!(this instanceof SingletonIterator))\n    return new SingletonIterator(item);\n  AsyncIterator.call(this);\n\n  this._item = item;\n  if (item === null)\n    this.close();\n  else\n    this.readable = true;\n}\nAsyncIterator.subclass(SingletonIterator);\n\n/* Reads the item from the iterator. */\nSingletonIterator.prototype.read = function () {\n  var item = this._item;\n  this._item = null;\n  this.close();\n  return item;\n};\n\n/* Generates details for a textual representation of the iterator. */\nSingletonIterator.prototype._toStringDetails = function () {\n  return this._item === null ? '' : '(' + this._item + ')';\n};\n\n\n\n/**\n  Creates a new `ArrayIterator`.\n\n  @constructor\n  @classdesc An iterator that emits the items of a given array.\n  @param {Array} items The items that will be emitted.\n  @extends AsyncIterator\n**/\nfunction ArrayIterator(items) {\n  if (!(this instanceof ArrayIterator))\n    return new ArrayIterator(items);\n  AsyncIterator.call(this);\n\n  if (!(items && items.length > 0))\n    return this.close();\n\n  this._buffer = Array.prototype.slice.call(items);\n  this.readable = true;\n}\nAsyncIterator.subclass(ArrayIterator);\n\n/* Reads an item from the iterator. */\nArrayIterator.prototype.read = function () {\n  var buffer = this._buffer, item = null;\n  if (buffer) {\n    item = buffer.shift();\n    if (!buffer.length) {\n      delete this._buffer;\n      this.close();\n    }\n  }\n  return item;\n};\n\n/* Generates details for a textual representation of the iterator. */\nArrayIterator.prototype._toStringDetails = function () {\n  return '(' + (this._buffer && this._buffer.length || 0) + ')';\n};\n\n/* Called by {@link AsyncIterator#destroy} */\nArrayIterator.prototype._destroy = function (error, callback) {\n  delete this._buffer;\n  callback();\n};\n\n\n\n/**\n  Creates a new `IntegerIterator`.\n\n  @constructor\n  @classdesc An iterator that enumerates integers in a certain range.\n  @param {object} [options] Settings of the iterator\n  @param {integer} [options.start=0] The first number to emit\n  @param {integer} [options.end=Infinity] The last number to emit\n  @param {integer} [options.step=1] The increment between two numbers\n  @extends AsyncIterator\n**/\nfunction IntegerIterator(options) {\n  if (!(this instanceof IntegerIterator))\n    return new IntegerIterator(options);\n  AsyncIterator.call(this);\n\n  // Set start, end, and step\n  options = options || {};\n  var step = options.step, limit, last = options.end, next = options.start;\n  this._step = step  = isFinite(step) ? ~~step : 1;\n  limit      = step >= 0 ? Infinity : -Infinity; // counting towards plus or minus infinity?\n  this._last = last  = isFinite(last) ? ~~last : (last === -limit ? last : limit);\n  this._next = next  = typeof next !== 'number' ? 0 : (isFinite(next) ? ~~next : next);\n\n  // Start iteration if there is at least one item; close otherwise\n  if (!isFinite(next) || (step >= 0 ? next > last : next < last))\n    this.close();\n  else\n    this.readable = true;\n}\nAsyncIterator.subclass(IntegerIterator);\n\n/* Reads an item from the iterator. */\nIntegerIterator.prototype.read = function () {\n  if (this.closed)\n    return null;\n  var current = this._next, step = this._step, last = this._last, next = this._next += step;\n  if (step >= 0 ? next > last : next < last)\n    this.close();\n  return current;\n};\n\n/* Generates details for a textual representation of the iterator. */\nIntegerIterator.prototype._toStringDetails = function () {\n  return '(' + this._next + '...' + this._last + ')';\n};\n\n/**\n  Creates an iterator of natural numbers within the given range.\n\n  The current iterator may not be read anymore until the returned iterator ends.\n\n  @param {integer} [start=0] The first number to emit\n  @param {integer} [end=Infinity] The last number to emit\n  @param {integer} [step=1] The increment between two numbers\n  @returns {IntegerIterator} An iterator of natural numbers within the given range\n**/\nAsyncIterator.range = function (start, end, step) {\n  return new IntegerIterator({ start: start, end: end, step: step });\n};\n\n\n\n/**\n  Creates a new `BufferedIterator`.\n\n  @constructor\n  @classdesc A iterator that maintains an internal buffer of items.\n\n  This class serves as a base class for other iterators\n  with a typically complex item generation process.\n  @param {object} [options] Settings of the iterator\n  @param {integer} [options.maxBufferSize=4] The number of items to preload in the internal buffer\n  @param {boolean} [options.autoStart=true] Whether buffering starts directly after construction\n  @extends AsyncIterator\n**/\nfunction BufferedIterator(options) {\n  if (!(this instanceof BufferedIterator))\n    return new BufferedIterator(options);\n  AsyncIterator.call(this);\n\n  options = options || {};\n\n  // Set up the internal buffer\n  var maxBufferSize = options.maxBufferSize, autoStart = options.autoStart;\n  this._state  = INIT;\n  this._buffer = [];\n  this._pushedCount = 0;\n  this.maxBufferSize = maxBufferSize;\n\n  // Acquire reading lock to read initialization items\n  this._reading = true;\n  setImmediate(init, this, autoStart !== false || autoStart);\n}\nAsyncIterator.subclass(BufferedIterator);\n\n/**\n  Gets or sets the maximum number of items to preload in the internal buffer.\n\n  A `BufferedIterator` tries to fill its buffer as far as possible.\n  Set to `Infinity` to fully drain the source.\n\n  @name BufferedIterator#maxBufferSize\n  @type number\n**/\nObject.defineProperty(BufferedIterator.prototype, 'maxBufferSize', {\n  set: function (maxBufferSize) {\n    // Allow only positive integers and infinity\n    if (maxBufferSize !== Infinity)\n      maxBufferSize = isFinite(maxBufferSize) ? Math.max(~~maxBufferSize, 1) : 4;\n    // Only set the maximum buffer size if it changes\n    if (this._maxBufferSize !== maxBufferSize) {\n      this._maxBufferSize = maxBufferSize;\n      // Ensure sufficient elements are buffered\n      if (this._state === OPEN)\n        this._fillBuffer();\n    }\n  },\n  get: function () { return this._maxBufferSize; },\n  enumerable: true,\n});\n\n/**\n  Initializing the iterator by calling {@link BufferedIterator#_begin}\n  and changing state from INIT to OPEN.\n\n  @protected\n  @param {boolean} autoStart Whether reading of items should immediately start after OPEN.\n**/\nBufferedIterator.prototype._init = function (autoStart) {\n  // Perform initialization tasks\n  var self = this;\n  this._reading = true;\n  this._begin(function () {\n    if (!self)\n      throw new Error('done callback called multiple times');\n    // Open the iterator and start buffering\n    self._reading = false;\n    self._changeState(OPEN);\n    if (autoStart)\n      fillBufferAsync(self);\n    // If reading should not start automatically, the iterator doesn't become readable.\n    // Therefore, mark the iterator as (potentially) readable so consumers know it might be read.\n    else\n      self.readable = true;\n    self = null;\n  });\n};\nfunction init(self, autoStart) { self._init(autoStart); }\n\n/**\n  Writes beginning items and opens iterator resources.\n\n  Should never be called before {@link BufferedIterator#_init};\n  typically, `_init` is responsible for calling `_begin`.\n\n  @protected\n  @param {function} done To be called when initialization is complete\n**/\nBufferedIterator.prototype._begin = function (done) { done(); };\n\n/**\n  Tries to read the next item from the iterator.\n\n  If the buffer is empty,\n  this method calls {@link BufferedIterator#_read} to fetch items.\n  @returns {object?} The next item, or `null` if none is available\n**/\nBufferedIterator.prototype.read = function () {\n  if (this.done)\n    return null;\n\n  // Try to retrieve an item from the buffer\n  var buffer = this._buffer, item;\n  if (buffer.length)\n    item = buffer.shift();\n  else {\n    item = null;\n    this.readable = false;\n  }\n\n  // If the buffer is becoming empty, either fill it or end the iterator\n  if (!this._reading && buffer.length < this._maxBufferSize) {\n    // If the iterator is not closed and thus may still generate new items, fill the buffer\n    if (!this.closed)\n      fillBufferAsync(this);\n    // No new items will be generated, so if none are buffered, the iterator ends here\n    else if (!buffer.length)\n      endAsync(this);\n  }\n\n  return item;\n};\n\n/**\n  Tries to generate the given number of items.\n\n  Implementers should add `count` items through {@link BufferedIterator#_push}.\n\n  @protected\n  @param {integer} count The number of items to generate\n  @param {function} done To be called when reading is complete\n**/\nBufferedIterator.prototype._read = function (count, done) { done(); };\n\n/**\n  Adds an item to the internal buffer.\n\n  @protected\n  @param {object} item The item to add\n  @emits AsyncIterator.readable\n**/\nBufferedIterator.prototype._push = function (item) {\n  if (!this.done) {\n    this._pushedCount++;\n    this._buffer.push(item);\n    this.readable = true;\n  }\n};\n\n/**\n  Fills the internal buffer until `this._maxBufferSize` items are present.\n\n  This method calls {@link BufferedIterator#_read} to fetch items.\n\n  @protected\n  @emits AsyncIterator.readable\n**/\nBufferedIterator.prototype._fillBuffer = function () {\n  var self = this, neededItems;\n  // Avoid recursive reads\n  if (this._reading)\n    return;\n  // If iterator closing started in the meantime, don't generate new items anymore\n  else if (this.closed)\n    this._completeClose();\n  // Otherwise, try to fill empty spaces in the buffer by generating new items\n  else if ((neededItems = Math.min(this._maxBufferSize - this._buffer.length, 128)) > 0) {\n    // Acquire reading lock and start reading, counting pushed items\n    this._pushedCount = 0;\n    this._reading = true;\n    this._read(neededItems, function () {\n      // Verify the callback is only called once\n      if (!neededItems)\n        throw new Error('done callback called multiple times');\n      neededItems = 0;\n      // Release reading lock\n      self._reading = false;\n      // If the iterator was closed while reading, complete closing\n      if (self.closed)\n        self._completeClose();\n      // If the iterator pushed one or more items,\n      // it might currently be able to generate additional items\n      // (even though all pushed items might already have been read)\n      else if (self._pushedCount) {\n        self.readable = true;\n        // If the buffer is insufficiently full, continue filling\n        if (self._buffer.length < self._maxBufferSize / 2)\n          fillBufferAsync(self);\n      }\n    });\n  }\n};\nfunction fillBufferAsync(self) {\n  // Acquire reading lock to avoid recursive reads\n  if (!self._reading) {\n    self._reading = true;\n    setImmediate(fillBufferAsyncCallback, self);\n  }\n}\nfunction fillBufferAsyncCallback(self) {\n  // Release reading lock so _fillBuffer` can take it\n  self._reading = false;\n  self._fillBuffer();\n}\n\n/**\n  Stops the iterator from generating new items\n  after a possible pending read operation has finished.\n\n  Already generated, pending, or terminating items can still be emitted.\n  After this, the iterator will end asynchronously.\n\n  @emits AsyncIterator.end\n**/\nBufferedIterator.prototype.close = function () {\n  // If the iterator is not currently reading, we can close immediately\n  if (!this._reading)\n    this._completeClose();\n  // Closing cannot complete when reading, so temporarily assume CLOSING state\n  // `_fillBuffer` becomes responsible for calling `_completeClose`\n  else\n    this._changeState(CLOSING);\n};\n\n/**\n  Stops the iterator from generating new items,\n  switching from `CLOSING` state into `CLOSED` state.\n\n  @protected\n  @emits AsyncIterator.end\n**/\nBufferedIterator.prototype._completeClose = function () {\n  if (this._changeState(CLOSED)) {\n    // Write possible terminating items\n    var self = this;\n    this._reading = true;\n    this._flush(function () {\n      if (!self._reading)\n        throw new Error('done callback called multiple times');\n      self._reading = false;\n      // If no items are left, end the iterator\n      // Otherwise, `read` becomes responsible for ending the iterator\n      if (!self._buffer.length)\n        endAsync(self);\n    });\n  }\n};\n\n/* Called by {@link AsyncIterator#destroy} */\nBufferedIterator.prototype._destroy = function (error, callback) {\n  this._buffer = [];\n  callback();\n};\n\n/**\n  Writes terminating items and closes iterator resources.\n\n  Should never be called before {@link BufferedIterator#close};\n  typically, `close` is responsible for calling `_flush`.\n\n  @protected\n  @param {function} done To be called when termination is complete\n**/\nBufferedIterator.prototype._flush = function (done) { done(); };\n\n/* Generates details for a textual representation of the iterator. */\nBufferedIterator.prototype._toStringDetails = function () {\n  var buffer = this._buffer, length = buffer.length;\n  return '{' + (length ? 'next: ' + buffer[0] + ', ' : '') + 'buffer: ' + length + '}';\n};\n\n\n\n\n/**\n  Creates a new `TransformIterator`.\n\n  This class serves as a base class for other iterators.\n\n  @constructor\n  @classdesc An iterator that generates items based on a source iterator.\n  @param {AsyncIterator|Readable} [source] The source this iterator generates items from\n  @param {object} [options] Settings of the iterator\n  @param {integer} [options.maxBufferSize=4] The maximum number of items to keep in the buffer\n  @param {boolean} [options.autoStart=true] Whether buffering starts directly after construction\n  @param {boolean} [options.optional=false] If transforming is optional, the original item is pushed when its transformation yields no items\n  @param {boolean} [options.destroySource=true] Whether the source should be destroyed when this transformed iterator is closed or destroyed\n  @param {AsyncIterator} [options.source] The source this iterator generates items from\n  @extends BufferedIterator\n**/\nfunction TransformIterator(source, options) {\n  if (!(this instanceof TransformIterator))\n    return new TransformIterator(source, options);\n  // Shift arguments if the first is not a source\n  if (!source || !isFunction(source.read)) {\n    if (!options) options = source;\n    source = options && options.source;\n  }\n  BufferedIterator.call(this, options);\n  if (source) this.source = source;\n  this._optional = !!(options && options.optional);\n  this._destroySource = !options || options.destroySource !== false;\n}\nBufferedIterator.subclass(TransformIterator);\n\n/**\n  Gets or sets the source this iterator generates items from.\n\n  @name TransformIterator#source\n  @type AsyncIterator\n**/\nObject.defineProperty(TransformIterator.prototype, 'source', {\n  set: function (source) {\n    // Validate and set source\n    this._validateSource(source);\n    this._source = source;\n    source._destination = this;\n\n    // Close this iterator if the source has already ended\n    if (source.ended)\n      this.close();\n    // Otherwise, react to source events\n    else {\n      source.on('end',      destinationCloseWhenDone);\n      source.on('readable', destinationFillBuffer);\n      source.on('error',    destinationEmitError);\n    }\n  },\n  get: getSource,\n  enumerable: true,\n});\nfunction getSource() { return this._source; }\nfunction destinationEmitError(error) { this._destination.emit('error', error); }\nfunction destinationCloseWhenDone()  { this._destination._closeWhenDone(); }\nfunction destinationFillBuffer()     { this._destination._fillBuffer(); }\n\n/**\n  Validates whether the given iterator can be used as a source.\n\n  @protected\n  @param {object} source The source to validate\n  @param {boolean} allowDestination Whether the source can already have a destination\n**/\nTransformIterator.prototype._validateSource = function (source, allowDestination) {\n  if (this._source)\n    throw new Error('The source cannot be changed after it has been set');\n  if (!source || !isFunction(source.read) || !isFunction(source.on))\n    throw new Error('Invalid source: ' + source);\n  if (!allowDestination && source._destination)\n    throw new Error('The source already has a destination');\n};\n\n/* Tries to read a transformed item */\nTransformIterator.prototype._read = function (count, done) {\n  var self = this;\n  readAndTransform(self, function next() {\n    // Continue transforming until at least `count` items have been pushed\n    if (self._pushedCount < count && !self.closed)\n      setImmediate(readAndTransform, self, next, done);\n    else\n      done();\n  }, done);\n};\nfunction readAndTransform(self, next, done) {\n  // If the source exists and still can read items,\n  // try to read and transform the next item.\n  var source = self._source, item;\n  if (source && !source.ended && (item = source.read()) !== null) {\n    if (!self._optional)\n      self._transform(item, next);\n    else\n      optionalTransform(self, item, next);\n  }\n  else\n    done();\n}\n// Tries to transform the item;\n// if the transformation yields no items, pushes the original item\nfunction optionalTransform(self, item, done) {\n  var pushedCount = self._pushedCount;\n  self._transform(item, function () {\n    if (pushedCount === self._pushedCount)\n      self._push(item);\n    done();\n  });\n}\n\n/**\n  Generates items based on the item from the source.\n\n  Implementers should add items through {@link BufferedIterator#_push}.\n  The default implementation pushes the source item as-is.\n\n  @protected\n  @param {object} item The last read item from the source\n  @param {function} done To be called when reading is complete\n**/\nTransformIterator.prototype._transform = function (item, done) {\n  this._push(item), done();\n};\n\n/**\n  Closes the iterator when pending items are transformed.\n\n  @protected\n**/\nTransformIterator.prototype._closeWhenDone = function () {\n  this.close();\n};\n\n/* Cleans up the source iterator and ends. */\nTransformIterator.prototype._end = function (destroy) {\n  var source = this._source;\n  if (source) {\n    source.removeListener('end',      destinationCloseWhenDone);\n    source.removeListener('error',    destinationEmitError);\n    source.removeListener('readable', destinationFillBuffer);\n    delete source._destination;\n    if (this._destroySource)\n      source.destroy();\n  }\n  BufferedIterator.prototype._end.call(this, destroy);\n};\n\n/**\n  Creates an iterator that wraps around a given iterator or readable stream.\n\n  Use this to convert an iterator-like object into a full-featured AsyncIterator.\n\n  After this operation, only read the returned iterator instead of the given one.\n\n  @function\n  @param {AsyncIterator|Readable} [source] The source this iterator generates items from\n  @param {object} [options] Settings of the iterator\n  @returns {AsyncIterator} A new iterator with the items from the given iterator\n**/\nAsyncIterator.wrap = TransformIterator;\n\n\n\n\n/**\n  Creates a new `SimpleTransformIterator`.\n\n  @constructor\n  @classdesc An iterator that generates items based on a source iterator\n             and simple transformation steps passed as arguments.\n  @param {AsyncIterator|Readable} [source] The source this iterator generates items from\n  @param {object|Function} [options] Settings of the iterator, or the transformation function\n  @param {integer} [options.maxbufferSize=4] The maximum number of items to keep in the buffer\n  @param {boolean} [options.autoStart=true] Whether buffering starts directly after construction\n  @param {AsyncIterator} [options.source] The source this iterator generates items from\n  @param {integer} [options.offset] The number of items to skip\n  @param {integer} [options.limit] The maximum number of items\n  @param {Function} [options.filter] A function to synchronously filter items from the source\n  @param {Function} [options.map] A function to synchronously transform items from the source\n  @param {Function} [options.transform] A function to asynchronously transform items from the source\n  @param {boolean} [options.optional=false] If transforming is optional, the original item is pushed when its mapping yields `null` or its transformation yields no items\n  @param {Array|AsyncIterator} [options.prepend] Items to insert before the source items\n  @param {Array|AsyncIterator} [options.append]  Items to insert after the source items\n  @extends TransformIterator\n**/\nfunction SimpleTransformIterator(source, options) {\n  if (!(this instanceof SimpleTransformIterator))\n    return new SimpleTransformIterator(source, options);\n  TransformIterator.call(this, source, options);\n\n  // Set transformation steps from the options\n  if (options = options || !isFunction(source && source.read) && source) {\n    var limit = options.limit, offset = options.offset,\n        filter = options.filter, map = options.map,\n        transform = isFunction(options) ? options : options.transform,\n        prepend = options.prepend, append = options.append;\n    // Don't emit any items when bounds are unreachable\n    if (offset === Infinity || limit === -Infinity)\n      this._limit = 0;\n    else {\n      if (isFinite(offset))      this._offset    = Math.max(~~offset, 0);\n      if (isFinite(limit))       this._limit     = Math.max(~~limit,  0);\n      if (isFunction(filter))    this._filter    = filter;\n      if (isFunction(map))       this._map       = map;\n      if (isFunction(transform)) this._transform = transform;\n    }\n    if (prepend) this._prepender = prepend.on ? prepend : new ArrayIterator(prepend);\n    if (append)  this._appender  = append.on  ? append  : new ArrayIterator(append);\n  }\n}\nTransformIterator.subclass(SimpleTransformIterator);\n\n// Default settings\nSimpleTransformIterator.prototype._offset = 0;\nSimpleTransformIterator.prototype._limit = Infinity;\nSimpleTransformIterator.prototype._filter = function ()  { return true; };\nSimpleTransformIterator.prototype._map = null;\nSimpleTransformIterator.prototype._transform = null;\n\n/* Tries to read and transform items */\nSimpleTransformIterator.prototype._read = function (count, done) {\n  var self = this;\n  readAndTransformSimple(self, count, function next() {\n    setImmediate(readAndTransformSimple, self, count, next, done);\n  }, done);\n};\nfunction readAndTransformSimple(self, count, next, done) {\n  // Verify we have a readable source\n  var source = self._source, item;\n  if (!source || source.ended) {\n    done();\n    return;\n  }\n  // Verify we are still below the limit\n  if (self._limit === 0)\n    self.close();\n\n  // Try to read the next item until at least `count` items have been pushed\n  while (!self.closed && self._pushedCount < count && (item = source.read()) !== null) {\n    // Verify the item passes the filter and we've reached the offset\n    if (!self._filter(item) || self._offset !== 0 && self._offset--)\n      continue;\n\n    // Synchronously map the item\n    var mappedItem = self._map === null ? item : self._map(item);\n    // Skip `null` items, pushing the original item if the mapping was optional\n    if (mappedItem === null) {\n      if (self._optional)\n        self._push(item);\n    }\n    // Skip the asynchronous phase if no transformation was specified\n    else if (self._transform === null)\n      self._push(mappedItem);\n    // Asynchronously transform the item, and wait for `next` to call back\n    else {\n      if (!self._optional)\n        self._transform(mappedItem, next);\n      else\n        optionalTransform(self, mappedItem, next);\n      return;\n    }\n\n    // Stop when we've reached the limit\n    if (--self._limit === 0)\n      self.close();\n  }\n  done();\n}\n\n// Prepends items to the iterator\nSimpleTransformIterator.prototype._begin = function (done) {\n  this._insert(this._prepender, done);\n  delete this._prepender;\n};\n\n// Appends items to the iterator\nSimpleTransformIterator.prototype._flush = function (done) {\n  this._insert(this._appender, done);\n  delete this._appender;\n};\n\n// Inserts items in the iterator\nSimpleTransformIterator.prototype._insert = function (inserter, done) {\n  var self = this;\n  if (!inserter || inserter.ended)\n    done();\n  else {\n    inserter.on('data', push);\n    inserter.on('end',  end);\n  }\n  function push(item) { self._push(item); }\n  function end() {\n    inserter.removeListener('data', push);\n    inserter.removeListener('end',  end);\n    done();\n  }\n};\n\n/**\n  Transforms items from this iterator.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {object|Function} [options] Settings of the iterator, or the transformation function\n  @param {integer} [options.maxbufferSize=4] The maximum number of items to keep in the buffer\n  @param {boolean} [options.autoStart=true] Whether buffering starts directly after construction\n  @param {integer} [options.offset] The number of items to skip\n  @param {integer} [options.limit] The maximum number of items\n  @param {Function} [options.filter] A function to synchronously filter items from the source\n  @param {Function} [options.map] A function to synchronously transform items from the source\n  @param {Function} [options.transform] A function to asynchronously transform items from the source\n  @param {boolean} [options.optional=false] If transforming is optional, the original item is pushed when its mapping yields `null` or its transformation yields no items\n  @param {Array|AsyncIterator} [options.prepend] Items to insert before the source items\n  @param {Array|AsyncIterator} [options.append]  Items to insert after the source items\n  @returns {AsyncIterator} A new iterator that maps the items from this iterator\n**/\nAsyncIterator.prototype.transform = function (options) {\n  return new SimpleTransformIterator(this, options);\n};\n\n/**\n  Maps items from this iterator using the given function.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {Function} mapper A mapping function to call on this iterator's (remaining) items\n  @param {object?} self The `this` pointer for the mapping function\n  @returns {AsyncIterator} A new iterator that maps the items from this iterator\n**/\nAsyncIterator.prototype.map = function (mapper, self) {\n  return this.transform({ map: self ? mapper.bind(self) : mapper });\n};\n\n/**\n  Return items from this iterator that match the filter.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {Function} filter A filter function to call on this iterator's (remaining) items\n  @param {object?} self The `this` pointer for the filter function\n  @returns {AsyncIterator} A new iterator that filters items from this iterator\n**/\nAsyncIterator.prototype.filter = function (filter, self) {\n  return this.transform({ filter: self ? filter.bind(self) : filter });\n};\n\n/**\n  Prepends the items after those of the current iterator.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {Array|AsyncIterator} items Items to insert before this iterator's (remaining) items\n  @returns {AsyncIterator} A new iterator that prepends items to this iterator\n**/\nAsyncIterator.prototype.prepend = function (items) {\n  return this.transform({ prepend: items });\n};\n\n/**\n  Appends the items after those of the current iterator.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {Array|AsyncIterator} items Items to insert after this iterator's (remaining) items\n  @returns {AsyncIterator} A new iterator that appends items to this iterator\n**/\nAsyncIterator.prototype.append = function (items) {\n  return this.transform({ append: items });\n};\n\n/**\n  Surrounds items of the current iterator with the given items.\n\n  After this operation, only read the returned iterator instead of the current one.\n\n  @param {Array|AsyncIterator} prepend Items to insert before this iterator's (remaining) items\n  @param {Array|AsyncIterator} append Items to insert after this iterator's (remaining) items\n  @returns {AsyncIterator} A new iterator that appends and prepends items to this iterator\n**/\nAsyncIterator.prototype.surround = function (prepend, append) {\n  return this.transform({ prepend: prepend, append: append });\n};\n\n/**\n  Skips the given number of items from the current iterator.\n\n  The current iterator may not be read anymore until the returned iterator ends.\n\n  @param {integer} offset The number of items to skip\n  @returns {AsyncIterator} A new iterator that skips the given number of items\n**/\nAsyncIterator.prototype.skip = function (offset) {\n  return this.transform({ offset: offset });\n};\n\n/**\n  Limits the current iterator to the given number of items.\n\n  The current iterator may not be read anymore until the returned iterator ends.\n\n  @param {integer} limit The maximum number of items\n  @returns {AsyncIterator} A new iterator with at most the given number of items\n**/\nAsyncIterator.prototype.take = function (limit) {\n  return this.transform({ limit: limit });\n};\n\n/**\n  Limits the current iterator to the given range.\n\n  The current iterator may not be read anymore until the returned iterator ends.\n\n  @param {integer} start Index of the first item to return\n  @param {integer} end Index of the last item to return\n  @returns {AsyncIterator} A new iterator with items in the given range\n**/\nAsyncIterator.prototype.range = function (start, end) {\n  return this.transform({ offset: start, limit: Math.max(end - start + 1, 0) });\n};\n\n\n\n\n/**\n  Creates a new `MultiTransformIterator`.\n\n  @constructor\n  @classdesc An iterator that generates items by transforming each item of a source\n             with a different iterator.\n  @param {AsyncIterator|Readable} [source] The source this iterator generates items from\n  @param {object} [options] Settings of the iterator\n  @extends TransformIterator\n**/\nfunction MultiTransformIterator(source, options) {\n  if (!(this instanceof MultiTransformIterator))\n    return new MultiTransformIterator(source, options);\n  TransformIterator.call(this, source, options);\n  this._transformerQueue = [];\n}\nTransformIterator.subclass(MultiTransformIterator);\n\n/* Tries to read and transform items */\nMultiTransformIterator.prototype._read = function (count, done) {\n  // Remove transformers that have ended\n  var item, head, transformer, transformerQueue = this._transformerQueue,\n      source = this._source, optional = this._optional;\n  while ((head = transformerQueue[0]) && head.transformer.ended) {\n    // If transforming is optional, push the original item if none was pushed\n    if (optional && head.item !== null)\n      this._push(head.item), count--;\n    // Remove listeners from the transformer\n    head = transformerQueue.shift(), transformer = head.transformer;\n    transformer.removeListener('end',      destinationFillBuffer);\n    transformer.removeListener('readable', destinationFillBuffer);\n    transformer.removeListener('error',    destinationEmitError);\n  }\n\n  // Create new transformers if there are less than the maximum buffer size\n  while (source && !source.ended && transformerQueue.length < this._maxBufferSize) {\n    // Read an item to create the next transformer\n    item = this._source.read();\n    if (item === null)\n      break;\n    // Create the transformer and listen to its events\n    transformer = this._createTransformer(item) || new EmptyIterator();\n    transformer._destination = this;\n    transformer.on('end',      destinationFillBuffer);\n    transformer.on('readable', destinationFillBuffer);\n    transformer.on('error',    destinationEmitError);\n    transformerQueue.push({ transformer: transformer, item: item });\n  }\n\n  // Try to read `count` items from the transformer\n  head = transformerQueue[0];\n  if (head) {\n    transformer = head.transformer;\n    while (count-- > 0 && (item = transformer.read()) !== null) {\n      this._push(item);\n      // If a transformed item was pushed, no need to push the original anymore\n      if (optional)\n        head.item = null;\n    }\n  }\n  // End the iterator if the source has ended\n  else if (source && source.ended)\n    this.close();\n  done();\n};\n\n/**\n  Creates a transformer for the given item.\n\n  @param {object} item The last read item from the source\n  @returns {AsyncIterator} An iterator that transforms the given item\n**/\nMultiTransformIterator.prototype._createTransformer = SingletonIterator;\n\n/* Closes the iterator when pending items are transformed. */\nMultiTransformIterator.prototype._closeWhenDone = function () {\n  // Only close if all transformers are read\n  if (!this._transformerQueue.length)\n    this.close();\n};\n\n\n\n\n/**\n  Creates a new `ClonedIterator`.\n\n  @constructor\n  @classdesc An iterator that copies items from another iterator.\n  @param {AsyncIterator|Readable} [source] The source this iterator copies items from\n  @extends TransformIterator\n**/\nfunction ClonedIterator(source) {\n  if (!(this instanceof ClonedIterator))\n    return new ClonedIterator(source);\n  // Although ClonedIterator inherits from TransformIterator and hence BufferedIterator,\n  // we do not need the buffering because items arrive directly from a history buffer.\n  // Therefore, initialize as an AsyncIterator, which does not set up buffering.\n  AsyncIterator.call(this);\n\n  this._readPosition = 0;\n  if (source) this.source = source;\n}\nTransformIterator.subclass(ClonedIterator);\n\n// The source this iterator copies items from\nObject.defineProperty(ClonedIterator.prototype, 'source', {\n  set: function (source) {\n    // Validate and set the source\n    var history = source && source._destination;\n    this._validateSource(source, !history || history instanceof HistoryReader);\n    this._source = source;\n    // Create a history reader for the source if none already existed\n    if (!history)\n      history = source._destination = new HistoryReader(source);\n\n    // Close this clone if history is empty and the source has ended\n    if (history.endsAt(0))\n      this.close();\n    else {\n      // Subscribe to history events\n      history.register(this);\n      // If there are already items in history, this clone is readable\n      if (history.readAt(0) !== null)\n        this.readable = true;\n    }\n\n    // Hook pending property callbacks to the source\n    var propertyCallbacks = this._propertyCallbacks;\n    for (var propertyName in propertyCallbacks) {\n      var callbacks = propertyCallbacks[propertyName];\n      for (var i = 0; i < callbacks.length; i++)\n        getSourceProperty(this, source, propertyName, callbacks[i]);\n    }\n  },\n  get: getSource,\n  enumerable: true,\n});\n\n// Retrieves the property with the given name from the clone or its source.\nClonedIterator.prototype.getProperty = function (propertyName, callback) {\n  var properties = this._properties, source = this._source,\n      hasProperty = properties && (propertyName in properties);\n  // If no callback was passed, return the property value\n  if (!callback)\n    return hasProperty ? properties[propertyName] : source && source.getProperty(propertyName);\n  // Try to look up the property in this clone\n  AsyncIterator.prototype.getProperty.call(this, propertyName, callback);\n  // If the property is not set on this clone, it might become set on the source first\n  if (source && !hasProperty)\n    getSourceProperty(this, source, propertyName, callback);\n};\n// Retrieves the property with the given name from the source\nfunction getSourceProperty(clone, source, propertyName, callback) {\n  source.getProperty(propertyName, function (value) {\n    // Only send the source's property if it was not set on the clone in the meantime\n    if (!clone._properties || !(propertyName in clone._properties))\n      callback(value);\n  });\n}\n\n// Retrieves all properties of the iterator and its source.\nClonedIterator.prototype.getProperties = function () {\n  var base = this._source ? this._source.getProperties() : {}, properties = this._properties;\n  for (var name in properties)\n    base[name] = properties[name];\n  return base;\n};\n\n/* Generates details for a textual representation of the iterator. */\nClonedIterator.prototype._toStringDetails = function () {\n  var source = this._source;\n  return '{source: ' + (source ? source.toString() : 'none') + '}';\n};\n\n// Stores the history of a source, so it can be cloned\nfunction HistoryReader(source) {\n  var history = [], clones;\n\n  // Tries to read the item at the given history position\n  this.readAt = function (pos) {\n    var item = null;\n    // Retrieve an item from history when available\n    if (pos < history.length)\n      item = history[pos];\n    // Read a new item from the source when possible\n    else if (!source.ended && (item = source.read()) !== null)\n      history[pos] = item;\n    return item;\n  };\n\n  // Determines whether the given position is the end of the source\n  this.endsAt = function (pos) {\n    return pos === history.length && source.ended;\n  };\n\n  // Registers a clone for history updates\n  this.register = function (clone) { clones && clones.push(clone); };\n\n  // Unregisters a clone for history updates\n  this.unregister = function (clone) {\n    var cloneIndex;\n    if (clones && (cloneIndex = clones.indexOf(clone)) >= 0)\n      clones.splice(cloneIndex, 1);\n  };\n\n  // Listen to source events to trigger events in subscribed clones\n  if (!source.ended) {\n    clones = [];\n    // When the source becomes readable, make all clones readable\n    source.on('readable', clonesMakeReadable);\n    function clonesMakeReadable() {\n      for (var i = 0; i < clones.length; i++)\n        clones[i].readable = true;\n    }\n    // When the source ends, close all clones that are fully read\n    source.on('end', clonesEnd);\n    function clonesEnd() {\n      for (var i = 0; i < clones.length; i++) {\n        if (clones[i]._readPosition === history.length)\n          clones[i].close();\n      }\n      clones = null;\n      source.removeListener('end',      clonesEnd);\n      source.removeListener('error',    clonesEmitError);\n      source.removeListener('readable', clonesMakeReadable);\n    }\n    // When the source errors, re-emit the error\n    source.on('error', clonesEmitError);\n    function clonesEmitError(error) {\n      for (var i = 0; i < clones.length; i++)\n        clones[i].emit('error', error);\n    }\n  }\n}\n\n/* Tries to read an item */\nClonedIterator.prototype.read = function () {\n  var source = this._source, item = null;\n  if (!this.done && source) {\n    // Try to read an item at the current point in history\n    var history = source._destination;\n    if ((item = history.readAt(this._readPosition)) !== null)\n      this._readPosition++;\n    else\n      this.readable = false;\n    // Close the iterator if we are at the end of the source\n    if (history.endsAt(this._readPosition))\n      this.close();\n  }\n  return item;\n};\n\n/* End the iterator and cleans up. */\nClonedIterator.prototype._end = function (destroy) {\n  // Unregister from a possible history reader\n  var history = this._source && this._source._destination;\n  if (history) history.unregister(this);\n\n  // Don't call TransformIterator#_end,\n  // as it would make the source inaccessible for other clones\n  BufferedIterator.prototype._end.call(this, destroy);\n};\n\n// Disable buffer cleanup\nClonedIterator.prototype.close = AsyncIterator.prototype.close;\n\n/**\n  Creates a copy of the current iterator,\n  containing all items emitted from this point onward.\n\n  Further copies can be created; they will all start from this same point.\n  After this operation, only read the returned copies instead of the original iterator.\n\n  @returns {AsyncIterator} A new iterator that contains all future items of this iterator\n**/\nAsyncIterator.prototype.clone = function () {\n  return new ClonedIterator(this);\n};\n\n\n\n\n// Determines whether the given object is a function\nfunction isFunction(object) { return typeof object === 'function'; }\n\n// Export all submodules\nmodule.exports = AsyncIterator;\nAsyncIterator.AsyncIterator = AsyncIterator;\nAsyncIterator.EmptyIterator = AsyncIterator.empty = EmptyIterator;\nAsyncIterator.SingletonIterator = AsyncIterator.single = SingletonIterator;\nAsyncIterator.ArrayIterator = AsyncIterator.fromArray = ArrayIterator;\nAsyncIterator.IntegerIterator = IntegerIterator;\nAsyncIterator.BufferedIterator = BufferedIterator;\nAsyncIterator.TransformIterator = TransformIterator;\nAsyncIterator.SimpleTransformIterator = SimpleTransformIterator;\nAsyncIterator.MultiTransformIterator = MultiTransformIterator;\nAsyncIterator.ClonedIterator = ClonedIterator;\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst graphTypes = require('./graphTypes');\nconst types = require('./types');\n// TODO: move `IdentifierIssuer` to its own package\nconst IdentifierIssuer = require('rdf-canonize').IdentifierIssuer;\nconst JsonLdError = require('./JsonLdError');\n\n// constants\nconst REGEX_LINK_HEADERS = /(?:<[^>]*?>|\"[^\"]*?\"|[^,])+/g;\nconst REGEX_LINK_HEADER = /\\s*<([^>]*?)>\\s*(?:;\\s*(.*))?/;\nconst REGEX_LINK_HEADER_PARAMS =\n  /(.*?)=(?:(?:\"([^\"]*?)\")|([^\"]*?))\\s*(?:(?:;\\s*)|$)/g;\n\nconst DEFAULTS = {\n  headers: {\n    accept: 'application/ld+json, application/json'\n  }\n};\n\nconst api = {};\nmodule.exports = api;\napi.IdentifierIssuer = IdentifierIssuer;\n\n// define setImmediate and nextTick\n// // nextTick implementation with browser-compatible fallback // //\n// from https://github.com/caolan/async/blob/master/lib/async.js\n\n// capture the global reference to guard against fakeTimer mocks\nconst _setImmediate = typeof setImmediate === 'function' && setImmediate;\n\nconst _delay = _setImmediate ?\n  // not a direct alias (for IE10 compatibility)\n  fn => _setImmediate(fn) :\n  fn => setTimeout(fn, 0);\n\nif(typeof process === 'object' && typeof process.nextTick === 'function') {\n  api.nextTick = process.nextTick;\n} else {\n  api.nextTick = _delay;\n}\napi.setImmediate = _setImmediate ? _delay : api.nextTick;\n\n/**\n * Clones an object, array, Map, Set, or string/number. If a typed JavaScript\n * object is given, such as a Date, it will be converted to a string.\n *\n * @param value the value to clone.\n *\n * @return the cloned value.\n */\napi.clone = function(value) {\n  if(value && typeof value === 'object') {\n    let rval;\n    if(types.isArray(value)) {\n      rval = [];\n      for(let i = 0; i < value.length; ++i) {\n        rval[i] = api.clone(value[i]);\n      }\n    } else if(value instanceof Map) {\n      rval = new Map();\n      for(const [k, v] of value) {\n        rval.set(k, api.clone(v));\n      }\n    } else if(value instanceof Set) {\n      rval = new Set();\n      for(const v of value) {\n        rval.add(api.clone(v));\n      }\n    } else if(types.isObject(value)) {\n      rval = {};\n      for(const key in value) {\n        rval[key] = api.clone(value[key]);\n      }\n    } else {\n      rval = value.toString();\n    }\n    return rval;\n  }\n  return value;\n};\n\n/**\n * Ensure a value is an array. If the value is an array, it is returned.\n * Otherwise, it is wrapped in an array.\n *\n * @param value the value to return as an array.\n *\n * @return the value as an array.\n */\napi.asArray = function(value) {\n  return Array.isArray(value) ? value : [value];\n};\n\n/**\n * Builds an HTTP headers object for making a JSON-LD request from custom\n * headers and asserts the `accept` header isn't overridden.\n *\n * @param headers an object of headers with keys as header names and values\n *          as header values.\n *\n * @return an object of headers with a valid `accept` header.\n */\napi.buildHeaders = (headers = {}) => {\n  const hasAccept = Object.keys(headers).some(\n    h => h.toLowerCase() === 'accept');\n\n  if(hasAccept) {\n    throw new RangeError(\n      'Accept header may not be specified; only \"' +\n      DEFAULTS.headers.accept + '\" is supported.');\n  }\n\n  return Object.assign({Accept: DEFAULTS.headers.accept}, headers);\n};\n\n/**\n * Parses a link header. The results will be key'd by the value of \"rel\".\n *\n * Link: <http://json-ld.org/contexts/person.jsonld>;\n * rel=\"http://www.w3.org/ns/json-ld#context\"; type=\"application/ld+json\"\n *\n * Parses as: {\n *   'http://www.w3.org/ns/json-ld#context': {\n *     target: http://json-ld.org/contexts/person.jsonld,\n *     type: 'application/ld+json'\n *   }\n * }\n *\n * If there is more than one \"rel\" with the same IRI, then entries in the\n * resulting map for that \"rel\" will be arrays.\n *\n * @param header the link header to parse.\n */\napi.parseLinkHeader = header => {\n  const rval = {};\n  // split on unbracketed/unquoted commas\n  const entries = header.match(REGEX_LINK_HEADERS);\n  for(let i = 0; i < entries.length; ++i) {\n    let match = entries[i].match(REGEX_LINK_HEADER);\n    if(!match) {\n      continue;\n    }\n    const result = {target: match[1]};\n    const params = match[2];\n    while((match = REGEX_LINK_HEADER_PARAMS.exec(params))) {\n      result[match[1]] = (match[2] === undefined) ? match[3] : match[2];\n    }\n    const rel = result['rel'] || '';\n    if(Array.isArray(rval[rel])) {\n      rval[rel].push(result);\n    } else if(rval.hasOwnProperty(rel)) {\n      rval[rel] = [rval[rel], result];\n    } else {\n      rval[rel] = result;\n    }\n  }\n  return rval;\n};\n\n/**\n * Throws an exception if the given value is not a valid @type value.\n *\n * @param v the value to check.\n */\napi.validateTypeValue = v => {\n  // can be a string or an empty object\n  if(types.isString(v) || types.isEmptyObject(v)) {\n    return;\n  }\n\n  // must be an array\n  let isValid = false;\n  if(types.isArray(v)) {\n    // must contain only strings\n    isValid = true;\n    for(let i = 0; i < v.length; ++i) {\n      if(!(types.isString(v[i]))) {\n        isValid = false;\n        break;\n      }\n    }\n  }\n\n  if(!isValid) {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; \"@type\" value must a string, an array of ' +\n      'strings, or an empty object.', 'jsonld.SyntaxError',\n      {code: 'invalid type value', value: v});\n  }\n};\n\n/**\n * Returns true if the given subject has the given property.\n *\n * @param subject the subject to check.\n * @param property the property to look for.\n *\n * @return true if the subject has the given property, false if not.\n */\napi.hasProperty = (subject, property) => {\n  if(subject.hasOwnProperty(property)) {\n    const value = subject[property];\n    return (!types.isArray(value) || value.length > 0);\n  }\n  return false;\n};\n\n/**\n * Determines if the given value is a property of the given subject.\n *\n * @param subject the subject to check.\n * @param property the property to check.\n * @param value the value to check.\n *\n * @return true if the value exists, false if not.\n */\napi.hasValue = (subject, property, value) => {\n  if(api.hasProperty(subject, property)) {\n    let val = subject[property];\n    const isList = graphTypes.isList(val);\n    if(types.isArray(val) || isList) {\n      if(isList) {\n        val = val['@list'];\n      }\n      for(let i = 0; i < val.length; ++i) {\n        if(api.compareValues(value, val[i])) {\n          return true;\n        }\n      }\n    } else if(!types.isArray(value)) {\n      // avoid matching the set of values with an array value parameter\n      return api.compareValues(value, val);\n    }\n  }\n  return false;\n};\n\n/**\n * Adds a value to a subject. If the value is an array, all values in the\n * array will be added.\n *\n * @param subject the subject to add the value to.\n * @param property the property that relates the value to the subject.\n * @param value the value to add.\n * @param [options] the options to use:\n *        [propertyIsArray] true if the property is always an array, false\n *          if not (default: false).\n *        [allowDuplicate] true to allow duplicates, false not to (uses a\n *          simple shallow comparison of subject ID or value) (default: true).\n */\napi.addValue = (subject, property, value, options) => {\n  options = options || {};\n  if(!('propertyIsArray' in options)) {\n    options.propertyIsArray = false;\n  }\n  if(!('allowDuplicate' in options)) {\n    options.allowDuplicate = true;\n  }\n\n  if(types.isArray(value)) {\n    if(value.length === 0 && options.propertyIsArray &&\n      !subject.hasOwnProperty(property)) {\n      subject[property] = [];\n    }\n    for(let i = 0; i < value.length; ++i) {\n      api.addValue(subject, property, value[i], options);\n    }\n  } else if(subject.hasOwnProperty(property)) {\n    // check if subject already has value if duplicates not allowed\n    const hasValue = (!options.allowDuplicate &&\n      api.hasValue(subject, property, value));\n\n    // make property an array if value not present or always an array\n    if(!types.isArray(subject[property]) &&\n      (!hasValue || options.propertyIsArray)) {\n      subject[property] = [subject[property]];\n    }\n\n    // add new value\n    if(!hasValue) {\n      subject[property].push(value);\n    }\n  } else {\n    // add new value as set or single value\n    subject[property] = options.propertyIsArray ? [value] : value;\n  }\n};\n\n/**\n * Gets all of the values for a subject's property as an array.\n *\n * @param subject the subject.\n * @param property the property.\n *\n * @return all of the values for a subject's property as an array.\n */\napi.getValues = (subject, property) => [].concat(subject[property] || []);\n\n/**\n * Removes a property from a subject.\n *\n * @param subject the subject.\n * @param property the property.\n */\napi.removeProperty = (subject, property) => {\n  delete subject[property];\n};\n\n/**\n * Removes a value from a subject.\n *\n * @param subject the subject.\n * @param property the property that relates the value to the subject.\n * @param value the value to remove.\n * @param [options] the options to use:\n *          [propertyIsArray] true if the property is always an array, false\n *            if not (default: false).\n */\napi.removeValue = (subject, property, value, options) => {\n  options = options || {};\n  if(!('propertyIsArray' in options)) {\n    options.propertyIsArray = false;\n  }\n\n  // filter out value\n  const values = api.getValues(subject, property).filter(\n    e => !api.compareValues(e, value));\n\n  if(values.length === 0) {\n    api.removeProperty(subject, property);\n  } else if(values.length === 1 && !options.propertyIsArray) {\n    subject[property] = values[0];\n  } else {\n    subject[property] = values;\n  }\n};\n\n/**\n * Relabels all blank nodes in the given JSON-LD input.\n *\n * @param input the JSON-LD input.\n * @param [options] the options to use:\n *          [issuer] an IdentifierIssuer to use to label blank nodes.\n */\napi.relabelBlankNodes = (input, options) => {\n  options = options || {};\n  const issuer = options.issuer || new IdentifierIssuer('_:b');\n  return _labelBlankNodes(issuer, input);\n};\n\n/**\n * Compares two JSON-LD values for equality. Two JSON-LD values will be\n * considered equal if:\n *\n * 1. They are both primitives of the same type and value.\n * 2. They are both @values with the same @value, @type, @language,\n *   and @index, OR\n * 3. They both have @ids they are the same.\n *\n * @param v1 the first value.\n * @param v2 the second value.\n *\n * @return true if v1 and v2 are considered equal, false if not.\n */\napi.compareValues = (v1, v2) => {\n  // 1. equal primitives\n  if(v1 === v2) {\n    return true;\n  }\n\n  // 2. equal @values\n  if(graphTypes.isValue(v1) && graphTypes.isValue(v2) &&\n    v1['@value'] === v2['@value'] &&\n    v1['@type'] === v2['@type'] &&\n    v1['@language'] === v2['@language'] &&\n    v1['@index'] === v2['@index']) {\n    return true;\n  }\n\n  // 3. equal @ids\n  if(types.isObject(v1) &&\n    ('@id' in v1) &&\n    types.isObject(v2) &&\n    ('@id' in v2)) {\n    return v1['@id'] === v2['@id'];\n  }\n\n  return false;\n};\n\n/**\n * Compares two strings first based on length and then lexicographically.\n *\n * @param a the first string.\n * @param b the second string.\n *\n * @return -1 if a < b, 1 if a > b, 0 if a === b.\n */\napi.compareShortestLeast = (a, b) => {\n  if(a.length < b.length) {\n    return -1;\n  }\n  if(b.length < a.length) {\n    return 1;\n  }\n  if(a === b) {\n    return 0;\n  }\n  return (a < b) ? -1 : 1;\n};\n\napi.normalizeDocumentLoader = fn => {\n  if(fn.length < 2) {\n    return api.callbackify(fn);\n  }\n\n  return async function(url) {\n    const callback = arguments[1];\n    return new Promise((resolve, reject) => {\n      try {\n        fn(url, (err, remoteDoc) => {\n          if(typeof callback === 'function') {\n            return _invokeCallback(callback, err, remoteDoc);\n          } else if(err) {\n            reject(err);\n          } else {\n            resolve(remoteDoc);\n          }\n        });\n      } catch(e) {\n        if(typeof callback === 'function') {\n          return _invokeCallback(callback, e);\n        }\n        reject(e);\n      }\n    });\n  };\n};\n\napi.callbackify = fn => {\n  return async function(...args) {\n    const callback = args[args.length - 1];\n    if(typeof callback === 'function') {\n      args.pop();\n    }\n\n    let result;\n    try {\n      result = await fn.apply(null, args);\n    } catch(e) {\n      if(typeof callback === 'function') {\n        return _invokeCallback(callback, e);\n      }\n      throw e;\n    }\n\n    if(typeof callback === 'function') {\n      return _invokeCallback(callback, null, result);\n    }\n\n    return result;\n  };\n};\n\nfunction _invokeCallback(callback, err, result) {\n  // execute on next tick to prevent \"unhandled rejected promise\"\n  // and simulate what would have happened in a promiseless API\n  api.nextTick(() => callback(err, result));\n}\n\n/**\n * Labels the blank nodes in the given value using the given IdentifierIssuer.\n *\n * @param issuer the IdentifierIssuer to use.\n * @param element the element with blank nodes to rename.\n *\n * @return the element.\n */\nfunction _labelBlankNodes(issuer, element) {\n  if(types.isArray(element)) {\n    for(let i = 0; i < element.length; ++i) {\n      element[i] = _labelBlankNodes(issuer, element[i]);\n    }\n  } else if(graphTypes.isList(element)) {\n    element['@list'] = _labelBlankNodes(issuer, element['@list']);\n  } else if(types.isObject(element)) {\n    // relabel blank node\n    if(graphTypes.isBlankNode(element)) {\n      element['@id'] = issuer.getId(element['@id']);\n    }\n\n    // recursively apply to all keys\n    const keys = Object.keys(element).sort();\n    for(let ki = 0; ki < keys.length; ++ki) {\n      const key = keys[ki];\n      if(key !== '@id') {\n        element[key] = _labelBlankNodes(issuer, element[key]);\n      }\n    }\n  }\n\n  return element;\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar Metadata = (function () {\n    function Metadata(key, value) {\n        this.key = key;\n        this.value = value;\n    }\n    Metadata.prototype.toString = function () {\n        if (this.key === METADATA_KEY.NAMED_TAG) {\n            return \"named: \" + this.value.toString() + \" \";\n        }\n        else {\n            return \"tagged: { key:\" + this.key.toString() + \", value: \" + this.value + \" }\";\n        }\n    };\n    return Metadata;\n}());\nexports.Metadata = Metadata;\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Returns true if the given value is an Array.\n *\n * @param v the value to check.\n *\n * @return true if the value is an Array, false if not.\n */\napi.isArray = Array.isArray;\n\n/**\n * Returns true if the given value is a Boolean.\n *\n * @param v the value to check.\n *\n * @return true if the value is a Boolean, false if not.\n */\napi.isBoolean = v => (typeof v === 'boolean' ||\n  Object.prototype.toString.call(v) === '[object Boolean]');\n\n/**\n * Returns true if the given value is a double.\n *\n * @param v the value to check.\n *\n * @return true if the value is a double, false if not.\n */\napi.isDouble = v => api.isNumber(v) && String(v).indexOf('.') !== -1;\n\n/**\n * Returns true if the given value is an empty Object.\n *\n * @param v the value to check.\n *\n * @return true if the value is an empty Object, false if not.\n */\napi.isEmptyObject = v => api.isObject(v) && Object.keys(v).length === 0;\n\n/**\n * Returns true if the given value is a Number.\n *\n * @param v the value to check.\n *\n * @return true if the value is a Number, false if not.\n */\napi.isNumber = v => (typeof v === 'number' ||\n  Object.prototype.toString.call(v) === '[object Number]');\n\n/**\n * Returns true if the given value is numeric.\n *\n * @param v the value to check.\n *\n * @return true if the value is numeric, false if not.\n */\napi.isNumeric = v => !isNaN(parseFloat(v)) && isFinite(v);\n\n/**\n * Returns true if the given value is an Object.\n *\n * @param v the value to check.\n *\n * @return true if the value is an Object, false if not.\n */\napi.isObject = v => Object.prototype.toString.call(v) === '[object Object]';\n\n/**\n * Returns true if the given value is a String.\n *\n * @param v the value to check.\n *\n * @return true if the value is a String, false if not.\n */\napi.isString = v => (typeof v === 'string' ||\n  Object.prototype.toString.call(v) === '[object String]');\n\n/**\n * Returns true if the given value is undefined.\n *\n * @param v the value to check.\n *\n * @return true if the value is undefined, false if not.\n */\napi.isUndefined = v => typeof v === 'undefined';\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BindingScopeEnum = {\n    Request: \"Request\",\n    Singleton: \"Singleton\",\n    Transient: \"Transient\"\n};\nexports.BindingScopeEnum = BindingScopeEnum;\nvar BindingTypeEnum = {\n    ConstantValue: \"ConstantValue\",\n    Constructor: \"Constructor\",\n    DynamicValue: \"DynamicValue\",\n    Factory: \"Factory\",\n    Function: \"Function\",\n    Instance: \"Instance\",\n    Invalid: \"Invalid\",\n    Provider: \"Provider\"\n};\nexports.BindingTypeEnum = BindingTypeEnum;\nvar TargetTypeEnum = {\n    ClassProperty: \"ClassProperty\",\n    ConstructorArgument: \"ConstructorArgument\",\n    Variable: \"Variable\"\n};\nexports.TargetTypeEnum = TargetTypeEnum;\n","import TravelMode from \"./enums/TravelMode\";\n\n/**\n * A Catalog instance holds the stops source and connections source configs.\n * These configs get passed to the [[StopsFetcherFactory]] and [[ConnectionsFetcherFactory]] to construct\n * respectively [[IStopsFetcher]] and [[IConnectionsFetcher]] instances\n */\nexport default class Catalog {\n\n  public static combine(...catalogs: Catalog[]): Catalog {\n    const combinedCatalog = new Catalog();\n\n    for (const sourceCatalog of catalogs) {\n      combinedCatalog.stopsSourceConfigs.push(...sourceCatalog.stopsSourceConfigs);\n      combinedCatalog.connectionsSourceConfigs.push(...sourceCatalog.connectionsSourceConfigs);\n    }\n\n    return combinedCatalog;\n  }\n\n  public stopsSourceConfigs: IStopsSourceConfig[] = [];\n  public connectionsSourceConfigs: IConnectionsSourceConfig[] = [];\n\n  public addStopsSource(accessUrl: string) {\n    this.stopsSourceConfigs.push({accessUrl});\n  }\n\n  public addConnectionsSource(accessUrl: string, travelMode: TravelMode) {\n    this.connectionsSourceConfigs.push({accessUrl, travelMode});\n  }\n}\n\nexport interface IStopsSourceConfig {\n  accessUrl: string;\n}\n\nexport interface IConnectionsSourceConfig {\n  accessUrl: string;\n  travelMode: TravelMode;\n}\n","enum TravelMode {\n  Train = \"train\",\n  Bus = \"bus\",\n  Walking = \"walking\",\n  Profile = \"profile\", // this could be more specific, maybe replace this enum with a data class\n}\n\nexport default TravelMode;\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst types = require('./types');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Returns true if the given value is a subject with properties.\n *\n * @param v the value to check.\n *\n * @return true if the value is a subject with properties, false if not.\n */\napi.isSubject = v => {\n  // Note: A value is a subject if all of these hold true:\n  // 1. It is an Object.\n  // 2. It is not a @value, @set, or @list.\n  // 3. It has more than 1 key OR any existing key is not @id.\n  if(types.isObject(v) &&\n    !(('@value' in v) || ('@set' in v) || ('@list' in v))) {\n    const keyCount = Object.keys(v).length;\n    return (keyCount > 1 || !('@id' in v));\n  }\n  return false;\n};\n\n/**\n * Returns true if the given value is a subject reference.\n *\n * @param v the value to check.\n *\n * @return true if the value is a subject reference, false if not.\n */\napi.isSubjectReference = v =>\n  // Note: A value is a subject reference if all of these hold true:\n  // 1. It is an Object.\n  // 2. It has a single key: @id.\n  (types.isObject(v) && Object.keys(v).length === 1 && ('@id' in v));\n\n/**\n * Returns true if the given value is a @value.\n *\n * @param v the value to check.\n *\n * @return true if the value is a @value, false if not.\n */\napi.isValue = v =>\n  // Note: A value is a @value if all of these hold true:\n  // 1. It is an Object.\n  // 2. It has the @value property.\n  types.isObject(v) && ('@value' in v);\n\n/**\n * Returns true if the given value is a @list.\n *\n * @param v the value to check.\n *\n * @return true if the value is a @list, false if not.\n */\napi.isList = v =>\n  // Note: A value is a @list if all of these hold true:\n  // 1. It is an Object.\n  // 2. It has the @list property.\n  types.isObject(v) && ('@list' in v);\n\n/**\n * Returns true if the given value is a @graph.\n *\n * @return true if the value is a @graph, false if not.\n */\napi.isGraph = v => {\n  // Note: A value is a graph if all of these hold true:\n  // 1. It is an object.\n  // 2. It has an `@graph` key.\n  // 3. It may have '@id' or '@index'\n  return types.isObject(v) &&\n    '@graph' in v &&\n    Object.keys(v)\n      .filter(key => key !== '@id' && key !== '@index').length === 1;\n};\n\n/**\n * Returns true if the given value is a simple @graph.\n *\n * @return true if the value is a simple @graph, false if not.\n */\napi.isSimpleGraph = v => {\n  // Note: A value is a simple graph if all of these hold true:\n  // 1. It is an object.\n  // 2. It has an `@graph` key.\n  // 3. It has only 1 key or 2 keys where one of them is `@index`.\n  return api.isGraph(v) && !('@id' in v);\n};\n\n/**\n * Returns true if the given value is a blank node.\n *\n * @param v the value to check.\n *\n * @return true if the value is a blank node, false if not.\n */\napi.isBlankNode = v => {\n  // Note: A value is a blank node if all of these hold true:\n  // 1. It is an Object.\n  // 2. If it has an @id key its value begins with '_:'.\n  // 3. It has no keys OR is not a @value, @set, or @list.\n  if(types.isObject(v)) {\n    if('@id' in v) {\n      return (v['@id'].indexOf('_:') === 0);\n    }\n    return (Object.keys(v).length === 0 ||\n      !(('@value' in v) || ('@set' in v) || ('@list' in v)));\n  }\n  return false;\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nmodule.exports = class JsonLdError extends Error {\n  /**\n   * Creates a JSON-LD Error.\n   *\n   * @param msg the error message.\n   * @param type the error type.\n   * @param details the error details.\n   */\n  constructor(\n    message = 'An unspecified JSON-LD error occurred.',\n    name = 'jsonld.Error',\n    details = {}) {\n    super(message);\n    this.name = name;\n    this.message = message;\n    this.details = details;\n  }\n};\n","export class RoutableTileCoordinate {\n    public zoom: number;\n    public x: number;\n    public y: number;\n\n    constructor(zoom: number, x: number, y: number) {\n        this.zoom = zoom;\n        this.x = x;\n        this.y = y;\n    }\n\n    public contains(other: RoutableTileCoordinate): boolean {\n        const n = Math.pow(2, other.zoom - this.zoom);\n        const otherX = Math.floor(other.x / n);\n        const otherY = Math.floor(other.y / n);\n        if (otherX === this.x && otherY === this.y) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n}\n","enum RoutingPhase {\n    Base = \"base\",\n    Transit = \"transit\",\n}\n\nexport default RoutingPhase;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction tagParameter(annotationTarget, propertyName, parameterIndex, metadata) {\n    var metadataKey = METADATA_KEY.TAGGED;\n    _tagParameterOrProperty(metadataKey, annotationTarget, propertyName, metadata, parameterIndex);\n}\nexports.tagParameter = tagParameter;\nfunction tagProperty(annotationTarget, propertyName, metadata) {\n    var metadataKey = METADATA_KEY.TAGGED_PROP;\n    _tagParameterOrProperty(metadataKey, annotationTarget.constructor, propertyName, metadata);\n}\nexports.tagProperty = tagProperty;\nfunction _tagParameterOrProperty(metadataKey, annotationTarget, propertyName, metadata, parameterIndex) {\n    var paramsOrPropertiesMetadata = {};\n    var isParameterDecorator = (typeof parameterIndex === \"number\");\n    var key = (parameterIndex !== undefined && isParameterDecorator) ? parameterIndex.toString() : propertyName;\n    if (isParameterDecorator && propertyName !== undefined) {\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\n    }\n    if (Reflect.hasOwnMetadata(metadataKey, annotationTarget)) {\n        paramsOrPropertiesMetadata = Reflect.getMetadata(metadataKey, annotationTarget);\n    }\n    var paramOrPropertyMetadata = paramsOrPropertiesMetadata[key];\n    if (!Array.isArray(paramOrPropertyMetadata)) {\n        paramOrPropertyMetadata = [];\n    }\n    else {\n        for (var _i = 0, paramOrPropertyMetadata_1 = paramOrPropertyMetadata; _i < paramOrPropertyMetadata_1.length; _i++) {\n            var m = paramOrPropertyMetadata_1[_i];\n            if (m.key === metadata.key) {\n                throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + m.key.toString());\n            }\n        }\n    }\n    paramOrPropertyMetadata.push(metadata);\n    paramsOrPropertiesMetadata[key] = paramOrPropertyMetadata;\n    Reflect.defineMetadata(metadataKey, paramsOrPropertiesMetadata, annotationTarget);\n}\nfunction _decorate(decorators, target) {\n    Reflect.decorate(decorators, target);\n}\nfunction _param(paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); };\n}\nfunction decorate(decorator, target, parameterIndex) {\n    if (typeof parameterIndex === \"number\") {\n        _decorate([_param(parameterIndex, decorator)], target);\n    }\n    else if (typeof parameterIndex === \"string\") {\n        Reflect.decorate([decorator], target, parameterIndex);\n    }\n    else {\n        _decorate([decorator], target);\n    }\n}\nexports.decorate = decorate;\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport Profile from \"../entities/profile/Profile\";\nimport { IRoutableTileNodeIndex, RoutableTileNode } from \"../entities/tiles/node\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport { RoutableTile } from \"../entities/tiles/tile\";\nimport { IRoutableTileWayIndex, RoutableTileWay } from \"../entities/tiles/way\";\nimport ProfileProvider from \"../fetcher/profiles/ProfileProviderDefault\";\nimport ILocation from \"../interfaces/ILocation\";\nimport TYPES from \"../types\";\nimport Geo from \"../util/Geo\";\nimport PathfindingGraph from \"./graph\";\nimport {\n  IShortestPathAlgorithm,\n  IShortestPathInstance,\n  IShortestPathTreeAlgorithm,\n  IShortestPathTreeInstance,\n} from \"./pathfinder\";\n\ninterface IPointEmbedding {\n  way: RoutableTileWay; // the road where the point gets embedded in\n  point: ILocation; // point that's embedded into the road network\n  intersection: ILocation; // closest point on the road segment closest to the point\n  segA: RoutableTileNode; // one side of the road segment closest to the point\n  segB: RoutableTileNode; // other side of the road segment closest to the point\n}\n\ninterface IGraphMap {\n  [label: string]: PathfindingGraph;\n}\n\n@injectable()\nexport default class PathfinderProvider {\n  private graphs: IGraphMap;\n\n  private shortestPath: IShortestPathAlgorithm;\n  private shortestPathTree: IShortestPathTreeAlgorithm;\n  private routableTileRegistry: RoutableTileRegistry;\n  private profileProvider: ProfileProvider;\n\n  constructor(\n    @inject(TYPES.ShortestPathTreeAlgorithm) shortestPathTree: IShortestPathTreeAlgorithm,\n    @inject(TYPES.ShortestPathAlgorithm) pointToPoint: IShortestPathAlgorithm,\n    @inject(TYPES.RoutableTileRegistry) routableTileRegistry: RoutableTileRegistry,\n    @inject(TYPES.ProfileProvider) profileProvider: ProfileProvider,\n  ) {\n    this.shortestPath = pointToPoint;\n    this.shortestPathTree = shortestPathTree;\n    this.routableTileRegistry = routableTileRegistry;\n    this.profileProvider = profileProvider;\n    this.graphs = {};\n  }\n\n  public getShortestPathAlgorithm(profile: Profile): IShortestPathInstance {\n    const graph = this.getGraphForProfile(profile);\n    return this.shortestPath.createInstance(graph);\n  }\n\n  public getShortestPathTreeAlgorithm(profile: Profile): IShortestPathTreeInstance {\n    const graph = this.getGraphForProfile(profile);\n    return this.shortestPathTree.createInstance(graph);\n  }\n\n  public async registerEdges(ways: IRoutableTileWayIndex, nodes: IRoutableTileNodeIndex): Promise<void> {\n    // add new edges to existing graphs\n    for (const profileId of Object.keys(this.graphs)) {\n      const profile = await this.profileProvider.getProfile(profileId);\n\n      for (const way of Object.values(ways)) {\n        if (!profile.hasAccess(way)) {\n          continue;\n        }\n\n        for (const edge of way.getParts()) {\n          const from = nodes[edge.from];\n          const to = nodes[edge.to];\n          if (from && to) {\n            if (profile.isObstacle(from) || profile.isObstacle(to)) {\n              continue;\n            }\n            this.addEdge(profile, from, to, way, edge.distance);\n            if (!profile.isOneWay(way)) {\n              this.addEdge(profile, to, from, way, edge.distance);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  public async embedLocation(p: ILocation, tileset: RoutableTile, invert = false) {\n    for (const profile of await this.profileProvider.getProfiles()) {\n      let bestDistance = Infinity;\n      let bestEmbedding: IPointEmbedding;\n\n      for (const wayId of tileset.getWays()) {\n        const way = this.routableTileRegistry.getWay(wayId);\n\n        if (!profile.hasAccess(way) || way.reachable === false) {\n          continue;\n        }\n\n        for (const segment of way.segments) {\n          for (let i = 0; i < segment.length - 1; i++) {\n            const nodeA = segment[i];\n            const from = this.routableTileRegistry.getNode(nodeA);\n            const nodeB = segment[i + 1];\n            const to = this.routableTileRegistry.getNode(nodeB);\n\n            if (!from || !to) {\n              // FIXME, caused by bug in data\n              continue;\n            }\n\n            const [distance, intersection] = this.segmentDistToPoint(from, to, p);\n            if (distance < bestDistance) {\n              bestDistance = distance;\n              bestEmbedding = {\n                way,\n                point: p,\n                segA: from,\n                segB: to,\n                intersection,\n              };\n            }\n          }\n        }\n      }\n\n      if (bestEmbedding) {\n        const intersection = bestEmbedding.intersection;\n        const segA = bestEmbedding.segA;\n        const segB = bestEmbedding.segB;\n        const way = bestEmbedding.way;\n        const isOneWay = profile.isOneWay(way);\n\n        if (!invert) {\n          // A -------------------> B\n          // A <-- intersection --> B\n          //            |\n          //            p\n          this.addEdge(profile, p, intersection, way);\n          this.addEdge(profile, intersection, segB, way);\n          if (!isOneWay) {\n            this.addEdge(profile, intersection, segA, way);\n          }\n        } else {\n          // A -------------------> B\n          // A --> intersection <-- B\n          //            |\n          //            p\n          this.addEdge(profile, intersection, p, way);\n          this.addEdge(profile, segA, intersection, way);\n          if (!isOneWay) {\n            this.addEdge(profile, segB, intersection, way);\n          }\n        }\n      }\n    }\n  }\n\n  public getGraphForProfile(profile: Profile): PathfindingGraph {\n    if (!this.graphs[profile.getID()]) {\n      // we don't have a graph for this profile yet\n      // create one\n      const graph = new PathfindingGraph(profile.getID());\n      this.graphs[profile.getID()] = graph;\n\n      // and populate it with all the data we have\n      for (const way of this.routableTileRegistry.getWays()) {\n        if (!profile.hasAccess(way)) {\n          continue;\n        }\n\n        for (const edge of way.getParts()) {\n          const from = this.routableTileRegistry.getNode(edge.from);\n          const to = this.routableTileRegistry.getNode(edge.to);\n          if (from && to) {\n            if (profile.isObstacle(from) || profile.isObstacle(to)) {\n              continue;\n            }\n            this.addEdge(profile, from, to, way, edge.distance, graph);\n            if (!profile.isOneWay(way)) {\n              this.addEdge(profile, to, from, way, edge.distance, graph);\n            }\n          }\n        }\n      }\n    }\n    return this.graphs[profile.getID()];\n  }\n\n  private addEdge(\n    profile: Profile,\n    from: ILocation, to:\n      ILocation,\n    way: RoutableTileWay,\n    distance?: number,\n    graph?: PathfindingGraph,\n  ) {\n    // this specifically adds an edge that corresponds to an actual street\n    // if you need to add any other edge, you'll need to create a different method\n    graph = graph || this.getGraphForProfile(profile);\n    distance = distance || profile.getDistance(from, to, way);\n    const duration = profile.getDuration(from, to, way);\n    const cost = profile.getCost(from, to, way);\n    graph.addEdge(Geo.getId(from), Geo.getId(to), distance, duration, cost);\n  }\n\n  private segmentDistToPoint(segA: ILocation, segB: ILocation, p: ILocation): [number, ILocation] {\n    // seems numerically unstable, see 'catastrophic cancellation'\n    const sx1 = segA.longitude;\n    const sx2 = segB.longitude;\n    const px = p.longitude;\n\n    const sy1 = segA.latitude;\n    const sy2 = segB.latitude;\n    const py = p.latitude;\n\n    const px2 = sx2 - sx1;  // <-\n    const py2 = sy2 - sy2;  // <-\n\n    const norm = px2 * px2 + py2 * py2;\n    let u = ((px - sx1) * px2 + (py - sy1) * py2) / norm;\n\n    if (u > 1) {\n      u = 1;\n    } else if (u < 0) {\n      u = 0;\n    }\n\n    const x = sx1 + u * px2;\n    const y = sy1 + u * py2;\n\n    const intersection = {\n      longitude: x,\n      latitude: y,\n    };\n\n    const dist = Geo.getDistanceBetweenLocations(p, intersection);\n\n    return [dist, intersection];\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar idCounter = 0;\nfunction id() {\n    return idCounter++;\n}\nexports.id = id;\n","/**\n * Signifies different phases at which reachable stops can be searched for\n * Classes that use [[IReachableStopsFinder]] implementations can use these to tag different dependencies\n * This is especially useful when the class could potentially use different implementations of\n * the same [[IReachableStopsFinder]] interface at each phase\n */\nenum ReachableStopsSearchPhase {\n  Initial = \"reachableStopsSearchInitial\",\n  Transfer = \"reachableStopsSearchTransfer\",\n  Final = \"reachableStopsSearchFinal\",\n}\n\nexport default ReachableStopsSearchPhase;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst api = {};\nmodule.exports = api;\n\n// define setImmediate and nextTick\n//// nextTick implementation with browser-compatible fallback ////\n// from https://github.com/caolan/async/blob/master/lib/async.js\n\n// capture the global reference to guard against fakeTimer mocks\nconst _setImmediate = typeof setImmediate === 'function' && setImmediate;\n\nconst _delay = _setImmediate ?\n  // not a direct alias (for IE10 compatibility)\n  fn => _setImmediate(fn) :\n  fn => setTimeout(fn, 0);\n\nif(typeof process === 'object' && typeof process.nextTick === 'function') {\n  api.nextTick = process.nextTick;\n} else {\n  api.nextTick = _delay;\n}\napi.setImmediate = _setImmediate ? _delay : api.nextTick;\n\n/**\n * Clones an object, array, or string/number. If a typed JavaScript object\n * is given, such as a Date, it will be converted to a string.\n *\n * @param value the value to clone.\n *\n * @return the cloned value.\n */\napi.clone = function(value) {\n  if(value && typeof value === 'object') {\n    let rval;\n    if(Array.isArray(value)) {\n      rval = [];\n      for(let i = 0; i < value.length; ++i) {\n        rval[i] = api.clone(value[i]);\n      }\n    } else if(api.isObject(value)) {\n      rval = {};\n      for(const key in value) {\n        rval[key] = api.clone(value[key]);\n      }\n    } else {\n      rval = value.toString();\n    }\n    return rval;\n  }\n  return value;\n};\n\n/**\n * Returns true if the given value is an Object.\n *\n * @param v the value to check.\n *\n * @return true if the value is an Object, false if not.\n */\napi.isObject = v => Object.prototype.toString.call(v) === '[object Object]';\n\n/**\n * Returns true if the given value is undefined.\n *\n * @param v the value to check.\n *\n * @return true if the value is undefined, false if not.\n */\napi.isUndefined = v => typeof v === 'undefined';\n\napi.callbackify = fn => {\n  return async function(...args) {\n    const callback = args[args.length - 1];\n    if(typeof callback === 'function') {\n      args.pop();\n    }\n\n    let result;\n    try {\n      result = await fn.apply(null, args);\n    } catch(e) {\n      if(typeof callback === 'function') {\n        return _invokeCallback(callback, e);\n      }\n      throw e;\n    }\n\n    if(typeof callback === 'function') {\n      return _invokeCallback(callback, null, result);\n    }\n\n    return result;\n  };\n};\n\nfunction _invokeCallback(callback, err, result) {\n  try {\n    return callback(err, result);\n  } catch(unhandledError) {\n    // throw unhandled errors to prevent \"unhandled rejected promise\"\n    // and simulate what would have happened in a promiseless API\n    process.nextTick(() => {\n      throw unhandledError;\n    });\n  }\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst util = require('./util');\nconst ActiveContextCache = require('./ActiveContextCache');\nconst JsonLdError = require('./JsonLdError');\n\nconst {\n  isArray: _isArray,\n  isObject: _isObject,\n  isString: _isString,\n  isUndefined: _isUndefined\n} = require('./types');\n\nconst {\n  isAbsolute: _isAbsoluteIri,\n  isRelative: _isRelativeIri,\n  prependBase,\n  parse: parseUrl\n} = require('./url');\n\nconst {\n  asArray: _asArray,\n  compareShortestLeast: _compareShortestLeast\n} = require('./util');\n\nconst MAX_CONTEXT_URLS = 10;\n\nconst INITIAL_CONTEXT_CACHE = new Map();\nconst INITIAL_CONTEXT_CACHE_MAX_SIZE = 10000;\n\nconst api = {};\nmodule.exports = api;\n\napi.cache = new ActiveContextCache();\n\n/**\n * Processes a local context and returns a new active context.\n *\n * @param activeCtx the current active context.\n * @param localCtx the local context to process.\n * @param options the context processing options.\n * @param isPropertyTermScopedContext `true` if `localCtx` is a scoped context\n *   from a property term.\n * @param isTypeScopedContext `true` if `localCtx` is a scoped context\n *   from a type.\n *\n * @return the new active context.\n */\napi.process = ({\n  activeCtx, localCtx, options,\n  isPropertyTermScopedContext = false,\n  isTypeScopedContext = false\n}) => {\n  // normalize local context to an array of @context objects\n  if(_isObject(localCtx) && '@context' in localCtx &&\n    _isArray(localCtx['@context'])) {\n    localCtx = localCtx['@context'];\n  }\n  const ctxs = _asArray(localCtx);\n\n  // no contexts in array, return current active context w/o changes\n  if(ctxs.length === 0) {\n    return activeCtx;\n  }\n\n  // track the previous context\n  const previousContext = activeCtx.previousContext || activeCtx;\n\n  // if context is property scoped and there's a previous context, amend it,\n  // not the current one\n  if(isPropertyTermScopedContext && activeCtx.previousContext) {\n    // TODO: consider optimizing to a shallow copy\n    activeCtx = activeCtx.clone();\n    activeCtx.isPropertyTermScoped = true;\n    activeCtx.previousContext = api.process({\n      activeCtx: activeCtx.previousContext,\n      localCtx: ctxs,\n      options,\n      isPropertyTermScopedContext\n    });\n    return activeCtx;\n  }\n\n  // process each context in order, update active context\n  // on each iteration to ensure proper caching\n  let rval = activeCtx;\n  for(let i = 0; i < ctxs.length; ++i) {\n    let ctx = ctxs[i];\n\n    // update active context to one computed from last iteration\n    activeCtx = rval;\n\n    // reset to initial context\n    if(ctx === null) {\n      // We can't nullify if there are protected terms and we're\n      // not processing a property term scoped context\n      if(!isPropertyTermScopedContext &&\n        Object.keys(activeCtx.protected).length !== 0) {\n        const protectedMode = (options && options.protectedMode) || 'error';\n        if(protectedMode === 'error') {\n          throw new JsonLdError(\n            'Tried to nullify a context with protected terms outside of ' +\n            'a term definition.',\n            'jsonld.SyntaxError',\n            {code: 'invalid context nullification'});\n        } else if(protectedMode === 'warn') {\n          // FIXME: remove logging and use a handler\n          console.warn('WARNING: invalid context nullification');\n          const oldActiveCtx = activeCtx;\n          // copy all protected term definitions to fresh initial context\n          rval = activeCtx = api.getInitialContext(options).clone();\n          for(const [term, _protected] of\n            Object.entries(oldActiveCtx.protected)) {\n            if(_protected) {\n              activeCtx.mappings[term] =\n                util.clone(oldActiveCtx.mappings[term]);\n            }\n          }\n          activeCtx.protected = util.clone(oldActiveCtx.protected);\n\n          // cache result\n          if(api.cache) {\n            api.cache.set(oldActiveCtx, ctx, rval);\n          }\n\n          continue;\n        }\n        throw new JsonLdError(\n          'Invalid protectedMode.',\n          'jsonld.SyntaxError',\n          {code: 'invalid protected mode', context: localCtx, protectedMode});\n      }\n      rval = activeCtx = api.getInitialContext(options).clone();\n      // if context is type-scoped, ensure previous context has been set\n      if(isTypeScopedContext) {\n        rval.previousContext = previousContext.clone();\n      }\n      continue;\n    }\n\n    // get context from cache if available\n    if(api.cache) {\n      const cached = api.cache.get(activeCtx, ctx);\n      if(cached) {\n        rval = activeCtx = cached;\n        continue;\n      }\n    }\n\n    // dereference @context key if present\n    if(_isObject(ctx) && '@context' in ctx) {\n      ctx = ctx['@context'];\n    }\n\n    // context must be an object by now, all URLs retrieved before this call\n    if(!_isObject(ctx)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context must be an object.',\n        'jsonld.SyntaxError', {code: 'invalid local context', context: ctx});\n    }\n\n    // TODO: there is likely a `preivousContext` cloning optimization that\n    // could be applied here (no need to copy it under certain conditions)\n\n    // clone context before updating it\n    rval = rval.clone();\n\n    // define context mappings for keys in local context\n    const defined = new Map();\n\n    // handle @version\n    if('@version' in ctx) {\n      if(ctx['@version'] !== 1.1) {\n        throw new JsonLdError(\n          'Unsupported JSON-LD version: ' + ctx['@version'],\n          'jsonld.UnsupportedVersion',\n          {code: 'invalid @version value', context: ctx});\n      }\n      if(activeCtx.processingMode &&\n        activeCtx.processingMode === 'json-ld-1.0') {\n        throw new JsonLdError(\n          '@version: ' + ctx['@version'] + ' not compatible with ' +\n          activeCtx.processingMode,\n          'jsonld.ProcessingModeConflict',\n          {code: 'processing mode conflict', context: ctx});\n      }\n      rval.processingMode = 'json-ld-1.1';\n      rval['@version'] = ctx['@version'];\n      defined.set('@version', true);\n    }\n\n    // if not set explicitly, set processingMode to \"json-ld-1.0\"\n    rval.processingMode =\n      rval.processingMode || activeCtx.processingMode || 'json-ld-1.0';\n\n    // handle @base\n    if('@base' in ctx) {\n      let base = ctx['@base'];\n\n      if(base === null) {\n        // no action\n      } else if(_isAbsoluteIri(base)) {\n        base = parseUrl(base);\n      } else if(_isRelativeIri(base)) {\n        base = parseUrl(prependBase(activeCtx['@base'].href, base));\n      } else {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; the value of \"@base\" in a ' +\n          '@context must be an absolute IRI, a relative IRI, or null.',\n          'jsonld.SyntaxError', {code: 'invalid base IRI', context: ctx});\n      }\n\n      rval['@base'] = base;\n      defined.set('@base', true);\n    }\n\n    // handle @vocab\n    if('@vocab' in ctx) {\n      const value = ctx['@vocab'];\n      if(value === null) {\n        delete rval['@vocab'];\n      } else if(!_isString(value)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; the value of \"@vocab\" in a ' +\n          '@context must be a string or null.',\n          'jsonld.SyntaxError', {code: 'invalid vocab mapping', context: ctx});\n      } else if(!_isAbsoluteIri(value)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; the value of \"@vocab\" in a ' +\n          '@context must be an absolute IRI.',\n          'jsonld.SyntaxError', {code: 'invalid vocab mapping', context: ctx});\n      } else {\n        rval['@vocab'] = value;\n      }\n      defined.set('@vocab', true);\n    }\n\n    // handle @language\n    if('@language' in ctx) {\n      const value = ctx['@language'];\n      if(value === null) {\n        delete rval['@language'];\n      } else if(!_isString(value)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; the value of \"@language\" in a ' +\n          '@context must be a string or null.',\n          'jsonld.SyntaxError',\n          {code: 'invalid default language', context: ctx});\n      } else {\n        rval['@language'] = value.toLowerCase();\n      }\n      defined.set('@language', true);\n    }\n\n    // handle @protected; determine whether this sub-context is declaring\n    // all its terms to be \"protected\" (exceptions can be made on a\n    // per-definition basis)\n    defined.set('@protected', ctx['@protected'] || false);\n\n    // process all other keys\n    for(const key in ctx) {\n      api.createTermDefinition(\n        rval, ctx, key, defined, options,\n        isPropertyTermScopedContext);\n    }\n\n    // if context is type-scoped, ensure previous context has been set\n    if(isTypeScopedContext && !rval.previousContext) {\n      rval.previousContext = previousContext.clone();\n    }\n\n    // cache result\n    if(api.cache) {\n      api.cache.set(activeCtx, ctx, rval);\n    }\n  }\n\n  return rval;\n};\n\n/**\n * Creates a term definition during context processing.\n *\n * @param activeCtx the current active context.\n * @param localCtx the local context being processed.\n * @param term the term in the local context to define the mapping for.\n * @param defined a map of defining/defined keys to detect cycles and prevent\n *          double definitions.\n * @param {Object} [options] - creation options.\n * @param {string} [options.protectedMode=\"error\"] - \"error\" to throw error\n *   on `@protected` constraint violation, \"warn\" to allow violations and\n *   signal a warning.\n * @param isPropertyTermScopedContext `true` if `localCtx` is a scoped context\n *   from a property term.\n */\napi.createTermDefinition = (\n  activeCtx, localCtx, term, defined, options,\n  isPropertyTermScopedContext = false) => {\n  if(defined.has(term)) {\n    // term already defined\n    if(defined.get(term)) {\n      return;\n    }\n    // cycle detected\n    throw new JsonLdError(\n      'Cyclical context definition detected.',\n      'jsonld.CyclicalContext',\n      {code: 'cyclic IRI mapping', context: localCtx, term});\n  }\n\n  // now defining term\n  defined.set(term, false);\n\n  if(api.isKeyword(term)) {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; keywords cannot be overridden.',\n      'jsonld.SyntaxError',\n      {code: 'keyword redefinition', context: localCtx, term});\n  }\n\n  if(term === '') {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; a term cannot be an empty string.',\n      'jsonld.SyntaxError',\n      {code: 'invalid term definition', context: localCtx});\n  }\n\n  // keep reference to previous mapping for potential `@protected` check\n  const previousMapping = activeCtx.mappings.get(term);\n\n  // remove old mapping\n  if(activeCtx.mappings.has(term)) {\n    activeCtx.mappings.delete(term);\n  }\n\n  // get context term value\n  let value;\n  if(localCtx.hasOwnProperty(term)) {\n    value = localCtx[term];\n  }\n\n  // clear context entry\n  if(value === null || (_isObject(value) && value['@id'] === null)) {\n    activeCtx.mappings.set(term, null);\n    defined.set(term, true);\n    return;\n  }\n\n  // convert short-hand value to object w/@id\n  let simpleTerm = false;\n  if(_isString(value)) {\n    simpleTerm = true;\n    value = {'@id': value};\n  }\n\n  if(!_isObject(value)) {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; @context term values must be ' +\n      'strings or objects.',\n      'jsonld.SyntaxError',\n      {code: 'invalid term definition', context: localCtx});\n  }\n\n  // create new mapping\n  const mapping = {};\n  activeCtx.mappings.set(term, mapping);\n  mapping.reverse = false;\n\n  // make sure term definition only has expected keywords\n  const validKeys = ['@container', '@id', '@language', '@reverse', '@type'];\n\n  // JSON-LD 1.1 support\n  if(api.processingMode(activeCtx, 1.1)) {\n    validKeys.push('@context', '@nest', '@prefix', '@protected');\n  }\n\n  for(const kw in value) {\n    if(!validKeys.includes(kw)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a term definition must not contain ' + kw,\n        'jsonld.SyntaxError',\n        {code: 'invalid term definition', context: localCtx});\n    }\n  }\n\n  // always compute whether term has a colon as an optimization for\n  // _compactIri\n  const colon = term.indexOf(':');\n  mapping._termHasColon = (colon !== -1);\n\n  if('@reverse' in value) {\n    if('@id' in value) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a @reverse term definition must not ' +\n        'contain @id.', 'jsonld.SyntaxError',\n        {code: 'invalid reverse property', context: localCtx});\n    }\n    if('@nest' in value) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a @reverse term definition must not ' +\n        'contain @nest.', 'jsonld.SyntaxError',\n        {code: 'invalid reverse property', context: localCtx});\n    }\n    const reverse = value['@reverse'];\n    if(!_isString(reverse)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a @context @reverse value must be a string.',\n        'jsonld.SyntaxError', {code: 'invalid IRI mapping', context: localCtx});\n    }\n\n    // expand and add @id mapping\n    const id = _expandIri(\n      activeCtx, reverse, {vocab: true, base: false}, localCtx, defined,\n      options);\n    if(!_isAbsoluteIri(id)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a @context @reverse value must be an ' +\n        'absolute IRI or a blank node identifier.',\n        'jsonld.SyntaxError', {code: 'invalid IRI mapping', context: localCtx});\n    }\n    mapping['@id'] = id;\n    mapping.reverse = true;\n  } else if('@id' in value) {\n    let id = value['@id'];\n    if(!_isString(id)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; a @context @id value must be an array ' +\n        'of strings or a string.',\n        'jsonld.SyntaxError', {code: 'invalid IRI mapping', context: localCtx});\n    }\n    if(id !== term) {\n      // expand and add @id mapping\n      id = _expandIri(\n        activeCtx, id, {vocab: true, base: false}, localCtx, defined, options);\n      if(!_isAbsoluteIri(id) && !api.isKeyword(id)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; a @context @id value must be an ' +\n          'absolute IRI, a blank node identifier, or a keyword.',\n          'jsonld.SyntaxError',\n          {code: 'invalid IRI mapping', context: localCtx});\n      }\n      mapping['@id'] = id;\n      // indicate if this term may be used as a compact IRI prefix\n      mapping._prefix = (!mapping._termHasColon &&\n        id.match(/[:\\/\\?#\\[\\]@]$/) &&\n        (simpleTerm || api.processingMode(activeCtx, 1.0)));\n    }\n  }\n\n  if(!('@id' in mapping)) {\n    // see if the term has a prefix\n    if(mapping._termHasColon) {\n      const prefix = term.substr(0, colon);\n      if(localCtx.hasOwnProperty(prefix)) {\n        // define parent prefix\n        api.createTermDefinition(activeCtx, localCtx, prefix, defined, options);\n      }\n\n      if(activeCtx.mappings.has(prefix)) {\n        // set @id based on prefix parent\n        const suffix = term.substr(colon + 1);\n        mapping['@id'] = activeCtx.mappings.get(prefix)['@id'] + suffix;\n      } else {\n        // term is an absolute IRI\n        mapping['@id'] = term;\n      }\n    } else {\n      // non-IRIs *must* define @ids if @vocab is not available\n      if(!('@vocab' in activeCtx)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; @context terms must define an @id.',\n          'jsonld.SyntaxError',\n          {code: 'invalid IRI mapping', context: localCtx, term});\n      }\n      // prepend vocab to term\n      mapping['@id'] = activeCtx['@vocab'] + term;\n    }\n  }\n\n  // Handle term protection\n  if(value['@protected'] === true ||\n    (defined.get('@protected') === true && value['@protected'] !== false)) {\n    activeCtx.protected[term] = true;\n    mapping.protected = true;\n  }\n\n  // IRI mapping now defined\n  defined.set(term, true);\n\n  if('@type' in value) {\n    let type = value['@type'];\n    if(!_isString(type)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; an @context @type value must be a string.',\n        'jsonld.SyntaxError',\n        {code: 'invalid type mapping', context: localCtx});\n    }\n\n    if(type !== '@id' && type !== '@vocab') {\n      // expand @type to full IRI\n      type = _expandIri(\n        activeCtx, type, {vocab: true, base: false}, localCtx, defined,\n        options);\n      if(!_isAbsoluteIri(type)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; an @context @type value must be an ' +\n          'absolute IRI.',\n          'jsonld.SyntaxError',\n          {code: 'invalid type mapping', context: localCtx});\n      }\n      if(type.indexOf('_:') === 0) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; an @context @type value must be an IRI, ' +\n          'not a blank node identifier.',\n          'jsonld.SyntaxError',\n          {code: 'invalid type mapping', context: localCtx});\n      }\n    }\n\n    // add @type to mapping\n    mapping['@type'] = type;\n  }\n\n  if('@container' in value) {\n    // normalize container to an array form\n    const container = _isString(value['@container']) ?\n      [value['@container']] : (value['@container'] || []);\n    const validContainers = ['@list', '@set', '@index', '@language'];\n    let isValid = true;\n    const hasSet = container.includes('@set');\n\n    // JSON-LD 1.1 support\n    if(api.processingMode(activeCtx, 1.1)) {\n      validContainers.push('@graph', '@id', '@type');\n\n      // check container length\n      if(container.includes('@list')) {\n        if(container.length !== 1) {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; @context @container with @list must ' +\n            'have no other values',\n            'jsonld.SyntaxError',\n            {code: 'invalid container mapping', context: localCtx});\n        }\n      } else if(container.includes('@graph')) {\n        if(container.some(key =>\n          key !== '@graph' && key !== '@id' && key !== '@index' &&\n          key !== '@set')) {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; @context @container with @graph must ' +\n            'have no other values other than @id, @index, and @set',\n            'jsonld.SyntaxError',\n            {code: 'invalid container mapping', context: localCtx});\n        }\n      } else {\n        // otherwise, container may also include @set\n        isValid &= container.length <= (hasSet ? 2 : 1);\n      }\n    } else {\n      // in JSON-LD 1.0, container must not be an array (it must be a string,\n      // which is one of the validContainers)\n      isValid &= !_isArray(value['@container']);\n\n      // check container length\n      isValid &= container.length <= 1;\n    }\n\n    // check against valid containers\n    isValid &= container.every(c => validContainers.includes(c));\n\n    // @set not allowed with @list\n    isValid &= !(hasSet && container.includes('@list'));\n\n    if(!isValid) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context @container value must be ' +\n        'one of the following: ' + validContainers.join(', '),\n        'jsonld.SyntaxError',\n        {code: 'invalid container mapping', context: localCtx});\n    }\n\n    if(mapping.reverse &&\n      !container.every(c => ['@index', '@set'].includes(c))) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context @container value for a @reverse ' +\n        'type definition must be @index or @set.', 'jsonld.SyntaxError',\n        {code: 'invalid reverse property', context: localCtx});\n    }\n\n    // add @container to mapping\n    mapping['@container'] = container;\n  }\n\n  // scoped contexts\n  if('@context' in value) {\n    mapping['@context'] = value['@context'];\n  }\n\n  if('@language' in value && !('@type' in value)) {\n    let language = value['@language'];\n    if(language !== null && !_isString(language)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context @language value must be ' +\n        'a string or null.', 'jsonld.SyntaxError',\n        {code: 'invalid language mapping', context: localCtx});\n    }\n\n    // add @language to mapping\n    if(language !== null) {\n      language = language.toLowerCase();\n    }\n    mapping['@language'] = language;\n  }\n\n  // term may be used as a prefix\n  if('@prefix' in value) {\n    if(mapping._termHasColon) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context @prefix used on a compact IRI term',\n        'jsonld.SyntaxError',\n        {code: 'invalid term definition', context: localCtx});\n    }\n    if(typeof value['@prefix'] === 'boolean') {\n      mapping._prefix = value['@prefix'] === true;\n    } else {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context value for @prefix must be boolean',\n        'jsonld.SyntaxError',\n        {code: 'invalid @prefix value', context: localCtx});\n    }\n  }\n\n  if('@nest' in value) {\n    const nest = value['@nest'];\n    if(!_isString(nest) || (nest !== '@nest' && nest.indexOf('@') === 0)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; @context @nest value must be ' +\n        'a string which is not a keyword other than @nest.',\n        'jsonld.SyntaxError',\n        {code: 'invalid @nest value', context: localCtx});\n    }\n    mapping['@nest'] = nest;\n  }\n\n  // disallow aliasing @context and @preserve\n  const id = mapping['@id'];\n  if(id === '@context' || id === '@preserve') {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; @context and @preserve cannot be aliased.',\n      'jsonld.SyntaxError', {code: 'invalid keyword alias', context: localCtx});\n  }\n\n  // FIXME if(1.1) ... ?\n  if(previousMapping && previousMapping.protected &&\n    !isPropertyTermScopedContext) {\n    // force new term to continue to be protected and see if the mappings would\n    // be equal\n    activeCtx.protected[term] = true;\n    mapping.protected = true;\n    if(!_deepCompare(previousMapping, mapping)) {\n      const protectedMode = (options && options.protectedMode) || 'error';\n      if(protectedMode === 'error') {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; tried to redefine a protected term.',\n          'jsonld.SyntaxError',\n          {code: 'protected term redefinition', context: localCtx, term});\n      } else if(protectedMode === 'warn') {\n        // FIXME: remove logging and use a handler\n        console.warn('WARNING: protected term redefinition', {term});\n        return;\n      }\n      throw new JsonLdError(\n        'Invalid protectedMode.',\n        'jsonld.SyntaxError',\n        {code: 'invalid protected mode', context: localCtx, term,\n          protectedMode});\n    }\n  }\n};\n\n/**\n * Expands a string to a full IRI. The string may be a term, a prefix, a\n * relative IRI, or an absolute IRI. The associated absolute IRI will be\n * returned.\n *\n * @param activeCtx the current active context.\n * @param value the string to expand.\n * @param relativeTo options for how to resolve relative IRIs:\n *          base: true to resolve against the base IRI, false not to.\n *          vocab: true to concatenate after @vocab, false not to.\n * @param {Object} [options] - processing options.\n *\n * @return the expanded value.\n */\napi.expandIri = (activeCtx, value, relativeTo, options) => {\n  return _expandIri(activeCtx, value, relativeTo, undefined, undefined,\n    options);\n};\n\n/**\n * Expands a string to a full IRI. The string may be a term, a prefix, a\n * relative IRI, or an absolute IRI. The associated absolute IRI will be\n * returned.\n *\n * @param activeCtx the current active context.\n * @param value the string to expand.\n * @param relativeTo options for how to resolve relative IRIs:\n *          base: true to resolve against the base IRI, false not to.\n *          vocab: true to concatenate after @vocab, false not to.\n * @param localCtx the local context being processed (only given if called\n *          during context processing).\n * @param defined a map for tracking cycles in context definitions (only given\n *          if called during context processing).\n * @param {Object} [options] - processing options.\n *\n * @return the expanded value.\n */\nfunction _expandIri(activeCtx, value, relativeTo, localCtx, defined, options) {\n  // already expanded\n  if(value === null || !_isString(value) || api.isKeyword(value)) {\n    return value;\n  }\n\n  // define term dependency if not defined\n  if(localCtx && localCtx.hasOwnProperty(value) &&\n    defined.get(value) !== true) {\n    api.createTermDefinition(activeCtx, localCtx, value, defined, options);\n  }\n\n  // if context is from a property term scoped context composed with a\n  // type-scoped context, then use previous context instead\n  if(activeCtx.isPropertyTermScoped && activeCtx.previousContext) {\n    activeCtx = activeCtx.previousContext;\n  }\n\n  relativeTo = relativeTo || {};\n  if(relativeTo.vocab) {\n    const mapping = activeCtx.mappings.get(value);\n\n    // value is explicitly ignored with a null mapping\n    if(mapping === null) {\n      return null;\n    }\n\n    if(mapping) {\n      // value is a term\n      return mapping['@id'];\n    }\n  }\n\n  // split value into prefix:suffix\n  const colon = value.indexOf(':');\n  if(colon !== -1) {\n    const prefix = value.substr(0, colon);\n    const suffix = value.substr(colon + 1);\n\n    // do not expand blank nodes (prefix of '_') or already-absolute\n    // IRIs (suffix of '//')\n    if(prefix === '_' || suffix.indexOf('//') === 0) {\n      return value;\n    }\n\n    // prefix dependency not defined, define it\n    if(localCtx && localCtx.hasOwnProperty(prefix)) {\n      api.createTermDefinition(activeCtx, localCtx, prefix, defined, options);\n    }\n\n    // use mapping if prefix is defined\n    if(activeCtx.mappings.has(prefix)) {\n      const mapping = activeCtx.mappings.get(prefix);\n      return mapping['@id'] + suffix;\n    }\n\n    // already absolute IRI\n    return value;\n  }\n\n  // prepend vocab\n  if(relativeTo.vocab && '@vocab' in activeCtx) {\n    return activeCtx['@vocab'] + value;\n  }\n\n  // prepend base\n  if(relativeTo.base) {\n    return prependBase(activeCtx['@base'], value);\n  }\n\n  return value;\n}\n\n/**\n * Gets the initial context.\n *\n * @param options the options to use:\n *          [base] the document base IRI.\n *\n * @return the initial context.\n */\napi.getInitialContext = options => {\n  const base = parseUrl(options.base || '');\n  const key = JSON.stringify({base, processingMode: options.processingMode});\n  const cached = INITIAL_CONTEXT_CACHE.get(key);\n  if(cached) {\n    return cached;\n  }\n\n  const initialContext = {\n    '@base': base,\n    processingMode: options.processingMode,\n    mappings: new Map(),\n    inverse: null,\n    getInverse: _createInverseContext,\n    clone: _cloneActiveContext,\n    revertTypeScopedContext: _revertTypeScopedContext,\n    protected: {}\n  };\n  // TODO: consider using LRU cache instead\n  if(INITIAL_CONTEXT_CACHE.size === INITIAL_CONTEXT_CACHE_MAX_SIZE) {\n    // clear whole cache -- assumes scenario where the cache fills means\n    // the cache isn't being used very efficiently anyway\n    INITIAL_CONTEXT_CACHE.clear();\n  }\n  INITIAL_CONTEXT_CACHE.set(key, initialContext);\n  return initialContext;\n\n  /**\n   * Generates an inverse context for use in the compaction algorithm, if\n   * not already generated for the given active context.\n   *\n   * @return the inverse context.\n   */\n  function _createInverseContext() {\n    const activeCtx = this;\n\n    // lazily create inverse\n    if(activeCtx.inverse) {\n      return activeCtx.inverse;\n    }\n    const inverse = activeCtx.inverse = {};\n\n    // variables for building fast CURIE map\n    const fastCurieMap = activeCtx.fastCurieMap = {};\n    const irisToTerms = {};\n\n    // handle default language\n    const defaultLanguage = activeCtx['@language'] || '@none';\n\n    // create term selections for each mapping in the context, ordered by\n    // shortest and then lexicographically least\n    const mappings = activeCtx.mappings;\n    const terms = [...mappings.keys()].sort(_compareShortestLeast);\n    for(const term of terms) {\n      const mapping = mappings.get(term);\n      if(mapping === null) {\n        continue;\n      }\n\n      let container = mapping['@container'] || '@none';\n      container = [].concat(container).sort().join('');\n\n      // iterate over every IRI in the mapping\n      const ids = _asArray(mapping['@id']);\n      for(const iri of ids) {\n        let entry = inverse[iri];\n        const isKeyword = api.isKeyword(iri);\n\n        if(!entry) {\n          // initialize entry\n          inverse[iri] = entry = {};\n\n          if(!isKeyword && !mapping._termHasColon) {\n            // init IRI to term map and fast CURIE prefixes\n            irisToTerms[iri] = [term];\n            const fastCurieEntry = {iri, terms: irisToTerms[iri]};\n            if(iri[0] in fastCurieMap) {\n              fastCurieMap[iri[0]].push(fastCurieEntry);\n            } else {\n              fastCurieMap[iri[0]] = [fastCurieEntry];\n            }\n          }\n        } else if(!isKeyword && !mapping._termHasColon) {\n          // add IRI to term match\n          irisToTerms[iri].push(term);\n        }\n\n        // add new entry\n        if(!entry[container]) {\n          entry[container] = {\n            '@language': {},\n            '@type': {},\n            '@any': {}\n          };\n        }\n        entry = entry[container];\n        _addPreferredTerm(term, entry['@any'], '@none');\n\n        if(mapping.reverse) {\n          // term is preferred for values using @reverse\n          _addPreferredTerm(term, entry['@type'], '@reverse');\n        } else if('@type' in mapping) {\n          // term is preferred for values using specific type\n          _addPreferredTerm(term, entry['@type'], mapping['@type']);\n        } else if('@language' in mapping) {\n          // term is preferred for values using specific language\n          const language = mapping['@language'] || '@null';\n          _addPreferredTerm(term, entry['@language'], language);\n        } else {\n          // term is preferred for values w/default language or no type and\n          // no language\n          // add an entry for the default language\n          _addPreferredTerm(term, entry['@language'], defaultLanguage);\n\n          // add entries for no type and no language\n          _addPreferredTerm(term, entry['@type'], '@none');\n          _addPreferredTerm(term, entry['@language'], '@none');\n        }\n      }\n    }\n\n    // build fast CURIE map\n    for(const key in fastCurieMap) {\n      _buildIriMap(fastCurieMap, key, 1);\n    }\n\n    return inverse;\n  }\n\n  /**\n   * Runs a recursive algorithm to build a lookup map for quickly finding\n   * potential CURIEs.\n   *\n   * @param iriMap the map to build.\n   * @param key the current key in the map to work on.\n   * @param idx the index into the IRI to compare.\n   */\n  function _buildIriMap(iriMap, key, idx) {\n    const entries = iriMap[key];\n    const next = iriMap[key] = {};\n\n    let iri;\n    let letter;\n    for(const entry of entries) {\n      iri = entry.iri;\n      if(idx >= iri.length) {\n        letter = '';\n      } else {\n        letter = iri[idx];\n      }\n      if(letter in next) {\n        next[letter].push(entry);\n      } else {\n        next[letter] = [entry];\n      }\n    }\n\n    for(const key in next) {\n      if(key === '') {\n        continue;\n      }\n      _buildIriMap(next, key, idx + 1);\n    }\n  }\n\n  /**\n   * Adds the term for the given entry if not already added.\n   *\n   * @param term the term to add.\n   * @param entry the inverse context typeOrLanguage entry to add to.\n   * @param typeOrLanguageValue the key in the entry to add to.\n   */\n  function _addPreferredTerm(term, entry, typeOrLanguageValue) {\n    if(!entry.hasOwnProperty(typeOrLanguageValue)) {\n      entry[typeOrLanguageValue] = term;\n    }\n  }\n\n  /**\n   * Clones an active context, creating a child active context.\n   *\n   * @return a clone (child) of the active context.\n   */\n  function _cloneActiveContext() {\n    const child = {};\n    child['@base'] = this['@base'];\n    child.mappings = util.clone(this.mappings);\n    child.clone = this.clone;\n    child.inverse = null;\n    child.getInverse = this.getInverse;\n    child.protected = util.clone(this.protected);\n    if(this.previousContext) {\n      child.isPropertyTermScoped = this.previousContext.isPropertyTermScoped;\n      child.previousContext = this.previousContext.clone();\n    }\n    child.revertTypeScopedContext = this.revertTypeScopedContext;\n    if('@language' in this) {\n      child['@language'] = this['@language'];\n    }\n    if('@vocab' in this) {\n      child['@vocab'] = this['@vocab'];\n    }\n    return child;\n  }\n\n  /**\n   * Reverts any type-scoped context in this active context to the previous\n   * context.\n   */\n  function _revertTypeScopedContext() {\n    if(!this.previousContext) {\n      return this;\n    }\n    return this.previousContext.clone();\n  }\n};\n\n/**\n * Gets the value for the given active context key and type, null if none is\n * set or undefined if none is set and type is '@context'.\n *\n * @param ctx the active context.\n * @param key the context key.\n * @param [type] the type of value to get (eg: '@id', '@type'), if not\n *          specified gets the entire entry for a key, null if not found.\n *\n * @return the value, null, or undefined.\n */\napi.getContextValue = (ctx, key, type) => {\n  // invalid key\n  if(key === null) {\n    if(type === '@context') {\n      return undefined;\n    }\n    return null;\n  }\n\n  // get specific entry information\n  if(ctx.mappings.has(key)) {\n    const entry = ctx.mappings.get(key);\n\n    if(_isUndefined(type)) {\n      // return whole entry\n      return entry;\n    }\n    if(entry.hasOwnProperty(type)) {\n      // return entry value for type\n      return entry[type];\n    }\n  }\n\n  // get default language\n  if(type === '@language' && ctx.hasOwnProperty(type)) {\n    return ctx[type];\n  }\n\n  if(type === '@context') {\n    return undefined;\n  }\n  return null;\n};\n\n/**\n * Retrieves external @context URLs using the given document loader. Every\n * instance of @context in the input that refers to a URL will be replaced\n * with the JSON @context found at that URL.\n *\n * @param input the JSON-LD input with possible contexts.\n * @param options the options to use:\n *          documentLoader(url, [callback(err, remoteDoc)]) the document loader.\n * @param callback(err, input) called once the operation completes.\n */\napi.getAllContexts = async (input, options) => {\n  return _retrieveContextUrls(input, options);\n};\n\n/**\n * Processing Mode check.\n *\n * @param activeCtx the current active context.\n * @param version the string or numeric version to check.\n *\n * @return boolean.\n */\napi.processingMode = (activeCtx, version) => {\n  if(version.toString() >= '1.1') {\n    return activeCtx.processingMode &&\n      activeCtx.processingMode >= 'json-ld-' + version.toString();\n  } else {\n    return !activeCtx.processingMode ||\n      activeCtx.processingMode === 'json-ld-1.0';\n  }\n};\n\n/**\n * Returns whether or not the given value is a keyword.\n *\n * @param v the value to check.\n *\n * @return true if the value is a keyword, false if not.\n */\napi.isKeyword = v => {\n  if(!_isString(v)) {\n    return false;\n  }\n  switch(v) {\n    case '@base':\n    case '@container':\n    case '@context':\n    case '@default':\n    case '@embed':\n    case '@explicit':\n    case '@graph':\n    case '@id':\n    case '@index':\n    case '@language':\n    case '@list':\n    case '@nest':\n    case '@none':\n    case '@omitDefault':\n    case '@prefix':\n    case '@preserve':\n    case '@protected':\n    case '@requireAll':\n    case '@reverse':\n    case '@set':\n    case '@type':\n    case '@value':\n    case '@version':\n    case '@vocab':\n      return true;\n  }\n  return false;\n};\n\nasync function _retrieveContextUrls(input, options) {\n  const documentLoader = util.normalizeDocumentLoader(options.documentLoader);\n\n  // retrieve all @context URLs in input\n  await retrieve(input, new Set(), documentLoader);\n\n  return input;\n\n  // recursive function that will retrieve all @context URLs in documents\n  async function retrieve(doc, cycles, documentLoader) {\n    if(cycles.size > MAX_CONTEXT_URLS) {\n      throw new JsonLdError(\n        'Maximum number of @context URLs exceeded.',\n        'jsonld.ContextUrlError',\n        {code: 'loading remote context failed', max: MAX_CONTEXT_URLS});\n    }\n\n    // find all URLs in the given document\n    const urls = new Map();\n    _findContextUrls(doc, urls, false, options.base);\n    if(urls.size === 0) {\n      return;\n    }\n\n    // queue all unretrieved URLs\n    const queue = [...urls.keys()].filter(u => urls.get(u) === false);\n\n    // retrieve URLs in queue\n    return Promise.all(queue.map(async url => {\n      // check for context URL cycle\n      if(cycles.has(url)) {\n        throw new JsonLdError(\n          'Cyclical @context URLs detected.',\n          'jsonld.ContextUrlError',\n          {code: 'recursive context inclusion', url});\n      }\n\n      const _cycles = new Set(cycles);\n      _cycles.add(url);\n      let remoteDoc;\n      let ctx;\n\n      try {\n        remoteDoc = await documentLoader(url);\n        ctx = remoteDoc.document || null;\n        // parse string context as JSON\n        if(_isString(ctx)) {\n          ctx = JSON.parse(ctx);\n        }\n      } catch(e) {\n        throw new JsonLdError(\n          'Dereferencing a URL did not result in a valid JSON-LD object. ' +\n          'Possible causes are an inaccessible URL perhaps due to ' +\n          'a same-origin policy (ensure the server uses CORS if you are ' +\n          'using client-side JavaScript), too many redirects, a ' +\n          'non-JSON response, or more than one HTTP Link Header was ' +\n          'provided for a remote context.',\n          'jsonld.InvalidUrl',\n          {code: 'loading remote context failed', url, cause: e});\n      }\n\n      // ensure ctx is an object\n      if(!_isObject(ctx)) {\n        throw new JsonLdError(\n          'Dereferencing a URL did not result in a JSON object. The ' +\n          'response was valid JSON, but it was not a JSON object.',\n          'jsonld.InvalidUrl',\n          {code: 'invalid remote context', url});\n      }\n\n      // use empty context if no @context key is present\n      if(!('@context' in ctx)) {\n        ctx = {'@context': {}};\n      } else {\n        ctx = {'@context': ctx['@context']};\n      }\n\n      // append @context URL to context if given\n      if(remoteDoc.contextUrl) {\n        if(!_isArray(ctx['@context'])) {\n          ctx['@context'] = [ctx['@context']];\n        }\n        ctx['@context'].push(remoteDoc.contextUrl);\n      }\n\n      // recurse\n      await retrieve(ctx, _cycles, documentLoader);\n\n      // store retrieved context w/replaced @context URLs\n      urls.set(url, ctx['@context']);\n\n      // replace all @context URLs in the document\n      _findContextUrls(doc, urls, true, options.base);\n    }));\n  }\n}\n\n/**\n * Finds all @context URLs in the given JSON-LD input.\n *\n * @param input the JSON-LD input.\n * @param urls a map of URLs (url => false/@contexts).\n * @param replace true to replace the URLs in the given input with the\n *           @contexts from the urls map, false not to.\n * @param base the base IRI to use to resolve relative IRIs.\n *\n * @return true if new URLs to retrieve were found, false if not.\n */\nfunction _findContextUrls(input, urls, replace, base) {\n  if(_isArray(input)) {\n    for(const element of input) {\n      _findContextUrls(element, urls, replace, base);\n    }\n    return;\n  }\n\n  if(!_isObject(input)) {\n    // no @context URLs can be found in non-object input\n    return;\n  }\n\n  // input is an object\n  for(const key in input) {\n    if(key !== '@context') {\n      _findContextUrls(input[key], urls, replace, base);\n      continue;\n    }\n\n    // get @context\n    const ctx = input[key];\n\n    if(_isArray(ctx)) {\n      // array @context\n      let length = ctx.length;\n      for(let i = 0; i < length; ++i) {\n        const _ctx = ctx[i];\n        if(_isString(_ctx)) {\n          const prepended = prependBase(base, _ctx);\n          const resolved = urls.get(prepended);\n          // replace w/@context if requested\n          if(replace) {\n            if(_isArray(resolved)) {\n              // add flattened context\n              Array.prototype.splice.apply(ctx, [i, 1].concat(resolved));\n              i += resolved.length - 1;\n              length = ctx.length;\n            } else if(resolved !== false) {\n              ctx[i] = resolved;\n            }\n          } else if(resolved === undefined) {\n            // @context URL found\n            urls.set(prepended, false);\n          }\n        } else {\n          // look for scoped context\n          for(const key in _ctx) {\n            if(_isObject(_ctx[key])) {\n              _findContextUrls(_ctx[key], urls, replace, base);\n            }\n          }\n        }\n      }\n    } else if(_isString(ctx)) {\n      // string @context\n      const prepended = prependBase(base, ctx);\n      const resolved = urls.get(prepended);\n      // replace w/@context if requested\n      if(replace) {\n        if(resolved !== false) {\n          input[key] = resolved;\n        }\n      } else if(resolved === undefined) {\n        // @context URL found\n        urls.set(prepended, false);\n      }\n    } else {\n      // look for scoped context\n      for(const key in ctx) {\n        if(_isObject(ctx[key])) {\n          _findContextUrls(ctx[key], urls, replace, base);\n        }\n      }\n    }\n  }\n}\n\nfunction _deepCompare(x1, x2) {\n  // compare `null` or primitive types directly\n  if((!(x1 && typeof x1 === 'object')) ||\n     (!(x2 && typeof x2 === 'object'))) {\n    return x1 === x2;\n  }\n  // x1 and x2 are objects (also potentially arrays)\n  const x1Array = Array.isArray(x1);\n  if(x1Array !== Array.isArray(x2)) {\n    return false;\n  }\n  if(x1Array) {\n    if(x1.length !== x2.length) {\n      return false;\n    }\n    for(let i = 0; i < x1.length; ++i) {\n      if(!_deepCompare(x1[i], x2[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  // x1 and x2 are non-array objects\n  const k1s = Object.keys(x1);\n  const k2s = Object.keys(x2);\n  if(k1s.length !== k2s.length) {\n    return false;\n  }\n  for(const k1 in x1) {\n    let v1 = x1[k1];\n    let v2 = x2[k1];\n    // special case: `@container` can be in any order\n    if(k1 === '@container') {\n      if(Array.isArray(v1) && Array.isArray(v2)) {\n        v1 = v1.slice().sort();\n        v2 = v2.slice().sort();\n      }\n    }\n    if(!_deepCompare(v1, v2)) {\n      return false;\n    }\n  }\n  return true;\n}\n","import { injectable } from \"inversify\";\nimport { Triple } from \"rdf-js\";\nimport { XMLS } from \"../uri/constants\";\nimport URI from \"../uri/uri\";\nimport { IEntity, IEntityMap } from \"./common\";\nimport { ThingView } from \"./views/single\";\n\n@injectable()\nexport class LDLoader {\n\n    private collectionFields: Set<string> = new Set();\n\n    public defineCollection(field: string) {\n        this.collectionFields.add(field);\n    }\n\n    public process(triples: Triple[], views: Array<ThingView<any>>) {\n        const entities = this._extractEntities(triples);\n\n        for (const entity of Object.values(entities)) {\n            for (const view of views) {\n                const mapped = view.process(entity);\n                if (mapped) {\n                    view.addEntity(mapped);\n                }\n            }\n        }\n\n        return views.map((view) => view.getContents());\n    }\n\n    public disambiguateBlankNodes(triples, scope: string) {\n        for (const triple of triples) {\n            if (triple.subject.termType === \"BlankNode\") {\n                triple.subject.value = `${scope}#${triple.subject.value}`;\n            }\n            if (triple.object.termType === \"BlankNode\") {\n                triple.object.value = `${scope}#${triple.object.value}`;\n            }\n        }\n    }\n\n    private _parseValue(entities, triple) {\n        const tripleObject = triple.object;\n        const rawValue = tripleObject.value;\n        if (tripleObject.termType === \"BlankNode\") {\n            if (!entities[rawValue]) {\n                entities[rawValue] = { id: rawValue };\n            }\n\n            return entities[rawValue];\n        }\n        if (tripleObject.termType === \"Literal\") {\n            const valueType = tripleObject.datatype.value;\n            if (valueType === URI.inNS(XMLS, \"string\")) {\n                return rawValue;\n            }\n            if (valueType === URI.inNS(XMLS, \"boolean\")) {\n                return rawValue === \"true\";\n            }\n            if (valueType === URI.inNS(XMLS, \"double\")) {\n                return parseFloat(rawValue);\n            }\n            if (valueType === URI.inNS(XMLS, \"integer\")) {\n                return parseInt(rawValue, 10);\n            }\n        }\n\n        return rawValue;\n    }\n\n    private _extractEntities(triples): IEntityMap<IEntity> {\n        const entities = {};\n        for (const triple of triples) {\n            const { subject: { value: subject }, predicate: { value: predicate } } = triple;\n\n            if (!(subject in entities)) {\n                entities[subject] = { id: subject };\n            }\n\n            const entity = entities[subject];\n            const parsedValue = this._parseValue(entities, triple);\n\n            if (!this.collectionFields.has(predicate)) {\n                entity[predicate] = parsedValue;\n            } else {\n                const fieldData = entity[predicate] || [];\n                fieldData.push(parsedValue);\n                entity[predicate] = fieldData;\n            }\n\n        }\n        return entities;\n    }\n}\n","import haversine from \"haversine\";\nimport IStop from \"../fetcher/stops/IStop\";\nimport ILocation from \"../interfaces/ILocation\";\nimport { DistanceM } from \"../interfaces/units\";\n\n/**\n * Utility class with geographic functions\n */\nexport default class Geo {\n\n  /**\n   * Calculate the distance between two [[ILocation]] instances using the haversine formula\n   * @returns distance is meters ([[DistanceM]])\n   */\n  public static getDistanceBetweenLocations(start: ILocation, stop: ILocation): DistanceM {\n    const { longitude: depLongitude, latitude: depLatitude } = start;\n    const { longitude: arrLongitude, latitude: arrLatitude } = stop;\n\n    if (depLongitude === undefined || depLatitude === undefined ||\n      arrLongitude === undefined || arrLatitude === undefined) {\n      return Number.POSITIVE_INFINITY;\n    }\n\n    return haversine({\n      latitude: depLatitude,\n      longitude: depLongitude,\n    }, {\n      latitude: arrLatitude,\n      longitude: arrLongitude,\n    }, {\n      unit: \"meter\",\n    });\n  }\n\n  /**\n   * Calculate tge distance between two [[IStop]] instances using the haversine formula\n   * @returns distance is meters ([[DistanceM]])\n   */\n  public static getDistanceBetweenStops(start: IStop, stop: IStop) {\n    return this.getDistanceBetweenLocations(start as ILocation, stop as ILocation);\n  }\n\n  /**\n   * Get the geo id of an [[ILocation]]\n   * @param location\n   * @returns geo id string\n   */\n  public static getId(location: ILocation): string {\n    if (\"id\" in location) {\n      return location.id;\n    }\n\n    return `geo:${location.latitude},${location.longitude}`;\n  }\n}\n","import { DistanceM, DurationMs, SpeedKmH } from \"../interfaces/units\";\n\n/**\n * Utility class with calculation functions dealing with [[DistanceM]], [[DurationMs]] and [[SpeedKmH]]\n */\nexport default class Units {\n\n  public static toSpeed(distance: DistanceM, duration: DurationMs): SpeedKmH {\n    return (distance / duration) * 3600;\n  }\n\n  public static toDistance(duration: DurationMs, speed: SpeedKmH): DistanceM {\n    return (speed * duration) / 3600;\n  }\n\n  public static toDuration(distance: DistanceM, speed: SpeedKmH): DurationMs {\n    // tslint:disable-next-line:no-bitwise\n    return ((distance / speed) * 3600 | 0);\n  }\n\n  public static fromHours(hours: number): DurationMs {\n    return hours * 3600000;\n  }\n\n  public static fromMinutes(minutes: number): DurationMs {\n    return minutes * 60000;\n  }\n\n  public static fromSeconds(seconds: number): DurationMs {\n    return seconds * 1000;\n  }\n\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    keys.push(key);\n  }return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\n\nutil.inherits(Duplex, Readable);\n\n{\n  // avoid scope creep, the keys array can then be collected\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\n\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n\n  Readable.call(this, options);\n  Writable.call(this, options);\n\n  if (options && options.readable === false) this.readable = false;\n\n  if (options && options.writable === false) this.writable = false;\n\n  this.allowHalfOpen = true;\n  if (options && options.allowHalfOpen === false) this.allowHalfOpen = false;\n\n  this.once('end', onend);\n}\n\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // if we allow half-open state, or if the writable side ended,\n  // then we're ok.\n  if (this.allowHalfOpen || this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  pna.nextTick(onEndNT, this);\n}\n\nfunction onEndNT(self) {\n  self.end();\n}\n\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  get: function () {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});\n\nDuplex.prototype._destroy = function (err, cb) {\n  this.push(null);\n  this.end();\n\n  pna.nextTick(cb, err);\n};","export const XMLS = \"http://www.w3.org/2001/XMLSchema\";\nexport const HYDRA = \"http://www.w3.org/ns/hydra/core\";\nexport const OSM = \"https://w3id.org/openstreetmap/terms\";\nexport const GEO = \"http://www.w3.org/2003/01/geo/wgs84_pos\";\nexport const RDF = \"http://www.w3.org/1999/02/22-rdf-syntax-ns\";\nexport const RDFS = \"http://www.w3.org/2000/01/rdf-schema\";\nexport const ROUTE = \"https://w3id.org/routabletiles/terms#\";\nexport const PLANNER = \"https://planner.js.org/terms#\";\nexport const PROFILE = \"https://w3id.org/openplannerteam/profile#\";\n","export default class URI {\n    public static inNS(ns: string, id: string): string {\n        // this probably misses a lot of special cases\n        // but it'll do for now\n        const lastChar = ns[ns.length - 1];\n        if (lastChar === \"/\") {\n            return `${ns}${id}`;\n        } else if (lastChar === \"#\") {\n            return `${ns}${id}`;\n        } else {\n            return `${ns}#${id}`;\n        }\n    }\n\n    public static fakeExpand(ns: string, id: string): string {\n        // discards the prefix and places it the specified NS\n        return this.inNS(ns, id.substring(4));\n    }\n}\n","import { RoutableTileCoordinate } from \"../entities/tiles/coordinate\";\n\nexport function lat_to_tile(lat: number, zoom: number) {\n    // from https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames\n    return Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180)) / Math.PI)\n        / 2 * Math.pow(2, zoom));\n}\n\nexport function long_to_tile(lon: number, zoom: number) {\n    // from https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames\n    return Math.floor((lon + 180) / 360 * Math.pow(2, zoom));\n}\nexport function toTileCoordinate(lat: number, long: number, zoom = 14): RoutableTileCoordinate {\n    return new RoutableTileCoordinate(zoom, long_to_tile(long, zoom), lat_to_tile(lat, zoom));\n}\n","import { inject, injectable } from \"inversify\";\nimport PedestrianProfile from \"../../entities/profile/PedestrianProfile\";\nimport Profile from \"../../entities/profile/Profile\";\nimport TYPES from \"../../types\";\nimport IProfileFetcher from \"./IProfileFetcher\";\nimport IProfileProvider from \"./IProfileProvider\";\n\ninterface IProfileMap {\n  [label: string]: Promise<Profile>;\n}\n\n@injectable()\nexport default class ProfileProviderDefault implements IProfileProvider {\n  // todo, fetcher that loads a profile from a URI\n  // todo, profiles per location\n  //       e.g. bicycle near a specific station\n\n  private profiles: IProfileMap;\n  private fetcher: IProfileFetcher;\n\n  private developmentProfile: Profile; // does not have a persistent id, will change often\n  private developmentProfileCounter: number;\n\n  constructor(\n    @inject(TYPES.ProfileFetcher) fetcher: IProfileFetcher,\n  ) {\n    this.profiles = {};\n    this.fetcher = fetcher;\n    this.developmentProfile = undefined;\n    this.developmentProfileCounter = 0;\n  }\n\n  public async parseDevelopmentProfile(blob: object): Promise<string> {\n    this.developmentProfileCounter += 1;\n    const newProfile = await this.fetcher.parseProfileBlob(blob, \"\" + this.developmentProfileCounter);\n    if (this.developmentProfile) {\n      delete this.profiles[this.developmentProfile.getID()];\n    }\n    this.developmentProfile = newProfile;\n    this.profiles[this.developmentProfile.getID()] = Promise.resolve(newProfile);\n    return newProfile.getID();\n  }\n\n  public addProfile(profile: Profile) {\n    this.profiles[profile.getID()] = Promise.resolve(profile);\n  }\n\n  public getProfile(profileId: string): Promise<Profile> {\n    if (this.profiles[profileId] === undefined) {\n      this.profiles[profileId] = this.fetcher.get(profileId);\n    }\n    return this.profiles[profileId];\n  }\n\n  public getProfiles(): Promise<Profile[]> {\n    return Promise.all(Object.values(this.profiles));\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport { RoutableTileSet } from \"../../entities/tiles/set\";\nimport { IRoutableTileIndex, RoutableTile } from \"../../entities/tiles/tile\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport TYPES from \"../../types\";\nimport { lat_to_tile, long_to_tile } from \"../../util/Tiles\";\nimport IRoutableTileFetcher from \"./IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"./IRoutableTileProvider\";\n\n@injectable()\nexport default class RoutableTileProviderDefault implements IRoutableTileProvider {\n\n  protected fetcher: IRoutableTileFetcher;\n  protected registry: RoutableTileRegistry;\n  protected tiles: IRoutableTileIndex = {};\n\n  constructor(\n    @inject(TYPES.RoutableTileFetcher) fetcher: IRoutableTileFetcher,\n    @inject(TYPES.RoutableTileRegistry) registry: RoutableTileRegistry,\n  ) {\n    this.fetcher = fetcher;\n    this.registry = registry;\n  }\n\n  public async wait() {\n    await Promise.all(Object.values(this.tiles));\n  }\n\n  public getIdForLocation(zoom: number, location: ILocation): string {\n    const y = lat_to_tile(location.latitude, zoom);\n    const x = long_to_tile(location.longitude, zoom);\n    const coordinate = new RoutableTileCoordinate(zoom, x, y);\n    return this.getIdForTileCoords(coordinate);\n  }\n\n  public getIdForTileCoords(coordinate: RoutableTileCoordinate): string {\n    return `https://tiles.openplanner.team/planet/${coordinate.zoom}/${coordinate.x}/${coordinate.y}`;\n  }\n\n  public getByLocation(zoom: number, location: ILocation): Promise<RoutableTile> {\n    const y = this.lat2tile(location.latitude, zoom);\n    const x = this.long2tile(location.longitude, zoom);\n    const coordinate = new RoutableTileCoordinate(zoom, x, y);\n    return this.getByTileCoords(coordinate);\n  }\n\n  public async getByTileCoords(coordinate: RoutableTileCoordinate): Promise<RoutableTile> {\n    const url = this.getIdForTileCoords(coordinate);\n    const tile = await this.getByUrl(url);\n    tile.coordinate = coordinate;  // todo, get these from server response\n    return tile;\n  }\n\n  public async getByUrl(url: string): Promise<RoutableTile> {\n    if (!this.tiles[url]) {\n      this.tiles[url] = this.fetcher.get(url);\n    }\n\n    return await this.tiles[url];\n  }\n\n  public async getMultipleByUrl(urls: string[]): Promise<RoutableTileSet> {\n    const tiles = await Promise.all(urls.map((url) => {\n      return this.getByUrl(url);\n    }));\n\n    return new RoutableTileSet(tiles);\n  }\n\n  public async getmultipleByLocation(zoom: number, locations: ILocation[]): Promise<RoutableTileSet> {\n    const tiles = await Promise.all(locations.map((location) => {\n      return this.getByLocation(zoom, location);\n    }));\n\n    return new RoutableTileSet(tiles);\n  }\n\n  public async getMultipleByTileCoords(coordinates: RoutableTileCoordinate[]): Promise<RoutableTileSet> {\n    const tiles = await Promise.all(coordinates.map((coordinate) => {\n      return this.getByTileCoords(coordinate);\n    }));\n\n    return new RoutableTileSet(tiles);\n  }\n\n  private long2tile(lon: number, zoom: number) {\n    return (Math.floor((lon + 180) / 360 * Math.pow(2, zoom)));\n  }\n\n  private lat2tile(lat: number, zoom: number) {\n    return (Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1\n      / Math.cos(lat * Math.PI / 180)) / Math.PI) / 2 * Math.pow(2, zoom)));\n  }\n}\n","import TravelMode from \"../enums/TravelMode\";\nimport ILeg from \"../interfaces/ILeg\";\nimport IPath from \"../interfaces/IPath\";\nimport IQuery from \"../interfaces/IQuery\";\nimport { DurationMs } from \"../interfaces/units\";\nimport Leg from \"./Leg\";\n\n/**\n * This Path class serves as an implementation of the [[IPath]] interface and as a home for some helper functions\n * related to [[IPath]] instances\n */\nexport default class Path implements IPath {\n\n  public static create(): Path {\n    return new Path(\n      [],\n    );\n  }\n\n  /**\n   * Compare two [[IPath]] instances\n   * @returns true if the two paths are the same\n   */\n  public static compareEquals(path: IPath, otherPath: IPath): boolean {\n    if (path.legs.length !== otherPath.legs.length) {\n      return false;\n    }\n\n    return path.legs.every((leg, legIndex) => {\n      const otherLeg = otherPath.legs[legIndex];\n\n      return Leg.compareEquals(leg, otherLeg);\n    });\n  }\n\n  public legs: ILeg[];\n\n  constructor(legs: ILeg[]) {\n    this.legs = legs;\n  }\n\n  public prependLeg(leg: ILeg) {\n    this.legs.unshift(leg);\n  }\n\n  public appendLeg(leg: ILeg): void {\n    this.legs.push(leg);\n  }\n\n  public addPath(path: IPath): void {\n    this.legs.push(...path.legs);\n  }\n\n  public getStartLocationId(): string {\n    return (\" \" + this.legs[0].getStartLocation().id).slice(1);\n  }\n\n  public getDepartureTime(query: IQuery): Date {\n    let acc = 0;\n    for (const leg of this.legs) {\n      if (leg.getStartTime()) {\n        return new Date(leg.getStartTime().getTime() - acc);\n      } else {\n        acc += leg.getExpectedDuration();\n      }\n    }\n\n    return query.minimumDepartureTime;\n  }\n\n  public getArrivalTime(query: IQuery): Date {\n    let acc = 0;\n    for (let i = this.legs.length - 1; i >= 0; i--) {\n      const leg = this.legs[i];\n      if (leg.getStopTime()) {\n        return new Date(leg.getStopTime().getTime() + acc);\n      } else {\n        acc += leg.getExpectedDuration();\n      }\n    }\n    return new Date(query.minimumDepartureTime.getTime() + (this.getTravelTime()));\n  }\n\n  public getTravelTime(): DurationMs {\n    return this.legs.reduce((time, leg) => time + leg.getExpectedDuration(), 0);\n  }\n\n  public getTransferTime(): DurationMs {\n    let time = this.getTravelTime();\n\n    for (const leg of this.legs) {\n      if (leg.getTravelMode() === TravelMode.Train || leg.getTravelMode() === TravelMode.Bus) {\n        time -= leg.getExpectedDuration();\n      }\n    }\n\n    return time;\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n    if (typeof serviceIdentifier === \"function\") {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier.name;\n    }\n    else if (typeof serviceIdentifier === \"symbol\") {\n        return serviceIdentifier.toString();\n    }\n    else {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier;\n    }\n}\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n    var registeredBindingsList = \"\";\n    var registeredBindings = getBindings(container, serviceIdentifier);\n    if (registeredBindings.length !== 0) {\n        registeredBindingsList = \"\\nRegistered bindings:\";\n        registeredBindings.forEach(function (binding) {\n            var name = \"Object\";\n            if (binding.implementationType !== null) {\n                name = getFunctionName(binding.implementationType);\n            }\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n            if (binding.constraint.metaData) {\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n            }\n        });\n    }\n    return registeredBindingsList;\n}\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n    if (request.parentRequest === null) {\n        return false;\n    }\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n        return true;\n    }\n    else {\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n    }\n}\nfunction dependencyChainToString(request) {\n    function _createStringArr(req, result) {\n        if (result === void 0) { result = []; }\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n        result.push(serviceIdentifier);\n        if (req.parentRequest !== null) {\n            return _createStringArr(req.parentRequest, result);\n        }\n        return result;\n    }\n    var stringArr = _createStringArr(request);\n    return stringArr.reverse().join(\" --> \");\n}\nfunction circularDependencyToException(request) {\n    request.childRequests.forEach(function (childRequest) {\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n            var services = dependencyChainToString(childRequest);\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n        }\n        else {\n            circularDependencyToException(childRequest);\n        }\n    });\n}\nexports.circularDependencyToException = circularDependencyToException;\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n    if (target.isTagged() || target.isNamed()) {\n        var m_1 = \"\";\n        var namedTag = target.getNamedTag();\n        var otherTags = target.getCustomTags();\n        if (namedTag !== null) {\n            m_1 += namedTag.toString() + \"\\n\";\n        }\n        if (otherTags !== null) {\n            otherTags.forEach(function (tag) {\n                m_1 += tag.toString() + \"\\n\";\n            });\n        }\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n    }\n    else {\n        return \" \" + serviceIdentifierString;\n    }\n}\nexports.listMetadataForTarget = listMetadataForTarget;\nfunction getFunctionName(v) {\n    if (v.name) {\n        return v.name;\n    }\n    else {\n        var name_1 = v.toString();\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\n        return match ? match[1] : \"Anonymous function: \" + name_1;\n    }\n}\nexports.getFunctionName = getFunctionName;\n","import Catalog from \"./Catalog\";\nimport TravelMode from \"./enums/TravelMode\";\n\nconst catalogNmbs = new Catalog();\n\ncatalogNmbs.addStopsSource(\"https://irail.be/stations/NMBS\");\ncatalogNmbs.addConnectionsSource(\"https://graph.irail.be/sncb/connections\", TravelMode.Train);\n\nexport default catalogNmbs;\n","import { Container, injectable } from \"inversify\";\n\n/**\n * The Context serves as event pass through and holder of the inversify container object.\n *\n * It proxies an internal EventEmitter (instead of extending EventEmitter) because\n * ´decorate(injectable(), EventEmitter)´ causes errors when running tests in Jest\n */\n@injectable()\nexport default class Context {\n  private container: Container;\n\n  public setContainer(container: Container) {\n    this.container = container;\n  }\n\n  public getContainer() {\n    return this.container;\n  }\n}\n","import fetch from \"cross-fetch\";\nimport { injectable } from \"inversify\";\nimport IConnection from \"../../entities/connections/connections\";\nimport { LinkedConnectionsPage } from \"../../entities/connections/page\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IConnectionsFetcher from \"./IConnectionsFetcher\";\n\n@injectable()\n// tslint:disable: no-string-literal\nexport default class ConnectionsFetcherRaw implements IConnectionsFetcher {\n    protected travelMode: TravelMode;\n\n    public setTravelMode(travelMode: TravelMode) {\n        this.travelMode = travelMode;\n    }\n\n    public async get(url: string): Promise<LinkedConnectionsPage> {\n        const beginTime = new Date();\n\n        const response = await fetch(url);\n        const responseText = await response.text();\n        if (response.status !== 200) {\n            EventBus.getInstance().emit(EventType.Warning, `${url} responded with status code ${response.status}`);\n        }\n        if (response.status === 200 && responseText) {\n            const blob = JSON.parse(responseText);\n\n            const connections: IConnection[] = [];\n\n            for (const entity of blob[\"@graph\"]) {\n                const connectionId = entity[\"@id\"];\n\n                const arrivalTime = new Date(entity[\"arrivalTime\"]);\n                const arrivalStop = entity[\"arrivalStop\"];\n                const arrivalDelay = entity[\"arrivalDelay\"] ? parseFloat(entity[\"arrivalDelay\"]) : 0;\n\n                const departureTime = new Date(entity[\"departureTime\"]);\n                const departureStop = entity[\"departureStop\"];\n                const departureDelay = entity[\"departureDelay\"] ? parseFloat(entity[\"departureDelay\"]) : 0;\n\n                const nextConnection = entity[\"nextConnection\"] || [];\n                const tripId = entity[\"gtfs:trip\"] || null;\n\n                const route = entity[\"gtfs:route\"] || null;\n                const dropOffType = entity[\"gtfs:dropOffType\"];\n                const pickupType = entity[\"gtfs:pickupType\"];\n                const headsign = entity[\"direction\"] || null;\n                const connection: IConnection = {\n                    id: connectionId,\n                    travelMode: this.travelMode,\n                    arrivalTime,\n                    arrivalStop,\n                    arrivalDelay,\n                    departureTime,\n                    departureStop,\n                    departureDelay,\n                    nextConnection,\n                    tripId,\n                    route,\n                    dropOffType,\n                    pickupType,\n                    headsign,\n                };\n\n                connections.push(connection);\n            }\n\n            const pageId = blob[\"@id\"];\n            const nextPageUrl = blob[\"hydra:next\"];\n            const previousPageUrl = blob[\"hydra:previous\"];\n\n            const duration = (new Date()).getTime() - beginTime.getTime();\n            EventBus.getInstance().emit(EventType.LDFetchGet, url, duration);\n\n            return new LinkedConnectionsPage(pageId, connections, previousPageUrl, nextPageUrl);\n        } else {\n            return new LinkedConnectionsPage(url, [], undefined, undefined);\n        }\n    }\n}\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","const util = require(\"util\");\nconst q = require('q');\nconst Fetcher = require(\"./NodeHttpFetcher.js\");\nconst N3 = require('n3');\nconst RDFXMLParser = require('rdfxmlprocessor');\nconst {DOMParser} = require('xmldom');\nconst JsonldToRDF = require('./JsonldToRDF');\nconst RDFaToRDF = require('./RDFaToRDF');\nconst NodeHTMLParser = require('./NodeHTMLParser');\nconst jsonld = require('jsonld');\nconst DataFactory = require('@rdfjs/data-model')\n\nconst EventEmitter = require('events');\n/** This is the common part for both browser and NodeJS */\nmodule.exports = class extends EventEmitter {\n  constructor (options) {\n    super();\n    this.prefixes = {};\n    //We like quads, so preference to serializations that we can parse fast with quads\n    //Then comes JSON-LD, which is slower to parse\n    //Then comes rdf/xml, turtle and n-triples, which we support in a fast manner, but it doesn’t contain named graphs\n    //We also support HTML, but that’s really slow\n    //We also support N3 and parse it quite fast, but we won’t do anything special with the N3 rules, so put it to low q\n    var accept = 'application/trig;q=1.0,application/n-quads,application/ld+json;q=.9,application/rdf+xml;q=.8,text/turtle,application/n-triples';\n    if (options && options.headers) {\n      this.fetcher = new Fetcher(accept, options.headers);\n    } else {\n      this.fetcher = new Fetcher(accept);\n    }\n    //forward events on this class\n    this.fetcher.on(\"cache-miss\", obj => {\n      this.emit(\"cache-miss\",obj);\n    });\n    this.fetcher.on(\"cache-hit\", obj => {\n      this.emit(\"cache-hit\",obj);\n    });\n    this.fetcher.on(\"downloaded\", obj => {\n      this.emit(\"downloaded\",obj);\n    });\n  }\n\n  async frame (triples, frame) {\n    if (typeof triples === 'string') {\n      triples = await this.get(triples).then(response => {\n        return response.triples;\n      });\n    }\n    var objects = {\"@graph\": []};\n    var graphs = {};\n    for (var triple of triples) {\n      //Json-LD lib uses underscores when blanknode\n      if (triple.subject.termType === 'BlankNode') {\n        triple.subject.value = '_:' + triple.subject.value;\n      }\n      if (triple.predicate.termType === 'BlankNode') {\n        triple.predicate.value = '_:' + triple.predicate.value;\n      }\n      if (triple.object.termType === 'BlankNode') {\n        triple.object.value = '_:' + triple.object.value;\n      }\n      if (triple.graph.termType === 'BlankNode') {\n        triple.graph.value = '_:' + triple.graph.value;\n      }\n      if (triple.graph.value && !graphs[triple.graph.value])\n        graphs[triple.graph.value] = {\"@id\": triple.graph.value, \"@graph\" : []};\n      var obj = {\n        \"@id\" : triple.subject.value,  \n      };\n      if (triple.object.termType === 'Literal') {\n        obj[triple.predicate.value] = {\"@value\" : triple.object.value};\n        if (triple.predicate.language)\n          obj[triple.predicate.value][\"@language\"] = triple.object.language;\n        if (triple.object.datatype)\n          obj[triple.predicate.value][\"@type\"] = triple.object.datatype.value;\n      } else if (triple.predicate.value === 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type') {\n        obj[\"@type\"] = triple.object.value;\n      } else {\n        obj[triple.predicate.value] = {\"@id\": triple.object.value};\n      }\n      if (!triple.graph.value) {\n        objects[\"@graph\"].push(obj);\n      } else {\n        graphs[triple.graph.value][\"@graph\"].push(obj);\n      }\n    }\n    objects[\"@graph\"].push(Object.values(graphs));\n    return jsonld.frame(objects, frame);\n  }\n\n  addPrefix (prefix, uri) {\n    this.prefixes[prefix] = uri;\n  }\n\n  getCacheStats () {\n    return this.fetcher.getCacheStats();\n  }\n  \n  get (url) {\n    this.emit('request', url);\n    return this.fetcher.get(url).then((response) => {\n      if (url !== response.url) {\n        this.emit('redirect',{'from': url, 'to': response.url});\n      }\n      this.emit('response', response.url);\n      var triples = [], prefixes = {}, promise = q.defer();\n      if (response.type === 'application/ld+json' || response.type === 'application/json') {\n        var parser = new JsonldToRDF({documentIRI: response.url, factory: DataFactory});\n        parser.parse(response.body, (error, triple, newPrefixes) => {\n          this.emit('parsed', response.url);\n          if (error) {\n            promise.reject(error);\n          } else if (triple) {\n            triples.push(triple);\n          } else {\n            prefixes = Object.assign(this.prefixes, prefixes);\n            promise.resolve({ triples,\n                              prefixes,\n                              statusCode: response.statusCode,\n                              url : response.url});\n          }\n          if (newPrefixes) {\n            prefixes = Object.assign(prefixes, newPrefixes);\n          }\n        });\n        return promise.promise;\n      } else if (response.type === 'text/html') {\n        var promises = [];\n        var promiseIndex = 0;\n\n        //Parses extra JSON-LD snippets in the page\n        var document = NodeHTMLParser(response.body, response.url); //In the browser, this is replaced with BrowserHTMLParser\n        var jsonldscriptelements = document.querySelectorAll(\"script[type*='application/ld+json']\");\n        \n        for (var index = 0; index < jsonldscriptelements.length; index++) {\n          var tag = jsonldscriptelements[index];\n          //TODO: what if there is no textContent and there is an src tag instead? Should this be supported?\n          promises[index] = q.defer();\n          var newTriples = [];\n          (new JsonldToRDF({documentIRI: response.url})).parse(tag.textContent, (error, triple, newPrefixes) => {\n            if (triple) {\n              triples.push(triple);\n            } else if (error) {\n              //If there’s an error in this promise, just resolve it without anything else\n              console.error('WARNING: an error was given while processing a JSON-LD snippet: ', error );\n              promises[promiseIndex].resolve();\n              promiseIndex++;\n            } else {\n              //Success! Let’s resolve it.\n              promises[promiseIndex].resolve();\n              promiseIndex++;\n            }\n          });\n        }\n        //Parses the RDFa\n        var parser = new RDFaToRDF({documentIRI: response.url, factory: DataFactory});\n        parser.parse(document, (error, triple, newPrefixes) => {\n          this.emit('parsed', response.url);\n          if (error) {\n            promise.reject(error);\n          } else if (triple) {\n            triples.push(triple);\n          } else {\n            prefixes = Object.assign(this.prefixes, prefixes);\n            promise.resolve();\n          }\n          if (newPrefixes) {\n            prefixes = Object.assign(prefixes, newPrefixes);\n          }\n        });\n        var promises2 = [promise].concat(promises).map(promise => {return promise.promise});\n        return q.all(promises2).then(() => {\n          return { triples,\n                   prefixes,\n                   statusCode: response.statusCode,\n                   url : response.url};\n        });\n      } else if ([\"application/trig\",\"application/n-quads\",\"text/turtle\",\"application/n-triples\",\"text/n3\"].indexOf(response.type.toLowerCase()) > -1) {\n        //Parse N3, text/turtle, N-Quads, n-triples or trig\n        var parser = new N3.Parser({documentIRI: response.url, factory: DataFactory});\n        parser.parse(response.body, (error, triple, newPrefixes) => {\n          this.emit(\"parsed\", response.url);\n          if (error) {\n            promise.reject(error);\n          } else if (triple) {\n            triples.push(triple);\n          } else {\n            prefixes = Object.assign(prefixes, this.prefixes);\n            promise.resolve({ triples: triples,\n                              prefixes: prefixes,\n                              statusCode: response.statusCode,\n                              url : response.url});\n          }\n          if (newPrefixes) {\n            prefixes = Object.assign(prefixes, newPrefixes);\n          }\n        });\n      } else if ([\"application/rdf+xml\"].indexOf(response.type.toLowerCase()) > -1) {\n        //RDFXML\n        var parser = new RDFXMLParser();\n        //both base and graphname to the response url\n        parser.parse(new DOMParser().parseFromString(response.body), response.url, response.url, (triple) => {\n          this.emit(\"parsed\", response.url);\n          if (triple) {\n            triples.push(triple);\n          } else {\n            promise.resolve({ triples: triples,\n                              statusCode: response.statusCode,\n                              url : response.url});\n          }\n        });\n      } else {\n        //No parser found -- TODO: let’s try any parser until we find triples! The fastest first, the slowest last.\n        \n        //Just resolve the promise\n        promise.resolve({\n          statusCode: response.statusCode,\n          triples: triples,\n          prefixes: prefixes,\n          url : response.url,\n          error: 'Cannot parse ' + response.type\n        });\n      }\n      return promise.promise;\n    });\n  }\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\n\nfunction isArray(arg) {\n  if (Array.isArray) {\n    return Array.isArray(arg);\n  }\n  return objectToString(arg) === '[object Array]';\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = Buffer.isBuffer;\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n","module.exports = {};\n","/**\n * Node.js module for Forge.\n *\n * @author Dave Longley\n *\n * Copyright 2011-2016 Digital Bazaar, Inc.\n */\nmodule.exports = {\n  // default options\n  options: {\n    usePureJavaScript: false\n  }\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst RDF = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#';\nconst XSD = 'http://www.w3.org/2001/XMLSchema#';\n\nmodule.exports = {\n  LINK_HEADER_REL: 'http://www.w3.org/ns/json-ld#context',\n\n  RDF,\n  RDF_LIST: RDF + 'List',\n  RDF_FIRST: RDF + 'first',\n  RDF_REST: RDF + 'rest',\n  RDF_NIL: RDF + 'nil',\n  RDF_TYPE: RDF + 'type',\n  RDF_PLAIN_LITERAL: RDF + 'PlainLiteral',\n  RDF_XML_LITERAL: RDF + 'XMLLiteral',\n  RDF_OBJECT: RDF + 'object',\n  RDF_LANGSTRING: RDF + 'langString',\n\n  XSD,\n  XSD_BOOLEAN: XSD + 'boolean',\n  XSD_DOUBLE: XSD + 'double',\n  XSD_INTEGER: XSD + 'integer',\n  XSD_STRING: XSD + 'string',\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst types = require('./types');\n\nconst api = {};\nmodule.exports = api;\n\n// define URL parser\n// parseUri 1.2.2\n// (c) Steven Levithan <stevenlevithan.com>\n// MIT License\n// with local jsonld.js modifications\napi.parsers = {\n  simple: {\n    // RFC 3986 basic parts\n    keys: [\n      'href', 'scheme', 'authority', 'path', 'query', 'fragment'\n    ],\n    regex: /^(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?/\n  },\n  full: {\n    keys: [\n      'href', 'protocol', 'scheme', 'authority', 'auth', 'user', 'password',\n      'hostname', 'port', 'path', 'directory', 'file', 'query', 'fragment'\n    ],\n    regex: /^(([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?(?:(((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/\n  }\n};\napi.parse = (str, parser) => {\n  const parsed = {};\n  const o = api.parsers[parser || 'full'];\n  const m = o.regex.exec(str);\n  let i = o.keys.length;\n  while(i--) {\n    parsed[o.keys[i]] = (m[i] === undefined) ? null : m[i];\n  }\n\n  // remove default ports in found in URLs\n  if((parsed.scheme === 'https' && parsed.port === '443') ||\n    (parsed.scheme === 'http' && parsed.port === '80')) {\n    parsed.href = parsed.href.replace(':' + parsed.port, '');\n    parsed.authority = parsed.authority.replace(':' + parsed.port, '');\n    parsed.port = null;\n  }\n\n  parsed.normalizedPath = api.removeDotSegments(parsed.path);\n  return parsed;\n};\n\n/**\n * Prepends a base IRI to the given relative IRI.\n *\n * @param base the base IRI.\n * @param iri the relative IRI.\n *\n * @return the absolute IRI.\n */\napi.prependBase = (base, iri) => {\n  // skip IRI processing\n  if(base === null) {\n    return iri;\n  }\n  // already an absolute IRI\n  if(iri.indexOf(':') !== -1) {\n    return iri;\n  }\n\n  // parse base if it is a string\n  if(types.isString(base)) {\n    base = api.parse(base || '');\n  }\n\n  // parse given IRI\n  const rel = api.parse(iri);\n\n  // per RFC3986 5.2.2\n  const transform = {\n    protocol: base.protocol || ''\n  };\n\n  if(rel.authority !== null) {\n    transform.authority = rel.authority;\n    transform.path = rel.path;\n    transform.query = rel.query;\n  } else {\n    transform.authority = base.authority;\n\n    if(rel.path === '') {\n      transform.path = base.path;\n      if(rel.query !== null) {\n        transform.query = rel.query;\n      } else {\n        transform.query = base.query;\n      }\n    } else {\n      if(rel.path.indexOf('/') === 0) {\n        // IRI represents an absolute path\n        transform.path = rel.path;\n      } else {\n        // merge paths\n        let path = base.path;\n\n        // append relative path to the end of the last directory from base\n        path = path.substr(0, path.lastIndexOf('/') + 1);\n        if(path.length > 0 && path.substr(-1) !== '/') {\n          path += '/';\n        }\n        path += rel.path;\n\n        transform.path = path;\n      }\n      transform.query = rel.query;\n    }\n  }\n\n  if(rel.path !== '') {\n    // remove slashes and dots in path\n    transform.path = api.removeDotSegments(transform.path);\n  }\n\n  // construct URL\n  let rval = transform.protocol;\n  if(transform.authority !== null) {\n    rval += '//' + transform.authority;\n  }\n  rval += transform.path;\n  if(transform.query !== null) {\n    rval += '?' + transform.query;\n  }\n  if(rel.fragment !== null) {\n    rval += '#' + rel.fragment;\n  }\n\n  // handle empty base\n  if(rval === '') {\n    rval = './';\n  }\n\n  return rval;\n};\n\n/**\n * Removes a base IRI from the given absolute IRI.\n *\n * @param base the base IRI.\n * @param iri the absolute IRI.\n *\n * @return the relative IRI if relative to base, otherwise the absolute IRI.\n */\napi.removeBase = (base, iri) => {\n  // skip IRI processing\n  if(base === null) {\n    return iri;\n  }\n\n  if(types.isString(base)) {\n    base = api.parse(base || '');\n  }\n\n  // establish base root\n  let root = '';\n  if(base.href !== '') {\n    root += (base.protocol || '') + '//' + (base.authority || '');\n  } else if(iri.indexOf('//')) {\n    // support network-path reference with empty base\n    root += '//';\n  }\n\n  // IRI not relative to base\n  if(iri.indexOf(root) !== 0) {\n    return iri;\n  }\n\n  // remove root from IRI and parse remainder\n  const rel = api.parse(iri.substr(root.length));\n\n  // remove path segments that match (do not remove last segment unless there\n  // is a hash or query)\n  const baseSegments = base.normalizedPath.split('/');\n  const iriSegments = rel.normalizedPath.split('/');\n  const last = (rel.fragment || rel.query) ? 0 : 1;\n  while(baseSegments.length > 0 && iriSegments.length > last) {\n    if(baseSegments[0] !== iriSegments[0]) {\n      break;\n    }\n    baseSegments.shift();\n    iriSegments.shift();\n  }\n\n  // use '../' for each non-matching base segment\n  let rval = '';\n  if(baseSegments.length > 0) {\n    // don't count the last segment (if it ends with '/' last path doesn't\n    // count and if it doesn't end with '/' it isn't a path)\n    baseSegments.pop();\n    for(let i = 0; i < baseSegments.length; ++i) {\n      rval += '../';\n    }\n  }\n\n  // prepend remaining segments\n  rval += iriSegments.join('/');\n\n  // add query and hash\n  if(rel.query !== null) {\n    rval += '?' + rel.query;\n  }\n  if(rel.fragment !== null) {\n    rval += '#' + rel.fragment;\n  }\n\n  // handle empty base\n  if(rval === '') {\n    rval = './';\n  }\n\n  return rval;\n};\n\n/**\n * Removes dot segments from a URL path.\n *\n * @param path the path to remove dot segments from.\n */\napi.removeDotSegments = path => {\n  // RFC 3986 5.2.4 (reworked)\n\n  // empty path shortcut\n  if(path.length === 0) {\n    return '';\n  }\n\n  const input = path.split('/');\n  const output = [];\n\n  while(input.length > 0) {\n    const next = input.shift();\n    const done = input.length === 0;\n\n    if(next === '.') {\n      if(done) {\n        // ensure output has trailing /\n        output.push('');\n      }\n      continue;\n    }\n\n    if(next === '..') {\n      output.pop();\n      if(done) {\n        // ensure output has trailing /\n        output.push('');\n      }\n      continue;\n    }\n\n    output.push(next);\n  }\n\n  // ensure output has leading /\n  if(output.length > 0 && output[0] !== '') {\n    output.unshift('');\n  }\n  if(output.length === 1 && output[0] === '') {\n    return '/';\n  }\n\n  return output.join('/');\n};\n\n// TODO: time better isAbsolute/isRelative checks using full regexes:\n// http://jmrware.com/articles/2009/uri_regexp/URI_regex.html\n\n// regex to check for absolute IRI (starting scheme and ':') or blank node IRI\nconst isAbsoluteRegex = /^([A-Za-z][A-Za-z0-9+-.]*|_):/;\n\n/**\n * Returns true if the given value is an absolute IRI or blank node IRI, false\n * if not.\n * Note: This weak check only checks for a correct starting scheme.\n *\n * @param v the value to check.\n *\n * @return true if the value is an absolute IRI, false if not.\n */\napi.isAbsolute = v => types.isString(v) && isAbsoluteRegex.test(v);\n\n/**\n * Returns true if the given value is a relative IRI, false if not.\n * Note: this is a weak check.\n *\n * @param v the value to check.\n *\n * @return true if the value is a relative IRI, false if not.\n */\napi.isRelative = v => types.isString(v);\n","import { EventEmitter } from \"events\";\nimport { injectable } from \"inversify\";\nimport LDFetchBase from \"ldfetch\";\nimport { Triple } from \"rdf-js\";\nimport EventBus from \"../events/EventBus\";\nimport EventType from \"../events/EventType\";\n\nexport interface ILDFetchResponse {\n  triples: Triple[];\n  prefixes: object;\n  statusCode: string;\n  url: string;\n}\n\n/**\n * Proxies an ldfetch instance to transform its events\n */\n@injectable()\nexport default class LDFetch implements LDFetchBase {\n  private eventBus: EventEmitter;\n  private ldFetchBase: LDFetchBase;\n  private httpStartTimes: { [url: string]: Date };\n\n  constructor() {\n    this.ldFetchBase = new LDFetchBase({ headers: { Accept: \"application/ld+json\" } });\n    this.eventBus = EventBus.getInstance();\n\n    this.setupEvents();\n  }\n\n  public get(url: string): Promise<ILDFetchResponse> {\n    return this.ldFetchBase.get(url);\n  }\n\n  private setupEvents(): void {\n    this.httpStartTimes = {};\n\n    this.ldFetchBase.on(\"request\", (url) => this.httpStartTimes[url] = new Date());\n    this.ldFetchBase.on(\"redirect\", (obj) => this.httpStartTimes[obj.to] = this.httpStartTimes[obj.from]);\n    this.ldFetchBase.on(\"response\", (url) => {\n      const duration = (new Date()).getTime() - this.httpStartTimes[url].getTime();\n\n      this.eventBus.emit(EventType.LDFetchGet, url, duration);\n    });\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport jsonld = require(\"jsonld\");\nimport LDFetch from \"ldfetch\";\nimport CharacteristicProfile from \"../../entities/profile/CharacteresticProfile\";\nimport Profile from \"../../entities/profile/Profile\";\nimport ProfileConclusion from \"../../entities/profile/ProfileConclusion\";\nimport ProfileCondition from \"../../entities/profile/ProfileCondition\";\nimport ProfileRule from \"../../entities/profile/ProfileRule\";\nimport { LDLoader } from \"../../loader/ldloader\";\nimport { ThingView } from \"../../loader/views/single\";\nimport TYPES from \"../../types\";\nimport { PROFILE } from \"../../uri/constants\";\nimport URI from \"../../uri/uri\";\nimport IProfileFetcher from \"./IProfileFetcher\";\n\n@injectable()\nexport default class ProfileFetcherDefault implements IProfileFetcher {\n\n  protected ldFetch: LDFetch;\n  protected ldLoader: LDLoader;\n\n  constructor(\n    @inject(TYPES.LDFetch) ldFetch: LDFetch,\n  ) {\n    this.ldFetch = ldFetch;\n    this.ldLoader = new LDLoader();\n\n    // unordered collections\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasAccessRules\"));\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasOnewayRules\"));\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasSpeedRules\"));\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasPriorityRules\"));\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasObstacleRules\"));\n    this.ldLoader.defineCollection(URI.inNS(PROFILE, \"hasObstacleTimeRules\"));\n  }\n\n  public async parseProfileBlob(blob: object, id: string): Promise<Profile> {\n    const triples = await jsonld.toRDF(blob);\n\n    const [profile] = this.ldLoader.process(triples, [\n      this.getView(),\n    ]);\n\n    profile.id = id;\n\n    return profile;\n  }\n\n  public async get(url: string): Promise<Profile> {\n    const rdfThing = await this.ldFetch.get(url);\n    const triples = rdfThing.triples;\n\n    const [profile] = this.ldLoader.process(triples, [\n      this.getView(),\n    ]);\n\n    profile.id = url;\n\n    return profile;\n  }\n\n  protected getView() {\n    const view = new ThingView(CharacteristicProfile.create);\n    view.addFilter((entity) =>\n      entity[URI.inNS(PROFILE, \"hasAccessRules\")] !== undefined ||\n      entity[URI.inNS(PROFILE, \"hasOnewayRules\")] !== undefined ||\n      entity[URI.inNS(PROFILE, \"hasSpeedRules\")] !== undefined ||\n      entity[URI.inNS(PROFILE, \"hasPriorityRules\")] !== undefined ||\n      entity[URI.inNS(PROFILE, \"hasObstacleRules\")] !== undefined ||\n      entity[URI.inNS(PROFILE, \"hasObstacleTimeRules\")] !== undefined,\n    );\n    view.addMapping(URI.inNS(PROFILE, \"hasAccessRules\"), \"accessRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasOnewayRules\"), \"onewayRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasSpeedRules\"), \"speedRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasPriorityRules\"), \"priorityRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasObstacleRules\"), \"obstacleRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasObstacleTimeRules\"), \"obstacleTimeRules\", this.getRuleView());\n    view.addMapping(URI.inNS(PROFILE, \"hasMaxSpeed\"), \"maxSpeed\");\n    view.addMapping(URI.inNS(PROFILE, \"usePublicTransport\"), \"usePublicTransport\");\n    return view;\n  }\n\n  protected getRuleView() {\n    const view = new ThingView(ProfileRule.create);\n    view.addFilter((entity) =>\n      entity[URI.inNS(PROFILE, \"concludes\")] !== undefined,\n    );\n    view.addMapping(URI.inNS(PROFILE, \"concludes\"), \"conclusion\", this.getConclusionView());\n    view.addMapping(URI.inNS(PROFILE, \"match\"), \"condition\", this.getConditionView());\n    view.addMapping(URI.inNS(PROFILE, \"hasOrder\"), \"order\");\n    return view;\n  }\n\n  protected getConditionView() {\n    const view = new ThingView(ProfileCondition.create);\n    view.addFilter((entity) =>\n      entity[URI.inNS(PROFILE, \"hasPredicate\")] !== undefined,\n    );\n    view.addMapping(URI.inNS(PROFILE, \"hasPredicate\"), \"predicate\");\n    view.addMapping(URI.inNS(PROFILE, \"hasObject\"), \"object\");\n    return view;\n  }\n\n  protected getConclusionView() {\n    const view = new ThingView(ProfileConclusion.create);\n    view.addFilter((entity) =>\n      (entity[URI.inNS(PROFILE, \"hasAccess\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"isOneway\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"isReversed\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"hasSpeed\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"isObstacle\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"hasPriority\")] !== undefined) ||\n      (entity[URI.inNS(PROFILE, \"hasObstacleTime\")] !== undefined),\n    );\n    view.addMapping(URI.inNS(PROFILE, \"hasAccess\"), \"hasAccess\");\n    view.addMapping(URI.inNS(PROFILE, \"isOneway\"), \"isOneway\");\n    view.addMapping(URI.inNS(PROFILE, \"isReversed\"), \"isReversed\");\n    view.addMapping(URI.inNS(PROFILE, \"hasSpeed\"), \"speed\");\n    view.addMapping(URI.inNS(PROFILE, \"isObstacle\"), \"isObstacle\");\n    view.addMapping(URI.inNS(PROFILE, \"hasPriority\"), \"priority\");\n    view.addMapping(URI.inNS(PROFILE, \"hasObstacleTime\"), \"obstacleTime\");\n    return view;\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport Catalog from \"../../Catalog\";\nimport TYPES, { StopsFetcherFactory } from \"../../types\";\nimport IStop from \"./IStop\";\nimport IStopsFetcher from \"./IStopsFetcher\";\nimport IStopsProvider from \"./IStopsProvider\";\n\n@injectable()\nexport default class StopsProviderDefault implements IStopsProvider {\n\n  private readonly stopsFetchers: IStopsFetcher[];\n  private cachedStops: IStop[];\n\n  constructor(\n    @inject(TYPES.StopsFetcherFactory) stopsFetcherFactory: StopsFetcherFactory,\n    @inject(TYPES.Catalog) catalog: Catalog,\n  ) {\n    this.stopsFetchers = [];\n    this.cachedStops = [];\n\n    for (const { accessUrl } of catalog.stopsSourceConfigs) {\n      this.stopsFetchers.push(stopsFetcherFactory(accessUrl));\n    }\n  }\n\n  public prefetchStops(): void {\n    for (const stopsFetcher of this.stopsFetchers) {\n      stopsFetcher.prefetchStops();\n    }\n  }\n\n  public async getStopById(stopId: string): Promise<IStop> {\n    return Promise.all(this.stopsFetchers\n      .map((stopsFetcher: IStopsFetcher) => stopsFetcher.getStopById(stopId)),\n    ).then((results: IStop[]) => results.find((stop) => stop !== undefined));\n  }\n\n  public async getAllStops(): Promise<IStop[]> {\n    if (this.cachedStops.length > 0) {\n      return Promise.resolve(this.cachedStops);\n    }\n\n    return Promise.all(this.stopsFetchers\n      .map((stopsFetcher: IStopsFetcher) => stopsFetcher.getAllStops()),\n    ).then((results: IStop[][]) => {\n      this.cachedStops = [].concat(...results);\n\n      return this.cachedStops;\n    });\n  }\n}\n","import fetch from \"cross-fetch\";\nimport { inject, injectable } from \"inversify\";\nimport { IRoutableTileNodeIndex, RoutableTileNode } from \"../../entities/tiles/node\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport { RoutableTile } from \"../../entities/tiles/tile\";\nimport { IRoutableTileWayIndex, RoutableTileWay } from \"../../entities/tiles/way\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport PathfinderProvider from \"../../pathfinding/PathfinderProvider\";\nimport TYPES from \"../../types\";\nimport { OSM } from \"../../uri/constants\";\nimport URI from \"../../uri/uri\";\nimport IRoutableTileFetcher from \"./IRoutableTileFetcher\";\n\n@injectable()\nexport default class RoutableTileFetcherRaw implements IRoutableTileFetcher {\n\n  protected mapping: object;\n  protected pathfinderProvider: PathfinderProvider;\n  protected routableTileRegistry: RoutableTileRegistry;\n\n  constructor(\n    @inject(TYPES.PathfinderProvider) pathfinderProvider: PathfinderProvider,\n    @inject(TYPES.RoutableTileRegistry) routableTileRegistry: RoutableTileRegistry,\n  ) {\n    this.pathfinderProvider = pathfinderProvider;\n    this.routableTileRegistry = routableTileRegistry;\n    this.mapping = {};\n\n    this.mapping[\"osm:barrier\"] = \"barrierKind\";\n    this.mapping[\"osm:access\"] = \"accessRestrictions\";\n    this.mapping[\"osm:bicycle\"] = \"bicycleAccessRestrictions\";\n    this.mapping[\"osm:construction\"] = \"constructionKind\";\n    this.mapping[\"osm:crossing\"] = \"crossingKind\";\n    this.mapping[\"osm:cycleway\"] = \"cyclewayKind\";\n    this.mapping[\"osm:footway\"] = \"footwayKind\";\n    this.mapping[\"osm:highway\"] = \"highwayKind\";\n    this.mapping[\"osm:maxspeed\"] = \"maxSpeed\";\n    this.mapping[\"osm:motor_vehicle\"] = \"motorVehicleAccessRestrictions\";\n    this.mapping[\"osm:motorcar\"] = \"motorcarAccessRestrictions\";\n    this.mapping[\"osm:oneway_bicycle\"] = \"onewayBicycleKind\";\n    this.mapping[\"osm:oneway\"] = \"onewayKind\";\n    this.mapping[\"osm:smoothness\"] = \"smoothnessKind\";\n    this.mapping[\"osm:surface\"] = \"surfaceKind\";\n    this.mapping[\"osm:tracktype\"] = \"trackType\";\n    this.mapping[\"osm:vehicle\"] = \"vehicleAccessRestrictions\";\n  }\n\n  public async get(url: string): Promise<RoutableTile> {\n    const response = await fetch(url);\n    const responseText = await response.text();\n    if (response.status !== 200) {\n      EventBus.getInstance().emit(EventType.Warning, `${url} responded with status code ${response.status}`);\n    }\n    if (response.status === 200 && responseText) {\n      const blob = JSON.parse(responseText);\n\n      const nodes: IRoutableTileNodeIndex = {};\n      const ways: IRoutableTileWayIndex = {};\n\n      for (const entity of blob[\"@graph\"]) {\n        if (entity[\"@type\"] === \"osm:Node\") {\n          const node = this.createNode(entity);\n          nodes[node.id] = node;\n        } else if (entity[\"@type\"] === \"osm:Way\") {\n          const way = this.createWay(entity);\n          ways[way.id] = way;\n        }\n      }\n\n      return this.processTileData(url, nodes, ways);\n    } else {\n      return new RoutableTile(url, new Set(), new Set());\n    }\n  }\n\n  protected processTileData(url: string, nodes: IRoutableTileNodeIndex, ways: IRoutableTileWayIndex) {\n    this.pathfinderProvider.registerEdges(ways, nodes);\n\n    for (const node of Object.values(nodes)) {\n      this.routableTileRegistry.registerNode(node);\n    }\n\n    for (const way of Object.values(ways)) {\n      this.routableTileRegistry.registerWay(way);\n    }\n\n    return new RoutableTile(url, new Set(Object.keys(nodes)), new Set(Object.keys(ways)));\n  }\n\n  private createNode(blob): RoutableTileNode {\n    const id = blob[\"@id\"];\n    const node = new RoutableTileNode(id);\n    node.latitude = parseFloat(blob[\"geo:lat\"]);\n    node.longitude = parseFloat(blob[\"geo:long\"]);\n\n    for (const [tag, field] of Object.entries(this.mapping)) {\n      if (blob[tag] && !node[field]) {\n        node[field] = URI.fakeExpand(OSM, blob[tag]);\n      }\n    }\n\n    return node;\n  }\n\n  private createWay(blob): RoutableTileWay {\n    const id = blob[\"@id\"];\n    const way = new RoutableTileWay(id);\n    if (blob[\"osm:maxspeed\"]) {\n      way.maxSpeed = parseFloat(blob[\"osm:maxspeed\"]);\n    }\n    if (blob[\"osm:hasNodes\"]) {\n      way.segments = [blob[\"osm:hasNodes\"]];\n    } else {\n      const weights = blob[\"osm:hasEdges\"];\n      way.segments = [weights[\"osm:hasNodes\"]];\n      way.weights = [weights[\"osm:hasWeights\"]];\n    }\n\n    way.name = blob[\"osm:name\"];\n\n    for (const [tag, field] of Object.entries(this.mapping)) {\n      if (blob[tag] && !way[field]) {\n        way[field] = URI.fakeExpand(OSM, blob[tag]);\n      }\n    }\n\n    return way;\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport TYPES from \"../../types\";\nimport IRoutableTileFetcher from \"./IRoutableTileFetcher\";\nimport RoutableTileProviderDefault from \"./RoutableTileProviderDefault\";\n\n@injectable()\nexport default class RoutableTileProviderTransit extends RoutableTileProviderDefault {\n\n  constructor(\n    @inject(TYPES.RoutableTileFetcher) fetcher: IRoutableTileFetcher,\n    @inject(TYPES.RoutableTileRegistry) registry: RoutableTileRegistry,\n  ) {\n      super(fetcher, registry);\n  }\n\n  public getIdForTileCoords(coordinate: RoutableTileCoordinate): string {\n    return `https://hdelva.be/tiles/reduced/${coordinate.zoom}/${coordinate.x}/${coordinate.y}`;\n  }\n}\n","import { injectable } from \"inversify\";\nimport TinyQueue from \"tinyqueue\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport PathfindingGraph from \"../graph\";\nimport { IPathTree, IShortestPathTreeAlgorithm, IShortestPathTreeInstance } from \"../pathfinder\";\nimport DijkstraTreeInstance from \"./DijkstraTreeInstance\";\n\ninterface IState {\n  position: number;\n  distance: DistanceM;\n  duration: DurationMs;\n  cost: number;\n}\n\n@injectable()\nexport default class DijkstraTree implements IShortestPathTreeAlgorithm {\n  public createInstance(graph: PathfindingGraph): IShortestPathTreeInstance {\n    return new DijkstraTreeInstance(graph);\n  }\n}\n","import { ArrayIterator, AsyncIterator } from \"asynciterator\";\nimport { EventEmitter } from \"events\";\nimport { inject, injectable, tagged } from \"inversify\";\nimport IConnection from \"../../entities/connections/connections\";\nimport DropOffType from \"../../enums/DropOffType\";\nimport PickupType from \"../../enums/PickupType\";\nimport ReachableStopsFinderMode from \"../../enums/ReachableStopsFinderMode\";\nimport ReachableStopsSearchPhase from \"../../enums/ReachableStopsSearchPhase\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IConnectionsProvider from \"../../fetcher/connections/IConnectionsProvider\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Geo from \"../../util/Geo\";\nimport MergeIterator from \"../../util/iterators/MergeIterator\";\nimport IReachableStopsFinder, { IReachableStop } from \"../stops/IReachableStopsFinder\";\nimport IProfileByStop from \"./CSA/data-structure/stops/IProfileByStop\";\nimport ITransferProfile from \"./CSA/data-structure/stops/ITransferProfile\";\nimport IEnterConnectionByTrip from \"./CSA/data-structure/trips/IEnterConnectionByTrip\";\nimport FootpathQueue from \"./CSA/FootpathQueue\";\nimport IJourneyExtractor from \"./IJourneyExtractor\";\nimport IPublicTransportPlanner from \"./IPublicTransportPlanner\";\nimport JourneyExtractorEarliestArrival from \"./JourneyExtractorEarliestArrival\";\n\ninterface IFinalReachableStops {\n  [stop: string]: IReachableStop;\n}\n\n// Implementation is as close as possible to the original paper: https://arxiv.org/pdf/1703.05997.pdf\n\n@injectable()\nexport default class CSAEarliestArrival implements IPublicTransportPlanner {\n  private static forwardsConnectionSelector(connections: IConnection[]): number {\n    if (connections.length === 1) {\n      return 0;\n    }\n\n    let earliestIndex = 0;\n    const earliest = connections[earliestIndex];\n\n    for (let i = 1; i < connections.length; i++) {\n      const connection = connections[i];\n\n      if (connection && connection.departureTime < earliest.departureTime) {\n        earliestIndex = i;\n      }\n    }\n\n    return earliestIndex;\n  }\n\n  protected readonly connectionsProvider: IConnectionsProvider;\n  protected readonly locationResolver: ILocationResolver;\n  protected readonly transferReachableStopsFinder: IReachableStopsFinder;\n  protected readonly initialReachableStopsFinder: IReachableStopsFinder;\n  protected readonly finalReachableStopsFinder: IReachableStopsFinder;\n  protected readonly eventBus: EventEmitter;\n\n  protected finalReachableStops: IFinalReachableStops = {};\n  protected profilesByStop: IProfileByStop = {}; // S\n  protected enterConnectionByTrip: IEnterConnectionByTrip = {}; // T\n\n  protected footpathsQueue: FootpathQueue;\n  protected connectionsQueue: AsyncIterator<IConnection>;\n\n  protected journeyExtractor: IJourneyExtractor;\n\n  constructor(\n    @inject(TYPES.ConnectionsProvider)\n    connectionsProvider: IConnectionsProvider,\n    @inject(TYPES.LocationResolver)\n    locationResolver: ILocationResolver,\n    @inject(TYPES.ReachableStopsFinder)\n    @tagged(\"phase\", ReachableStopsSearchPhase.Transfer)\n    transferReachableStopsFinder: IReachableStopsFinder,\n    @inject(TYPES.ReachableStopsFinder)\n    @tagged(\"phase\", ReachableStopsSearchPhase.Initial)\n    initialReachableStopsFinder: IReachableStopsFinder,\n    @inject(TYPES.ReachableStopsFinder)\n    @tagged(\"phase\", ReachableStopsSearchPhase.Final)\n    finalReachableStopsFinder: IReachableStopsFinder,\n  ) {\n    this.connectionsProvider = connectionsProvider;\n    this.locationResolver = locationResolver;\n    this.transferReachableStopsFinder = transferReachableStopsFinder;\n    this.initialReachableStopsFinder = initialReachableStopsFinder;\n    this.finalReachableStopsFinder = finalReachableStopsFinder;\n    this.eventBus = EventBus.getInstance();\n    this.journeyExtractor = new JourneyExtractorEarliestArrival(locationResolver);\n  }\n\n  public async plan(query: IResolvedQuery): Promise<AsyncIterator<IPath>> {\n    const {\n      minimumDepartureTime: lowerBoundDate,\n      maximumArrivalTime: upperBoundDate,\n    } = query;\n\n    this.footpathsQueue = new FootpathQueue();\n    const connectionsIterator = this.connectionsProvider.createIterator({\n      upperBoundDate,\n      lowerBoundDate,\n    });\n\n    this.connectionsQueue = new MergeIterator(\n      [connectionsIterator, this.footpathsQueue],\n      CSAEarliestArrival.forwardsConnectionSelector,\n      true,\n    );\n\n    const [hasInitialReachableStops, hasFinalReachableStops] = await Promise.all([\n      this.initInitialReachableStops(query),\n      this.initFinalReachableStops(query),\n    ]);\n\n    if (!hasInitialReachableStops || !hasFinalReachableStops) {\n      return Promise.resolve(new ArrayIterator([]));\n    }\n\n    const self = this;\n    return new Promise((resolve, reject) => {\n      let isDone: boolean = false;\n\n      const done = () => {\n        if (!isDone) {\n          self.connectionsQueue.close();\n\n          self.extractJourneys(query)\n            .then((resultIterator) => {\n              resolve(resultIterator);\n            });\n\n          isDone = true;\n        }\n      };\n\n      connectionsIterator.on(\"readable\", () =>\n        self.processConnections(query, done),\n      );\n\n      connectionsIterator.on(\"end\", () => done());\n\n      // iterator may have become readable before the listener was attached\n      self.processConnections(query, done);\n\n    }) as Promise<AsyncIterator<IPath>>;\n  }\n\n  protected updateProfile(query: IResolvedQuery, connection: IConnection) {\n    /*\n    Call this ONLY if the given connection is known to improve the arrival stop's profile\n    */\n\n    const tripId = connection.tripId;\n    const departureTime = connection.departureTime.getTime();\n    const arrivalTime = connection.arrivalTime.getTime();\n\n    // update profile of arrival stop\n    const arrivalProfile: ITransferProfile = {\n      departureTime,\n      arrivalTime,\n      exitConnection: connection,\n      enterConnection: this.enterConnectionByTrip[tripId],\n    };\n    this.profilesByStop[connection.arrivalStop] = arrivalProfile;\n  }\n\n  private async extractJourneys(query: IResolvedQuery): Promise<AsyncIterator<IPath>> {\n    return this.journeyExtractor.extractJourneys(this.profilesByStop, query);\n  }\n\n  private async processConnections(query: IResolvedQuery, resolve: () => void) {\n    const { from, to, minimumDepartureTime } = query;\n    const departureStopId: string = from[0].id;\n    const arrivalStopId: string = to[0].id;\n\n    let connection: IConnection = this.connectionsQueue.read();\n\n    while (connection && !this.connectionsQueue.closed) {\n\n      if (connection.departureTime < minimumDepartureTime && !this.connectionsQueue.closed) {\n        // starting criterion\n        // skip connections before the minimum departure time\n        connection = this.connectionsQueue.read();\n        continue;\n      }\n\n      if (this.getProfile(arrivalStopId).arrivalTime <= connection.departureTime.getTime()) {\n        // stopping criterion\n        // we cannot improve the tentative arrival time anymore\n        return resolve();\n      }\n\n      const tripId = connection.tripId;\n      const departureTime = connection.departureTime.getTime();\n\n      const canRemainSeated = this.enterConnectionByTrip[tripId];\n      const canTakeTransfer = (\n        (\n          connection.departureStop === departureStopId ||\n          this.getProfile(connection.departureStop).arrivalTime <= departureTime\n        ) &&\n        connection[\"gtfs:pickupType\"] !== PickupType.NotAvailable\n      );\n\n      if (canRemainSeated || canTakeTransfer) {\n        // enterConnectionByTrip should point to the first reachable connection\n        if (!this.enterConnectionByTrip[tripId]) {\n          this.enterConnectionByTrip[tripId] = connection;\n        }\n\n        // limited walking optimization\n        const canImprove = connection.arrivalTime.getTime() < this.getProfile(connection.arrivalStop).arrivalTime;\n        const canLeave = connection[\"gtfs:dropOffType\"] !== DropOffType.NotAvailable;\n\n        if (canLeave && canImprove) {\n          this.updateProfile(query, connection);\n          await this.scheduleExtraConnections(query, connection);\n        }\n      }\n\n      if (!this.connectionsQueue.closed) {\n        connection = this.connectionsQueue.read();\n        continue;\n      }\n\n      connection = undefined;\n    }\n  }\n\n  private getProfile(stopId: string): ITransferProfile {\n    if (!this.profilesByStop[stopId]) {\n      this.profilesByStop[stopId] = {\n        departureTime: Infinity,\n        arrivalTime: Infinity,\n      };\n    }\n    return this.profilesByStop[stopId];\n  }\n\n  private async scheduleExtraConnections(query: IResolvedQuery, sourceConnection: IConnection) {\n    try {\n      const arrivalStop: ILocation = await this.locationResolver.resolve(sourceConnection.arrivalStop);\n      const reachableStops: IReachableStop[] = await this.transferReachableStopsFinder.findReachableStops(\n        arrivalStop as IStop,\n        ReachableStopsFinderMode.Source,\n        query.maximumTransferDuration,\n        query.minimumWalkingSpeed,\n        query.profileID,\n      );\n\n      if (this.finalReachableStops[arrivalStop.id]) {\n        reachableStops.push(this.finalReachableStops[arrivalStop.id]);\n      }\n\n      for (const reachableStop of reachableStops) {\n        const { stop: stop, duration: duration } = reachableStop;\n\n        if (duration && stop.id) {\n          const transferTentativeArrival = this.getProfile(stop.id).arrivalTime;\n          const newArrivalTime = new Date(sourceConnection.arrivalTime.getTime() + duration);\n\n          if (transferTentativeArrival > newArrivalTime.getTime() && newArrivalTime <= query.maximumArrivalTime) {\n            // create a connection that resembles a footpath\n            // TODO, ditch the IReachbleStop and IConnection interfaces and make these proper objects\n            const transferConnection: IConnection = {\n              id: `TRANSFER_TO:${stop.id}`,\n              tripId: `TRANSFER_TO:${stop.id}`,\n              travelMode: TravelMode.Walking,  // TODO, this should be part of the reachable stop object\n              departureTime: sourceConnection.arrivalTime,\n              departureStop: sourceConnection.arrivalStop,\n              arrivalTime: new Date(sourceConnection.arrivalTime.getTime() + duration),\n              arrivalStop: stop.id,\n              dropOffType: DropOffType.Regular,\n              pickupType: PickupType.Regular,\n              headsign: stop.id,\n            };\n\n            this.footpathsQueue.write(transferConnection);\n          }\n        }\n      }\n    } catch (e) {\n      if (this.eventBus) {\n        this.eventBus.emit(EventType.Warning, (e));\n      }\n    }\n  }\n\n  private async initInitialReachableStops(query: IResolvedQuery): Promise<boolean> {\n    const fromLocation: ILocation = query.from[0];\n\n    // Making sure the departure location has an id\n    const geoId = Geo.getId(fromLocation);\n    if (!fromLocation.id) {\n      query.from[0].id = geoId;\n      query.from[0].name = \"Departure location\";\n    }\n\n    const reachableStops = await this.initialReachableStopsFinder.findReachableStops(\n      fromLocation,\n      ReachableStopsFinderMode.Source,\n      query.maximumWalkingDuration,\n      query.minimumWalkingSpeed,\n      query.profileID,\n    );\n\n    // Abort when we can't reach a single stop.\n    if (reachableStops.length === 0) {\n      this.eventBus.emit(EventType.AbortQuery, \"No reachable stops at departure location\");\n\n      return false;\n    }\n\n    if (this.eventBus) {\n      this.eventBus.emit(EventType.InitialReachableStops, reachableStops);\n    }\n\n    for (const reachableStop of reachableStops) {\n      const { stop: stop, duration: duration } = reachableStop;\n\n      if (duration) {\n        // create a connection that resembles a footpath\n        // TODO, ditch the IReachbleStop and IConnection interfaces and make these proper objects\n        const transferConnection: IConnection = {\n          id: `MOVE_TO:${stop.id}`,\n          tripId: `MOVE_TO:${stop.id}`,\n          travelMode: TravelMode.Walking,  // TODO, this should be part of the reachable stop object\n          departureTime: query.minimumDepartureTime,\n          departureStop: fromLocation.id,\n          arrivalTime: new Date(query.minimumDepartureTime.getTime() + duration),\n          arrivalStop: stop.id,\n          dropOffType: DropOffType.Regular,\n          pickupType: PickupType.Regular,\n          headsign: stop.id,\n        };\n\n        this.footpathsQueue.write(transferConnection);\n      }\n    }\n\n    return true;\n  }\n\n  private async initFinalReachableStops(query: IResolvedQuery): Promise<boolean> {\n    const toLocation: ILocation = query.to[0];\n\n    // Making sure the departure location has an id\n    const geoId = Geo.getId(toLocation);\n    if (!toLocation.id) {\n      query.to[0].id = geoId;\n      query.to[0].name = \"Arrival location\";\n    }\n\n    const reachableStops = await this.finalReachableStopsFinder.findReachableStops(\n      toLocation,\n      ReachableStopsFinderMode.Target,\n      query.maximumWalkingDuration,\n      query.minimumWalkingSpeed,\n      query.profileID,\n    );\n\n    // Abort when we can't reach a single stop.\n    if (reachableStops.length === 0) {\n      this.eventBus.emit(EventType.AbortQuery, \"No reachable stops at arrival location\");\n\n      return false;\n    }\n\n    if (this.eventBus) {\n      this.eventBus.emit(EventType.FinalReachableStops, reachableStops);\n    }\n\n    for (const reachableStop of reachableStops) {\n      if (reachableStop.duration > 0) {\n        this.finalReachableStops[reachableStop.stop.id] = {\n          stop: toLocation as IStop,\n          duration: reachableStop.duration,\n        };\n      }\n    }\n\n    return true;\n  }\n}\n","import TravelMode from \"../enums/TravelMode\";\nimport ILeg from \"../interfaces/ILeg\";\nimport ILocation from \"../interfaces/ILocation\";\nimport IStep from \"../interfaces/IStep\";\nimport { DistanceM, DurationMs } from \"../interfaces/units\";\nimport Step from \"./Step\";\n\nexport default class Leg implements ILeg {\n    public static compareEquals(leg: ILeg, otherLeg: ILeg): boolean {\n        if (leg.getSteps().length !== otherLeg.getSteps().length) {\n            return false;\n        }\n\n        if (otherLeg.getTravelMode() !== leg.getTravelMode()) {\n            return false;\n          }\n\n        return leg.getSteps().every((step, stepIndex) => {\n            const otherStep = otherLeg.getSteps()[stepIndex];\n\n            return Step.compareEquals(step, otherStep);\n        });\n    }\n\n    private travelMode: TravelMode;\n    private steps: IStep[];\n\n    public constructor(travelMode: TravelMode, steps: IStep[]) {\n        this.travelMode = travelMode;\n        this.steps = steps;\n    }\n\n    public getExpectedDuration(): DurationMs {\n        return this.getAverageDuration() || this.getMinimumDuration() || this.getMaximumDuration();\n    }\n\n    public getMinimumDuration(): DurationMs {\n        return this.steps.reduce((previous, current) => {\n            return previous + current.duration.minimum;\n        }, 0);\n    }\n\n    public getAverageDuration(): DurationMs {\n        // the average of averages isn't really the average of the whole series\n        // but this will have to do\n        return this.steps.reduce((previous, current) => {\n            return previous + current.duration.average;\n        }, 0);\n    }\n\n    public getMaximumDuration(): DurationMs {\n        return this.steps.reduce((previous, current) => {\n            return previous + current.duration.maximum;\n        }, 0);\n    }\n\n    public getDistance(): DistanceM {\n        return this.steps.reduce((previous, current) => {\n            return previous + current.distance;\n        }, 0);\n    }\n\n    public getTravelMode(): TravelMode {\n        return this.travelMode;\n    }\n\n    public getSteps(): IStep[] {\n        return this.steps;\n    }\n\n    public getStartTime(): Date {\n        if (this.steps.length > 0) {\n            return this.steps[0].startTime;\n        }\n    }\n\n    public getStopTime(): Date {\n        if (this.steps.length > 0) {\n            return this.steps[this.steps.length - 1].stopTime;\n        }\n    }\n\n    public getStartLocation(): ILocation {\n        if (this.steps.length > 0) {\n            return this.steps[0].startLocation;\n        }\n    }\n\n    public getStopLocation(): ILocation {\n        if (this.steps.length > 0) {\n            return this.steps[this.steps.length - 1].stopLocation;\n        }\n    }\n}\n","import { ArrayIterator, AsyncIterator } from \"asynciterator\";\nimport { EventEmitter } from \"events\";\nimport { inject, injectable } from \"inversify\";\nimport IConnection from \"../../entities/connections/connections\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport IStep from \"../../interfaces/IStep\";\nimport { DurationMs } from \"../../interfaces/units\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Leg from \"../Leg\";\nimport Path from \"../Path\";\nimport Step from \"../Step\";\nimport IProfile from \"./CSA/data-structure/stops/IProfile\";\nimport IProfilesByStop from \"./CSA/data-structure/stops/IProfilesByStop\";\nimport ITransferProfile from \"./CSA/data-structure/stops/ITransferProfile\";\nimport ProfileUtil from \"./CSA/util/ProfileUtil\";\nimport IJourneyExtractor from \"./IJourneyExtractor\";\n\n/**\n * Creates journeys based on the profiles and query from [[CSAProfile]].\n * A journey is an [[IPath]] that consist of several [[IStep]]s.\n *\n * @property bestArrivalTime Stores the best arrival time for each pair of departure-arrival stops.\n */\n@injectable()\nexport default class JourneyExtractorProfile implements IJourneyExtractor {\n  private readonly locationResolver: ILocationResolver;\n\n  private bestArrivalTime: number[][] = [];\n  private eventBus: EventEmitter;\n\n  constructor(\n    @inject(TYPES.LocationResolver) locationResolver: ILocationResolver,\n  ) {\n    this.locationResolver = locationResolver;\n    this.eventBus = EventBus.getInstance();\n  }\n\n  public async extractJourneys(\n    profilesByStop: IProfilesByStop,\n    query: IResolvedQuery,\n  ): Promise<AsyncIterator<IPath>> {\n    const filteredProfilesByStop: IProfilesByStop = ProfileUtil.filterInfinity(profilesByStop);\n\n    const departureLocation: ILocation = query.from[0];\n    const arrivalLocation: ILocation = query.to[0];\n\n    const paths: IPath[] = [];\n\n    const departureLocationProfiles: IProfile[] = filteredProfilesByStop[departureLocation.id];\n\n    // Can't find departure stop;\n    if (!departureLocationProfiles) {\n      return new ArrayIterator<IPath>(paths);\n    }\n\n    for (const profile of departureLocationProfiles) {\n\n      for (let amountOfTransfers = 0; amountOfTransfers < profile.transferProfiles.length; amountOfTransfers++) {\n        const transferProfile: ITransferProfile = profile.transferProfiles[amountOfTransfers];\n\n        if (this.checkBestArrivalTime(transferProfile, departureLocation, arrivalLocation)) {\n          try {\n            paths.push(await this.extractJourney(\n              departureLocation,\n              arrivalLocation,\n              transferProfile,\n              amountOfTransfers,\n              filteredProfilesByStop,\n            ));\n\n            this.setBestArrivalTime(\n              departureLocation,\n              arrivalLocation,\n              transferProfile.arrivalTime,\n            );\n\n          } catch (e) {\n            if (this.eventBus) {\n              this.eventBus.emit(EventType.Warning, (e));\n            }\n          }\n        }\n      }\n    }\n\n    return new ArrayIterator<IPath>(paths.reverse());\n  }\n\n  private checkBestArrivalTime(\n    transferProfile: ITransferProfile,\n    departureLocation: ILocation,\n    arrivalLocation: ILocation,\n  ): boolean {\n    const canArrive: boolean = transferProfile.arrivalTime < Infinity;\n\n    if (!canArrive) {\n      return false;\n    }\n\n    const bestArrivalTimesOfDepartureStop: number[] = this.bestArrivalTime[departureLocation.id];\n\n    if (!bestArrivalTimesOfDepartureStop) {\n      return true;\n    }\n\n    const bestArrivalTime: number = bestArrivalTimesOfDepartureStop[arrivalLocation.id];\n\n    if (!bestArrivalTime) {\n      return true;\n    }\n\n    return transferProfile.arrivalTime < bestArrivalTime;\n  }\n\n  private setBestArrivalTime(departureLocation: ILocation, arrivalLocation: ILocation, arrivalTime: number): void {\n    if (!this.bestArrivalTime[departureLocation.id]) {\n      this.bestArrivalTime[departureLocation.id] = [];\n    }\n    this.bestArrivalTime[departureLocation.id][arrivalLocation.id] = arrivalTime;\n  }\n\n  private async extractJourney(\n    departureLocation: ILocation,\n    arrivalLocation: ILocation,\n    transferProfile: ITransferProfile,\n    transfers: number,\n    profilesByStop: IProfilesByStop,\n  ): Promise<IPath> {\n    const path: Path = Path.create();\n\n    let currentTransferProfile: ITransferProfile = transferProfile;\n    let departureTime: number = transferProfile.departureTime;\n\n    let remainingTransfers: number = transfers;\n\n    let currentLocation: ILocation = departureLocation;\n\n    while (remainingTransfers >= 0) {\n      const enterConnection: IConnection = currentTransferProfile.enterConnection;\n      const exitConnection: IConnection = currentTransferProfile.exitConnection;\n\n      const enterLocation: ILocation = await this.locationResolver.resolve(enterConnection.departureStop);\n      const exitLocation: ILocation = await this.locationResolver.resolve(exitConnection.arrivalStop);\n\n      // Initial or transfer footpath.\n      const transferDepartureTime: number = enterConnection.departureTime.getTime();\n\n      if (departureTime !== transferDepartureTime) {\n\n        let timeToSubtract: DurationMs = 0;\n        if (path.legs.length > 0) {\n          timeToSubtract = departureTime - path.legs[path.legs.length - 1].getStopTime().getTime();\n        }\n\n        const footpath: IStep = Step.create(\n          currentLocation,\n          enterLocation,\n          {\n            minimum: transferDepartureTime - departureTime,\n          },\n          new Date(departureTime - timeToSubtract),\n          new Date(transferDepartureTime - timeToSubtract),\n        );\n\n        const footpathLeg = new Leg(TravelMode.Walking, [footpath]);\n        path.appendLeg(footpathLeg);\n      }\n\n      // Public transport step.\n      const step: IStep = Step.createFromConnections(enterConnection, exitConnection);\n      step.startLocation = enterLocation;\n      step.stopLocation = exitLocation;\n\n      const leg = new Leg(exitConnection.travelMode, [step]);\n      path.appendLeg(leg);\n\n      currentLocation = exitLocation;\n      remainingTransfers--;\n\n      // Stop if we already arrived.\n      if (path.legs[path.legs.length - 1].getStopLocation().id === arrivalLocation.id) {\n        break;\n      }\n\n      // Get next profile based on the arrival time at the current location.\n      if (remainingTransfers >= 0) {\n        const currentProfiles: IProfile[] = profilesByStop[currentLocation.id];\n        let profileIndex: number = currentProfiles.length - 1;\n\n        currentTransferProfile = currentProfiles[profileIndex].transferProfiles[remainingTransfers];\n        departureTime = currentTransferProfile.departureTime;\n\n        while (profileIndex >= 0 && departureTime < exitConnection.arrivalTime.getTime()) {\n          currentTransferProfile = currentProfiles[--profileIndex].transferProfiles[remainingTransfers];\n          departureTime = currentTransferProfile.departureTime;\n        }\n\n        if (profileIndex === -1) {\n          // This should never happen.\n          return Promise.reject(\"Can't find next connection\");\n        }\n\n      }\n\n      // Final footpath.\n      if (remainingTransfers === -1) {\n        const transferArrivalTime: Date = exitConnection.arrivalTime;\n        const arrivalTime: Date = new Date(currentTransferProfile.arrivalTime);\n\n        if (arrivalTime.getTime() !== transferArrivalTime.getTime()) {\n          const footpath: IStep = Step.create(\n            currentLocation,\n            arrivalLocation,\n            {\n              minimum: arrivalTime.getTime() - transferArrivalTime.getTime(),\n            },\n            transferArrivalTime,\n            arrivalTime,\n          );\n\n          const footpathLeg = new Leg(TravelMode.Walking, [footpath]);\n          path.appendLeg(footpathLeg);\n        }\n      }\n    }\n\n    // Check if path ends in the arrival location.\n    if (path.legs[path.legs.length - 1].getStopLocation().id !== arrivalLocation.id) {\n      // This should never happen.\n      return Promise.reject(\"Can't reach arrival stop:\");\n    }\n\n    return path as IPath;\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { Delaunay } from \"d3-delaunay\";\nimport { inject, injectable } from \"inversify\";\nimport ReachableStopsFinderMode from \"../../enums/ReachableStopsFinderMode\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport IStopsProvider from \"../../fetcher/stops/IStopsProvider\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport { DurationMs, SpeedKmH } from \"../../interfaces/units\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Iterators from \"../../util/Iterators\";\nimport IRoadPlanner from \"../road/IRoadPlanner\";\nimport IReachableStopsFinder, { IReachableStop } from \"./IReachableStopsFinder\";\n\n@injectable()\nexport default class ReachableStopsFinderDelaunay implements IReachableStopsFinder {\n  private readonly stopsProvider: IStopsProvider;\n  private readonly roadPlanner: IRoadPlanner;\n  private triangles: Delaunay;\n  private trianglePoints: IStop[];\n\n  constructor(\n    @inject(TYPES.StopsProvider) stopsProvider: IStopsProvider,\n    @inject(TYPES.RoadPlanner) roadPlanner: IRoadPlanner,\n  ) {\n    this.stopsProvider = stopsProvider;\n    this.roadPlanner = roadPlanner;\n    this.prepare();\n  }\n\n  public async findReachableStops(\n    location: ILocation,\n    mode: ReachableStopsFinderMode,\n    maximumDuration: DurationMs,\n    minimumSpeed: SpeedKmH,\n    profileID: string,\n  ): Promise<IReachableStop[]> {\n\n    const minimumDepartureTime = new Date();\n    const maximumArrivalTime = new Date(minimumDepartureTime.getTime() + maximumDuration);\n\n    const baseProp = mode === ReachableStopsFinderMode.Target ? \"to\" : \"from\";\n    const otherProp = mode === ReachableStopsFinderMode.Target ? \"from\" : \"to\";\n\n    const baseQuery: IResolvedQuery = {\n      [baseProp]: [location],\n      minimumDepartureTime,\n      maximumArrivalTime,\n      minimumWalkingSpeed: minimumSpeed,\n      profileID,\n    };\n\n    const stopsNearCell: IStop[] = await this.getNearbyStops(location);\n    const reachableStops: IReachableStop[] = [];\n\n    await Promise.all(stopsNearCell.map(async (possibleTarget: IStop) => {\n      const query = Object.assign({}, baseQuery, {\n        [otherProp]: [possibleTarget as ILocation],\n      });\n\n      const pathIterator = await this.roadPlanner.plan(query);\n\n      const durationIterator: AsyncIterator<DurationMs> = pathIterator.map((path: IPath) =>\n        path.legs.reduce((totalDuration: DurationMs, step) => totalDuration + step.getAverageDuration(), 0),\n      );\n\n      const durations = await Iterators.toArray(durationIterator);\n      if (durations.length) {\n        const shortestDuration = Math.min(...durations);\n        reachableStops.push({ stop: possibleTarget, duration: shortestDuration });\n      }\n    }));\n\n    return reachableStops;\n  }\n\n  private async getNearbyStops(location: ILocation): Promise<IStop[]> {\n    const triangles = await this.triangles;\n    const cell = triangles.find(location.longitude, location.latitude);\n\n    const result = [this.trianglePoints[cell]];\n\n    // not including these for now\n    // may result in large route network queries if the stops network is sparse\n    /*\n    const neighbors = triangles.neighbors(cell);\n    for (const neighbor of neighbors) {\n      result.push(this.trianglePoints[neighbor]);\n    }\n    */\n\n    return result;\n  }\n\n  private async prepare() {\n    this.triangles = this.stopsProvider.getAllStops().then((stops) => {\n      this.trianglePoints = stops;\n\n      function getX(p: ILocation) {\n        return p.longitude;\n      }\n\n      function getY(p: ILocation) {\n        return p.latitude;\n      }\n\n      return Delaunay.from(stops, getX, getY);\n    });\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport LocationResolverError from \"../errors/LocationResolverError\";\nimport IStop from \"../fetcher/stops/IStop\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport ILocation from \"../interfaces/ILocation\";\nimport TYPES from \"../types\";\nimport ILocationResolver from \"./ILocationResolver\";\nimport LocationResolverDefault from \"./LocationResolverDefault\";\n\n/**\n * Location resolver that allows stop names as input\n * Falls back to LocationResolverDefault\n */\n@injectable()\nexport default class LocationResolverConvenience implements ILocationResolver {\n  private readonly stopsProvider: IStopsProvider;\n  private readonly defaultLocationResolver: ILocationResolver;\n\n  private allStops: IStop[];\n\n  constructor(\n    @inject(TYPES.StopsProvider) stopsProvider: IStopsProvider,\n    @inject(TYPES.RoutableTileRegistry) tileRegistry: RoutableTileRegistry,\n  ) {\n    this.stopsProvider = stopsProvider;\n    this.defaultLocationResolver = new LocationResolverDefault(this.stopsProvider, tileRegistry);\n  }\n\n  public async resolve(input: ILocation | IStop | string): Promise<ILocation> {\n    if (typeof input === \"string\" && !this.isId(input)) {\n\n      if (input.includes(\"geo:\")) {\n        const expression = /geo:([\\-0-9.]+),([\\-0-9.]+)/;\n        const result = expression.exec(input);\n\n        if (result && result.length) {\n          return {\n            latitude: parseFloat(result[1]),\n            longitude: parseFloat(result[2]),\n          };\n        }\n      }\n\n      if (!this.allStops) {\n        this.allStops = await this.stopsProvider.getAllStops();\n      }\n\n      const matchingStop = this.allStops.find((stop: IStop) => stop.name === input);\n\n      if (matchingStop) {\n        return matchingStop;\n      }\n\n      return Promise.reject(\n        new LocationResolverError(`Location \"${input}\" is a string, but not an ID and not a valid stop name`),\n      );\n    }\n\n    return this.defaultLocationResolver.resolve(input);\n  }\n\n  private isId(testString: string): boolean {\n    return testString.indexOf(\"http://\") === 0 || testString.indexOf(\"https://\") === 0;\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { inject, injectable } from \"inversify\";\nimport Catalog from \"../../Catalog\";\nimport IConnection from \"../../entities/connections/connections\";\nimport { ILinkedConnectionsPageIndex, LinkedConnectionsPage } from \"../../entities/connections/page\";\nimport TYPES, { ConnectionsFetcherFactory } from \"../../types\";\nimport BackwardConnectionIterator from \"./BackwardConnectionIterator\";\nimport ForwardConnectionIterator from \"./ForwardConnectionIterator\";\nimport IConnectionsFetcher from \"./IConnectionsFetcher\";\nimport IConnectionsIteratorOptions from \"./IConnectionsIteratorOptions\";\nimport IConnectionsProvider from \"./IConnectionsProvider\";\n\n@injectable()\nexport default class ConnectionsProviderDefault implements IConnectionsProvider {\n\n    protected fetcher: IConnectionsFetcher;\n    protected pages: ILinkedConnectionsPageIndex = {};\n    protected accessUrl: string;\n\n    constructor(\n        @inject(TYPES.ConnectionsFetcherFactory) connectionsFetcherFactory: ConnectionsFetcherFactory,\n        @inject(TYPES.Catalog) catalog: Catalog,\n    ) {\n        if (catalog.connectionsSourceConfigs.length > 1) {\n            throw (new Error(\"Use the ConnectionsProviderMerge if you have multiple connections sources\"));\n        }\n\n        const { accessUrl, travelMode } = catalog.connectionsSourceConfigs[0];\n        this.accessUrl = accessUrl;\n        this.fetcher = connectionsFetcherFactory(travelMode);\n    }\n\n    public async getByUrl(url: string): Promise<LinkedConnectionsPage> {\n        if (!this.pages[url]) {\n            this.pages[url] = this.fetcher.get(url);\n        }\n\n        return await this.pages[url];\n    }\n\n    public async getByTime(date: Date): Promise<LinkedConnectionsPage> {\n        // TODO, look up in the index -- use lower/upper bounds of each page\n        const url = this.getIdForTime(date);\n        return this.getByUrl(url);\n    }\n\n    public getIdForTime(date: Date): string {\n        return `${this.accessUrl}?departureTime=${date.toISOString()}`;\n    }\n\n    public prefetchConnections(lowerBound: Date, upperBound: Date): void {\n        // TODO\n        return;\n    }\n\n    public createIterator(options: IConnectionsIteratorOptions): AsyncIterator<IConnection> {\n        if (options.backward) {\n            const beginTime = options.upperBoundDate;\n            const beginUrl = this.getIdForTime(beginTime);\n            return new BackwardConnectionIterator(this, options, beginUrl);\n        } else {\n            const beginTime = options.lowerBoundDate;\n            const beginUrl = this.getIdForTime(beginTime);\n            return new ForwardConnectionIterator(this, options, beginUrl);\n        }\n    }\n}\n","'use strict';\n\nif (!process.version ||\n    process.version.indexOf('v0.') === 0 ||\n    process.version.indexOf('v1.') === 0 && process.version.indexOf('v1.8.') !== 0) {\n  module.exports = { nextTick: nextTick };\n} else {\n  module.exports = process\n}\n\nfunction nextTick(fn, arg1, arg2, arg3) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('\"callback\" argument must be a function');\n  }\n  var len = arguments.length;\n  var args, i;\n  switch (len) {\n  case 0:\n  case 1:\n    return process.nextTick(fn);\n  case 2:\n    return process.nextTick(function afterTickOne() {\n      fn.call(null, arg1);\n    });\n  case 3:\n    return process.nextTick(function afterTickTwo() {\n      fn.call(null, arg1, arg2);\n    });\n  case 4:\n    return process.nextTick(function afterTickThree() {\n      fn.call(null, arg1, arg2, arg3);\n    });\n  default:\n    args = new Array(len - 1);\n    i = 0;\n    while (i < args.length) {\n      args[i++] = arguments[i];\n    }\n    return process.nextTick(function afterTick() {\n      fn.apply(null, args);\n    });\n  }\n}\n\n","/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {isKeyword} = require('./context');\nconst graphTypes = require('./graphTypes');\nconst types = require('./types');\nconst util = require('./util');\nconst JsonLdError = require('./JsonLdError');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Creates a merged JSON-LD node map (node ID => node).\n *\n * @param input the expanded JSON-LD to create a node map of.\n * @param [options] the options to use:\n *          [issuer] a jsonld.IdentifierIssuer to use to label blank nodes.\n *\n * @return the node map.\n */\napi.createMergedNodeMap = (input, options) => {\n  options = options || {};\n\n  // produce a map of all subjects and name each bnode\n  const issuer = options.issuer || new util.IdentifierIssuer('_:b');\n  const graphs = {'@default': {}};\n  api.createNodeMap(input, graphs, '@default', issuer);\n\n  // add all non-default graphs to default graph\n  return api.mergeNodeMaps(graphs);\n};\n\n/**\n * Recursively flattens the subjects in the given JSON-LD expanded input\n * into a node map.\n *\n * @param input the JSON-LD expanded input.\n * @param graphs a map of graph name to subject map.\n * @param graph the name of the current graph.\n * @param issuer the blank node identifier issuer.\n * @param name the name assigned to the current input if it is a bnode.\n * @param list the list to append to, null for none.\n */\napi.createNodeMap = (input, graphs, graph, issuer, name, list) => {\n  // recurse through array\n  if(types.isArray(input)) {\n    for(let i = 0; i < input.length; ++i) {\n      api.createNodeMap(input[i], graphs, graph, issuer, undefined, list);\n    }\n    return;\n  }\n\n  // add non-object to list\n  if(!types.isObject(input)) {\n    if(list) {\n      list.push(input);\n    }\n    return;\n  }\n\n  // add values to list\n  if(graphTypes.isValue(input)) {\n    if('@type' in input) {\n      let type = input['@type'];\n      // rename @type blank node\n      if(type.indexOf('_:') === 0) {\n        input['@type'] = type = issuer.getId(type);\n      }\n    }\n    if(list) {\n      list.push(input);\n    }\n    return;\n  }\n\n  // Note: At this point, input must be a subject.\n\n  // spec requires @type to be named first, so assign names early\n  if('@type' in input) {\n    const types = input['@type'];\n    for(let i = 0; i < types.length; ++i) {\n      const type = types[i];\n      if(type.indexOf('_:') === 0) {\n        issuer.getId(type);\n      }\n    }\n  }\n\n  // get name for subject\n  if(types.isUndefined(name)) {\n    name = graphTypes.isBlankNode(input) ?\n      issuer.getId(input['@id']) : input['@id'];\n  }\n\n  // add subject reference to list\n  if(list) {\n    list.push({'@id': name});\n  }\n\n  // create new subject or merge into existing one\n  const subjects = graphs[graph];\n  const subject = subjects[name] = subjects[name] || {};\n  subject['@id'] = name;\n  const properties = Object.keys(input).sort();\n  for(let pi = 0; pi < properties.length; ++pi) {\n    let property = properties[pi];\n\n    // skip @id\n    if(property === '@id') {\n      continue;\n    }\n\n    // handle reverse properties\n    if(property === '@reverse') {\n      const referencedNode = {'@id': name};\n      const reverseMap = input['@reverse'];\n      for(const reverseProperty in reverseMap) {\n        const items = reverseMap[reverseProperty];\n        for(let ii = 0; ii < items.length; ++ii) {\n          const item = items[ii];\n          let itemName = item['@id'];\n          if(graphTypes.isBlankNode(item)) {\n            itemName = issuer.getId(itemName);\n          }\n          api.createNodeMap(item, graphs, graph, issuer, itemName);\n          util.addValue(\n            subjects[itemName], reverseProperty, referencedNode,\n            {propertyIsArray: true, allowDuplicate: false});\n        }\n      }\n      continue;\n    }\n\n    // recurse into graph\n    if(property === '@graph') {\n      // add graph subjects map entry\n      if(!(name in graphs)) {\n        graphs[name] = {};\n      }\n      api.createNodeMap(input[property], graphs, name, issuer);\n      continue;\n    }\n\n    // copy non-@type keywords\n    if(property !== '@type' && isKeyword(property)) {\n      if(property === '@index' && property in subject &&\n        (input[property] !== subject[property] ||\n        input[property]['@id'] !== subject[property]['@id'])) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; conflicting @index property detected.',\n          'jsonld.SyntaxError',\n          {code: 'conflicting indexes', subject});\n      }\n      subject[property] = input[property];\n      continue;\n    }\n\n    // iterate over objects\n    const objects = input[property];\n\n    // if property is a bnode, assign it a new id\n    if(property.indexOf('_:') === 0) {\n      property = issuer.getId(property);\n    }\n\n    // ensure property is added for empty arrays\n    if(objects.length === 0) {\n      util.addValue(subject, property, [], {propertyIsArray: true});\n      continue;\n    }\n    for(let oi = 0; oi < objects.length; ++oi) {\n      let o = objects[oi];\n\n      if(property === '@type') {\n        // rename @type blank nodes\n        o = (o.indexOf('_:') === 0) ? issuer.getId(o) : o;\n      }\n\n      // handle embedded subject or subject reference\n      if(graphTypes.isSubject(o) || graphTypes.isSubjectReference(o)) {\n        // relabel blank node @id\n        const id = graphTypes.isBlankNode(o) ?\n          issuer.getId(o['@id']) : o['@id'];\n\n        // add reference and recurse\n        util.addValue(\n          subject, property, {'@id': id},\n          {propertyIsArray: true, allowDuplicate: false});\n        api.createNodeMap(o, graphs, graph, issuer, id);\n      } else if(graphTypes.isList(o)) {\n        // handle @list\n        const _list = [];\n        api.createNodeMap(o['@list'], graphs, graph, issuer, name, _list);\n        o = {'@list': _list};\n        util.addValue(\n          subject, property, o,\n          {propertyIsArray: true, allowDuplicate: false});\n      } else {\n        // handle @value\n        api.createNodeMap(o, graphs, graph, issuer, name);\n        util.addValue(\n          subject, property, o, {propertyIsArray: true, allowDuplicate: false});\n      }\n    }\n  }\n};\n\n/**\n * Merge separate named graphs into a single merged graph including\n * all nodes from the default graph and named graphs.\n *\n * @param graphs a map of graph name to subject map.\n *\n * @return the merged graph map.\n */\napi.mergeNodeMapGraphs = graphs => {\n  const merged = {};\n  for(const name of Object.keys(graphs).sort()) {\n    for(const id of Object.keys(graphs[name]).sort()) {\n      const node = graphs[name][id];\n      if(!(id in merged)) {\n        merged[id] = {'@id': id};\n      }\n      const mergedNode = merged[id];\n\n      for(const property of Object.keys(node).sort()) {\n        if(isKeyword(property)) {\n          // copy keywords\n          mergedNode[property] = util.clone(node[property]);\n        } else {\n          // merge objects\n          for(const value of node[property]) {\n            util.addValue(\n              mergedNode, property, util.clone(value),\n              {propertyIsArray: true, allowDuplicate: false});\n          }\n        }\n      }\n    }\n  }\n\n  return merged;\n};\n\napi.mergeNodeMaps = graphs => {\n  // add all non-default graphs to default graph\n  const defaultGraph = graphs['@default'];\n  const graphNames = Object.keys(graphs).sort();\n  for(let i = 0; i < graphNames.length; ++i) {\n    const graphName = graphNames[i];\n    if(graphName === '@default') {\n      continue;\n    }\n    const nodeMap = graphs[graphName];\n    let subject = defaultGraph[graphName];\n    if(!subject) {\n      defaultGraph[graphName] = subject = {\n        '@id': graphName,\n        '@graph': []\n      };\n    } else if(!('@graph' in subject)) {\n      subject['@graph'] = [];\n    }\n    const graph = subject['@graph'];\n    const ids = Object.keys(nodeMap).sort();\n    for(let ii = 0; ii < ids.length; ++ii) {\n      const node = nodeMap[ids[ii]];\n      // only add full subjects\n      if(!graphTypes.isSubjectReference(node)) {\n        graph.push(node);\n      }\n    }\n  }\n  return defaultGraph;\n};\n","interface IEdge {\n    node: number;\n    distance: number;\n    duration: number;\n    cost: number;\n}\n\ninterface INodeMap {\n    [label: string]: number;\n}\n\ninterface IBreakPointIndex {\n    [position: number]: (on: string) => Promise<void>;\n}\n\nexport default class PathfindingGraph {\n    private id: string;\n    private nodes: Map<string, number>;\n    private labels: string[];\n    private adjacencyList: IEdge[][];\n    private reverseAdjacencyList: IEdge[][];\n    private breakPoints: IBreakPointIndex;\n\n    constructor(id: string) {\n        this.nodes = new Map();\n        this.labels = [];\n        this.adjacencyList = [];\n        this.reverseAdjacencyList = [];\n        this.id = id;\n        this.breakPoints = {};\n    }\n\n    public addEdge(from: string, to: string, distance: number, duration: number, cost: number) {\n        const fromIndex = this.getNodeIndex(from);\n        const toIndex = this.getNodeIndex(to);\n        this.adjacencyList[fromIndex].push({ node: toIndex, distance, cost, duration });\n        this.reverseAdjacencyList[toIndex].push({ node: fromIndex, distance, cost, duration });\n    }\n\n    public getNodeMap() {\n        return this.nodes;\n    }\n\n    public getLabel(position: number) {\n        return this.labels[position];\n    }\n\n    public getAdjacencyList() {\n        return this.adjacencyList;\n    }\n\n    public getReverseAdjacencyList() {\n        return this.reverseAdjacencyList;\n    }\n\n    public getNodeIndex(label: string) {\n        if (!this.nodes.has(label)) {\n            const index = this.adjacencyList.length;\n            this.nodes.set(label, index);\n            this.labels.push(label);\n            this.adjacencyList.push([]);\n            this.reverseAdjacencyList.push([]);\n        }\n\n        return this.nodes.get(label);\n    }\n\n    public setBreakPoint(on: string, callback: (on: string) => Promise<void>): void {\n        const position = this.getNodeIndex(on);\n        this.breakPoints[position] = callback;\n    }\n\n    public getBreakPoint(position: number): (on: string) => Promise<void> {\n        return this.breakPoints[position];\n    }\n\n    public removeBreakPoint(on: string): void {\n        const position = this.getNodeIndex(on);\n        delete this.breakPoints[position];\n    }\n}\n","\nexport default class TinyQueue {\n    constructor(data = [], compare = defaultCompare) {\n        this.data = data;\n        this.length = this.data.length;\n        this.compare = compare;\n\n        if (this.length > 0) {\n            for (let i = (this.length >> 1) - 1; i >= 0; i--) this._down(i);\n        }\n    }\n\n    push(item) {\n        this.data.push(item);\n        this.length++;\n        this._up(this.length - 1);\n    }\n\n    pop() {\n        if (this.length === 0) return undefined;\n\n        const top = this.data[0];\n        const bottom = this.data.pop();\n        this.length--;\n\n        if (this.length > 0) {\n            this.data[0] = bottom;\n            this._down(0);\n        }\n\n        return top;\n    }\n\n    peek() {\n        return this.data[0];\n    }\n\n    _up(pos) {\n        const {data, compare} = this;\n        const item = data[pos];\n\n        while (pos > 0) {\n            const parent = (pos - 1) >> 1;\n            const current = data[parent];\n            if (compare(item, current) >= 0) break;\n            data[pos] = current;\n            pos = parent;\n        }\n\n        data[pos] = item;\n    }\n\n    _down(pos) {\n        const {data, compare} = this;\n        const halfLength = this.length >> 1;\n        const item = data[pos];\n\n        while (pos < halfLength) {\n            let left = (pos << 1) + 1;\n            let best = data[left];\n            const right = left + 1;\n\n            if (right < this.length && compare(data[right], best) < 0) {\n                left = right;\n                best = data[right];\n            }\n            if (compare(best, item) >= 0) break;\n\n            data[pos] = best;\n            pos = left;\n        }\n\n        data[pos] = item;\n    }\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n","import { ArrayIterator, AsyncIterator } from \"asynciterator\";\nimport { EventEmitter } from \"events\";\nimport { inject, injectable, tagged } from \"inversify\";\nimport inBBox from \"tiles-in-bbox\";\nimport Profile from \"../../entities/profile/Profile\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport RoutingPhase from \"../../enums/RoutingPhase\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IProfileProvider from \"../../fetcher/profiles/IProfileProvider\";\nimport IRoutableTileProvider from \"../../fetcher/tiles/IRoutableTileProvider\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport IStep from \"../../interfaces/IStep\";\nimport PathfinderProvider from \"../../pathfinding/PathfinderProvider\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Geo from \"../../util/Geo\";\nimport { toTileCoordinate } from \"../../util/Tiles\";\nimport Leg from \"../Leg\";\nimport Path from \"../Path\";\nimport IRoadPlanner from \"./IRoadPlanner\";\n\n@injectable()\nexport default class RoadPlannerPathfinding implements IRoadPlanner {\n    private tileProvider: IRoutableTileProvider;\n    private pathfinderProvider: PathfinderProvider;\n    private profileProvider: IProfileProvider;\n    private locationResolver: ILocationResolver;\n    private registry: RoutableTileRegistry;\n    private eventBus: EventEmitter;\n\n    private reachedTiles: Set<string>;\n\n    constructor(\n        @inject(TYPES.RoutableTileProvider)\n        @tagged(\"phase\", RoutingPhase.Base)\n        tileProvider: IRoutableTileProvider,\n        @inject(TYPES.PathfinderProvider) pathfinderProvider: PathfinderProvider,\n        @inject(TYPES.ProfileProvider) profileProvider: IProfileProvider,\n        @inject(TYPES.LocationResolver) locationResolver: ILocationResolver,\n        @inject(TYPES.RoutableTileRegistry) registry: RoutableTileRegistry,\n    ) {\n        this.tileProvider = tileProvider;\n        this.pathfinderProvider = pathfinderProvider;\n        this.profileProvider = profileProvider;\n        this.locationResolver = locationResolver;\n        this.registry = registry;\n        this.eventBus = EventBus.getInstance();\n        this.reachedTiles = new Set();\n    }\n\n    public async plan(query: IResolvedQuery): Promise<AsyncIterator<IPath>> {\n        const {\n            from: fromLocations,\n            to: toLocations,\n            profileID,\n        } = query;\n\n        const paths = [];\n        const profile = await this.profileProvider.getProfile(profileID);\n\n        if (fromLocations && toLocations && fromLocations.length && toLocations.length) {\n\n            for (const from of fromLocations) {\n                for (const to of toLocations) {\n\n                    const newPath = await this.getPathBetweenLocations(\n                        from,\n                        to,\n                        profile,\n                    );\n\n                    if (newPath) {\n                        paths.push(newPath);\n                    }\n                }\n            }\n        }\n\n        return new ArrayIterator<IPath>(paths);\n    }\n\n    private async getPathBetweenLocations(\n        from: ILocation,\n        to: ILocation,\n        profile: Profile,\n    ): Promise<IPath> {\n\n        await Promise.all([\n            this.embedLocation(from),\n            this.embedLocation(to, true),\n        ]);\n\n        return this._innerPath(from, to, profile);\n    }\n\n    private async _innerPath(\n        start: ILocation,\n        stop: ILocation,\n        profile: Profile,\n    ): Promise<IPath> {\n        const pathfinder = await this.pathfinderProvider.getShortestPathAlgorithm(profile);\n        const maxDistance = Geo.getDistanceBetweenLocations(start, stop) * 10 + 1000;\n        const path = await pathfinder.queryPath(Geo.getId(start), Geo.getId(stop), maxDistance);\n\n        const steps: IStep[] = [];\n        for (const step of path) {\n            const to = await this.locationResolver.resolve(step.to);\n            const from = await this.locationResolver.resolve(step.from);\n            steps.push({\n                startLocation: from,\n                stopLocation: to,\n                duration: { average: step.duration },\n                distance: step.distance,\n            });\n        }\n\n        const leg = new Leg(TravelMode.Profile, steps);\n        return new Path([leg]);\n    }\n\n    private async fetchTile(coordinate: RoutableTileCoordinate) {\n        const tileId = this.tileProvider.getIdForTileCoords(coordinate);\n        if (!this.reachedTiles.has(tileId)) {\n            this.eventBus.emit(EventType.FetchTile, coordinate);\n            const tile = await this.tileProvider.getByTileCoords(coordinate);\n            this.reachedTiles.add(tileId);\n            const boundaryNodes: Set<string> = new Set();\n\n            for (const nodeId of tile.getNodes()) {\n                const node = this.registry.getNode(nodeId);\n                if (!tile.contains(node)) {\n                    boundaryNodes.add(nodeId);\n                }\n            }\n\n            const self = this;\n            for (const profile of await this.profileProvider.getProfiles()) {\n                const pathfinder = this.pathfinderProvider.getShortestPathAlgorithm(profile);\n\n                for (const nodeId of boundaryNodes) {\n                    pathfinder.setBreakPoint(nodeId, async (on: string) => {\n                        const node = self.registry.getNode(on);\n                        const boundaryTileCoordinate = toTileCoordinate(node.latitude, node.longitude);\n                        await self.fetchTile(boundaryTileCoordinate);\n                    });\n                }\n            }\n        }\n    }\n\n    private async embedLocation(from: ILocation, invert = false) {\n        const zoom = 14;\n        const padding = 0.005;\n\n        const fromBBox = {\n            top: from.latitude + padding,\n            bottom: from.latitude - padding,\n            left: from.longitude - padding,\n            right: from.longitude + padding,\n        };\n\n        const fromTileCoords = inBBox.tilesInBbox(fromBBox, zoom).map((obj) => {\n            const coordinate = new RoutableTileCoordinate(zoom, obj.x, obj.y);\n            this.fetchTile(coordinate);\n            return coordinate;\n        });\n\n        // this won't download anything new\n        // but we need the tile data to embed the starting location\n        const fromTileset = await this.tileProvider.getMultipleByTileCoords(fromTileCoords);\n        await this.pathfinderProvider.embedLocation(from, fromTileset, invert);\n    }\n}\n","import { inject, injectable } from \"inversify\";\nimport LDFetch from \"ldfetch\";\nimport { EventType } from \"../..\";\nimport EventBus from \"../../events/EventBus\";\nimport TYPES from \"../../types\";\nimport IStop from \"./IStop\";\nimport IStopsFetcher from \"./IStopsFetcher\";\n\ninterface IPartialStopMap {\n    [stopId: string]: Partial<IStop>;\n}\n\ninterface IStopMap {\n    [stopId: string]: IStop;\n}\n\n@injectable()\n// tslint:disable: no-string-literal\nexport default class StopsFetcherRaw implements IStopsFetcher {\n\n    private accessUrl: string;\n\n    private ldFetch: LDFetch;\n    private loadPromise: Promise<any>;\n    private stops: IStopMap;\n\n    constructor(\n        @inject(TYPES.LDFetch) ldFetch: LDFetch,\n    ) {\n        this.ldFetch = ldFetch;\n    }\n\n    public setAccessUrl(accessUrl: string) {\n        this.accessUrl = accessUrl;\n    }\n\n    public prefetchStops(): void {\n        this.ensureStopsLoaded();\n    }\n\n    public async getStopById(stopId: string): Promise<IStop> {\n        await this.ensureStopsLoaded();\n\n        return this.stops[stopId];\n    }\n\n    public async getAllStops(): Promise<IStop[]> {\n        await this.ensureStopsLoaded();\n\n        return Object.values(this.stops);\n    }\n\n    private async ensureStopsLoaded() {\n        if (!this.loadPromise && !this.stops) {\n            this.loadStops();\n        }\n\n        if (this.loadPromise) {\n            await this.loadPromise;\n        }\n    }\n\n    private loadStops() {\n        this.loadPromise = this.getByUrl(this.accessUrl)\n            .then((stops) => {\n                this.stops = stops;\n                this.loadPromise = null;\n            })\n            .catch((reason) => {\n                console.log(reason);\n            });\n    }\n\n    private async getByUrl(url: string): Promise<IStopMap> {\n        const beginTime = new Date();\n\n        const response = await fetch(url);\n        const responseText = await response.text();\n\n        const stops: IStopMap = {};\n\n        if (response.status !== 200) {\n            EventBus.getInstance().emit(EventType.Warning, `${url} responded with status code ${response.status}`);\n        }\n\n        if (response.status === 200 && responseText) {\n            const blob = JSON.parse(responseText);\n\n            for (const entity of blob[\"@graph\"]) {\n                const id = entity[\"@id\"];\n                const latitudeRaw = entity[\"http://www.w3.org/2003/01/geo/wgs84_pos#lat\"] || entity[\"latitude\"];\n                const longitudeRaw = entity[\"http://www.w3.org/2003/01/geo/wgs84_pos#long\"] || entity[\"longitude\"];\n                const stopTimeRaw = entity[\"avgStopTimes\"] || 0;\n                const stop: IStop = {\n                    id: entity[\"@id\"],\n                    latitude: parseFloat(latitudeRaw),\n                    longitude: parseFloat(longitudeRaw),\n                    name: entity[\"name\"],\n                    avgStopTimes: parseFloat(stopTimeRaw) * 1000,\n                };\n                stops[id] = stop;\n            }\n        }\n\n        const duration = (new Date()).getTime() - beginTime.getTime();\n        EventBus.getInstance().emit(EventType.LDFetchGet, url, duration);\n\n        return stops;\n    }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { PromiseProxyIterator } from \"asynciterator-promiseproxy\";\nimport { EventEmitter } from \"events\";\nimport Context from \"../../Context\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IConnectionsProvider from \"../../fetcher/connections/IConnectionsProvider\";\nimport ProfileProvider from \"../../fetcher/profiles/ProfileProviderDefault\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport IStopsProvider from \"../../fetcher/stops/IStopsProvider\";\nimport IPath from \"../../interfaces/IPath\";\nimport IQuery from \"../../interfaces/IQuery\";\nimport defaultContainer from \"../../inversify.config\";\nimport IQueryRunner from \"../../query-runner/IQueryRunner\";\nimport TYPES from \"../../types\";\nimport Iterators from \"../../util/Iterators\";\nimport Units from \"../../util/Units\";\nimport Path from \"../Path\";\nimport IRoadPlanner from \"../road/IRoadPlanner\";\n\n/**\n * Allows to ask route planning queries. Emits events defined in [[EventType]]\n */\nexport default abstract class Planner {\n  public static Units = Units;\n\n  private activeProfileID: string;\n  private context: Context;\n  private eventBus: EventEmitter;\n  private queryRunner: IQueryRunner;\n  private profileProvider: ProfileProvider;\n  private roadPlanner: IRoadPlanner;\n\n  /**\n   * Initializes a new Planner\n   * @param container The container of dependencies we are working with\n   */\n  constructor(container = defaultContainer) {\n    // Store container on context before doing anything else\n    this.context = container.get<Context>(TYPES.Context);\n    this.context.setContainer(container);\n\n    this.queryRunner = container.get<IQueryRunner>(TYPES.QueryRunner);\n    this.profileProvider = container.get<ProfileProvider>(TYPES.ProfileProvider);\n    this.eventBus = EventBus.getInstance();\n    this.roadPlanner = container.get<IRoadPlanner>(TYPES.RoadPlanner);\n\n    this.activeProfileID = \"https://hdelva.be/profile/pedestrian\";\n  }\n\n  public async completePath(path: IPath): Promise<IPath> {\n    const completePath = Path.create();\n\n    let walkingDeparture;\n    let walkingDestination;\n\n    for (const leg of path.legs) {\n      if (leg.getTravelMode() === TravelMode.Walking) {\n        if (!walkingDeparture) {\n          walkingDeparture = leg.getStartLocation();\n        }\n        walkingDestination = leg.getStopLocation();\n      } else {\n        if (walkingDestination) {\n          const walkingPathIterator = await this.roadPlanner.plan({\n            from: [walkingDeparture],\n            to: [walkingDestination],\n            profileID: this.activeProfileID,\n          });\n          const walkingPaths = await Iterators.toArray(walkingPathIterator);\n          for (const walkingLeg of walkingPaths[0].legs) {\n            completePath.appendLeg(walkingLeg);\n          }\n\n          walkingDeparture = null;\n          walkingDestination = null;\n        }\n\n        completePath.appendLeg(leg);\n      }\n    }\n\n    if (walkingDestination) {\n      const walkingPathIterator = await this.roadPlanner.plan({\n        from: [walkingDeparture],\n        to: [walkingDestination],\n        profileID: this.activeProfileID,\n      });\n      const walkingPaths = await Iterators.toArray(walkingPathIterator);\n      for (const walkingLeg of walkingPaths[0].legs) {\n        completePath.appendLeg(walkingLeg);\n      }\n\n      walkingDeparture = null;\n      walkingDestination = null;\n    }\n\n    return completePath;\n  }\n\n  /**\n   * Given an [[IQuery]], it will evaluate the query and return a promise for an AsyncIterator of [[IPath]] instances\n   * @param query An [[IQuery]] specifying a route planning query\n   * @returns An [[AsyncIterator]] of [[IPath]] instances\n   */\n  public query(query: IQuery): AsyncIterator<IPath> {\n    this.eventBus.emit(EventType.Query, query);\n\n    query.profileID = this.activeProfileID;\n    const iterator = new PromiseProxyIterator(() => this.queryRunner.run(query));\n\n    this.eventBus.once(EventType.AbortQuery, () => {\n      iterator.close();\n    });\n\n    iterator.on(\"error\", (e) => {\n      if (e && e.eventType) {\n        this.eventBus.emit(e.eventType, e.message);\n      }\n    });\n\n    return iterator;\n  }\n\n  public prefetchStops(): void {\n    const container = this.context.getContainer();\n    const stopsProvider = container.get<IStopsProvider>(TYPES.StopsProvider);\n\n    if (stopsProvider) {\n      stopsProvider.prefetchStops();\n    }\n  }\n\n  public prefetchConnections(from: Date, to: Date): void {\n    // TODO, get rid of service locator anti-pattern\n    const container = this.context.getContainer();\n    const connectionsProvider = container.get<IConnectionsProvider>(TYPES.ConnectionsProvider);\n    connectionsProvider.prefetchConnections(from, to);\n  }\n\n  public async setDevelopmentProfile(blob: object) {\n    const profileID = await this.profileProvider.parseDevelopmentProfile(blob);\n    return this.setProfileID(profileID);\n  }\n\n  public setProfileID(profileID: string) {\n    this.activeProfileID = profileID;\n    return this;\n  }\n\n  public getAllStops(): Promise<IStop[]> {\n    // fixme, why is this here?\n    // is this just for visualizations?\n    const container = this.context.getContainer();\n    const stopsProvider = container.get<IStopsProvider>(TYPES.StopsProvider);\n\n    if (stopsProvider) {\n      return stopsProvider.getAllStops();\n    }\n\n    return Promise.reject();\n  }\n\n}\n","function lonToX(lon, zoom) {\n\n    var n = Math.pow(2, zoom)\n    var x = Math.floor( (lon + 180) / 360 * n )\n\n    return (x)\n}\n\nfunction latToY(lat, zoom) {\n\n    var lat_rad = lat * Math.PI / 180\n    var n = Math.pow(2, zoom)\n    var y = Math.floor((1 - Math.log(Math.tan(lat_rad) + 1 / Math.cos(lat_rad)) / Math.PI) / 2 * n)\n\n    return (y)\n}\n\nexports.tilesInBbox = function(bbox, zoom) {\n\n    var tiles = []\n\n    var xMin = lonToX(bbox.left, zoom)\n    var xMax = lonToX(bbox.right, zoom)\n    var yMin = latToY(bbox.top, zoom)\n    var yMax = latToY(bbox.bottom, zoom)\n\n    var i = xMin\n    while (i <= xMax) {\n        var j = yMin\n        while (j <= yMax) {\n            tiles.push({ x : i, y : j, z : zoom })\n            j++\n        }\n        i++\n    }\n\n    return (tiles)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingOnSyntax = (function () {\n    function BindingOnSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingOnSyntax.prototype.onActivation = function (handler) {\n        this._binding.onActivation = handler;\n        return new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n    };\n    return BindingOnSyntax;\n}());\nexports.BindingOnSyntax = BindingOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar constraint_helpers_1 = require(\"./constraint_helpers\");\nvar BindingWhenSyntax = (function () {\n    function BindingWhenSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingWhenSyntax.prototype.when = function (constraint) {\n        this._binding.constraint = constraint;\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetNamed = function (name) {\n        this._binding.constraint = constraint_helpers_1.namedConstraint(name);\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetIsDefault = function () {\n        this._binding.constraint = function (request) {\n            var targetIsDefault = (request.target !== null) &&\n                (!request.target.isNamed()) &&\n                (!request.target.isTagged());\n            return targetIsDefault;\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetTagged = function (tag, value) {\n        this._binding.constraint = constraint_helpers_1.taggedConstraint(tag)(value);\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenInjectedInto = function (parent) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.typeConstraint(parent)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.namedConstraint(name)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.taggedConstraint(tag)(value)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.typeConstraint(ancestor));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.typeConstraint(ancestor));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.namedConstraint(name));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.namedConstraint(name));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.taggedConstraint(tag)(value));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.taggedConstraint(tag)(value));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    return BindingWhenSyntax;\n}());\nexports.BindingWhenSyntax = BindingWhenSyntax;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","/**\n * A JavaScript implementation of the JSON-LD API.\n *\n * @author Dave Longley\n *\n * @license BSD 3-Clause License\n * Copyright (c) 2011-2017 Digital Bazaar, Inc.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * Redistributions of source code must retain the above copyright notice,\n * this list of conditions and the following disclaimer.\n *\n * Redistributions in binary form must reproduce the above copyright\n * notice, this list of conditions and the following disclaimer in the\n * documentation and/or other materials provided with the distribution.\n *\n * Neither the name of the Digital Bazaar, Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n * IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED\n * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A\n * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED\n * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\nconst canonize = require('rdf-canonize');\nconst util = require('./util');\nconst IdentifierIssuer = util.IdentifierIssuer;\nconst JsonLdError = require('./JsonLdError');\nconst NQuads = require('./NQuads');\nconst Rdfa = require('./Rdfa');\n\nconst {expand: _expand} = require('./expand');\nconst {flatten: _flatten} = require('./flatten');\nconst {fromRDF: _fromRDF} = require('./fromRdf');\nconst {toRDF: _toRDF} = require('./toRdf');\n\nconst {\n  frameMergedOrDefault: _frameMergedOrDefault\n} = require('./frame');\n\nconst {\n  isArray: _isArray,\n  isObject: _isObject,\n  isString: _isString\n} = require('./types');\n\nconst {\n  isSubjectReference: _isSubjectReference,\n} = require('./graphTypes');\n\nconst {\n  getInitialContext: _getInitialContext,\n  process: _processContext,\n  getAllContexts: _getAllContexts\n} = require('./context');\n\nconst {\n  compact: _compact,\n  compactIri: _compactIri,\n  removePreserve: _removePreserve\n} = require('./compact');\n\nconst {\n  createNodeMap: _createNodeMap,\n  createMergedNodeMap: _createMergedNodeMap,\n  mergeNodeMaps: _mergeNodeMaps\n} = require('./nodeMap');\n\n// determine if in-browser or using node.js\nconst _nodejs = (\n  typeof process !== 'undefined' && process.versions && process.versions.node);\nconst _browser = !_nodejs &&\n  (typeof window !== 'undefined' || typeof self !== 'undefined');\n\n/* eslint-disable indent */\n// attaches jsonld API to the given object\nconst wrapper = function(jsonld) {\n\n/* Core API */\n\n/**\n * Performs JSON-LD compaction.\n *\n * @param input the JSON-LD input to compact.\n * @param ctx the context to compact with.\n * @param [options] options to use:\n *          [base] the base IRI to use.\n *          [compactArrays] true to compact arrays to single values when\n *            appropriate, false not to (default: true).\n *          [compactToRelative] true to compact IRIs to be relative to document\n *            base, false to keep absolute (default: true)\n *          [graph] true to always output a top-level graph (default: false).\n *          [expandContext] a context to expand with.\n *          [skipExpansion] true to assume the input is expanded and skip\n *            expansion, false not to, defaults to false.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n *          [expansionMap(info)] a function that can be used to custom map\n *            unmappable values (or to throw an error when they are detected);\n *            if this function returns `undefined` then the default behavior\n *            will be used.\n *          [framing] true if compaction is occuring during a framing operation.\n *          [compactionMap(info)] a function that can be used to custom map\n *            unmappable values (or to throw an error when they are detected);\n *            if this function returns `undefined` then the default behavior\n *            will be used.\n * @param [callback(err, compacted)] called once the operation completes.\n *\n * @return a Promise that resolves to the compacted output.\n */\njsonld.compact = util.callbackify(async function(input, ctx, options) {\n  if(arguments.length < 2) {\n    throw new TypeError('Could not compact, too few arguments.');\n  }\n\n  if(ctx === null) {\n    throw new JsonLdError(\n      'The compaction context must not be null.',\n      'jsonld.CompactError', {code: 'invalid local context'});\n  }\n\n  // nothing to compact\n  if(input === null) {\n    return null;\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : '',\n    compactArrays: true,\n    compactToRelative: true,\n    graph: false,\n    skipExpansion: false,\n    link: false,\n    issuer: new IdentifierIssuer('_:b')\n  });\n  if(options.link) {\n    // force skip expansion when linking, \"link\" is not part of the public\n    // API, it should only be called from framing\n    options.skipExpansion = true;\n  }\n  if(!options.compactToRelative) {\n    delete options.base;\n  }\n\n  // expand input\n  let expanded;\n  if(options.skipExpansion) {\n    expanded = input;\n  } else {\n    expanded = await jsonld.expand(input, options);\n  }\n\n  // process context\n  const activeCtx = await jsonld.processContext(\n    _getInitialContext(options), ctx, options);\n\n  // do compaction\n  let compacted = _compact({\n    activeCtx,\n    element: expanded,\n    options,\n    compactionMap: options.compactionMap\n  });\n\n  // perform clean up\n  if(options.compactArrays && !options.graph && _isArray(compacted)) {\n    if(compacted.length === 1) {\n      // simplify to a single item\n      compacted = compacted[0];\n    } else if(compacted.length === 0) {\n      // simplify to an empty object\n      compacted = {};\n    }\n  } else if(options.graph && _isObject(compacted)) {\n    // always use array if graph option is on\n    compacted = [compacted];\n  }\n\n  // follow @context key\n  if(_isObject(ctx) && '@context' in ctx) {\n    ctx = ctx['@context'];\n  }\n\n  // build output context\n  ctx = util.clone(ctx);\n  if(!_isArray(ctx)) {\n    ctx = [ctx];\n  }\n  // remove empty contexts\n  const tmp = ctx;\n  ctx = [];\n  for(let i = 0; i < tmp.length; ++i) {\n    if(!_isObject(tmp[i]) || Object.keys(tmp[i]).length > 0) {\n      ctx.push(tmp[i]);\n    }\n  }\n\n  // remove array if only one context\n  const hasContext = (ctx.length > 0);\n  if(ctx.length === 1) {\n    ctx = ctx[0];\n  }\n\n  // add context and/or @graph\n  if(_isArray(compacted)) {\n    // use '@graph' keyword\n    const graphAlias = _compactIri({\n      activeCtx, iri: '@graph', relativeTo: {vocab: true}\n    });\n    const graph = compacted;\n    compacted = {};\n    if(hasContext) {\n      compacted['@context'] = ctx;\n    }\n    compacted[graphAlias] = graph;\n  } else if(_isObject(compacted) && hasContext) {\n    // reorder keys so @context is first\n    const graph = compacted;\n    compacted = {'@context': ctx};\n    for(const key in graph) {\n      compacted[key] = graph[key];\n    }\n  }\n\n  if(options.framing) {\n    // get graph alias\n    const graph = _compactIri({\n      activeCtx, iri: '@graph', relativeTo: {vocab: true}\n    });\n    // remove @preserve from results\n    options.link = {};\n    compacted[graph] = _removePreserve(activeCtx, compacted[graph], options);\n  }\n\n  return compacted;\n});\n\n/**\n * Performs JSON-LD expansion.\n *\n * @param input the JSON-LD input to expand.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [keepFreeFloatingNodes] true to keep free-floating nodes,\n *            false not to, defaults to false.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n *          [expansionMap(info)] a function that can be used to custom map\n *            unmappable values (or to throw an error when they are detected);\n *            if this function returns `undefined` then the default behavior\n *            will be used.\n * @param [callback(err, expanded)] called once the operation completes.\n *\n * @return a Promise that resolves to the expanded output.\n */\njsonld.expand = util.callbackify(async function(input, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not expand, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    keepFreeFloatingNodes: false\n  });\n  if(options.expansionMap === false) {\n    options.expansionMap = undefined;\n  }\n\n  // build set of objects that may have @contexts to resolve\n  const toResolve = {};\n\n  // build set of contexts to process prior to expansion\n  const contextsToProcess = [];\n\n  // if an `expandContext` has been given ensure it gets resolved\n  if('expandContext' in options) {\n    const expandContext = util.clone(options.expandContext);\n    if(_isObject(expandContext) && '@context' in expandContext) {\n      toResolve.expandContext = expandContext;\n    } else {\n      toResolve.expandContext = {'@context': expandContext};\n    }\n    contextsToProcess.push(toResolve.expandContext);\n  }\n\n  // if input is a string, attempt to dereference remote document\n  let defaultBase;\n  if(!_isString(input)) {\n    // input is not a URL, do not need to retrieve it first\n    toResolve.input = util.clone(input);\n  } else {\n    // load remote doc\n    const remoteDoc = await jsonld.get(input, options);\n    defaultBase = remoteDoc.documentUrl;\n    toResolve.input = remoteDoc.document;\n    if(remoteDoc.contextUrl) {\n      // context included in HTTP link header and must be resolved\n      toResolve.remoteContext = {'@context': remoteDoc.contextUrl};\n      contextsToProcess.push(toResolve.remoteContext);\n    }\n  }\n\n  // set default base\n  if(!('base' in options)) {\n    options.base = defaultBase || '';\n  }\n\n  // get all contexts in `toResolve`\n  await _getAllContexts(toResolve, options);\n\n  // process any additional contexts\n  let activeCtx = _getInitialContext(options);\n  contextsToProcess.forEach(localCtx => {\n    activeCtx = _processContext({activeCtx, localCtx, options});\n  });\n\n  // expand resolved input\n  let expanded = _expand({\n    activeCtx,\n    element: toResolve.input,\n    options,\n    expansionMap: options.expansionMap\n  });\n\n  // optimize away @graph with no other properties\n  if(_isObject(expanded) && ('@graph' in expanded) &&\n    Object.keys(expanded).length === 1) {\n    expanded = expanded['@graph'];\n  } else if(expanded === null) {\n    expanded = [];\n  }\n\n  // normalize to an array\n  if(!_isArray(expanded)) {\n    expanded = [expanded];\n  }\n\n  return expanded;\n});\n\n/**\n * Performs JSON-LD flattening.\n *\n * @param input the JSON-LD to flatten.\n * @param ctx the context to use to compact the flattened output, or null.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, flattened)] called once the operation completes.\n *\n * @return a Promise that resolves to the flattened output.\n */\njsonld.flatten = util.callbackify(async function(input, ctx, options) {\n  if(arguments.length < 1) {\n    return new TypeError('Could not flatten, too few arguments.');\n  }\n\n  if(typeof ctx === 'function') {\n    ctx = null;\n  } else {\n    ctx = ctx || null;\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : ''\n  });\n\n  // expand input\n  const expanded = await jsonld.expand(input, options);\n\n  // do flattening\n  const flattened = _flatten(expanded);\n\n  if(ctx === null) {\n    // no compaction required\n    return flattened;\n  }\n\n  // compact result (force @graph option to true, skip expansion)\n  options.graph = true;\n  options.skipExpansion = true;\n  const compacted = await jsonld.compact(flattened, ctx, options);\n\n  return compacted;\n});\n\n/**\n * Performs JSON-LD framing.\n *\n * @param input the JSON-LD input to frame.\n * @param frame the JSON-LD frame to use.\n * @param [options] the framing options.\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [embed] default @embed flag: '@last', '@always', '@never', '@link'\n *            (default: '@last').\n *          [explicit] default @explicit flag (default: false).\n *          [requireAll] default @requireAll flag (default: true).\n *          [omitDefault] default @omitDefault flag (default: false).\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, framed)] called once the operation completes.\n *\n * @return a Promise that resolves to the framed output.\n */\njsonld.frame = util.callbackify(async function(input, frame, options) {\n  if(arguments.length < 2) {\n    throw new TypeError('Could not frame, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : '',\n    embed: '@last',\n    explicit: false,\n    requireAll: true,\n    omitDefault: false,\n    pruneBlankNodeIdentifiers: true,\n    bnodesToClear: []\n  });\n\n  // if frame is a string, attempt to dereference remote document\n  if(_isString(frame)) {\n    // load remote doc\n    const remoteDoc = await jsonld.get(frame, options);\n    frame = remoteDoc.document;\n\n    if(remoteDoc.contextUrl) {\n      // inject link header @context into frame\n      let ctx = frame['@context'];\n      if(!ctx) {\n        ctx = remoteDoc.contextUrl;\n      } else if(_isArray(ctx)) {\n        ctx.push(remoteDoc.contextUrl);\n      } else {\n        ctx = [ctx, remoteDoc.contextUrl];\n      }\n      frame['@context'] = ctx;\n    }\n  }\n\n  const frameContext = frame ? frame['@context'] || {} : {};\n\n  // expand input\n  const expanded = await jsonld.expand(input, options);\n\n  // expand frame\n  const opts = util.clone(options);\n  opts.isFrame = true;\n  opts.keepFreeFloatingNodes = true;\n  const expandedFrame = await jsonld.expand(frame, opts);\n\n  // if the unexpanded frame includes a key expanding to @graph, frame the\n  // default graph, otherwise, the merged graph\n  let framed;\n  // FIXME should look for aliases of @graph\n  opts.merged = !('@graph' in frame);\n  // do framing\n  framed = _frameMergedOrDefault(expanded, expandedFrame, opts);\n\n  // compact result (force @graph option to true, skip expansion,\n  // check for linked embeds)\n  opts.graph = true;\n  opts.skipExpansion = true;\n  opts.link = {};\n  opts.framing = true;\n  const compacted = await jsonld.compact(framed, frameContext, opts);\n\n  return compacted;\n});\n\n/**\n * **Experimental**\n *\n * Links a JSON-LD document's nodes in memory.\n *\n * @param input the JSON-LD document to link.\n * @param [ctx] the JSON-LD context to apply.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, linked)] called once the operation completes.\n *\n * @return a Promise that resolves to the linked output.\n */\njsonld.link = util.callbackify(async function(input, ctx, options) {\n  // API matches running frame with a wildcard frame and embed: '@link'\n  // get arguments\n  const frame = {};\n  if(ctx) {\n    frame['@context'] = ctx;\n  }\n  frame['@embed'] = '@link';\n  return jsonld.frame(input, frame, options);\n});\n\n/**\n * Performs RDF dataset normalization on the given input. The input is JSON-LD\n * unless the 'inputFormat' option is used. The output is an RDF dataset\n * unless the 'format' option is used.\n *\n * @param input the input to normalize as JSON-LD or as a format specified by\n *          the 'inputFormat' option.\n * @param [options] the options to use:\n *          [algorithm] the normalization algorithm to use, `URDNA2015` or\n *            `URGNA2012` (default: `URDNA2015`).\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [skipExpansion] true to assume the input is expanded and skip\n *            expansion, false not to, defaults to false.\n *          [inputFormat] the format if input is not JSON-LD:\n *            'application/n-quads' for N-Quads.\n *          [format] the format if output is a string:\n *            'application/n-quads' for N-Quads.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n *          [useNative] true to use a native canonize algorithm\n * @param [callback(err, normalized)] called once the operation completes.\n *\n * @return a Promise that resolves to the normalized output.\n */\njsonld.normalize = jsonld.canonize = util.callbackify(async function(\n  input, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not canonize, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : '',\n    algorithm: 'URDNA2015',\n    skipExpansion: false\n  });\n  if('inputFormat' in options) {\n    if(options.inputFormat !== 'application/n-quads' &&\n      options.inputFormat !== 'application/nquads') {\n      throw new JsonLdError(\n        'Unknown canonicalization input format.',\n        'jsonld.CanonizeError');\n    }\n    // TODO: `await` for async parsers\n    const parsedInput = NQuads.parse(input);\n\n    // do canonicalization\n    return canonize.canonize(parsedInput, options);\n  }\n\n  // convert to RDF dataset then do normalization\n  const opts = util.clone(options);\n  delete opts.format;\n  opts.produceGeneralizedRdf = false;\n  const dataset = await jsonld.toRDF(input, opts);\n\n  // do canonicalization\n  return canonize.canonize(dataset, options);\n});\n\n/**\n * Converts an RDF dataset to JSON-LD.\n *\n * @param dataset a serialized string of RDF in a format specified by the\n *          format option or an RDF dataset to convert.\n * @param [options] the options to use:\n *          [format] the format if dataset param must first be parsed:\n *            'application/n-quads' for N-Quads (default).\n *          [rdfParser] a custom RDF-parser to use to parse the dataset.\n *          [useRdfType] true to use rdf:type, false to use @type\n *            (default: false).\n *          [useNativeTypes] true to convert XSD types into native types\n *            (boolean, integer, double), false not to (default: false).\n * @param [callback(err, output)] called once the operation completes.\n *\n * @return a Promise that resolves to the JSON-LD document.\n */\njsonld.fromRDF = util.callbackify(async function(dataset, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not convert from RDF, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    format: _isString(dataset) ? 'application/n-quads' : undefined\n  });\n\n  let {format, rdfParser} = options;\n\n  // handle special format\n  if(format) {\n    // check supported formats\n    rdfParser = rdfParser || _rdfParsers[format];\n    if(!rdfParser) {\n      throw new JsonLdError(\n        'Unknown input format.',\n        'jsonld.UnknownFormat', {format});\n    }\n  } else {\n    // no-op parser, assume dataset already parsed\n    rdfParser = () => dataset;\n  }\n\n  // TODO: call `normalizeAsyncFn` on parser fn\n\n  // rdfParser can be callback, promise-based, or synchronous\n  let parsedDataset;\n  if(rdfParser.length > 1) {\n    // convert callback-based rdf parser to promise-based\n    parsedDataset = new Promise((resolve, reject) => {\n      rdfParser(dataset, (err, dataset) => {\n        if(err) {\n          reject(err);\n        } else {\n          resolve(dataset);\n        }\n      });\n    });\n  } else {\n    parsedDataset = Promise.resolve(rdfParser(dataset));\n  }\n\n  parsedDataset = await parsedDataset;\n\n  // back-compat with old parsers that produced legacy dataset format\n  if(!Array.isArray(parsedDataset)) {\n    parsedDataset = NQuads.legacyDatasetToQuads(parsedDataset);\n  }\n\n  return _fromRDF(parsedDataset, options);\n});\n\n/**\n * Outputs the RDF dataset found in the given JSON-LD object.\n *\n * @param input the JSON-LD input.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [skipExpansion] true to assume the input is expanded and skip\n *            expansion, false not to, defaults to false.\n *          [format] the format to use to output a string:\n *            'application/n-quads' for N-Quads.\n *          [produceGeneralizedRdf] true to output generalized RDF, false\n *            to produce only standard RDF (default: false).\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, dataset)] called once the operation completes.\n *\n * @return a Promise that resolves to the RDF dataset.\n */\njsonld.toRDF = util.callbackify(async function(input, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not convert to RDF, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : '',\n    skipExpansion: false\n  });\n\n  // TODO: support toRDF custom map?\n  let expanded;\n  if(options.skipExpansion) {\n    expanded = input;\n  } else {\n    // expand input\n    expanded = await jsonld.expand(input, options);\n  }\n\n  // output RDF dataset\n  const dataset = _toRDF(expanded, options);\n  if(options.format) {\n    if(options.format === 'application/n-quads' ||\n      options.format === 'application/nquads') {\n      return await NQuads.serialize(dataset);\n    }\n    throw new JsonLdError(\n      'Unknown output format.',\n      'jsonld.UnknownFormat', {format: options.format});\n  }\n\n  return dataset;\n});\n\n/**\n * **Experimental**\n *\n * Recursively flattens the nodes in the given JSON-LD input into a merged\n * map of node ID => node. All graphs will be merged into the default graph.\n *\n * @param input the JSON-LD input.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [issuer] a jsonld.IdentifierIssuer to use to label blank nodes.\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, nodeMap)] called once the operation completes.\n *\n * @return a Promise that resolves to the merged node map.\n */\njsonld.createNodeMap = util.callbackify(async function(input, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not create node map, too few arguments.');\n  }\n\n  // set default options\n  options = _setDefaults(options, {\n    base: _isString(input) ? input : ''\n  });\n\n  // expand input\n  const expanded = await jsonld.expand(input, options);\n\n  return _createMergedNodeMap(expanded, options);\n});\n\n/**\n * **Experimental**\n *\n * Merges two or more JSON-LD documents into a single flattened document.\n *\n * @param docs the JSON-LD documents to merge together.\n * @param ctx the context to use to compact the merged result, or null.\n * @param [options] the options to use:\n *          [base] the base IRI to use.\n *          [expandContext] a context to expand with.\n *          [issuer] a jsonld.IdentifierIssuer to use to label blank nodes.\n *          [mergeNodes] true to merge properties for nodes with the same ID,\n *            false to ignore new properties for nodes with the same ID once\n *            the ID has been defined; note that this may not prevent merging\n *            new properties where a node is in the `object` position\n *            (default: true).\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, merged)] called once the operation completes.\n *\n * @return a Promise that resolves to the merged output.\n */\njsonld.merge = util.callbackify(async function(docs, ctx, options) {\n  if(arguments.length < 1) {\n    throw new TypeError('Could not merge, too few arguments.');\n  }\n  if(!_isArray(docs)) {\n    throw new TypeError('Could not merge, \"docs\" must be an array.');\n  }\n\n  if(typeof ctx === 'function') {\n    ctx = null;\n  } else {\n    ctx = ctx || null;\n  }\n\n  // set default options\n  options = _setDefaults(options, {});\n\n  // expand all documents\n  const expanded = await Promise.all(docs.map(doc => {\n    const opts = Object.assign({}, options);\n    return jsonld.expand(doc, opts);\n  }));\n\n  let mergeNodes = true;\n  if('mergeNodes' in options) {\n    mergeNodes = options.mergeNodes;\n  }\n\n  const issuer = options.issuer || new IdentifierIssuer('_:b');\n  const graphs = {'@default': {}};\n\n  for(let i = 0; i < expanded.length; ++i) {\n    // uniquely relabel blank nodes\n    const doc = util.relabelBlankNodes(expanded[i], {\n      issuer: new IdentifierIssuer('_:b' + i + '-')\n    });\n\n    // add nodes to the shared node map graphs if merging nodes, to a\n    // separate graph set if not\n    const _graphs = (mergeNodes || i === 0) ? graphs : {'@default': {}};\n    _createNodeMap(doc, _graphs, '@default', issuer);\n\n    if(_graphs !== graphs) {\n      // merge document graphs but don't merge existing nodes\n      for(const graphName in _graphs) {\n        const _nodeMap = _graphs[graphName];\n        if(!(graphName in graphs)) {\n          graphs[graphName] = _nodeMap;\n          continue;\n        }\n        const nodeMap = graphs[graphName];\n        for(const key in _nodeMap) {\n          if(!(key in nodeMap)) {\n            nodeMap[key] = _nodeMap[key];\n          }\n        }\n      }\n    }\n  }\n\n  // add all non-default graphs to default graph\n  const defaultGraph = _mergeNodeMaps(graphs);\n\n  // produce flattened output\n  const flattened = [];\n  const keys = Object.keys(defaultGraph).sort();\n  for(let ki = 0; ki < keys.length; ++ki) {\n    const node = defaultGraph[keys[ki]];\n    // only add full subjects to top-level\n    if(!_isSubjectReference(node)) {\n      flattened.push(node);\n    }\n  }\n\n  if(ctx === null) {\n    return flattened;\n  }\n\n  // compact result (force @graph option to true, skip expansion)\n  options.graph = true;\n  options.skipExpansion = true;\n  const compacted = await jsonld.compact(flattened, ctx, options);\n\n  return compacted;\n});\n\n/**\n * The default document loader for external documents. If the environment\n * is node.js, a callback-continuation-style document loader is used; otherwise,\n * a promises-style document loader is used.\n *\n * @param url the URL to load.\n * @param callback(err, remoteDoc) called once the operation completes,\n *          if using a non-promises API.\n *\n * @return a promise, if using a promises API.\n */\nObject.defineProperty(jsonld, 'documentLoader', {\n  get: () => jsonld._documentLoader,\n  set: v => jsonld._documentLoader = util.normalizeDocumentLoader(v)\n});\n// default document loader not implemented\njsonld.documentLoader = async url => {\n  throw new JsonLdError(\n    'Could not retrieve a JSON-LD document from the URL. URL ' +\n    'dereferencing not implemented.', 'jsonld.LoadDocumentError',\n    {code: 'loading document failed', url});\n};\n\n/**\n * Deprecated default document loader. Do not use or override.\n */\njsonld.loadDocument = util.callbackify(async function() {\n  return jsonld.documentLoader.apply(null, arguments);\n});\n\n/**\n * Gets a remote JSON-LD document using the default document loader or\n * one given in the passed options.\n *\n * @param url the URL to fetch.\n * @param [options] the options to use:\n *          [documentLoader] the document loader to use.\n * @param [callback(err, remoteDoc)] called once the operation completes.\n *\n * @return a Promise that resolves to the retrieved remote document.\n */\njsonld.get = util.callbackify(async function(url, options) {\n  let load;\n  if(typeof options.documentLoader === 'function') {\n    load = util.normalizeDocumentLoader(options.documentLoader);\n  } else {\n    load = jsonld.documentLoader;\n  }\n\n  const remoteDoc = await load(url);\n\n  // TODO: can this be moved into `normalizeDocumentLoader`?\n  try {\n    if(!remoteDoc.document) {\n      throw new JsonLdError(\n        'No remote document found at the given URL.',\n        'jsonld.NullRemoteDocument');\n    }\n    if(_isString(remoteDoc.document)) {\n      remoteDoc.document = JSON.parse(remoteDoc.document);\n    }\n  } catch(e) {\n    throw new JsonLdError(\n      'Could not retrieve a JSON-LD document from the URL.',\n      'jsonld.LoadDocumentError', {\n        code: 'loading document failed',\n        cause: e,\n        remoteDoc\n      });\n  }\n\n  return remoteDoc;\n});\n\n/**\n * Processes a local context, resolving any URLs as necessary, and returns a\n * new active context in its callback.\n *\n * @param activeCtx the current active context.\n * @param localCtx the local context to process.\n * @param [options] the options to use:\n *          [documentLoader(url, callback(err, remoteDoc))] the document loader.\n * @param [callback(err, activeCtx)] called once the operation completes.\n *\n * @return a Promise that resolves to the new active context.\n */\njsonld.processContext = util.callbackify(async function(\n  activeCtx, localCtx, options) {\n  // set default options\n  options = _setDefaults(options, {\n    base: ''\n  });\n\n  // return initial context early for null context\n  if(localCtx === null) {\n    return _getInitialContext(options);\n  }\n\n  // get URLs in localCtx\n  localCtx = util.clone(localCtx);\n  if(!(_isObject(localCtx) && '@context' in localCtx)) {\n    localCtx = {'@context': localCtx};\n  }\n  const ctx = await _getAllContexts(localCtx, options);\n\n  return _processContext({activeCtx, localCtx: ctx, options});\n});\n\n// backwards compatibility\njsonld.getContextValue = require('./context').getContextValue;\n\n/**\n * Document loaders.\n */\njsonld.documentLoaders = {};\njsonld.documentLoaders.node = require('./documentLoaders/node');\njsonld.documentLoaders.xhr = require('./documentLoaders/xhr');\n\n/**\n * Assigns the default document loader for external document URLs to a built-in\n * default. Supported types currently include: 'xhr' and 'node'.\n *\n * @param type the type to set.\n * @param [params] the parameters required to use the document loader.\n */\njsonld.useDocumentLoader = function(type) {\n  if(!(type in jsonld.documentLoaders)) {\n    throw new JsonLdError(\n      'Unknown document loader type: \"' + type + '\"',\n      'jsonld.UnknownDocumentLoader',\n      {type});\n  }\n\n  // set document loader\n  jsonld.documentLoader = jsonld.documentLoaders[type].apply(\n    jsonld, Array.prototype.slice.call(arguments, 1));\n};\n\n/** Registered RDF dataset parsers hashed by content-type. */\nconst _rdfParsers = {};\n\n/**\n * Registers an RDF dataset parser by content-type, for use with\n * jsonld.fromRDF. An RDF dataset parser will always be given two parameters,\n * a string of input and a callback. An RDF dataset parser can be synchronous\n * or asynchronous.\n *\n * If the parser function returns undefined or null then it will be assumed to\n * be asynchronous w/a continuation-passing style and the callback parameter\n * given to the parser MUST be invoked.\n *\n * If it returns a Promise, then it will be assumed to be asynchronous, but the\n * callback parameter MUST NOT be invoked. It should instead be ignored.\n *\n * If it returns an RDF dataset, it will be assumed to be synchronous and the\n * callback parameter MUST NOT be invoked. It should instead be ignored.\n *\n * @param contentType the content-type for the parser.\n * @param parser(input, callback(err, dataset)) the parser function (takes a\n *          string as a parameter and either returns null/undefined and uses\n *          the given callback, returns a Promise, or returns an RDF dataset).\n */\njsonld.registerRDFParser = function(contentType, parser) {\n  _rdfParsers[contentType] = parser;\n};\n\n/**\n * Unregisters an RDF dataset parser by content-type.\n *\n * @param contentType the content-type for the parser.\n */\njsonld.unregisterRDFParser = function(contentType) {\n  delete _rdfParsers[contentType];\n};\n\n// register the N-Quads RDF parser\njsonld.registerRDFParser('application/n-quads', NQuads.parse);\njsonld.registerRDFParser('application/nquads', NQuads.parse);\n\n// register the RDFa API RDF parser\njsonld.registerRDFParser('rdfa-api', Rdfa.parse);\n\n/* URL API */\njsonld.url = require('./url');\n\n/* Utility API */\njsonld.util = util;\n// backwards compatibility\nObject.assign(jsonld, util);\n\n// reexpose API as jsonld.promises for backwards compatability\njsonld.promises = jsonld;\n\n// backwards compatibility\njsonld.RequestQueue = require('./RequestQueue');\n\n/* WebIDL API */\njsonld.JsonLdProcessor = require('./JsonLdProcessor')(jsonld);\n\n// setup browser global JsonLdProcessor\nif(_browser && typeof global.JsonLdProcessor === 'undefined') {\n  Object.defineProperty(global, 'JsonLdProcessor', {\n    writable: true,\n    enumerable: false,\n    configurable: true,\n    value: jsonld.JsonLdProcessor\n  });\n}\n\n// set platform-specific defaults/APIs\nif(_nodejs) {\n  // use node document loader by default\n  jsonld.useDocumentLoader('node');\n} else if(typeof XMLHttpRequest !== 'undefined') {\n  // use xhr document loader by default\n  jsonld.useDocumentLoader('xhr');\n}\n\nfunction _setDefaults(options, {\n  documentLoader = jsonld.documentLoader,\n  ...defaults\n}) {\n  return Object.assign({}, {documentLoader}, defaults, options);\n}\n\n// end of jsonld API `wrapper` factory\nreturn jsonld;\n};\n\n// external APIs:\n\n// used to generate a new jsonld API instance\nconst factory = function() {\n  return wrapper(function() {\n    return factory();\n  });\n};\n\n// wrap the main jsonld API instance\nwrapper(factory);\n// export API\nmodule.exports = factory;\n","/**\n * An implementation of the RDF Dataset Normalization specification.\n * This library works in the browser and node.js.\n *\n * BSD 3-Clause License\n * Copyright (c) 2016-2017 Digital Bazaar, Inc.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * Redistributions of source code must retain the above copyright notice,\n * this list of conditions and the following disclaimer.\n *\n * Redistributions in binary form must reproduce the above copyright\n * notice, this list of conditions and the following disclaimer in the\n * documentation and/or other materials provided with the distribution.\n *\n * Neither the name of the Digital Bazaar, Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n * IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED\n * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A\n * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED\n * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n'use strict';\n\nconst util = require('./util');\nconst URDNA2015 = require('./URDNA2015');\nconst URGNA2012 = require('./URGNA2012');\nconst URDNA2015Sync = require('./URDNA2015Sync');\nconst URGNA2012Sync = require('./URGNA2012Sync');\n\n// optional native support\nlet rdfCanonizeNative;\ntry {\n  rdfCanonizeNative = require('rdf-canonize-native');\n} catch(e) {}\n\nconst api = {};\nmodule.exports = api;\n\n// expose helpers\napi.NQuads = require('./NQuads');\napi.IdentifierIssuer = require('./IdentifierIssuer');\n\n/**\n * Get or set native API.\n *\n * @param api the native API.\n *\n * @return the currently set native API.\n */\napi._rdfCanonizeNative = function(api) {\n  if(api) {\n    rdfCanonizeNative = api;\n  }\n  return rdfCanonizeNative;\n};\n\n/**\n * Asynchronously canonizes an RDF dataset.\n *\n * @param dataset the dataset to canonize.\n * @param options the options to use:\n *          algorithm the canonicalization algorithm to use, `URDNA2015` or\n *            `URGNA2012`.\n *          [useNative] use native implementation (default: false).\n * @param [callback(err, canonical)] called once the operation completes.\n *\n * @return a Promise that resolves to the canonicalized RDF Dataset.\n */\napi.canonize = util.callbackify(async function(dataset, options) {\n  let callback;\n  const promise = new Promise((resolve, reject) => {\n    callback = (err, canonical) => {\n      if(err) {\n        return reject(err);\n      }\n\n      /*if(options.format === 'application/n-quads') {\n        canonical = canonical.join('');\n      }\n      canonical = _parseNQuads(canonical.join(''));*/\n\n      resolve(canonical);\n    };\n  });\n\n  // back-compat with legacy dataset\n  if(!Array.isArray(dataset)) {\n    dataset = api.NQuads.legacyDatasetToQuads(dataset);\n  }\n\n  // TODO: convert algorithms to Promise-based async\n  if(options.useNative) {\n    if(rdfCanonizeNative) {\n      rdfCanonizeNative.canonize(dataset, options, callback);\n    } else {\n      throw new Error('rdf-canonize-native not available');\n    }\n  } else {\n    if(options.algorithm === 'URDNA2015') {\n      new URDNA2015(options).main(dataset, callback);\n    } else if(options.algorithm === 'URGNA2012') {\n      new URGNA2012(options).main(dataset, callback);\n    } else if(!('algorithm' in options)) {\n      throw new Error('No RDF Dataset Canonicalization algorithm specified.');\n    } else {\n      throw new Error(\n        'Invalid RDF Dataset Canonicalization algorithm: ' + options.algorithm);\n    }\n  }\n\n  return promise;\n});\n\n/**\n * Synchronously canonizes an RDF dataset.\n *\n * @param dataset the dataset to canonize.\n * @param options the options to use:\n *          algorithm the canonicalization algorithm to use, `URDNA2015` or\n *            `URGNA2012`.\n *          [useNative] use native implementation (default: false).\n *\n * @return the RDF dataset in canonical form.\n */\napi.canonizeSync = function(dataset, options) {\n  // back-compat with legacy dataset\n  if(!Array.isArray(dataset)) {\n    dataset = api.NQuads.legacyDatasetToQuads(dataset);\n  }\n\n  if(options.useNative) {\n    if(rdfCanonizeNative) {\n      return rdfCanonizeNative.canonizeSync(dataset, options);\n    }\n    throw new Error('rdf-canonize-native not available');\n  }\n  if(options.algorithm === 'URDNA2015') {\n    return new URDNA2015Sync(options).main(dataset);\n  } else if(options.algorithm === 'URGNA2012') {\n    return new URGNA2012Sync(options).main(dataset);\n  }\n  if(!('algorithm' in options)) {\n    throw new Error('No RDF Dataset Canonicalization algorithm specified.');\n  }\n  throw new Error(\n    'Invalid RDF Dataset Canonicalization algorithm: ' + options.algorithm);\n};\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst util = require('./util');\n\nmodule.exports = class IdentifierIssuer {\n  /**\n   * Creates a new IdentifierIssuer. A IdentifierIssuer issues unique\n   * identifiers, keeping track of any previously issued identifiers.\n   *\n   * @param prefix the prefix to use ('<prefix><counter>').\n   */\n  constructor(prefix) {\n    this.prefix = prefix;\n    this.counter = 0;\n    this.existing = {};\n  }\n\n  /**\n   * Copies this IdentifierIssuer.\n   *\n   * @return a copy of this IdentifierIssuer.\n   */\n  clone() {\n    const copy = new IdentifierIssuer(this.prefix);\n    copy.counter = this.counter;\n    copy.existing = util.clone(this.existing);\n    return copy;\n  }\n\n  /**\n   * Gets the new identifier for the given old identifier, where if no old\n   * identifier is given a new identifier will be generated.\n   *\n   * @param [old] the old identifier to get the new identifier for.\n   *\n   * @return the new identifier.\n   */\n  getId(old) {\n    // return existing old identifier\n    if(old && old in this.existing) {\n      return this.existing[old];\n    }\n\n    // get next identifier\n    const identifier = this.prefix + this.counter;\n    this.counter += 1;\n\n    // save mapping\n    if(old) {\n      this.existing[old] = identifier;\n    }\n\n    return identifier;\n  }\n\n  /**\n   * Returns true if the given old identifer has already been assigned a new\n   * identifier.\n   *\n   * @param old the old identifier to check.\n   *\n   * @return true if the old identifier has been assigned a new identifier,\n   *   false if not.\n   */\n  hasId(old) {\n    return (old in this.existing);\n  }\n};\n","/**\n * Node.js module for Forge message digests.\n *\n * @author Dave Longley\n *\n * Copyright 2011-2017 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\n\nmodule.exports = forge.md = forge.md || {};\nforge.md.algorithms = forge.md.algorithms || {};\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst TERMS = ['subject', 'predicate', 'object', 'graph'];\nconst RDF = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#';\nconst RDF_LANGSTRING = RDF + 'langString';\nconst XSD_STRING = 'http://www.w3.org/2001/XMLSchema#string';\n\n// build regexes\nconst REGEX = {};\n(() => {\n  const iri = '(?:<([^:]+:[^>]*)>)';\n  // https://www.w3.org/TR/turtle/#grammar-production-BLANK_NODE_LABEL\n  const PN_CHARS_BASE =\n    'A-Z' + 'a-z' +\n    '\\u00C0-\\u00D6' +\n    '\\u00D8-\\u00F6' +\n    '\\u00F8-\\u02FF' +\n    '\\u0370-\\u037D' +\n    '\\u037F-\\u1FFF' +\n    '\\u200C-\\u200D' +\n    '\\u2070-\\u218F' +\n    '\\u2C00-\\u2FEF' +\n    '\\u3001-\\uD7FF' +\n    '\\uF900-\\uFDCF' +\n    '\\uFDF0-\\uFFFD';\n    // TODO:\n    //'\\u10000-\\uEFFFF';\n  const PN_CHARS_U =\n    PN_CHARS_BASE +\n    '_';\n  const PN_CHARS =\n    PN_CHARS_U +\n    '0-9' +\n    '-' +\n    '\\u00B7' +\n    '\\u0300-\\u036F' +\n    '\\u203F-\\u2040';\n  const BLANK_NODE_LABEL =\n    '(_:' +\n      '(?:[' + PN_CHARS_U + '0-9])' +\n      '(?:(?:[' + PN_CHARS + '.])*(?:[' + PN_CHARS + ']))?' +\n    ')';\n  const bnode = BLANK_NODE_LABEL;\n  const plain = '\"([^\"\\\\\\\\]*(?:\\\\\\\\.[^\"\\\\\\\\]*)*)\"';\n  const datatype = '(?:\\\\^\\\\^' + iri + ')';\n  const language = '(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*))';\n  const literal = '(?:' + plain + '(?:' + datatype + '|' + language + ')?)';\n  const ws = '[ \\\\t]+';\n  const wso = '[ \\\\t]*';\n\n  // define quad part regexes\n  const subject = '(?:' + iri + '|' + bnode + ')' + ws;\n  const property = iri + ws;\n  const object = '(?:' + iri + '|' + bnode + '|' + literal + ')' + wso;\n  const graphName = '(?:\\\\.|(?:(?:' + iri + '|' + bnode + ')' + wso + '\\\\.))';\n\n  // end of line and empty regexes\n  REGEX.eoln = /(?:\\r\\n)|(?:\\n)|(?:\\r)/g;\n  REGEX.empty = new RegExp('^' + wso + '$');\n\n  // full quad regex\n  REGEX.quad = new RegExp(\n    '^' + wso + subject + property + object + graphName + wso + '$');\n})();\n\nmodule.exports = class NQuads {\n  /**\n   * Parses RDF in the form of N-Quads.\n   *\n   * @param input the N-Quads input to parse.\n   *\n   * @return an RDF dataset (an array of quads per http://rdf.js.org/).\n   */\n  static parse(input) {\n    // build RDF dataset\n    const dataset = [];\n\n    const graphs = {};\n\n    // split N-Quad input into lines\n    const lines = input.split(REGEX.eoln);\n    let lineNumber = 0;\n    for(const line of lines) {\n      lineNumber++;\n\n      // skip empty lines\n      if(REGEX.empty.test(line)) {\n        continue;\n      }\n\n      // parse quad\n      const match = line.match(REGEX.quad);\n      if(match === null) {\n        throw new Error('N-Quads parse error on line ' + lineNumber + '.');\n      }\n\n      // create RDF quad\n      const quad = {};\n\n      // get subject\n      if(match[1] !== undefined) {\n        quad.subject = {termType: 'NamedNode', value: match[1]};\n      } else {\n        quad.subject = {termType: 'BlankNode', value: match[2]};\n      }\n\n      // get predicate\n      quad.predicate = {termType: 'NamedNode', value: match[3]};\n\n      // get object\n      if(match[4] !== undefined) {\n        quad.object = {termType: 'NamedNode', value: match[4]};\n      } else if(match[5] !== undefined) {\n        quad.object = {termType: 'BlankNode', value: match[5]};\n      } else {\n        quad.object = {\n          termType: 'Literal',\n          value: undefined,\n          datatype: {\n            termType: 'NamedNode'\n          }\n        };\n        if(match[7] !== undefined) {\n          quad.object.datatype.value = match[7];\n        } else if(match[8] !== undefined) {\n          quad.object.datatype.value = RDF_LANGSTRING;\n          quad.object.language = match[8];\n        } else {\n          quad.object.datatype.value = XSD_STRING;\n        }\n        quad.object.value = _unescape(match[6]);\n      }\n\n      // get graph\n      if(match[9] !== undefined) {\n        quad.graph = {\n          termType: 'NamedNode',\n          value: match[9]\n        };\n      } else if(match[10] !== undefined) {\n        quad.graph = {\n          termType: 'BlankNode',\n          value: match[10]\n        };\n      } else {\n        quad.graph = {\n          termType: 'DefaultGraph',\n          value: ''\n        };\n      }\n\n      // only add quad if it is unique in its graph\n      if(!(quad.graph.value in graphs)) {\n        graphs[quad.graph.value] = [quad];\n        dataset.push(quad);\n      } else {\n        let unique = true;\n        const quads = graphs[quad.graph.value];\n        for(const q of quads) {\n          if(_compareTriples(q, quad)) {\n            unique = false;\n            break;\n          }\n        }\n        if(unique) {\n          quads.push(quad);\n          dataset.push(quad);\n        }\n      }\n    }\n\n    return dataset;\n  }\n\n  /**\n   * Converts an RDF dataset to N-Quads.\n   *\n   * @param dataset (array of quads) the RDF dataset to convert.\n   *\n   * @return the N-Quads string.\n   */\n  static serialize(dataset) {\n    if(!Array.isArray(dataset)) {\n      dataset = NQuads.legacyDatasetToQuads(dataset);\n    }\n    const quads = [];\n    for(const quad of dataset) {\n      quads.push(NQuads.serializeQuad(quad));\n    }\n    return quads.sort().join('');\n  }\n\n  /**\n   * Converts an RDF quad to an N-Quad string (a single quad).\n   *\n   * @param quad the RDF quad convert.\n   *\n   * @return the N-Quad string.\n   */\n  static serializeQuad(quad) {\n    const s = quad.subject;\n    const p = quad.predicate;\n    const o = quad.object;\n    const g = quad.graph;\n\n    let nquad = '';\n\n    // subject and predicate can only be NamedNode or BlankNode\n    [s, p].forEach(term => {\n      if(term.termType === 'NamedNode') {\n        nquad += '<' + term.value + '>';\n      } else {\n        nquad += term.value;\n      }\n      nquad += ' ';\n    });\n\n    // object is NamedNode, BlankNode, or Literal\n    if(o.termType === 'NamedNode') {\n      nquad += '<' + o.value + '>';\n    } else if(o.termType === 'BlankNode') {\n      nquad += o.value;\n    } else {\n      nquad += '\"' + _escape(o.value) + '\"';\n      if(o.datatype.value === RDF_LANGSTRING) {\n        if(o.language) {\n          nquad += '@' + o.language;\n        }\n      } else if(o.datatype.value !== XSD_STRING) {\n        nquad += '^^<' + o.datatype.value + '>';\n      }\n    }\n\n    // graph can only be NamedNode or BlankNode (or DefaultGraph, but that\n    // does not add to `nquad`)\n    if(g.termType === 'NamedNode') {\n      nquad += ' <' + g.value + '>';\n    } else if(g.termType === 'BlankNode') {\n      nquad += ' ' + g.value;\n    }\n\n    nquad += ' .\\n';\n    return nquad;\n  }\n\n  /**\n   * Converts a legacy-formatted dataset to an array of quads dataset per\n   * http://rdf.js.org/.\n   *\n   * @param dataset the legacy dataset to convert.\n   *\n   * @return the array of quads dataset.\n   */\n  static legacyDatasetToQuads(dataset) {\n    const quads = [];\n\n    const termTypeMap = {\n      'blank node': 'BlankNode',\n      'IRI': 'NamedNode',\n      'literal': 'Literal'\n    };\n\n    for(const graphName in dataset) {\n      const triples = dataset[graphName];\n      triples.forEach(triple => {\n        const quad = {};\n        for(const componentName in triple) {\n          const oldComponent = triple[componentName];\n          const newComponent = {\n            termType: termTypeMap[oldComponent.type],\n            value: oldComponent.value\n          };\n          if(newComponent.termType === 'Literal') {\n            newComponent.datatype = {\n              termType: 'NamedNode'\n            };\n            if('datatype' in oldComponent) {\n              newComponent.datatype.value = oldComponent.datatype;\n            }\n            if('language' in oldComponent) {\n              if(!('datatype' in oldComponent)) {\n                newComponent.datatype.value = RDF_LANGSTRING;\n              }\n              newComponent.language = oldComponent.language;\n            } else if(!('datatype' in oldComponent)) {\n              newComponent.datatype.value = XSD_STRING;\n            }\n          }\n          quad[componentName] = newComponent;\n        }\n        if(graphName === '@default') {\n          quad.graph = {\n            termType: 'DefaultGraph',\n            value: ''\n          };\n        } else {\n          quad.graph = {\n            termType: graphName.startsWith('_:') ? 'BlankNode' : 'NamedNode',\n            value: graphName\n          };\n        }\n        quads.push(quad);\n      });\n    }\n\n    return quads;\n  }\n};\n\n/**\n * Compares two RDF triples for equality.\n *\n * @param t1 the first triple.\n * @param t2 the second triple.\n *\n * @return true if the triples are the same, false if not.\n */\nfunction _compareTriples(t1, t2) {\n  for(const k in t1) {\n    if(t1[k].termType !== t2[k].termType || t1[k].value !== t2[k].value) {\n      return false;\n    }\n  }\n  if(t1.object.termType !== 'Literal') {\n    return true;\n  }\n  return (\n    (t1.object.datatype.termType === t2.object.datatype.termType) &&\n    (t1.object.datatype.value === t2.object.datatype.value) &&\n    (t1.object.language === t2.object.language)\n  );\n}\n\nconst _escapeRegex = /[\"\\\\\\n\\r]/g;\n/**\n * Escape string to N-Quads literal\n */\nfunction _escape(s) {\n  return s.replace(_escapeRegex, function(match) {\n    switch(match) {\n      case '\"': return '\\\\\"';\n      case '\\\\': return '\\\\\\\\';\n      case '\\n': return '\\\\n';\n      case '\\r': return '\\\\r';\n    }\n  });\n}\n\nconst _unescapeRegex =\n  /(?:\\\\([tbnrf\"'\\\\]))|(?:\\\\u([0-9A-Fa-f]{4}))|(?:\\\\U([0-9A-Fa-f]{8}))/g;\n/**\n * Unescape N-Quads literal to string\n */\nfunction _unescape(s) {\n  return s.replace(_unescapeRegex, function(match, code, u, U) {\n    if(code) {\n      switch(code) {\n        case 't': return '\\t';\n        case 'b': return '\\b';\n        case 'n': return '\\n';\n        case 'r': return '\\r';\n        case 'f': return '\\f';\n        case '\"': return '\"';\n        case '\\'': return '\\'';\n        case '\\\\': return '\\\\';\n      }\n    }\n    if(u) {\n      return String.fromCharCode(parseInt(u, 16));\n    }\n    if(U) {\n      // FIXME: support larger values\n      throw new Error('Unsupported U escape');\n    }\n  });\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {callbackify, normalizeDocumentLoader} = require('./util');\n\nmodule.exports = class RequestQueue {\n  /**\n   * Creates a simple queue for requesting documents.\n   */\n  constructor() {\n    this._requests = {};\n    this.add = callbackify(this.add.bind(this));\n  }\n\n  wrapLoader(loader) {\n    const self = this;\n    self._loader = normalizeDocumentLoader(loader);\n    return function(/* url */) {\n      return self.add.apply(self, arguments);\n    };\n  }\n\n  async add(url) {\n    const self = this;\n\n    let promise = self._requests[url];\n    if(promise) {\n      // URL already queued, wait for it to load\n      return Promise.resolve(promise);\n    }\n\n    // queue URL and load it\n    promise = self._requests[url] = self._loader(url);\n\n    try {\n      return await promise;\n    } finally {\n      delete self._requests[url];\n    }\n  }\n};\n","var DataFactory = require('./lib/data-factory')\n\nmodule.exports = DataFactory\n","import IConnection from \"../entities/connections/connections\";\nimport ILocation from \"../interfaces/ILocation\";\nimport IProbabilisticValue from \"../interfaces/IProbabilisticValue\";\nimport IStep from \"../interfaces/IStep\";\nimport { DistanceM, DurationMs } from \"../interfaces/units\";\nimport Geo from \"../util/Geo\";\n\n/**\n * This Step class serves as an implementation of the [[IStep]] interface and as a home for some helper functions\n * related to [[IStep]] instances\n */\nexport default class Step implements IStep {\n\n  public static create(\n    startLocation: ILocation,\n    stopLocation: ILocation,\n    duration: IProbabilisticValue<DurationMs>,\n    startTime?: Date,\n    stopTime?: Date,\n    distance?: DistanceM,\n  ): IStep {\n    return new Step(\n      startLocation,\n      stopLocation,\n      duration,\n      startTime,\n      stopTime,\n      distance,\n    );\n  }\n\n  public static createFromConnections(enterConnection: IConnection, exitConnection: IConnection): IStep {\n    return new Step(\n      { id: enterConnection.departureStop },\n      { id: exitConnection.arrivalStop },\n      {\n        minimum: (\n          exitConnection.arrivalTime.getTime() -\n          enterConnection.departureTime.getTime()\n        ),\n      },\n      enterConnection.departureTime,\n      exitConnection.arrivalTime,\n      undefined,\n      enterConnection.id,\n      exitConnection.id,\n    );\n  }\n\n  /**\n   * Compare two [[IStep]] instances\n   * @returns true if the two steps are the same\n   */\n  public static compareEquals(step: IStep, otherStep: IStep): boolean {\n    return Step.compareLocations(otherStep.startLocation, step.startLocation) &&\n      Step.compareLocations(otherStep.stopLocation, step.stopLocation);\n  }\n\n  private static compareLocations(a: ILocation, b: ILocation): boolean {\n    return Geo.getId(a) === Geo.getId(b) && a.longitude === b.longitude && a.latitude === b.latitude;\n  }\n\n  public distance: DistanceM;\n  public duration: IProbabilisticValue<DurationMs>;\n  public startLocation: ILocation;\n  public startTime: Date;\n  public stopLocation: ILocation;\n  public stopTime: Date;\n  public enterConnectionId: string;\n  public exitConnectionId: string;\n\n  constructor(\n    startLocation: ILocation,\n    stopLocation: ILocation,\n    duration: IProbabilisticValue<DurationMs>,\n    startTime?: Date,\n    stopTime?: Date,\n    distance?: DistanceM,\n    enterConnectionId?: string,\n    exitConnectionId?: string,\n  ) {\n    this.distance = distance;\n    this.duration = duration;\n    this.startLocation = startLocation;\n    this.startTime = startTime;\n    this.stopLocation = stopLocation;\n    this.stopTime = stopTime;\n    this.enterConnectionId = enterConnectionId;\n    this.exitConnectionId = exitConnectionId;\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport ReachableStopsFinderMode from \"../../enums/ReachableStopsFinderMode\";\nimport IFootpathsProvider from \"../../fetcher/footpaths/IFootpathsProvider\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport IStopsProvider from \"../../fetcher/stops/IStopsProvider\";\nimport { DurationMs, SpeedKmH } from \"../../interfaces/units\";\nimport TYPES from \"../../types\";\nimport Units from \"../../util/Units\";\nimport IReachableStopsFinder, { IReachableStop } from \"./IReachableStopsFinder\";\n\n@injectable()\nexport default class ReachableStopsFinderFootpaths implements IReachableStopsFinder {\n  private readonly stopsProvider: IStopsProvider;\n  private readonly footpathsProvider: IFootpathsProvider;\n\n  constructor(\n    @inject(TYPES.StopsProvider) stopsProvider: IStopsProvider,\n    @inject(TYPES.FootpathsProvider) footpathsProvider: IFootpathsProvider,\n  ) {\n    this.stopsProvider = stopsProvider;\n    this.footpathsProvider = footpathsProvider;\n  }\n\n  public async findReachableStops(\n    sourceOrTargetStop: IStop,\n    mode: ReachableStopsFinderMode,\n    maximumDuration: DurationMs,\n    minimumSpeed: SpeedKmH,\n  ): Promise<IReachableStop[]> {\n\n    const reachableStops: IReachableStop[] = [{ stop: sourceOrTargetStop, duration: 0 }];\n\n    const footpaths = await this.footpathsProvider.get(sourceOrTargetStop);\n    for (const footpath of Object.values(footpaths)) {\n        let otherStop: IStop;\n\n        if (sourceOrTargetStop.id === footpath.from) {\n            otherStop = await this.stopsProvider.getStopById(footpath.to);\n        } else if (sourceOrTargetStop.id === footpath.to) {\n            otherStop = await this.stopsProvider.getStopById(footpath.from);\n        }\n\n        if (otherStop) {\n            const duration = Units.toDuration(footpath.distance, minimumSpeed);\n            reachableStops.push({stop: otherStop, duration, id: footpath.id});\n        }\n    }\n\n    return reachableStops;\n  }\n}\n","import { injectable } from \"inversify\";\nimport PathfindingGraph from \"../graph\";\nimport { IShortestPathAlgorithm, IShortestPathInstance } from \"../pathfinder\";\nimport { BidirDijkstraInstance } from \"./BidirDijkstraInstance\";\n\n@injectable()\nexport class BidirDijkstra implements IShortestPathAlgorithm {\n    public createInstance(graph: PathfindingGraph): IShortestPathInstance {\n        return new BidirDijkstraInstance(graph);\n    }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { inject, injectable } from \"inversify\";\nimport { cat } from \"shelljs\";\nimport Defaults from \"../Defaults\";\nimport InvalidQueryError from \"../errors/InvalidQueryError\";\nimport ILocation from \"../interfaces/ILocation\";\nimport IPath from \"../interfaces/IPath\";\nimport IQuery from \"../interfaces/IQuery\";\nimport IPublicTransportPlanner from \"../planner/public-transport/IPublicTransportPlanner\";\nimport IRoadPlanner from \"../planner/road/IRoadPlanner\";\nimport TYPES from \"../types\";\nimport Units from \"../util/Units\";\nimport ILocationResolver from \"./ILocationResolver\";\nimport IQueryRunner from \"./IQueryRunner\";\nimport IResolvedQuery from \"./IResolvedQuery\";\n\n/**\n * The default `minimumDepartureTime` is *now*. The default `maximumArrivalTime` is `minimumDepartureTime + 2 hours`.\n */\n@injectable()\nexport default class QueryRunnerDefault implements IQueryRunner {\n  private locationResolver: ILocationResolver;\n  private publicTransportPlanner: IPublicTransportPlanner;\n  private roadPlanner: IRoadPlanner;\n\n  constructor(\n    @inject(TYPES.LocationResolver) locationResolver: ILocationResolver,\n    @inject(TYPES.PublicTransportPlanner) publicTransportPlanner: IPublicTransportPlanner,\n    @inject(TYPES.RoadPlanner) roadPlanner: IRoadPlanner,\n  ) {\n    this.locationResolver = locationResolver;\n    this.publicTransportPlanner = publicTransportPlanner;\n    this.roadPlanner = roadPlanner;\n  }\n\n  public async run(query: IQuery): Promise<AsyncIterator<IPath>> {\n    const resolvedQuery: IResolvedQuery = await this.resolveQuery(query);\n\n    if (resolvedQuery.roadNetworkOnly) {\n      return this.roadPlanner.plan(resolvedQuery);\n    } else {\n      return this.publicTransportPlanner.plan(resolvedQuery);\n    }\n  }\n\n  private async resolveEndpoint(endpoint: string | string[] | ILocation | ILocation[]): Promise<ILocation[]> {\n    if (Array.isArray(endpoint)) {\n      const promises = (endpoint as Array<string | ILocation>)\n        .map((singleEndpoint: string | ILocation) =>\n          this.locationResolver.resolve(singleEndpoint),\n        );\n\n      return await Promise.all(promises);\n    } else {\n      return [await this.locationResolver.resolve(endpoint)];\n    }\n  }\n\n  private async resolveQuery(query: IQuery): Promise<IResolvedQuery> {\n    // tslint:disable:trailing-comma\n    const {\n      from, to,\n      minimumWalkingSpeed, maximumWalkingSpeed, walkingSpeed,\n      maximumWalkingDuration, maximumWalkingDistance,\n      minimumTransferDuration, maximumTransferDuration, maximumTransferDistance,\n      maximumTransfers,\n      minimumDepartureTime, maximumArrivalTime,\n      ...other\n    } = query;\n    // tslint:enable:trailing-comma\n\n    const resolvedQuery: IResolvedQuery = Object.assign({}, other as IResolvedQuery);\n\n    resolvedQuery.minimumDepartureTime = minimumDepartureTime || new Date();\n\n    if (maximumArrivalTime) {\n      resolvedQuery.maximumArrivalTime = maximumArrivalTime;\n\n    } else {\n      const { minimumDepartureTime: newDepartureTime } = resolvedQuery;\n      resolvedQuery.maximumArrivalTime = new Date(newDepartureTime.getTime()\n        + 12 * 60 * 60 * 1000);\n    }\n\n    try {\n      resolvedQuery.from = await this.resolveEndpoint(from);\n      resolvedQuery.to = await this.resolveEndpoint(to);\n\n    } catch (e) {\n      return Promise.reject(new InvalidQueryError(e));\n    }\n\n    resolvedQuery.minimumWalkingSpeed = minimumWalkingSpeed || walkingSpeed || Defaults.defaultMinimumWalkingSpeed;\n    resolvedQuery.maximumWalkingSpeed = maximumWalkingSpeed || walkingSpeed || Defaults.defaultMaximumWalkingSpeed;\n\n    resolvedQuery.maximumWalkingDuration = maximumWalkingDuration ||\n      Units.toDuration(maximumWalkingDistance, resolvedQuery.minimumWalkingSpeed) || Defaults.defaultWalkingDuration;\n\n    resolvedQuery.minimumTransferDuration = minimumTransferDuration || Defaults.defaultMinimumTransferDuration;\n    resolvedQuery.maximumTransferDuration = maximumTransferDuration ||\n      Units.toDuration(maximumTransferDistance, resolvedQuery.minimumWalkingSpeed) ||\n      Defaults.defaultMaximumTransferDuration;\n\n    resolvedQuery.maximumTransfers = maximumTransfers || Defaults.defaultMaximumTransfers;\n\n    return resolvedQuery;\n  }\n}\n","import \"isomorphic-fetch\";\nimport \"reflect-metadata\";\n\nimport IsochroneGenerator from \"./analytics/isochrones/main\";\nimport EventBus_ from \"./events/EventBus\";\nimport EventType from \"./events/EventType\";\nimport BasicTrainPlanner from \"./planner/configurations/BasicTrainPlanner\";\nimport DissectPlanner from \"./planner/configurations/DissectPlanner\";\nimport TransitCarPlanner from \"./planner/configurations/TransitCarPlanner\";\nimport TriangleDemoPlanner from \"./planner/configurations/TriangleDemoPlanner\";\nimport Units from \"./util/Units\";\n\nexport { default as EventType } from \"./events/EventType\";\nexport { default as IsochroneGenerator } from \"./analytics/isochrones/main\";\nexport { default as Units } from \"./util/Units\";\nexport { default as BasicTrainPlanner } from \"./planner/configurations/BasicTrainPlanner\";\nexport { default as DissectPlanner } from \"./planner/configurations/DissectPlanner\";\nexport { default as TransitCarPlanner } from \"./planner/configurations/TransitCarPlanner\";\nexport { default as TriangleDemoPlanner } from \"./planner/configurations/TriangleDemoPlanner\";\n\nexport const EventBus = EventBus_.getInstance();\n\nexport default {\n    EventType,\n    IsochroneGenerator,\n    Units,\n    EventBus,\n    BasicTrainPlanner,\n    DissectPlanner,\n    TransitCarPlanner,\n    TriangleDemoPlanner,\n};\n","// the whatwg-fetch polyfill installs the fetch() function\n// on the global object (window or self)\n//\n// Return that as the export for use in Webpack, Browserify etc.\nrequire('whatwg-fetch');\nmodule.exports = self.fetch.bind(self);\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122 § 4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","import { EventEmitter } from \"events\";\nimport \"isomorphic-fetch\";\nimport \"reflect-metadata\";\nimport inBBox from \"tiles-in-bbox\";\nimport Profile from \"../../entities/profile/Profile\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport RoutingPhase from \"../../enums/RoutingPhase\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport ProfileProvider from \"../../fetcher/profiles/ProfileProviderDefault\";\nimport IRoutableTileProvider from \"../../fetcher/tiles/IRoutableTileProvider\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport defaultContainer from \"../../inversify.config\";\nimport { IPathTree } from \"../../pathfinding/pathfinder\";\nimport PathfinderProvider from \"../../pathfinding/PathfinderProvider\";\nimport TYPES from \"../../types\";\nimport Geo from \"../../util/Geo\";\nimport { toTileCoordinate } from \"../../util/Tiles\";\nimport { visualizeConcaveIsochrone, visualizeIsochrone } from \"./visualize\";\n\nexport default class IsochroneGenerator {\n    private pathfinderProvider: PathfinderProvider;\n    private tileProvider: IRoutableTileProvider;\n    private reachedTiles: Set<string>;\n    private startPoint: ILocation;\n    private registry: RoutableTileRegistry;\n    private profileProvider: ProfileProvider;\n    private eventBus: EventEmitter;\n\n    private activeProfile: Promise<Profile>;\n    private loaded: Promise<boolean>;\n    private embedded: boolean;\n    private showIncremental: boolean;\n    private showDebugLogs: boolean;\n\n    constructor(point: ILocation, container = defaultContainer) {\n        this.tileProvider = container.getTagged<IRoutableTileProvider>(\n            TYPES.RoutableTileProvider,\n            \"phase\",\n            RoutingPhase.Base,\n        );\n        this.pathfinderProvider = container.get<PathfinderProvider>(TYPES.PathfinderProvider);\n        this.registry = container.get<RoutableTileRegistry>(TYPES.RoutableTileRegistry);\n        this.profileProvider = container.get<ProfileProvider>(TYPES.ProfileProvider);\n        this.eventBus = EventBus.getInstance();\n        this.reachedTiles = new Set();\n        this.startPoint = point;\n        this.showIncremental = false;\n        this.showDebugLogs = false;\n        this.embedded = false;\n\n        this.setProfileID(\"http://hdelva.be/profile/car\");\n    }\n\n    public enableIncrementalResults() {\n        this.showIncremental = true;\n    }\n\n    public enableDebugLogs() {\n        this.showDebugLogs = true;\n    }\n\n    public async setDevelopmentProfile(blob: object) {\n        const id = await this.profileProvider.parseDevelopmentProfile(blob);\n        this.setProfileID(id);\n    }\n\n    public async setProfileID(profileID: string) {\n        this.activeProfile = this.profileProvider.getProfile(profileID);\n        this.embedded = false;\n    }\n\n    public async getIsochrone(maxDuration: number, reset = true) {\n        if (this.showDebugLogs) {\n            console.time(Geo.getId(this.startPoint));\n            console.log(`Generating the ${maxDuration / 1000}s isochrone ` +\n                `from ${this.startPoint.latitude}, ${this.startPoint.longitude}`);\n        }\n\n        if (!this.embedded) {\n            await this.embedBeginPoint(this.startPoint);\n            this.embedded = true;\n        }\n\n        await this.loaded;\n        const profile = await this.activeProfile;\n\n        if (this.showDebugLogs) {\n            console.log(`Using the ${profile.getID()} profile`);\n        }\n\n        const pathfinder = this.pathfinderProvider.getShortestPathTreeAlgorithm(profile);\n\n        // wait for all data to arrive\n        await this.tileProvider.wait();\n\n        let pathTree: IPathTree;\n        pathfinder.setUseWeightedCost(false); // we want the raw durations\n        if (reset) {\n            pathTree = await pathfinder.start(Geo.getId(this.startPoint), maxDuration);\n        } else {\n            pathTree = await pathfinder.continue(maxDuration);\n        }\n\n        if (this.showDebugLogs) {\n            console.log(`Path tree computed using ${this.reachedTiles.size} tiles.`);\n            console.timeEnd(Geo.getId(this.startPoint));\n            console.time(Geo.getId(this.startPoint));\n        }\n\n        const result = await visualizeConcaveIsochrone(pathTree, maxDuration, this.registry);\n\n        if (this.showDebugLogs) {\n            console.timeEnd(Geo.getId(this.startPoint));\n        }\n\n        return result;\n    }\n\n    private async fetchTile(coordinate: RoutableTileCoordinate) {\n        const tileId = this.tileProvider.getIdForTileCoords(coordinate);\n        if (!this.reachedTiles.has(tileId)) {\n            this.eventBus.emit(EventType.FetchTile, coordinate);\n\n            const profile = await this.activeProfile;\n            const pathfinder = this.pathfinderProvider.getShortestPathTreeAlgorithm(profile);\n            const tile = await this.tileProvider.getByTileCoords(coordinate);\n            this.reachedTiles.add(tileId);\n            const boundaryNodes: Set<string> = new Set();\n\n            for (const nodeId of tile.getNodes()) {\n                pathfinder.removeBreakPoint(nodeId);\n                const node = this.registry.getNode(nodeId);\n                if (!tile.contains(node)) {\n                    boundaryNodes.add(nodeId);\n                }\n\n                if (this.showIncremental) {\n                    pathfinder.setBreakPoint(nodeId, async (on: string) => {\n                        const innerNode = self.registry.getNode(on);\n                        if (innerNode) {\n                            self.eventBus.emit(EventType.PointReached, innerNode);\n                        }\n                    });\n                }\n            }\n\n            const self = this;\n            for (const nodeId of boundaryNodes) {\n                const node = self.registry.getNode(nodeId);\n                const boundaryTileCoordinate = toTileCoordinate(node.latitude, node.longitude);\n\n                pathfinder.setBreakPoint(nodeId, async (on: string) => {\n                    await self.fetchTile(boundaryTileCoordinate);\n                });\n            }\n        }\n    }\n\n    private async embedBeginPoint(from: ILocation) {\n        const zoom = 14;\n        const padding = 0.005;\n\n        const fromBBox = {\n            top: from.latitude + padding,\n            bottom: from.latitude - padding,\n            left: from.longitude - padding,\n            right: from.longitude + padding,\n        };\n\n        const fromTileCoords = inBBox.tilesInBbox(fromBBox, zoom).map((obj) => {\n            const coordinate = new RoutableTileCoordinate(zoom, obj.x, obj.y);\n            this.fetchTile(coordinate);\n            return coordinate;\n        });\n\n        // this won't download anything new\n        // but we need the tile data to embed the starting location\n        const fromTileset = await this.tileProvider.getMultipleByTileCoords(fromTileCoords);\n        await this.pathfinderProvider.embedLocation(from, fromTileset);\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar MetadataReader = (function () {\n    function MetadataReader() {\n    }\n    MetadataReader.prototype.getConstructorMetadata = function (constructorFunc) {\n        var compilerGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.PARAM_TYPES, constructorFunc);\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED, constructorFunc);\n        return {\n            compilerGeneratedMetadata: compilerGeneratedMetadata,\n            userGeneratedMetadata: userGeneratedMetadata || {}\n        };\n    };\n    MetadataReader.prototype.getPropertiesMetadata = function (constructorFunc) {\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED_PROP, constructorFunc) || [];\n        return userGeneratedMetadata;\n    };\n    return MetadataReader;\n}());\nexports.MetadataReader = MetadataReader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction isStackOverflowExeption(error) {\n    return (error instanceof RangeError ||\n        error.message === ERROR_MSGS.STACK_OVERFLOW);\n}\nexports.isStackOverflowExeption = isStackOverflowExeption;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar error_msgs_1 = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nvar LazyServiceIdentifer = (function () {\n    function LazyServiceIdentifer(cb) {\n        this._cb = cb;\n    }\n    LazyServiceIdentifer.prototype.unwrap = function () {\n        return this._cb();\n    };\n    return LazyServiceIdentifer;\n}());\nexports.LazyServiceIdentifer = LazyServiceIdentifer;\nfunction inject(serviceIdentifier) {\n    return function (target, targetKey, index) {\n        if (serviceIdentifier === undefined) {\n            throw new Error(error_msgs_1.UNDEFINED_INJECT_ANNOTATION(target.name));\n        }\n        var metadata = new metadata_1.Metadata(METADATA_KEY.INJECT_TAG, serviceIdentifier);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.inject = inject;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar id_1 = require(\"../utils/id\");\nvar metadata_1 = require(\"./metadata\");\nvar queryable_string_1 = require(\"./queryable_string\");\nvar Target = (function () {\n    function Target(type, name, serviceIdentifier, namedOrTagged) {\n        this.id = id_1.id();\n        this.type = type;\n        this.serviceIdentifier = serviceIdentifier;\n        this.name = new queryable_string_1.QueryableString(name || \"\");\n        this.metadata = new Array();\n        var metadataItem = null;\n        if (typeof namedOrTagged === \"string\") {\n            metadataItem = new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, namedOrTagged);\n        }\n        else if (namedOrTagged instanceof metadata_1.Metadata) {\n            metadataItem = namedOrTagged;\n        }\n        if (metadataItem !== null) {\n            this.metadata.push(metadataItem);\n        }\n    }\n    Target.prototype.hasTag = function (key) {\n        for (var _i = 0, _a = this.metadata; _i < _a.length; _i++) {\n            var m = _a[_i];\n            if (m.key === key) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Target.prototype.isArray = function () {\n        return this.hasTag(METADATA_KEY.MULTI_INJECT_TAG);\n    };\n    Target.prototype.matchesArray = function (name) {\n        return this.matchesTag(METADATA_KEY.MULTI_INJECT_TAG)(name);\n    };\n    Target.prototype.isNamed = function () {\n        return this.hasTag(METADATA_KEY.NAMED_TAG);\n    };\n    Target.prototype.isTagged = function () {\n        return this.metadata.some(function (m) {\n            return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                (m.key !== METADATA_KEY.NAME_TAG) &&\n                (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                (m.key !== METADATA_KEY.NAMED_TAG);\n        });\n    };\n    Target.prototype.isOptional = function () {\n        return this.matchesTag(METADATA_KEY.OPTIONAL_TAG)(true);\n    };\n    Target.prototype.getNamedTag = function () {\n        if (this.isNamed()) {\n            return this.metadata.filter(function (m) { return m.key === METADATA_KEY.NAMED_TAG; })[0];\n        }\n        return null;\n    };\n    Target.prototype.getCustomTags = function () {\n        if (this.isTagged()) {\n            return this.metadata.filter(function (m) {\n                return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.NAME_TAG) &&\n                    (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                    (m.key !== METADATA_KEY.NAMED_TAG);\n            });\n        }\n        return null;\n    };\n    Target.prototype.matchesNamedTag = function (name) {\n        return this.matchesTag(METADATA_KEY.NAMED_TAG)(name);\n    };\n    Target.prototype.matchesTag = function (key) {\n        var _this = this;\n        return function (value) {\n            for (var _i = 0, _a = _this.metadata; _i < _a.length; _i++) {\n                var m = _a[_i];\n                if (m.key === key && m.value === value) {\n                    return true;\n                }\n            }\n            return false;\n        };\n    };\n    return Target;\n}());\nexports.Target = Target;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingWhenOnSyntax = (function () {\n    function BindingWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    }\n    BindingWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingWhenOnSyntax;\n}());\nexports.BindingWhenOnSyntax = BindingWhenOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar traverseAncerstors = function (request, constraint) {\n    var parent = request.parentRequest;\n    if (parent !== null) {\n        return constraint(parent) ? true : traverseAncerstors(parent, constraint);\n    }\n    else {\n        return false;\n    }\n};\nexports.traverseAncerstors = traverseAncerstors;\nvar taggedConstraint = function (key) { return function (value) {\n    var constraint = function (request) {\n        return request !== null && request.target !== null && request.target.matchesTag(key)(value);\n    };\n    constraint.metaData = new metadata_1.Metadata(key, value);\n    return constraint;\n}; };\nexports.taggedConstraint = taggedConstraint;\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\nexports.namedConstraint = namedConstraint;\nvar typeConstraint = function (type) { return function (request) {\n    var binding = null;\n    if (request !== null) {\n        binding = request.bindings[0];\n        if (typeof type === \"string\") {\n            var serviceIdentifier = binding.serviceIdentifier;\n            return serviceIdentifier === type;\n        }\n        else {\n            var constructor = request.bindings[0].implementationType;\n            return type === constructor;\n        }\n    }\n    return false;\n}; };\nexports.typeConstraint = typeConstraint;\n","import { EventEmitter } from \"events\";\nimport { Container, interfaces } from \"inversify\";\nimport Catalog from \"./Catalog\";\nimport catalogDeLijn from \"./catalog.delijn\";\nimport catalogMivb from \"./catalog.mivb\";\nimport catalogNmbs from \"./catalog.nmbs\";\nimport catalogTec from \"./catalog.tec\";\nimport Context from \"./Context\";\nimport RoutableTileRegistry from \"./entities/tiles/registry\";\nimport ReachableStopsSearchPhase from \"./enums/ReachableStopsSearchPhase\";\nimport RoutingPhase from \"./enums/RoutingPhase\";\nimport TravelMode from \"./enums/TravelMode\";\nimport ConnectionsFetcherRaw from \"./fetcher/connections/ConnectionsFetcherRaw\";\nimport ConnectionsProviderDefault from \"./fetcher/connections/ConnectionsProviderDefault\";\nimport IConnectionsFetcher from \"./fetcher/connections/IConnectionsFetcher\";\nimport IConnectionsProvider from \"./fetcher/connections/IConnectionsProvider\";\nimport FootpathsProviderDefault from \"./fetcher/footpaths/FootpathsProviderDefault\";\nimport IFootpathsFetcher from \"./fetcher/footpaths/IFootpathsProvider\";\nimport LDFetch from \"./fetcher/LDFetch\";\nimport IProfileFetcher from \"./fetcher/profiles/IProfileFetcher\";\nimport IProfileProvider from \"./fetcher/profiles/IProfileProvider\";\nimport ProfileFetcherDefault from \"./fetcher/profiles/ProfileFetcherDefault\";\nimport ProfileProviderDefault from \"./fetcher/profiles/ProfileProviderDefault\";\nimport IStopsFetcher from \"./fetcher/stops/IStopsFetcher\";\nimport IStopsProvider from \"./fetcher/stops/IStopsProvider\";\nimport StopsFetcherLDFetch from \"./fetcher/stops/ld-fetch/StopsFetcherLDFetch\";\nimport StopsProviderDefault from \"./fetcher/stops/StopsProviderDefault\";\nimport IRoutableTileFetcher from \"./fetcher/tiles/IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"./fetcher/tiles/IRoutableTileProvider\";\nimport RoutableTileFetcherDefault from \"./fetcher/tiles/RoutableTileFetcherDefault\";\nimport RoutableTileFetcherExtended from \"./fetcher/tiles/RoutableTileFetcherExtended\";\nimport RoutableTileFetcherRaw from \"./fetcher/tiles/RoutableTileFetcherRaw\";\nimport RoutableTileProviderDefault from \"./fetcher/tiles/RoutableTileProviderDefault\";\nimport RoutableTileProviderTransit from \"./fetcher/tiles/RoutableTileProviderTransit\";\n\nimport { LDLoader } from \"./loader/ldloader\";\nimport DijkstraTree from \"./pathfinding/dijkstra-tree/DijkstraTree\";\nimport { Dijkstra } from \"./pathfinding/dijkstra/Dijkstra\";\nimport { IShortestPathAlgorithm, IShortestPathTreeAlgorithm } from \"./pathfinding/pathfinder\";\nimport PathfinderProvider from \"./pathfinding/PathfinderProvider\";\nimport CSAEarliestArrival from \"./planner/public-transport/CSAEarliestArrival\";\nimport IJourneyExtractor from \"./planner/public-transport/IJourneyExtractor\";\nimport IPublicTransportPlanner from \"./planner/public-transport/IPublicTransportPlanner\";\nimport JourneyExtractorProfile from \"./planner/public-transport/JourneyExtractorProfile\";\nimport IRoadPlanner from \"./planner/road/IRoadPlanner\";\nimport RoadPlannerPathfinding from \"./planner/road/RoadPlannerPathfinding\";\nimport IReachableStopsFinder from \"./planner/stops/IReachableStopsFinder\";\nimport ReachableStopsFinderDelaunay from \"./planner/stops/ReachableStopsFinderDelaunay\";\nimport ReachableStopsFinderFootpaths from \"./planner/stops/ReachableStopsFinderFootpaths\";\nimport QueryRunnerExponential from \"./query-runner/exponential/QueryRunnerExponential\";\nimport ILocationResolver from \"./query-runner/ILocationResolver\";\nimport IQueryRunner from \"./query-runner/IQueryRunner\";\nimport LocationResolverConvenience from \"./query-runner/LocationResolverConvenience\";\nimport TYPES from \"./types\";\n\nconst container = new Container();\ncontainer.bind<Context>(TYPES.Context).to(Context).inSingletonScope();\ncontainer.bind<IQueryRunner>(TYPES.QueryRunner).to(QueryRunnerExponential);\ncontainer.bind<ILocationResolver>(TYPES.LocationResolver).to(LocationResolverConvenience);\n\ncontainer.bind<IPublicTransportPlanner>(TYPES.PublicTransportPlanner)\n  .to(CSAEarliestArrival);\ncontainer.bind<interfaces.Factory<IPublicTransportPlanner>>(TYPES.PublicTransportPlannerFactory)\n  .toAutoFactory<IPublicTransportPlanner>(TYPES.PublicTransportPlanner);\n\ncontainer.bind<IRoadPlanner>(TYPES.RoadPlanner)\n  .to(RoadPlannerPathfinding);\n\ncontainer.bind<IShortestPathTreeAlgorithm>(TYPES.ShortestPathTreeAlgorithm).to(DijkstraTree).inSingletonScope();\ncontainer.bind<IShortestPathAlgorithm>(TYPES.ShortestPathAlgorithm).to(Dijkstra).inSingletonScope();\ncontainer.bind<PathfinderProvider>(TYPES.PathfinderProvider).to(PathfinderProvider).inSingletonScope();\ncontainer.bind<IProfileFetcher>(TYPES.ProfileFetcher).to(ProfileFetcherDefault).inSingletonScope();\ncontainer.bind<IProfileProvider>(TYPES.ProfileProvider).to(ProfileProviderDefault).inSingletonScope();\n\n// TODO, make this a fixed property of the planner itself\ncontainer.bind<IJourneyExtractor>(TYPES.JourneyExtractor)\n  .to(JourneyExtractorProfile);\n\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Initial);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderFootpaths).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Transfer);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Final);\n\ncontainer.bind<IConnectionsProvider>(TYPES.ConnectionsProvider).to(ConnectionsProviderDefault).inSingletonScope();\ncontainer.bind<IConnectionsFetcher>(TYPES.ConnectionsFetcher).to(ConnectionsFetcherRaw);\ncontainer.bind<interfaces.Factory<IConnectionsFetcher>>(TYPES.ConnectionsFetcherFactory)\n  .toFactory<IConnectionsFetcher>(\n    (context: interfaces.Context) =>\n      (travelMode: TravelMode) => {\n        const fetcher = context.container.get<ConnectionsFetcherRaw>(TYPES.ConnectionsFetcher);\n        fetcher.setTravelMode(travelMode);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<IStopsProvider>(TYPES.StopsProvider).to(StopsProviderDefault).inSingletonScope();\ncontainer.bind<IStopsFetcher>(TYPES.StopsFetcher).to(StopsFetcherLDFetch);\ncontainer.bind<interfaces.Factory<IStopsFetcher>>(TYPES.StopsFetcherFactory)\n  .toFactory<IStopsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string) => {\n        const fetcher = context.container.get<StopsFetcherLDFetch>(TYPES.StopsFetcher);\n        fetcher.setAccessUrl(accessUrl);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<RoutableTileRegistry>(TYPES.RoutableTileRegistry).to(RoutableTileRegistry).inSingletonScope();\ncontainer.bind<IRoutableTileFetcher>(TYPES.RoutableTileFetcher).to(RoutableTileFetcherRaw).inSingletonScope();\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderDefault).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Base);\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderTransit).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Transit);\n\ncontainer.bind<IFootpathsFetcher>(TYPES.FootpathsProvider).to(FootpathsProviderDefault).inSingletonScope();\n\n// Bind catalog\ncontainer.bind<Catalog>(TYPES.Catalog).toConstantValue(catalogNmbs);\n\n// Init LDFetch\ncontainer.bind<LDFetch>(TYPES.LDFetch).to(LDFetch).inSingletonScope();\n\ncontainer.bind<LDLoader>(TYPES.LDLoader).to(LDLoader);\n\nexport default container;\n","var __self__ = (function (root) {\nfunction F() {\nthis.fetch = false;\nthis.DOMException = root.DOMException\n}\nF.prototype = root;\nreturn new F();\n})(typeof self !== 'undefined' ? self : this);\n(function(self) {\n\nvar irrelevant = (function (exports) {\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  return exports;\n\n}({}));\n})(__self__);\ndelete __self__.fetch.polyfill\nexports = __self__.fetch // To enable: import fetch from 'cross-fetch'\nexports.default = __self__.fetch // For TypeScript consumers without esModuleInterop.\nexports.fetch = __self__.fetch // To enable: import {fetch} from 'cross-fetch'\nexports.Headers = __self__.Headers\nexports.Request = __self__.Request\nexports.Response = __self__.Response\nmodule.exports = exports\n","import { inject, injectable } from \"inversify\";\nimport LDFetch from \"ldfetch\";\nimport { Footpath, IFootpathIndex } from \"../../entities/footpaths/footpath\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport { LDLoader } from \"../../loader/ldloader\";\nimport { IndexThingView } from \"../../loader/views\";\nimport TYPES from \"../../types\";\nimport { PLANNER } from \"../../uri/constants\";\nimport URI from \"../../uri/uri\";\nimport { lat_to_tile, long_to_tile } from \"../../util/Tiles\";\nimport IStop from \"../stops/IStop\";\nimport IFootpathsProvider from \"./IFootpathsProvider\";\n\nconst ZOOM = 12;\n\ninterface ITiledFootpathIndex {\n    [id: string]: Promise<IFootpathIndex>;\n}\n\n@injectable()\nexport default class FootpathsProviderDefault implements IFootpathsProvider {\n\n    protected ldFetch: LDFetch;\n    protected ldLoader: LDLoader;\n    protected paths: ITiledFootpathIndex;\n\n    constructor(\n        @inject(TYPES.LDFetch) ldFetch: LDFetch,\n    ) {\n        this.ldFetch = ldFetch;\n        this.ldLoader = new LDLoader();\n        this.paths = {};\n    }\n\n    public async get(stop: IStop): Promise<IFootpathIndex> {\n        const tileId = this.getIdForLocation(ZOOM, stop);\n        if (!this.paths[tileId]) {\n            this.paths[tileId] = this.getByUrl(tileId);\n        }\n\n        return this.paths[tileId];\n    }\n\n    public getIdForLocation(zoom: number, location: ILocation): string {\n        const y = lat_to_tile(location.latitude, zoom);\n        const x = long_to_tile(location.longitude, zoom);\n        const coordinate = new RoutableTileCoordinate(zoom, x, y );\n        return this.getIdForTileCoords(coordinate);\n      }\n\n    public getIdForTileCoords(coordinate: RoutableTileCoordinate): string {\n        return `https://hdelva.be/stops/distances/${coordinate.zoom}/${coordinate.x}/${coordinate.y}`;\n    }\n\n    public getByLocation(zoom: number, location: ILocation): Promise<IFootpathIndex> {\n        const y = lat_to_tile(location.latitude, zoom);\n        const x = long_to_tile(location.longitude, zoom);\n        const coordinate = new RoutableTileCoordinate(zoom, x, y);\n        return this.getByTileCoords(coordinate);\n    }\n\n    public async getByTileCoords(coordinate: RoutableTileCoordinate): Promise<IFootpathIndex> {\n        const url = this.getIdForTileCoords(coordinate);\n        return await this.getByUrl(url);\n    }\n\n    protected async getByUrl(url: string): Promise<IFootpathIndex> {\n        const rdfThing = await this.ldFetch.get(url);\n        const triples = rdfThing.triples;\n\n        const [paths] = this.ldLoader.process(triples, [\n            this.getPathsView(),\n        ]);\n        return paths;\n    }\n\n    protected getPathsView() {\n        const nodesView = new IndexThingView(Footpath.create);\n        nodesView.addMapping(URI.inNS(PLANNER, \"source\"), \"from\");\n        nodesView.addMapping(URI.inNS(PLANNER, \"destination\"), \"to\");\n        nodesView.addMapping(URI.inNS(PLANNER, \"distance\"), \"distance\");\n        return nodesView;\n    }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// Mocks the (only) user of the q promise library by ldfetch\n\nmodule.exports = {\n  defer: () => {\n    const deferred = {};\n\n    deferred.promise = new Promise((resolve, reject) => {\n      deferred.resolve = resolve;\n      deferred.reject = reject;\n    });\n\n    return deferred;\n  }\n};\n","var ClientRequest = require('./lib/request')\nvar response = require('./lib/response')\nvar extend = require('xtend')\nvar statusCodes = require('builtin-status-codes')\nvar url = require('url')\n\nvar http = exports\n\nhttp.request = function (opts, cb) {\n\tif (typeof opts === 'string')\n\t\topts = url.parse(opts)\n\telse\n\t\topts = extend(opts)\n\n\t// Normally, the page is loaded from http or https, so not specifying a protocol\n\t// will result in a (valid) protocol-relative url. However, this won't work if\n\t// the protocol is something else, like 'file:'\n\tvar defaultProtocol = global.location.protocol.search(/^https?:$/) === -1 ? 'http:' : ''\n\n\tvar protocol = opts.protocol || defaultProtocol\n\tvar host = opts.hostname || opts.host\n\tvar port = opts.port\n\tvar path = opts.path || '/'\n\n\t// Necessary for IPv6 addresses\n\tif (host && host.indexOf(':') !== -1)\n\t\thost = '[' + host + ']'\n\n\t// This may be a relative url. The browser should always be able to interpret it correctly.\n\topts.url = (host ? (protocol + '//' + host) : '') + (port ? ':' + port : '') + path\n\topts.method = (opts.method || 'GET').toUpperCase()\n\topts.headers = opts.headers || {}\n\n\t// Also valid opts.auth, opts.mode\n\n\tvar req = new ClientRequest(opts)\n\tif (cb)\n\t\treq.on('response', cb)\n\treturn req\n}\n\nhttp.get = function get (opts, cb) {\n\tvar req = http.request(opts, cb)\n\treq.end()\n\treturn req\n}\n\nhttp.ClientRequest = ClientRequest\nhttp.IncomingMessage = response.IncomingMessage\n\nhttp.Agent = function () {}\nhttp.Agent.defaultMaxSockets = 4\n\nhttp.globalAgent = new http.Agent()\n\nhttp.STATUS_CODES = statusCodes\n\nhttp.METHODS = [\n\t'CHECKOUT',\n\t'CONNECT',\n\t'COPY',\n\t'DELETE',\n\t'GET',\n\t'HEAD',\n\t'LOCK',\n\t'M-SEARCH',\n\t'MERGE',\n\t'MKACTIVITY',\n\t'MKCOL',\n\t'MOVE',\n\t'NOTIFY',\n\t'OPTIONS',\n\t'PATCH',\n\t'POST',\n\t'PROPFIND',\n\t'PROPPATCH',\n\t'PURGE',\n\t'PUT',\n\t'REPORT',\n\t'SEARCH',\n\t'SUBSCRIBE',\n\t'TRACE',\n\t'UNLOCK',\n\t'UNSUBSCRIBE'\n]","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","exports.fetch = isFunction(global.fetch) && isFunction(global.ReadableStream)\n\nexports.writableStream = isFunction(global.WritableStream)\n\nexports.abortController = isFunction(global.AbortController)\n\nexports.blobConstructor = false\ntry {\n\tnew Blob([new ArrayBuffer(1)])\n\texports.blobConstructor = true\n} catch (e) {}\n\n// The xhr request to example.com may violate some restrictive CSP configurations,\n// so if we're running in a browser that supports `fetch`, avoid calling getXHR()\n// and assume support for certain features below.\nvar xhr\nfunction getXHR () {\n\t// Cache the xhr value\n\tif (xhr !== undefined) return xhr\n\n\tif (global.XMLHttpRequest) {\n\t\txhr = new global.XMLHttpRequest()\n\t\t// If XDomainRequest is available (ie only, where xhr might not work\n\t\t// cross domain), use the page location. Otherwise use example.com\n\t\t// Note: this doesn't actually make an http request.\n\t\ttry {\n\t\t\txhr.open('GET', global.XDomainRequest ? '/' : 'https://example.com')\n\t\t} catch(e) {\n\t\t\txhr = null\n\t\t}\n\t} else {\n\t\t// Service workers don't have XHR\n\t\txhr = null\n\t}\n\treturn xhr\n}\n\nfunction checkTypeSupport (type) {\n\tvar xhr = getXHR()\n\tif (!xhr) return false\n\ttry {\n\t\txhr.responseType = type\n\t\treturn xhr.responseType === type\n\t} catch (e) {}\n\treturn false\n}\n\n// For some strange reason, Safari 7.0 reports typeof global.ArrayBuffer === 'object'.\n// Safari 7.1 appears to have fixed this bug.\nvar haveArrayBuffer = typeof global.ArrayBuffer !== 'undefined'\nvar haveSlice = haveArrayBuffer && isFunction(global.ArrayBuffer.prototype.slice)\n\n// If fetch is supported, then arraybuffer will be supported too. Skip calling\n// checkTypeSupport(), since that calls getXHR().\nexports.arraybuffer = exports.fetch || (haveArrayBuffer && checkTypeSupport('arraybuffer'))\n\n// These next two tests unavoidably show warnings in Chrome. Since fetch will always\n// be used if it's available, just return false for these to avoid the warnings.\nexports.msstream = !exports.fetch && haveSlice && checkTypeSupport('ms-stream')\nexports.mozchunkedarraybuffer = !exports.fetch && haveArrayBuffer &&\n\tcheckTypeSupport('moz-chunked-arraybuffer')\n\n// If fetch is supported, then overrideMimeType will be supported too. Skip calling\n// getXHR().\nexports.overrideMimeType = exports.fetch || (getXHR() ? isFunction(getXHR().overrideMimeType) : false)\n\nexports.vbArray = isFunction(global.VBArray)\n\nfunction isFunction (value) {\n\treturn typeof value === 'function'\n}\n\nxhr = null // Help gc\n","var capability = require('./capability')\nvar inherits = require('inherits')\nvar stream = require('readable-stream')\n\nvar rStates = exports.readyStates = {\n\tUNSENT: 0,\n\tOPENED: 1,\n\tHEADERS_RECEIVED: 2,\n\tLOADING: 3,\n\tDONE: 4\n}\n\nvar IncomingMessage = exports.IncomingMessage = function (xhr, response, mode, fetchTimer) {\n\tvar self = this\n\tstream.Readable.call(self)\n\n\tself._mode = mode\n\tself.headers = {}\n\tself.rawHeaders = []\n\tself.trailers = {}\n\tself.rawTrailers = []\n\n\t// Fake the 'close' event, but only once 'end' fires\n\tself.on('end', function () {\n\t\t// The nextTick is necessary to prevent the 'request' module from causing an infinite loop\n\t\tprocess.nextTick(function () {\n\t\t\tself.emit('close')\n\t\t})\n\t})\n\n\tif (mode === 'fetch') {\n\t\tself._fetchResponse = response\n\n\t\tself.url = response.url\n\t\tself.statusCode = response.status\n\t\tself.statusMessage = response.statusText\n\t\t\n\t\tresponse.headers.forEach(function (header, key){\n\t\t\tself.headers[key.toLowerCase()] = header\n\t\t\tself.rawHeaders.push(key, header)\n\t\t})\n\n\t\tif (capability.writableStream) {\n\t\t\tvar writable = new WritableStream({\n\t\t\t\twrite: function (chunk) {\n\t\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\t\tif (self._destroyed) {\n\t\t\t\t\t\t\treject()\n\t\t\t\t\t\t} else if(self.push(new Buffer(chunk))) {\n\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself._resumeFetch = resolve\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tclose: function () {\n\t\t\t\t\tglobal.clearTimeout(fetchTimer)\n\t\t\t\t\tif (!self._destroyed)\n\t\t\t\t\t\tself.push(null)\n\t\t\t\t},\n\t\t\t\tabort: function (err) {\n\t\t\t\t\tif (!self._destroyed)\n\t\t\t\t\t\tself.emit('error', err)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\ttry {\n\t\t\t\tresponse.body.pipeTo(writable).catch(function (err) {\n\t\t\t\t\tglobal.clearTimeout(fetchTimer)\n\t\t\t\t\tif (!self._destroyed)\n\t\t\t\t\t\tself.emit('error', err)\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t} catch (e) {} // pipeTo method isn't defined. Can't find a better way to feature test this\n\t\t}\n\t\t// fallback for when writableStream or pipeTo aren't available\n\t\tvar reader = response.body.getReader()\n\t\tfunction read () {\n\t\t\treader.read().then(function (result) {\n\t\t\t\tif (self._destroyed)\n\t\t\t\t\treturn\n\t\t\t\tif (result.done) {\n\t\t\t\t\tglobal.clearTimeout(fetchTimer)\n\t\t\t\t\tself.push(null)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tself.push(new Buffer(result.value))\n\t\t\t\tread()\n\t\t\t}).catch(function (err) {\n\t\t\t\tglobal.clearTimeout(fetchTimer)\n\t\t\t\tif (!self._destroyed)\n\t\t\t\t\tself.emit('error', err)\n\t\t\t})\n\t\t}\n\t\tread()\n\t} else {\n\t\tself._xhr = xhr\n\t\tself._pos = 0\n\n\t\tself.url = xhr.responseURL\n\t\tself.statusCode = xhr.status\n\t\tself.statusMessage = xhr.statusText\n\t\tvar headers = xhr.getAllResponseHeaders().split(/\\r?\\n/)\n\t\theaders.forEach(function (header) {\n\t\t\tvar matches = header.match(/^([^:]+):\\s*(.*)/)\n\t\t\tif (matches) {\n\t\t\t\tvar key = matches[1].toLowerCase()\n\t\t\t\tif (key === 'set-cookie') {\n\t\t\t\t\tif (self.headers[key] === undefined) {\n\t\t\t\t\t\tself.headers[key] = []\n\t\t\t\t\t}\n\t\t\t\t\tself.headers[key].push(matches[2])\n\t\t\t\t} else if (self.headers[key] !== undefined) {\n\t\t\t\t\tself.headers[key] += ', ' + matches[2]\n\t\t\t\t} else {\n\t\t\t\t\tself.headers[key] = matches[2]\n\t\t\t\t}\n\t\t\t\tself.rawHeaders.push(matches[1], matches[2])\n\t\t\t}\n\t\t})\n\n\t\tself._charset = 'x-user-defined'\n\t\tif (!capability.overrideMimeType) {\n\t\t\tvar mimeType = self.rawHeaders['mime-type']\n\t\t\tif (mimeType) {\n\t\t\t\tvar charsetMatch = mimeType.match(/;\\s*charset=([^;])(;|$)/)\n\t\t\t\tif (charsetMatch) {\n\t\t\t\t\tself._charset = charsetMatch[1].toLowerCase()\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!self._charset)\n\t\t\t\tself._charset = 'utf-8' // best guess\n\t\t}\n\t}\n}\n\ninherits(IncomingMessage, stream.Readable)\n\nIncomingMessage.prototype._read = function () {\n\tvar self = this\n\n\tvar resolve = self._resumeFetch\n\tif (resolve) {\n\t\tself._resumeFetch = null\n\t\tresolve()\n\t}\n}\n\nIncomingMessage.prototype._onXHRProgress = function () {\n\tvar self = this\n\n\tvar xhr = self._xhr\n\n\tvar response = null\n\tswitch (self._mode) {\n\t\tcase 'text:vbarray': // For IE9\n\t\t\tif (xhr.readyState !== rStates.DONE)\n\t\t\t\tbreak\n\t\t\ttry {\n\t\t\t\t// This fails in IE8\n\t\t\t\tresponse = new global.VBArray(xhr.responseBody).toArray()\n\t\t\t} catch (e) {}\n\t\t\tif (response !== null) {\n\t\t\t\tself.push(new Buffer(response))\n\t\t\t\tbreak\n\t\t\t}\n\t\t\t// Falls through in IE8\t\n\t\tcase 'text':\n\t\t\ttry { // This will fail when readyState = 3 in IE9. Switch mode and wait for readyState = 4\n\t\t\t\tresponse = xhr.responseText\n\t\t\t} catch (e) {\n\t\t\t\tself._mode = 'text:vbarray'\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tif (response.length > self._pos) {\n\t\t\t\tvar newData = response.substr(self._pos)\n\t\t\t\tif (self._charset === 'x-user-defined') {\n\t\t\t\t\tvar buffer = new Buffer(newData.length)\n\t\t\t\t\tfor (var i = 0; i < newData.length; i++)\n\t\t\t\t\t\tbuffer[i] = newData.charCodeAt(i) & 0xff\n\n\t\t\t\t\tself.push(buffer)\n\t\t\t\t} else {\n\t\t\t\t\tself.push(newData, self._charset)\n\t\t\t\t}\n\t\t\t\tself._pos = response.length\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'arraybuffer':\n\t\t\tif (xhr.readyState !== rStates.DONE || !xhr.response)\n\t\t\t\tbreak\n\t\t\tresponse = xhr.response\n\t\t\tself.push(new Buffer(new Uint8Array(response)))\n\t\t\tbreak\n\t\tcase 'moz-chunked-arraybuffer': // take whole\n\t\t\tresponse = xhr.response\n\t\t\tif (xhr.readyState !== rStates.LOADING || !response)\n\t\t\t\tbreak\n\t\t\tself.push(new Buffer(new Uint8Array(response)))\n\t\t\tbreak\n\t\tcase 'ms-stream':\n\t\t\tresponse = xhr.response\n\t\t\tif (xhr.readyState !== rStates.LOADING)\n\t\t\t\tbreak\n\t\t\tvar reader = new global.MSStreamReader()\n\t\t\treader.onprogress = function () {\n\t\t\t\tif (reader.result.byteLength > self._pos) {\n\t\t\t\t\tself.push(new Buffer(new Uint8Array(reader.result.slice(self._pos))))\n\t\t\t\t\tself._pos = reader.result.byteLength\n\t\t\t\t}\n\t\t\t}\n\t\t\treader.onload = function () {\n\t\t\t\tself.push(null)\n\t\t\t}\n\t\t\t// reader.onerror = ??? // TODO: this\n\t\t\treader.readAsArrayBuffer(response)\n\t\t\tbreak\n\t}\n\n\t// The ms-stream case handles end separately in reader.onload()\n\tif (self._xhr.readyState === rStates.DONE && self._mode !== 'ms-stream') {\n\t\tself.push(null)\n\t}\n}\n","exports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = exports;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar isArray = require('isarray');\n/*</replacement>*/\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\n\nvar EElistenerCount = function (emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\nvar OurUint8Array = global.Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*</replacement>*/\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug = void 0;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function () {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/BufferList');\nvar destroyImpl = require('./internal/streams/destroy');\nvar StringDecoder;\n\nutil.inherits(Readable, Stream);\n\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\n\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\n\nfunction ReadableState(options, stream) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  var isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  var hwm = options.highWaterMark;\n  var readableHwm = options.readableHighWaterMark;\n  var defaultHwm = this.objectMode ? 16 : 16 * 1024;\n\n  if (hwm || hwm === 0) this.highWaterMark = hwm;else if (isDuplex && (readableHwm || readableHwm === 0)) this.highWaterMark = readableHwm;else this.highWaterMark = defaultHwm;\n\n  // cast to ints.\n  this.highWaterMark = Math.floor(this.highWaterMark);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\n\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  this._readableState = new ReadableState(options, this);\n\n  // legacy\n  this.readable = true;\n\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n\n  Stream.call(this);\n}\n\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  get: function () {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\n\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  this.push(null);\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\n\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      stream.emit('error', er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n\n      if (addToFront) {\n        if (state.endEmitted) stream.emit('error', new Error('stream.unshift() after end event'));else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        stream.emit('error', new Error('stream.push() after EOF'));\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n    }\n  }\n\n  return needMoreData(state);\n}\n\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    stream.emit('data', chunk);\n    stream.read(0);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\n\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  return er;\n}\n\n// if it's past the high water mark, we can push in some more.\n// Also, if we have no data yet, we can stand some\n// more bytes.  This is to work around cases where hwm=0,\n// such as the repl.  Also, if the push() triggered a\n// readable event, and the user called read(largeNumber) such that\n// needReadable was set, then we ought to push more, so that another\n// 'readable' event will be triggered.\nfunction needMoreData(state) {\n  return !state.ended && (state.needReadable || state.length < state.highWaterMark || state.length === 0);\n}\n\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  this._readableState.decoder = new StringDecoder(enc);\n  this._readableState.encoding = enc;\n  return this;\n};\n\n// Don't raise the hwm > 8MB\nvar MAX_HWM = 0x800000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && (state.length >= state.highWaterMark || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n\n  if (ret === null) {\n    state.needReadable = true;\n    n = 0;\n  } else {\n    state.length -= n;\n  }\n\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n\n  if (ret !== null) this.emit('data', ret);\n\n  return ret;\n};\n\nfunction onEofChunk(stream, state) {\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n\n  // emit 'readable' now to make sure it gets picked up.\n  emitReadable(stream);\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    if (state.sync) pna.nextTick(emitReadable_, stream);else emitReadable_(stream);\n  }\n}\n\nfunction emitReadable_(stream) {\n  debug('emit readable');\n  stream.emit('readable');\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    pna.nextTick(maybeReadMore_, stream, state);\n  }\n}\n\nfunction maybeReadMore_(stream, state) {\n  var len = state.length;\n  while (!state.reading && !state.flowing && !state.ended && state.length < state.highWaterMark) {\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;else len = state.length;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  this.emit('error', new Error('_read() is not implemented'));\n};\n\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) pna.nextTick(endFn);else src.once('end', endFn);\n\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n\n  // If the user pushes more data while we're writing to dest then we'll end up\n  // in ondata again. However, we only want to increase awaitDrain once because\n  // dest will only emit one 'drain' event for the multiple writes.\n  // => Introduce a guard on increasing awaitDrain.\n  var increasedAwaitDrain = false;\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    increasedAwaitDrain = false;\n    var ret = dest.write(chunk);\n    if (false === ret && !increasedAwaitDrain) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', src._readableState.awaitDrain);\n        src._readableState.awaitDrain++;\n        increasedAwaitDrain = true;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) dest.emit('error', er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n\n  return dest;\n};\n\nfunction pipeOnDrain(src) {\n  return function () {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\n\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = { hasUnpiped: false };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n\n    for (var i = 0; i < len; i++) {\n      dests[i].emit('unpipe', this, unpipeInfo);\n    }return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n\n  dest.emit('unpipe', this, unpipeInfo);\n\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n\n  if (ev === 'data') {\n    // Start flowing on next tick if stream isn't explicitly paused\n    if (this._readableState.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    var state = this._readableState;\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.emittedReadable = false;\n      if (!state.reading) {\n        pna.nextTick(nReadingNextTick, this);\n      } else if (state.length) {\n        emitReadable(this);\n      }\n    }\n  }\n\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\n\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    state.flowing = true;\n    resume(this, state);\n  }\n  return this;\n};\n\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    pna.nextTick(resume_, stream, state);\n  }\n}\n\nfunction resume_(stream, state) {\n  if (!state.reading) {\n    debug('resume read 0');\n    stream.read(0);\n  }\n\n  state.resumeScheduled = false;\n  state.awaitDrain = 0;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\n\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (false !== this._readableState.flowing) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  return this;\n};\n\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null) {}\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n\n  var state = this._readableState;\n  var paused = false;\n\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n\n    _this.push(null);\n  });\n\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function (method) {\n        return function () {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n\n  return this;\n};\n\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._readableState.highWaterMark;\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.head.data;else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = fromListPartial(n, state.buffer, state.decoder);\n  }\n\n  return ret;\n}\n\n// Extracts only enough buffered data to satisfy the amount requested.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromListPartial(n, list, hasStrings) {\n  var ret;\n  if (n < list.head.data.length) {\n    // slice is the same for buffers and strings\n    ret = list.head.data.slice(0, n);\n    list.head.data = list.head.data.slice(n);\n  } else if (n === list.head.data.length) {\n    // first chunk is a perfect match\n    ret = list.shift();\n  } else {\n    // result spans more than one buffer\n    ret = hasStrings ? copyFromBufferString(n, list) : copyFromBuffer(n, list);\n  }\n  return ret;\n}\n\n// Copies a specified amount of characters from the list of buffered data\n// chunks.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction copyFromBufferString(n, list) {\n  var p = list.head;\n  var c = 1;\n  var ret = p.data;\n  n -= ret.length;\n  while (p = p.next) {\n    var str = p.data;\n    var nb = n > str.length ? str.length : n;\n    if (nb === str.length) ret += str;else ret += str.slice(0, n);\n    n -= nb;\n    if (n === 0) {\n      if (nb === str.length) {\n        ++c;\n        if (p.next) list.head = p.next;else list.head = list.tail = null;\n      } else {\n        list.head = p;\n        p.data = str.slice(nb);\n      }\n      break;\n    }\n    ++c;\n  }\n  list.length -= c;\n  return ret;\n}\n\n// Copies a specified amount of bytes from the list of buffered data chunks.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction copyFromBuffer(n, list) {\n  var ret = Buffer.allocUnsafe(n);\n  var p = list.head;\n  var c = 1;\n  p.data.copy(ret);\n  n -= p.data.length;\n  while (p = p.next) {\n    var buf = p.data;\n    var nb = n > buf.length ? buf.length : n;\n    buf.copy(ret, ret.length - n, 0, nb);\n    n -= nb;\n    if (n === 0) {\n      if (nb === buf.length) {\n        ++c;\n        if (p.next) list.head = p.next;else list.head = list.tail = null;\n      } else {\n        list.head = p;\n        p.data = buf.slice(nb);\n      }\n      break;\n    }\n    ++c;\n  }\n  list.length -= c;\n  return ret;\n}\n\nfunction endReadable(stream) {\n  var state = stream._readableState;\n\n  // If we get here before consuming all the bytes, then that is a\n  // bug in node.  Should never happen.\n  if (state.length > 0) throw new Error('\"endReadable()\" called on non-empty stream');\n\n  if (!state.endEmitted) {\n    state.ended = true;\n    pna.nextTick(endReadableNT, state, stream);\n  }\n}\n\nfunction endReadableNT(state, stream) {\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n  }\n}\n\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","module.exports = require('events').EventEmitter;\n","'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err && (!this._writableState || !this._writableState.errorEmitted)) {\n      pna.nextTick(emitErrorNT, this, err);\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      pna.nextTick(emitErrorNT, _this, err);\n      if (_this._writableState) {\n        _this._writableState.errorEmitted = true;\n      }\n    } else if (cb) {\n      cb(err);\n    }\n  });\n\n  return this;\n}\n\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\n\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\n\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar asyncWrite = !process.browser && ['v0.10', 'v0.9.'].indexOf(process.version.slice(0, 5)) > -1 ? setImmediate : pna.nextTick;\n/*</replacement>*/\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\nvar OurUint8Array = global.Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*</replacement>*/\n\nvar destroyImpl = require('./internal/streams/destroy');\n\nutil.inherits(Writable, Stream);\n\nfunction nop() {}\n\nfunction WritableState(options, stream) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  var isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  var hwm = options.highWaterMark;\n  var writableHwm = options.writableHighWaterMark;\n  var defaultHwm = this.objectMode ? 16 : 16 * 1024;\n\n  if (hwm || hwm === 0) this.highWaterMark = hwm;else if (isDuplex && (writableHwm || writableHwm === 0)) this.highWaterMark = writableHwm;else this.highWaterMark = defaultHwm;\n\n  // cast to ints.\n  this.highWaterMark = Math.floor(this.highWaterMark);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\n\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function () {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function (object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function (object) {\n    return object instanceof this;\n  };\n}\n\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n  if (!realHasInstance.call(Writable, this) && !(this instanceof Duplex)) {\n    return new Writable(options);\n  }\n\n  this._writableState = new WritableState(options, this);\n\n  // legacy.\n  this.writable = true;\n\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n\n    if (typeof options.writev === 'function') this._writev = options.writev;\n\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  this.emit('error', new Error('Cannot pipe, not readable'));\n};\n\nfunction writeAfterEnd(stream, cb) {\n  var er = new Error('write after end');\n  // TODO: defer error events consistently everywhere, not just the cb\n  stream.emit('error', er);\n  pna.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var valid = true;\n  var er = false;\n\n  if (chunk === null) {\n    er = new TypeError('May not write null values to stream');\n  } else if (typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  if (er) {\n    stream.emit('error', er);\n    pna.nextTick(cb, er);\n    valid = false;\n  }\n  return valid;\n}\n\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n\n  if (typeof cb !== 'function') cb = nop;\n\n  if (state.ended) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n\n  return ret;\n};\n\nWritable.prototype.cork = function () {\n  var state = this._writableState;\n\n  state.corked++;\n};\n\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n\n  if (state.corked) {\n    state.corked--;\n\n    if (!state.writing && !state.corked && !state.finished && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\n\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new TypeError('Unknown encoding: ' + encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\n\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\n\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n\n  state.length += len;\n\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n\n  return ret;\n}\n\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\n\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    pna.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    pna.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    stream.emit('error', er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    stream.emit('error', er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\n\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\n\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n\n  onwriteStateUpdate(state);\n\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state);\n\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n\n    if (sync) {\n      /*<replacement>*/\n      asyncWrite(afterWrite, stream, state, finished, cb);\n      /*</replacement>*/\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\n\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\n\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new Error('_write() is not implemented'));\n};\n\nWritable.prototype._writev = null;\n\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending && !state.finished) endWritable(this, state, cb);\n};\n\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      stream.emit('error', err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function') {\n      state.pendingcb++;\n      state.finalCalled = true;\n      pna.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\n\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n    }\n  }\n  return need;\n}\n\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) pna.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\n\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n  if (state.corkedRequestsFree) {\n    state.corkedRequestsFree.next = corkReq;\n  } else {\n    state.corkedRequestsFree = corkReq;\n  }\n}\n\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  get: function () {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\n\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  this.end();\n  cb(err);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\n/*</replacement>*/\n\nvar isEncoding = Buffer.isEncoding || function (encoding) {\n  encoding = '' + encoding;\n  switch (encoding && encoding.toLowerCase()) {\n    case 'hex':case 'utf8':case 'utf-8':case 'ascii':case 'binary':case 'base64':case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':case 'raw':\n      return true;\n    default:\n      return false;\n  }\n};\n\nfunction _normalizeEncoding(enc) {\n  if (!enc) return 'utf8';\n  var retried;\n  while (true) {\n    switch (enc) {\n      case 'utf8':\n      case 'utf-8':\n        return 'utf8';\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return 'utf16le';\n      case 'latin1':\n      case 'binary':\n        return 'latin1';\n      case 'base64':\n      case 'ascii':\n      case 'hex':\n        return enc;\n      default:\n        if (retried) return; // undefined\n        enc = ('' + enc).toLowerCase();\n        retried = true;\n    }\n  }\n};\n\n// Do not cache `Buffer.isEncoding` when checking encoding names as some\n// modules monkey-patch it to support additional encodings\nfunction normalizeEncoding(enc) {\n  var nenc = _normalizeEncoding(enc);\n  if (typeof nenc !== 'string' && (Buffer.isEncoding === isEncoding || !isEncoding(enc))) throw new Error('Unknown encoding: ' + enc);\n  return nenc || enc;\n}\n\n// StringDecoder provides an interface for efficiently splitting a series of\n// buffers into a series of JS strings without breaking apart multi-byte\n// characters.\nexports.StringDecoder = StringDecoder;\nfunction StringDecoder(encoding) {\n  this.encoding = normalizeEncoding(encoding);\n  var nb;\n  switch (this.encoding) {\n    case 'utf16le':\n      this.text = utf16Text;\n      this.end = utf16End;\n      nb = 4;\n      break;\n    case 'utf8':\n      this.fillLast = utf8FillLast;\n      nb = 4;\n      break;\n    case 'base64':\n      this.text = base64Text;\n      this.end = base64End;\n      nb = 3;\n      break;\n    default:\n      this.write = simpleWrite;\n      this.end = simpleEnd;\n      return;\n  }\n  this.lastNeed = 0;\n  this.lastTotal = 0;\n  this.lastChar = Buffer.allocUnsafe(nb);\n}\n\nStringDecoder.prototype.write = function (buf) {\n  if (buf.length === 0) return '';\n  var r;\n  var i;\n  if (this.lastNeed) {\n    r = this.fillLast(buf);\n    if (r === undefined) return '';\n    i = this.lastNeed;\n    this.lastNeed = 0;\n  } else {\n    i = 0;\n  }\n  if (i < buf.length) return r ? r + this.text(buf, i) : this.text(buf, i);\n  return r || '';\n};\n\nStringDecoder.prototype.end = utf8End;\n\n// Returns only complete characters in a Buffer\nStringDecoder.prototype.text = utf8Text;\n\n// Attempts to complete a partial non-UTF-8 character using bytes from a Buffer\nStringDecoder.prototype.fillLast = function (buf) {\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, buf.length);\n  this.lastNeed -= buf.length;\n};\n\n// Checks the type of a UTF-8 byte, whether it's ASCII, a leading byte, or a\n// continuation byte. If an invalid byte is detected, -2 is returned.\nfunction utf8CheckByte(byte) {\n  if (byte <= 0x7F) return 0;else if (byte >> 5 === 0x06) return 2;else if (byte >> 4 === 0x0E) return 3;else if (byte >> 3 === 0x1E) return 4;\n  return byte >> 6 === 0x02 ? -1 : -2;\n}\n\n// Checks at most 3 bytes at the end of a Buffer in order to detect an\n// incomplete multi-byte UTF-8 character. The total number of bytes (2, 3, or 4)\n// needed to complete the UTF-8 character (if applicable) are returned.\nfunction utf8CheckIncomplete(self, buf, i) {\n  var j = buf.length - 1;\n  if (j < i) return 0;\n  var nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 1;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 2;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) {\n      if (nb === 2) nb = 0;else self.lastNeed = nb - 3;\n    }\n    return nb;\n  }\n  return 0;\n}\n\n// Validates as many continuation bytes for a multi-byte UTF-8 character as\n// needed or are available. If we see a non-continuation byte where we expect\n// one, we \"replace\" the validated continuation bytes we've seen so far with\n// a single UTF-8 replacement character ('\\ufffd'), to match v8's UTF-8 decoding\n// behavior. The continuation byte check is included three times in the case\n// where all of the continuation bytes for a character exist in the same buffer.\n// It is also done this way as a slight performance increase instead of using a\n// loop.\nfunction utf8CheckExtraBytes(self, buf, p) {\n  if ((buf[0] & 0xC0) !== 0x80) {\n    self.lastNeed = 0;\n    return '\\ufffd';\n  }\n  if (self.lastNeed > 1 && buf.length > 1) {\n    if ((buf[1] & 0xC0) !== 0x80) {\n      self.lastNeed = 1;\n      return '\\ufffd';\n    }\n    if (self.lastNeed > 2 && buf.length > 2) {\n      if ((buf[2] & 0xC0) !== 0x80) {\n        self.lastNeed = 2;\n        return '\\ufffd';\n      }\n    }\n  }\n}\n\n// Attempts to complete a multi-byte UTF-8 character using bytes from a Buffer.\nfunction utf8FillLast(buf) {\n  var p = this.lastTotal - this.lastNeed;\n  var r = utf8CheckExtraBytes(this, buf, p);\n  if (r !== undefined) return r;\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, p, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, p, 0, buf.length);\n  this.lastNeed -= buf.length;\n}\n\n// Returns all complete UTF-8 characters in a Buffer. If the Buffer ended on a\n// partial character, the character's bytes are buffered until the required\n// number of bytes are available.\nfunction utf8Text(buf, i) {\n  var total = utf8CheckIncomplete(this, buf, i);\n  if (!this.lastNeed) return buf.toString('utf8', i);\n  this.lastTotal = total;\n  var end = buf.length - (total - this.lastNeed);\n  buf.copy(this.lastChar, 0, end);\n  return buf.toString('utf8', i, end);\n}\n\n// For UTF-8, a replacement character is added when ending on a partial\n// character.\nfunction utf8End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + '\\ufffd';\n  return r;\n}\n\n// UTF-16LE typically needs two bytes per character, but even if we have an even\n// number of bytes available, we need to check if we end on a leading/high\n// surrogate. In that case, we need to wait for the next two bytes in order to\n// decode the last character properly.\nfunction utf16Text(buf, i) {\n  if ((buf.length - i) % 2 === 0) {\n    var r = buf.toString('utf16le', i);\n    if (r) {\n      var c = r.charCodeAt(r.length - 1);\n      if (c >= 0xD800 && c <= 0xDBFF) {\n        this.lastNeed = 2;\n        this.lastTotal = 4;\n        this.lastChar[0] = buf[buf.length - 2];\n        this.lastChar[1] = buf[buf.length - 1];\n        return r.slice(0, -1);\n      }\n    }\n    return r;\n  }\n  this.lastNeed = 1;\n  this.lastTotal = 2;\n  this.lastChar[0] = buf[buf.length - 1];\n  return buf.toString('utf16le', i, buf.length - 1);\n}\n\n// For UTF-16LE we do not explicitly append special replacement characters if we\n// end on a partial character, we simply let v8 handle that.\nfunction utf16End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) {\n    var end = this.lastTotal - this.lastNeed;\n    return r + this.lastChar.toString('utf16le', 0, end);\n  }\n  return r;\n}\n\nfunction base64Text(buf, i) {\n  var n = (buf.length - i) % 3;\n  if (n === 0) return buf.toString('base64', i);\n  this.lastNeed = 3 - n;\n  this.lastTotal = 3;\n  if (n === 1) {\n    this.lastChar[0] = buf[buf.length - 1];\n  } else {\n    this.lastChar[0] = buf[buf.length - 2];\n    this.lastChar[1] = buf[buf.length - 1];\n  }\n  return buf.toString('base64', i, buf.length - n);\n}\n\nfunction base64End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + this.lastChar.toString('base64', 0, 3 - this.lastNeed);\n  return r;\n}\n\n// Pass bytes on through for single-byte encodings (e.g. ascii, latin1, hex)\nfunction simpleWrite(buf) {\n  return buf.toString(this.encoding);\n}\n\nfunction simpleEnd(buf) {\n  return buf && buf.length ? this.write(buf) : '';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\n\nvar Duplex = require('./_stream_duplex');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(Transform, Duplex);\n\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n\n  var cb = ts.writecb;\n\n  if (!cb) {\n    return this.emit('error', new Error('write callback called multiple times'));\n  }\n\n  ts.writechunk = null;\n  ts.writecb = null;\n\n  if (data != null) // single equals check for both `null` and `undefined`\n    this.push(data);\n\n  cb(er);\n\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\n\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n\n  Duplex.call(this, options);\n\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\n\nfunction prefinish() {\n  var _this = this;\n\n  if (typeof this._flush === 'function') {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\n\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  throw new Error('_transform() is not implemented');\n};\n\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n\n  if (ts.writechunk !== null && ts.writecb && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\n\nTransform.prototype._destroy = function (err, cb) {\n  var _this2 = this;\n\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n    _this2.emit('close');\n  });\n};\n\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n\n  if (data != null) // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new Error('Calling transform done when ws.length != 0');\n\n  if (stream._transformState.transforming) throw new Error('Calling transform done when still transforming');\n\n  return stream.push(null);\n}","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst AsyncAlgorithm = require('./AsyncAlgorithm');\nconst IdentifierIssuer = require('./IdentifierIssuer');\nconst MessageDigest = require('./MessageDigest');\nconst Permutator = require('./Permutator');\nconst NQuads = require('./NQuads');\nconst util = require('./util');\n\nconst POSITIONS = {subject: 's', object: 'o', graph: 'g'};\n\nmodule.exports = class URDNA2015 extends AsyncAlgorithm {\n  constructor(options) {\n    options = options || {};\n    super(options);\n    this.name = 'URDNA2015';\n    this.options = Object.assign({}, options);\n    this.blankNodeInfo = {};\n    this.hashToBlankNodes = {};\n    this.canonicalIssuer = new IdentifierIssuer('_:c14n');\n    this.hashAlgorithm = 'sha256';\n    this.quads;\n  }\n\n  // 4.4) Normalization Algorithm\n  main(dataset, callback) {\n    const self = this;\n    self.schedule.start = Date.now();\n    let result;\n    self.quads = dataset;\n\n    // 1) Create the normalization state.\n\n    // Note: Optimize by generating non-normalized blank node map concurrently.\n    const nonNormalized = {};\n\n    self.waterfall([\n      callback => {\n        // 2) For every quad in input dataset:\n        self.forEach(dataset, (quad, idx, callback) => {\n          // 2.1) For each blank node that occurs in the quad, add a reference\n          // to the quad using the blank node identifier in the blank node to\n          // quads map, creating a new entry if necessary.\n          self.forEachComponent(quad, component => {\n            if(component.termType !== 'BlankNode') {\n              return;\n            }\n            const id = component.value;\n            if(id in self.blankNodeInfo) {\n              self.blankNodeInfo[id].quads.push(quad);\n            } else {\n              nonNormalized[id] = true;\n              self.blankNodeInfo[id] = {quads: [quad]};\n            }\n          });\n\n          callback();\n        }, callback);\n      },\n      callback => {\n        // 3) Create a list of non-normalized blank node identifiers\n        // non-normalized identifiers and populate it using the keys from the\n        // blank node to quads map.\n        // Note: We use a map here and it was generated during step 2.\n\n        // 4) Initialize simple, a boolean flag, to true.\n        let simple = true;\n\n        // 5) While simple is true, issue canonical identifiers for blank nodes:\n        self.whilst(() => simple, callback => {\n          // 5.1) Set simple to false.\n          simple = false;\n\n          // 5.2) Clear hash to blank nodes map.\n          self.hashToBlankNodes = {};\n\n          self.waterfall([\n            callback => {\n              // 5.3) For each blank node identifier identifier in\n              // non-normalized identifiers:\n              self.forEach(nonNormalized, (value, id, callback) => {\n                // 5.3.1) Create a hash, hash, according to the Hash First\n                // Degree Quads algorithm.\n                self.hashFirstDegreeQuads(id, (err, hash) => {\n                  if(err) {\n                    return callback(err);\n                  }\n                  // 5.3.2) Add hash and identifier to hash to blank nodes map,\n                  // creating a new entry if necessary.\n                  if(hash in self.hashToBlankNodes) {\n                    self.hashToBlankNodes[hash].push(id);\n                  } else {\n                    self.hashToBlankNodes[hash] = [id];\n                  }\n                  callback();\n                });\n              }, callback);\n            },\n            callback => {\n              // 5.4) For each hash to identifier list mapping in hash to blank\n              // nodes map, lexicographically-sorted by hash:\n              const hashes = Object.keys(self.hashToBlankNodes).sort();\n              self.forEach(hashes, (hash, i, callback) => {\n                // 5.4.1) If the length of identifier list is greater than 1,\n                // continue to the next mapping.\n                const idList = self.hashToBlankNodes[hash];\n                if(idList.length > 1) {\n                  return callback();\n                }\n\n                // 5.4.2) Use the Issue Identifier algorithm, passing canonical\n                // issuer and the single blank node identifier in identifier\n                // list, identifier, to issue a canonical replacement identifier\n                // for identifier.\n                // TODO: consider changing `getId` to `issue`\n                const id = idList[0];\n                self.canonicalIssuer.getId(id);\n\n                // 5.4.3) Remove identifier from non-normalized identifiers.\n                delete nonNormalized[id];\n\n                // 5.4.4) Remove hash from the hash to blank nodes map.\n                delete self.hashToBlankNodes[hash];\n\n                // 5.4.5) Set simple to true.\n                simple = true;\n                callback();\n              }, callback);\n            }\n          ], callback);\n        }, callback);\n      },\n      callback => {\n        // 6) For each hash to identifier list mapping in hash to blank nodes\n        // map, lexicographically-sorted by hash:\n        const hashes = Object.keys(self.hashToBlankNodes).sort();\n        self.forEach(hashes, (hash, idx, callback) => {\n          // 6.1) Create hash path list where each item will be a result of\n          // running the Hash N-Degree Quads algorithm.\n          const hashPathList = [];\n\n          // 6.2) For each blank node identifier identifier in identifier list:\n          const idList = self.hashToBlankNodes[hash];\n          self.waterfall([\n            callback => {\n              self.forEach(idList, (id, idx, callback) => {\n                // 6.2.1) If a canonical identifier has already been issued for\n                // identifier, continue to the next identifier.\n                if(self.canonicalIssuer.hasId(id)) {\n                  return callback();\n                }\n\n                // 6.2.2) Create temporary issuer, an identifier issuer\n                // initialized with the prefix _:b.\n                const issuer = new IdentifierIssuer('_:b');\n\n                // 6.2.3) Use the Issue Identifier algorithm, passing temporary\n                // issuer and identifier, to issue a new temporary blank node\n                // identifier for identifier.\n                issuer.getId(id);\n\n                // 6.2.4) Run the Hash N-Degree Quads algorithm, passing\n                // temporary issuer, and append the result to the hash path\n                // list.\n                self.hashNDegreeQuads(id, issuer, (err, result) => {\n                  if(err) {\n                    return callback(err);\n                  }\n                  hashPathList.push(result);\n                  callback();\n                });\n              }, callback);\n            },\n            callback => {\n              // 6.3) For each result in the hash path list,\n              // lexicographically-sorted by the hash in result:\n              // TODO: use `String.localeCompare`?\n              hashPathList.sort((a, b) =>\n                (a.hash < b.hash) ? -1 : ((a.hash > b.hash) ? 1 : 0));\n              self.forEach(hashPathList, (result, idx, callback) => {\n                // 6.3.1) For each blank node identifier, existing identifier,\n                // that was issued a temporary identifier by identifier issuer\n                // in result, issue a canonical identifier, in the same order,\n                // using the Issue Identifier algorithm, passing canonical\n                // issuer and existing identifier.\n                for(const existing in result.issuer.existing) {\n                  self.canonicalIssuer.getId(existing);\n                }\n                callback();\n              }, callback);\n            }\n          ], callback);\n        }, callback);\n      }, callback => {\n        /* Note: At this point all blank nodes in the set of RDF quads have been\n        assigned canonical identifiers, which have been stored in the canonical\n        issuer. Here each quad is updated by assigning each of its blank nodes\n        its new identifier. */\n\n        // 7) For each quad, quad, in input dataset:\n        const normalized = [];\n        self.waterfall([\n          callback => {\n            self.forEach(self.quads, (quad, idx, callback) => {\n              // 7.1) Create a copy, quad copy, of quad and replace any existing\n              // blank node identifiers using the canonical identifiers\n              // previously issued by canonical issuer.\n              // Note: We optimize away the copy here.\n              self.forEachComponent(quad, component => {\n                if(component.termType === 'BlankNode' &&\n                  !component.value.startsWith(self.canonicalIssuer.prefix)) {\n                  component.value = self.canonicalIssuer.getId(component.value);\n                }\n              });\n              // 7.2) Add quad copy to the normalized dataset.\n              normalized.push(NQuads.serializeQuad(quad));\n              callback();\n            }, callback);\n          },\n          callback => {\n            // sort normalized output\n            normalized.sort();\n\n            // 8) Return the normalized dataset.\n            result = normalized.join('');\n            return callback();\n          }\n        ], callback);\n      }\n    ], err => callback(err, result));\n  }\n\n  // 4.6) Hash First Degree Quads\n  hashFirstDegreeQuads(id, callback) {\n    const self = this;\n\n    // return cached hash\n    const info = self.blankNodeInfo[id];\n    if('hash' in info) {\n      return callback(null, info.hash);\n    }\n\n    // 1) Initialize nquads to an empty list. It will be used to store quads in\n    // N-Quads format.\n    const nquads = [];\n\n    // 2) Get the list of quads quads associated with the reference blank node\n    // identifier in the blank node to quads map.\n    const quads = info.quads;\n\n    // 3) For each quad quad in quads:\n    self.forEach(quads, (quad, idx, callback) => {\n      // 3.1) Serialize the quad in N-Quads format with the following special\n      // rule:\n\n      // 3.1.1) If any component in quad is an blank node, then serialize it\n      // using a special identifier as follows:\n      const copy = {predicate: quad.predicate};\n      self.forEachComponent(quad, (component, key) => {\n        // 3.1.2) If the blank node's existing blank node identifier matches the\n        // reference blank node identifier then use the blank node identifier\n        // _:a, otherwise, use the blank node identifier _:z.\n        copy[key] = self.modifyFirstDegreeComponent(id, component, key);\n      });\n      nquads.push(NQuads.serializeQuad(copy));\n      callback();\n    }, err => {\n      if(err) {\n        return callback(err);\n      }\n      // 4) Sort nquads in lexicographical order.\n      nquads.sort();\n\n      // 5) Return the hash that results from passing the sorted, joined nquads\n      // through the hash algorithm.\n      const md = new MessageDigest(self.hashAlgorithm);\n      for(let i = 0; i < nquads.length; ++i) {\n        md.update(nquads[i]);\n      }\n      // TODO: represent as byte buffer instead to cut memory usage in half\n      info.hash = md.digest();\n      callback(null, info.hash);\n    });\n  }\n\n  // 4.7) Hash Related Blank Node\n  hashRelatedBlankNode(related, quad, issuer, position, callback) {\n    const self = this;\n\n    // 1) Set the identifier to use for related, preferring first the canonical\n    // identifier for related if issued, second the identifier issued by issuer\n    // if issued, and last, if necessary, the result of the Hash First Degree\n    // Quads algorithm, passing related.\n    let id;\n    self.waterfall([\n      callback => {\n        if(self.canonicalIssuer.hasId(related)) {\n          id = self.canonicalIssuer.getId(related);\n          return callback();\n        }\n        if(issuer.hasId(related)) {\n          id = issuer.getId(related);\n          return callback();\n        }\n        self.hashFirstDegreeQuads(related, (err, hash) => {\n          if(err) {\n            return callback(err);\n          }\n          id = hash;\n          callback();\n        });\n      }\n    ], err => {\n      if(err) {\n        return callback(err);\n      }\n\n      // 2) Initialize a string input to the value of position.\n      // Note: We use a hash object instead.\n      const md = new MessageDigest(self.hashAlgorithm);\n      md.update(position);\n\n      // 3) If position is not g, append <, the value of the predicate in quad,\n      // and > to input.\n      if(position !== 'g') {\n        md.update(self.getRelatedPredicate(quad));\n      }\n\n      // 4) Append identifier to input.\n      md.update(id);\n\n      // 5) Return the hash that results from passing input through the hash\n      // algorithm.\n      // TODO: represent as byte buffer instead to cut memory usage in half\n      return callback(null, md.digest());\n    });\n  }\n\n  // 4.8) Hash N-Degree Quads\n  hashNDegreeQuads(id, issuer, callback) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    // Note: 2) and 3) handled within `createHashToRelated`\n    let hashToRelated;\n    const md = new MessageDigest(self.hashAlgorithm);\n    self.waterfall([\n      callback => self.createHashToRelated(id, issuer, (err, result) => {\n        if(err) {\n          return callback(err);\n        }\n        hashToRelated = result;\n        callback();\n      }),\n      callback => {\n        // 4) Create an empty string, data to hash.\n        // Note: We created a hash object `md` above instead.\n\n        // 5) For each related hash to blank node list mapping in hash to\n        // related blank nodes map, sorted lexicographically by related hash:\n        const hashes = Object.keys(hashToRelated).sort();\n        self.forEach(hashes, (hash, idx, callback) => {\n          // 5.1) Append the related hash to the data to hash.\n          md.update(hash);\n\n          // 5.2) Create a string chosen path.\n          let chosenPath = '';\n\n          // 5.3) Create an unset chosen issuer variable.\n          let chosenIssuer;\n\n          // 5.4) For each permutation of blank node list:\n          const permutator = new Permutator(hashToRelated[hash]);\n          self.whilst(() => permutator.hasNext(), nextPermutation => {\n            const permutation = permutator.next();\n\n            // 5.4.1) Create a copy of issuer, issuer copy.\n            let issuerCopy = issuer.clone();\n\n            // 5.4.2) Create a string path.\n            let path = '';\n\n            // 5.4.3) Create a recursion list, to store blank node identifiers\n            // that must be recursively processed by this algorithm.\n            const recursionList = [];\n\n            self.waterfall([\n              callback => {\n                // 5.4.4) For each related in permutation:\n                self.forEach(permutation, (related, idx, callback) => {\n                  // 5.4.4.1) If a canonical identifier has been issued for\n                  // related, append it to path.\n                  if(self.canonicalIssuer.hasId(related)) {\n                    path += self.canonicalIssuer.getId(related);\n                  } else {\n                    // 5.4.4.2) Otherwise:\n                    // 5.4.4.2.1) If issuer copy has not issued an identifier\n                    // for related, append related to recursion list.\n                    if(!issuerCopy.hasId(related)) {\n                      recursionList.push(related);\n                    }\n                    // 5.4.4.2.2) Use the Issue Identifier algorithm, passing\n                    // issuer copy and related and append the result to path.\n                    path += issuerCopy.getId(related);\n                  }\n\n                  // 5.4.4.3) If chosen path is not empty and the length of path\n                  // is greater than or equal to the length of chosen path and\n                  // path is lexicographically greater than chosen path, then\n                  // skip to the next permutation.\n                  if(chosenPath.length !== 0 &&\n                    path.length >= chosenPath.length && path > chosenPath) {\n                    // FIXME: may cause inaccurate total depth calculation\n                    return nextPermutation();\n                  }\n                  callback();\n                }, callback);\n              },\n              callback => {\n                // 5.4.5) For each related in recursion list:\n                self.forEach(recursionList, (related, idx, callback) => {\n                  // 5.4.5.1) Set result to the result of recursively executing\n                  // the Hash N-Degree Quads algorithm, passing related for\n                  // identifier and issuer copy for path identifier issuer.\n                  self.hashNDegreeQuads(related, issuerCopy, (err, result) => {\n                    if(err) {\n                      return callback(err);\n                    }\n\n                    // 5.4.5.2) Use the Issue Identifier algorithm, passing\n                    // issuer copy and related and append the result to path.\n                    path += issuerCopy.getId(related);\n\n                    // 5.4.5.3) Append <, the hash in result, and > to path.\n                    path += '<' + result.hash + '>';\n\n                    // 5.4.5.4) Set issuer copy to the identifier issuer in\n                    // result.\n                    issuerCopy = result.issuer;\n\n                    // 5.4.5.5) If chosen path is not empty and the length of\n                    // path is greater than or equal to the length of chosen\n                    // path and path is lexicographically greater than chosen\n                    // path, then skip to the next permutation.\n                    if(chosenPath.length !== 0 &&\n                      path.length >= chosenPath.length && path > chosenPath) {\n                      // FIXME: may cause inaccurate total depth calculation\n                      return nextPermutation();\n                    }\n                    callback();\n                  });\n                }, callback);\n              },\n              callback => {\n                // 5.4.6) If chosen path is empty or path is lexicographically\n                // less than chosen path, set chosen path to path and chosen\n                // issuer to issuer copy.\n                if(chosenPath.length === 0 || path < chosenPath) {\n                  chosenPath = path;\n                  chosenIssuer = issuerCopy;\n                }\n                callback();\n              }\n            ], nextPermutation);\n          }, err => {\n            if(err) {\n              return callback(err);\n            }\n\n            // 5.5) Append chosen path to data to hash.\n            md.update(chosenPath);\n\n            // 5.6) Replace issuer, by reference, with chosen issuer.\n            issuer = chosenIssuer;\n            callback();\n          });\n        }, callback);\n      }\n    ], err => {\n      // 6) Return issuer and the hash that results from passing data to hash\n      // through the hash algorithm.\n      callback(err, {hash: md.digest(), issuer});\n    });\n  }\n\n  // helper for modifying component during Hash First Degree Quads\n  modifyFirstDegreeComponent(id, component) {\n    if(component.termType !== 'BlankNode') {\n      return component;\n    }\n    component = util.clone(component);\n    component.value = (component.value === id ? '_:a' : '_:z');\n    return component;\n  }\n\n  // helper for getting a related predicate\n  getRelatedPredicate(quad) {\n    return '<' + quad.predicate.value + '>';\n  }\n\n  // helper for creating hash to related blank nodes map\n  createHashToRelated(id, issuer, callback) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    const hashToRelated = {};\n\n    // 2) Get a reference, quads, to the list of quads in the blank node to\n    // quads map for the key identifier.\n    const quads = self.blankNodeInfo[id].quads;\n\n    // 3) For each quad in quads:\n    self.forEach(quads, (quad, idx, callback) => {\n      // 3.1) For each component in quad, if component is the subject, object,\n      // and graph name and it is a blank node that is not identified by\n      // identifier:\n      self.forEach(quad, (component, key, callback) => {\n        if(key === 'predicate' ||\n          !(component.termType === 'BlankNode' && component.value !== id)) {\n          return callback();\n        }\n        // 3.1.1) Set hash to the result of the Hash Related Blank Node\n        // algorithm, passing the blank node identifier for component as\n        // related, quad, path identifier issuer as issuer, and position as\n        // either s, o, or g based on whether component is a subject, object,\n        // graph name, respectively.\n        const related = component.value;\n        const position = POSITIONS[key];\n        self.hashRelatedBlankNode(\n          related, quad, issuer, position, (err, hash) => {\n          if(err) {\n            return callback(err);\n          }\n          // 3.1.2) Add a mapping of hash to the blank node identifier for\n          // component to hash to related blank nodes map, adding an entry as\n          // necessary.\n          if(hash in hashToRelated) {\n            hashToRelated[hash].push(related);\n          } else {\n            hashToRelated[hash] = [related];\n          }\n          callback();\n        });\n      }, callback);\n    }, err => callback(err, hashToRelated));\n  }\n\n  // helper that iterates over quad components (skips predicate)\n  forEachComponent(quad, op) {\n    for(const key in quad) {\n      // skip `predicate`\n      if(key === 'predicate') {\n        continue;\n      }\n      op(quad[key], key, quad);\n    }\n  }\n};\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst forge = require('node-forge/lib/forge');\nrequire('node-forge/lib/md');\nrequire('node-forge/lib/sha1');\nrequire('node-forge/lib/sha256');\n\nmodule.exports = class MessageDigest {\n  /**\n   * Creates a new MessageDigest.\n   *\n   * @param algorithm the algorithm to use.\n   */\n  constructor(algorithm) {\n    this.md = forge.md[algorithm].create();\n  }\n\n  update(msg) {\n    this.md.update(msg, 'utf8');\n  }\n\n  digest() {\n    return this.md.digest().toHex();\n  }\n};\n","/**\n * Utility functions for web applications.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2018 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nvar baseN = require('./baseN');\n\n/* Utilities API */\nvar util = module.exports = forge.util = forge.util || {};\n\n// define setImmediate and nextTick\n(function() {\n  // use native nextTick (unless we're in webpack)\n  // webpack (or better node-libs-browser polyfill) sets process.browser.\n  // this way we can detect webpack properly\n  if(typeof process !== 'undefined' && process.nextTick && !process.browser) {\n    util.nextTick = process.nextTick;\n    if(typeof setImmediate === 'function') {\n      util.setImmediate = setImmediate;\n    } else {\n      // polyfill setImmediate with nextTick, older versions of node\n      // (those w/o setImmediate) won't totally starve IO\n      util.setImmediate = util.nextTick;\n    }\n    return;\n  }\n\n  // polyfill nextTick with native setImmediate\n  if(typeof setImmediate === 'function') {\n    util.setImmediate = function() { return setImmediate.apply(undefined, arguments); };\n    util.nextTick = function(callback) {\n      return setImmediate(callback);\n    };\n    return;\n  }\n\n  /* Note: A polyfill upgrade pattern is used here to allow combining\n  polyfills. For example, MutationObserver is fast, but blocks UI updates,\n  so it needs to allow UI updates periodically, so it falls back on\n  postMessage or setTimeout. */\n\n  // polyfill with setTimeout\n  util.setImmediate = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  // upgrade polyfill to use postMessage\n  if(typeof window !== 'undefined' &&\n    typeof window.postMessage === 'function') {\n    var msg = 'forge.setImmediate';\n    var callbacks = [];\n    util.setImmediate = function(callback) {\n      callbacks.push(callback);\n      // only send message when one hasn't been sent in\n      // the current turn of the event loop\n      if(callbacks.length === 1) {\n        window.postMessage(msg, '*');\n      }\n    };\n    function handler(event) {\n      if(event.source === window && event.data === msg) {\n        event.stopPropagation();\n        var copy = callbacks.slice();\n        callbacks.length = 0;\n        copy.forEach(function(callback) {\n          callback();\n        });\n      }\n    }\n    window.addEventListener('message', handler, true);\n  }\n\n  // upgrade polyfill to use MutationObserver\n  if(typeof MutationObserver !== 'undefined') {\n    // polyfill with MutationObserver\n    var now = Date.now();\n    var attr = true;\n    var div = document.createElement('div');\n    var callbacks = [];\n    new MutationObserver(function() {\n      var copy = callbacks.slice();\n      callbacks.length = 0;\n      copy.forEach(function(callback) {\n        callback();\n      });\n    }).observe(div, {attributes: true});\n    var oldSetImmediate = util.setImmediate;\n    util.setImmediate = function(callback) {\n      if(Date.now() - now > 15) {\n        now = Date.now();\n        oldSetImmediate(callback);\n      } else {\n        callbacks.push(callback);\n        // only trigger observer when it hasn't been triggered in\n        // the current turn of the event loop\n        if(callbacks.length === 1) {\n          div.setAttribute('a', attr = !attr);\n        }\n      }\n    };\n  }\n\n  util.nextTick = util.setImmediate;\n})();\n\n// check if running under Node.js\nutil.isNodejs =\n  typeof process !== 'undefined' && process.versions && process.versions.node;\n\n\n// 'self' will also work in Web Workers (instance of WorkerGlobalScope) while\n// it will point to `window` in the main thread.\n// To remain compatible with older browsers, we fall back to 'window' if 'self'\n// is not available.\nutil.globalScope = (function() {\n  if(util.isNodejs) {\n    return global;\n  }\n\n  return typeof self === 'undefined' ? window : self;\n})();\n\n// define isArray\nutil.isArray = Array.isArray || function(x) {\n  return Object.prototype.toString.call(x) === '[object Array]';\n};\n\n// define isArrayBuffer\nutil.isArrayBuffer = function(x) {\n  return typeof ArrayBuffer !== 'undefined' && x instanceof ArrayBuffer;\n};\n\n// define isArrayBufferView\nutil.isArrayBufferView = function(x) {\n  return x && util.isArrayBuffer(x.buffer) && x.byteLength !== undefined;\n};\n\n/**\n * Ensure a bits param is 8, 16, 24, or 32. Used to validate input for\n * algorithms where bit manipulation, JavaScript limitations, and/or algorithm\n * design only allow for byte operations of a limited size.\n *\n * @param n number of bits.\n *\n * Throw Error if n invalid.\n */\nfunction _checkBitsParam(n) {\n  if(!(n === 8 || n === 16 || n === 24 || n === 32)) {\n    throw new Error('Only 8, 16, 24, or 32 bits supported: ' + n);\n  }\n}\n\n// TODO: set ByteBuffer to best available backing\nutil.ByteBuffer = ByteStringBuffer;\n\n/** Buffer w/BinaryString backing */\n\n/**\n * Constructor for a binary string backed byte buffer.\n *\n * @param [b] the bytes to wrap (either encoded as string, one byte per\n *          character, or as an ArrayBuffer or Typed Array).\n */\nfunction ByteStringBuffer(b) {\n  // TODO: update to match DataBuffer API\n\n  // the data in this buffer\n  this.data = '';\n  // the pointer for reading from this buffer\n  this.read = 0;\n\n  if(typeof b === 'string') {\n    this.data = b;\n  } else if(util.isArrayBuffer(b) || util.isArrayBufferView(b)) {\n    if(typeof Buffer !== 'undefined' && b instanceof Buffer) {\n      this.data = b.toString('binary');\n    } else {\n      // convert native buffer to forge buffer\n      // FIXME: support native buffers internally instead\n      var arr = new Uint8Array(b);\n      try {\n        this.data = String.fromCharCode.apply(null, arr);\n      } catch(e) {\n        for(var i = 0; i < arr.length; ++i) {\n          this.putByte(arr[i]);\n        }\n      }\n    }\n  } else if(b instanceof ByteStringBuffer ||\n    (typeof b === 'object' && typeof b.data === 'string' &&\n    typeof b.read === 'number')) {\n    // copy existing buffer\n    this.data = b.data;\n    this.read = b.read;\n  }\n\n  // used for v8 optimization\n  this._constructedStringLength = 0;\n}\nutil.ByteStringBuffer = ByteStringBuffer;\n\n/* Note: This is an optimization for V8-based browsers. When V8 concatenates\n  a string, the strings are only joined logically using a \"cons string\" or\n  \"constructed/concatenated string\". These containers keep references to one\n  another and can result in very large memory usage. For example, if a 2MB\n  string is constructed by concatenating 4 bytes together at a time, the\n  memory usage will be ~44MB; so ~22x increase. The strings are only joined\n  together when an operation requiring their joining takes place, such as\n  substr(). This function is called when adding data to this buffer to ensure\n  these types of strings are periodically joined to reduce the memory\n  footprint. */\nvar _MAX_CONSTRUCTED_STRING_LENGTH = 4096;\nutil.ByteStringBuffer.prototype._optimizeConstructedString = function(x) {\n  this._constructedStringLength += x;\n  if(this._constructedStringLength > _MAX_CONSTRUCTED_STRING_LENGTH) {\n    // this substr() should cause the constructed string to join\n    this.data.substr(0, 1);\n    this._constructedStringLength = 0;\n  }\n};\n\n/**\n * Gets the number of bytes in this buffer.\n *\n * @return the number of bytes in this buffer.\n */\nutil.ByteStringBuffer.prototype.length = function() {\n  return this.data.length - this.read;\n};\n\n/**\n * Gets whether or not this buffer is empty.\n *\n * @return true if this buffer is empty, false if not.\n */\nutil.ByteStringBuffer.prototype.isEmpty = function() {\n  return this.length() <= 0;\n};\n\n/**\n * Puts a byte in this buffer.\n *\n * @param b the byte to put.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putByte = function(b) {\n  return this.putBytes(String.fromCharCode(b));\n};\n\n/**\n * Puts a byte in this buffer N times.\n *\n * @param b the byte to put.\n * @param n the number of bytes of value b to put.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.fillWithByte = function(b, n) {\n  b = String.fromCharCode(b);\n  var d = this.data;\n  while(n > 0) {\n    if(n & 1) {\n      d += b;\n    }\n    n >>>= 1;\n    if(n > 0) {\n      b += b;\n    }\n  }\n  this.data = d;\n  this._optimizeConstructedString(n);\n  return this;\n};\n\n/**\n * Puts bytes in this buffer.\n *\n * @param bytes the bytes (as a UTF-8 encoded string) to put.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putBytes = function(bytes) {\n  this.data += bytes;\n  this._optimizeConstructedString(bytes.length);\n  return this;\n};\n\n/**\n * Puts a UTF-16 encoded string into this buffer.\n *\n * @param str the string to put.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putString = function(str) {\n  return this.putBytes(util.encodeUtf8(str));\n};\n\n/**\n * Puts a 16-bit integer in this buffer in big-endian order.\n *\n * @param i the 16-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt16 = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i & 0xFF));\n};\n\n/**\n * Puts a 24-bit integer in this buffer in big-endian order.\n *\n * @param i the 24-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt24 = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i >> 16 & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i & 0xFF));\n};\n\n/**\n * Puts a 32-bit integer in this buffer in big-endian order.\n *\n * @param i the 32-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt32 = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i >> 24 & 0xFF) +\n    String.fromCharCode(i >> 16 & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i & 0xFF));\n};\n\n/**\n * Puts a 16-bit integer in this buffer in little-endian order.\n *\n * @param i the 16-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt16Le = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF));\n};\n\n/**\n * Puts a 24-bit integer in this buffer in little-endian order.\n *\n * @param i the 24-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt24Le = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i >> 16 & 0xFF));\n};\n\n/**\n * Puts a 32-bit integer in this buffer in little-endian order.\n *\n * @param i the 32-bit integer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt32Le = function(i) {\n  return this.putBytes(\n    String.fromCharCode(i & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i >> 16 & 0xFF) +\n    String.fromCharCode(i >> 24 & 0xFF));\n};\n\n/**\n * Puts an n-bit integer in this buffer in big-endian order.\n *\n * @param i the n-bit integer.\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putInt = function(i, n) {\n  _checkBitsParam(n);\n  var bytes = '';\n  do {\n    n -= 8;\n    bytes += String.fromCharCode((i >> n) & 0xFF);\n  } while(n > 0);\n  return this.putBytes(bytes);\n};\n\n/**\n * Puts a signed n-bit integer in this buffer in big-endian order. Two's\n * complement representation is used.\n *\n * @param i the n-bit integer.\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putSignedInt = function(i, n) {\n  // putInt checks n\n  if(i < 0) {\n    i += 2 << (n - 1);\n  }\n  return this.putInt(i, n);\n};\n\n/**\n * Puts the given buffer into this buffer.\n *\n * @param buffer the buffer to put into this one.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.putBuffer = function(buffer) {\n  return this.putBytes(buffer.getBytes());\n};\n\n/**\n * Gets a byte from this buffer and advances the read pointer by 1.\n *\n * @return the byte.\n */\nutil.ByteStringBuffer.prototype.getByte = function() {\n  return this.data.charCodeAt(this.read++);\n};\n\n/**\n * Gets a uint16 from this buffer in big-endian order and advances the read\n * pointer by 2.\n *\n * @return the uint16.\n */\nutil.ByteStringBuffer.prototype.getInt16 = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) << 8 ^\n    this.data.charCodeAt(this.read + 1));\n  this.read += 2;\n  return rval;\n};\n\n/**\n * Gets a uint24 from this buffer in big-endian order and advances the read\n * pointer by 3.\n *\n * @return the uint24.\n */\nutil.ByteStringBuffer.prototype.getInt24 = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) << 16 ^\n    this.data.charCodeAt(this.read + 1) << 8 ^\n    this.data.charCodeAt(this.read + 2));\n  this.read += 3;\n  return rval;\n};\n\n/**\n * Gets a uint32 from this buffer in big-endian order and advances the read\n * pointer by 4.\n *\n * @return the word.\n */\nutil.ByteStringBuffer.prototype.getInt32 = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) << 24 ^\n    this.data.charCodeAt(this.read + 1) << 16 ^\n    this.data.charCodeAt(this.read + 2) << 8 ^\n    this.data.charCodeAt(this.read + 3));\n  this.read += 4;\n  return rval;\n};\n\n/**\n * Gets a uint16 from this buffer in little-endian order and advances the read\n * pointer by 2.\n *\n * @return the uint16.\n */\nutil.ByteStringBuffer.prototype.getInt16Le = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) ^\n    this.data.charCodeAt(this.read + 1) << 8);\n  this.read += 2;\n  return rval;\n};\n\n/**\n * Gets a uint24 from this buffer in little-endian order and advances the read\n * pointer by 3.\n *\n * @return the uint24.\n */\nutil.ByteStringBuffer.prototype.getInt24Le = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) ^\n    this.data.charCodeAt(this.read + 1) << 8 ^\n    this.data.charCodeAt(this.read + 2) << 16);\n  this.read += 3;\n  return rval;\n};\n\n/**\n * Gets a uint32 from this buffer in little-endian order and advances the read\n * pointer by 4.\n *\n * @return the word.\n */\nutil.ByteStringBuffer.prototype.getInt32Le = function() {\n  var rval = (\n    this.data.charCodeAt(this.read) ^\n    this.data.charCodeAt(this.read + 1) << 8 ^\n    this.data.charCodeAt(this.read + 2) << 16 ^\n    this.data.charCodeAt(this.read + 3) << 24);\n  this.read += 4;\n  return rval;\n};\n\n/**\n * Gets an n-bit integer from this buffer in big-endian order and advances the\n * read pointer by ceil(n/8).\n *\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return the integer.\n */\nutil.ByteStringBuffer.prototype.getInt = function(n) {\n  _checkBitsParam(n);\n  var rval = 0;\n  do {\n    // TODO: Use (rval * 0x100) if adding support for 33 to 53 bits.\n    rval = (rval << 8) + this.data.charCodeAt(this.read++);\n    n -= 8;\n  } while(n > 0);\n  return rval;\n};\n\n/**\n * Gets a signed n-bit integer from this buffer in big-endian order, using\n * two's complement, and advances the read pointer by n/8.\n *\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return the integer.\n */\nutil.ByteStringBuffer.prototype.getSignedInt = function(n) {\n  // getInt checks n\n  var x = this.getInt(n);\n  var max = 2 << (n - 2);\n  if(x >= max) {\n    x -= max << 1;\n  }\n  return x;\n};\n\n/**\n * Reads bytes out into a UTF-8 string and clears them from the buffer.\n *\n * @param count the number of bytes to read, undefined or null for all.\n *\n * @return a UTF-8 string of bytes.\n */\nutil.ByteStringBuffer.prototype.getBytes = function(count) {\n  var rval;\n  if(count) {\n    // read count bytes\n    count = Math.min(this.length(), count);\n    rval = this.data.slice(this.read, this.read + count);\n    this.read += count;\n  } else if(count === 0) {\n    rval = '';\n  } else {\n    // read all bytes, optimize to only copy when needed\n    rval = (this.read === 0) ? this.data : this.data.slice(this.read);\n    this.clear();\n  }\n  return rval;\n};\n\n/**\n * Gets a UTF-8 encoded string of the bytes from this buffer without modifying\n * the read pointer.\n *\n * @param count the number of bytes to get, omit to get all.\n *\n * @return a string full of UTF-8 encoded characters.\n */\nutil.ByteStringBuffer.prototype.bytes = function(count) {\n  return (typeof(count) === 'undefined' ?\n    this.data.slice(this.read) :\n    this.data.slice(this.read, this.read + count));\n};\n\n/**\n * Gets a byte at the given index without modifying the read pointer.\n *\n * @param i the byte index.\n *\n * @return the byte.\n */\nutil.ByteStringBuffer.prototype.at = function(i) {\n  return this.data.charCodeAt(this.read + i);\n};\n\n/**\n * Puts a byte at the given index without modifying the read pointer.\n *\n * @param i the byte index.\n * @param b the byte to put.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.setAt = function(i, b) {\n  this.data = this.data.substr(0, this.read + i) +\n    String.fromCharCode(b) +\n    this.data.substr(this.read + i + 1);\n  return this;\n};\n\n/**\n * Gets the last byte without modifying the read pointer.\n *\n * @return the last byte.\n */\nutil.ByteStringBuffer.prototype.last = function() {\n  return this.data.charCodeAt(this.data.length - 1);\n};\n\n/**\n * Creates a copy of this buffer.\n *\n * @return the copy.\n */\nutil.ByteStringBuffer.prototype.copy = function() {\n  var c = util.createBuffer(this.data);\n  c.read = this.read;\n  return c;\n};\n\n/**\n * Compacts this buffer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.compact = function() {\n  if(this.read > 0) {\n    this.data = this.data.slice(this.read);\n    this.read = 0;\n  }\n  return this;\n};\n\n/**\n * Clears this buffer.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.clear = function() {\n  this.data = '';\n  this.read = 0;\n  return this;\n};\n\n/**\n * Shortens this buffer by triming bytes off of the end of this buffer.\n *\n * @param count the number of bytes to trim off.\n *\n * @return this buffer.\n */\nutil.ByteStringBuffer.prototype.truncate = function(count) {\n  var len = Math.max(0, this.length() - count);\n  this.data = this.data.substr(this.read, len);\n  this.read = 0;\n  return this;\n};\n\n/**\n * Converts this buffer to a hexadecimal string.\n *\n * @return a hexadecimal string.\n */\nutil.ByteStringBuffer.prototype.toHex = function() {\n  var rval = '';\n  for(var i = this.read; i < this.data.length; ++i) {\n    var b = this.data.charCodeAt(i);\n    if(b < 16) {\n      rval += '0';\n    }\n    rval += b.toString(16);\n  }\n  return rval;\n};\n\n/**\n * Converts this buffer to a UTF-16 string (standard JavaScript string).\n *\n * @return a UTF-16 string.\n */\nutil.ByteStringBuffer.prototype.toString = function() {\n  return util.decodeUtf8(this.bytes());\n};\n\n/** End Buffer w/BinaryString backing */\n\n/** Buffer w/UInt8Array backing */\n\n/**\n * FIXME: Experimental. Do not use yet.\n *\n * Constructor for an ArrayBuffer-backed byte buffer.\n *\n * The buffer may be constructed from a string, an ArrayBuffer, DataView, or a\n * TypedArray.\n *\n * If a string is given, its encoding should be provided as an option,\n * otherwise it will default to 'binary'. A 'binary' string is encoded such\n * that each character is one byte in length and size.\n *\n * If an ArrayBuffer, DataView, or TypedArray is given, it will be used\n * *directly* without any copying. Note that, if a write to the buffer requires\n * more space, the buffer will allocate a new backing ArrayBuffer to\n * accommodate. The starting read and write offsets for the buffer may be\n * given as options.\n *\n * @param [b] the initial bytes for this buffer.\n * @param options the options to use:\n *          [readOffset] the starting read offset to use (default: 0).\n *          [writeOffset] the starting write offset to use (default: the\n *            length of the first parameter).\n *          [growSize] the minimum amount, in bytes, to grow the buffer by to\n *            accommodate writes (default: 1024).\n *          [encoding] the encoding ('binary', 'utf8', 'utf16', 'hex') for the\n *            first parameter, if it is a string (default: 'binary').\n */\nfunction DataBuffer(b, options) {\n  // default options\n  options = options || {};\n\n  // pointers for read from/write to buffer\n  this.read = options.readOffset || 0;\n  this.growSize = options.growSize || 1024;\n\n  var isArrayBuffer = util.isArrayBuffer(b);\n  var isArrayBufferView = util.isArrayBufferView(b);\n  if(isArrayBuffer || isArrayBufferView) {\n    // use ArrayBuffer directly\n    if(isArrayBuffer) {\n      this.data = new DataView(b);\n    } else {\n      // TODO: adjust read/write offset based on the type of view\n      // or specify that this must be done in the options ... that the\n      // offsets are byte-based\n      this.data = new DataView(b.buffer, b.byteOffset, b.byteLength);\n    }\n    this.write = ('writeOffset' in options ?\n      options.writeOffset : this.data.byteLength);\n    return;\n  }\n\n  // initialize to empty array buffer and add any given bytes using putBytes\n  this.data = new DataView(new ArrayBuffer(0));\n  this.write = 0;\n\n  if(b !== null && b !== undefined) {\n    this.putBytes(b);\n  }\n\n  if('writeOffset' in options) {\n    this.write = options.writeOffset;\n  }\n}\nutil.DataBuffer = DataBuffer;\n\n/**\n * Gets the number of bytes in this buffer.\n *\n * @return the number of bytes in this buffer.\n */\nutil.DataBuffer.prototype.length = function() {\n  return this.write - this.read;\n};\n\n/**\n * Gets whether or not this buffer is empty.\n *\n * @return true if this buffer is empty, false if not.\n */\nutil.DataBuffer.prototype.isEmpty = function() {\n  return this.length() <= 0;\n};\n\n/**\n * Ensures this buffer has enough empty space to accommodate the given number\n * of bytes. An optional parameter may be given that indicates a minimum\n * amount to grow the buffer if necessary. If the parameter is not given,\n * the buffer will be grown by some previously-specified default amount\n * or heuristic.\n *\n * @param amount the number of bytes to accommodate.\n * @param [growSize] the minimum amount, in bytes, to grow the buffer by if\n *          necessary.\n */\nutil.DataBuffer.prototype.accommodate = function(amount, growSize) {\n  if(this.length() >= amount) {\n    return this;\n  }\n  growSize = Math.max(growSize || this.growSize, amount);\n\n  // grow buffer\n  var src = new Uint8Array(\n    this.data.buffer, this.data.byteOffset, this.data.byteLength);\n  var dst = new Uint8Array(this.length() + growSize);\n  dst.set(src);\n  this.data = new DataView(dst.buffer);\n\n  return this;\n};\n\n/**\n * Puts a byte in this buffer.\n *\n * @param b the byte to put.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putByte = function(b) {\n  this.accommodate(1);\n  this.data.setUint8(this.write++, b);\n  return this;\n};\n\n/**\n * Puts a byte in this buffer N times.\n *\n * @param b the byte to put.\n * @param n the number of bytes of value b to put.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.fillWithByte = function(b, n) {\n  this.accommodate(n);\n  for(var i = 0; i < n; ++i) {\n    this.data.setUint8(b);\n  }\n  return this;\n};\n\n/**\n * Puts bytes in this buffer. The bytes may be given as a string, an\n * ArrayBuffer, a DataView, or a TypedArray.\n *\n * @param bytes the bytes to put.\n * @param [encoding] the encoding for the first parameter ('binary', 'utf8',\n *          'utf16', 'hex'), if it is a string (default: 'binary').\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putBytes = function(bytes, encoding) {\n  if(util.isArrayBufferView(bytes)) {\n    var src = new Uint8Array(bytes.buffer, bytes.byteOffset, bytes.byteLength);\n    var len = src.byteLength - src.byteOffset;\n    this.accommodate(len);\n    var dst = new Uint8Array(this.data.buffer, this.write);\n    dst.set(src);\n    this.write += len;\n    return this;\n  }\n\n  if(util.isArrayBuffer(bytes)) {\n    var src = new Uint8Array(bytes);\n    this.accommodate(src.byteLength);\n    var dst = new Uint8Array(this.data.buffer);\n    dst.set(src, this.write);\n    this.write += src.byteLength;\n    return this;\n  }\n\n  // bytes is a util.DataBuffer or equivalent\n  if(bytes instanceof util.DataBuffer ||\n    (typeof bytes === 'object' &&\n    typeof bytes.read === 'number' && typeof bytes.write === 'number' &&\n    util.isArrayBufferView(bytes.data))) {\n    var src = new Uint8Array(bytes.data.byteLength, bytes.read, bytes.length());\n    this.accommodate(src.byteLength);\n    var dst = new Uint8Array(bytes.data.byteLength, this.write);\n    dst.set(src);\n    this.write += src.byteLength;\n    return this;\n  }\n\n  if(bytes instanceof util.ByteStringBuffer) {\n    // copy binary string and process as the same as a string parameter below\n    bytes = bytes.data;\n    encoding = 'binary';\n  }\n\n  // string conversion\n  encoding = encoding || 'binary';\n  if(typeof bytes === 'string') {\n    var view;\n\n    // decode from string\n    if(encoding === 'hex') {\n      this.accommodate(Math.ceil(bytes.length / 2));\n      view = new Uint8Array(this.data.buffer, this.write);\n      this.write += util.binary.hex.decode(bytes, view, this.write);\n      return this;\n    }\n    if(encoding === 'base64') {\n      this.accommodate(Math.ceil(bytes.length / 4) * 3);\n      view = new Uint8Array(this.data.buffer, this.write);\n      this.write += util.binary.base64.decode(bytes, view, this.write);\n      return this;\n    }\n\n    // encode text as UTF-8 bytes\n    if(encoding === 'utf8') {\n      // encode as UTF-8 then decode string as raw binary\n      bytes = util.encodeUtf8(bytes);\n      encoding = 'binary';\n    }\n\n    // decode string as raw binary\n    if(encoding === 'binary' || encoding === 'raw') {\n      // one byte per character\n      this.accommodate(bytes.length);\n      view = new Uint8Array(this.data.buffer, this.write);\n      this.write += util.binary.raw.decode(view);\n      return this;\n    }\n\n    // encode text as UTF-16 bytes\n    if(encoding === 'utf16') {\n      // two bytes per character\n      this.accommodate(bytes.length * 2);\n      view = new Uint16Array(this.data.buffer, this.write);\n      this.write += util.text.utf16.encode(view);\n      return this;\n    }\n\n    throw new Error('Invalid encoding: ' + encoding);\n  }\n\n  throw Error('Invalid parameter: ' + bytes);\n};\n\n/**\n * Puts the given buffer into this buffer.\n *\n * @param buffer the buffer to put into this one.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putBuffer = function(buffer) {\n  this.putBytes(buffer);\n  buffer.clear();\n  return this;\n};\n\n/**\n * Puts a string into this buffer.\n *\n * @param str the string to put.\n * @param [encoding] the encoding for the string (default: 'utf16').\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putString = function(str) {\n  return this.putBytes(str, 'utf16');\n};\n\n/**\n * Puts a 16-bit integer in this buffer in big-endian order.\n *\n * @param i the 16-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt16 = function(i) {\n  this.accommodate(2);\n  this.data.setInt16(this.write, i);\n  this.write += 2;\n  return this;\n};\n\n/**\n * Puts a 24-bit integer in this buffer in big-endian order.\n *\n * @param i the 24-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt24 = function(i) {\n  this.accommodate(3);\n  this.data.setInt16(this.write, i >> 8 & 0xFFFF);\n  this.data.setInt8(this.write, i >> 16 & 0xFF);\n  this.write += 3;\n  return this;\n};\n\n/**\n * Puts a 32-bit integer in this buffer in big-endian order.\n *\n * @param i the 32-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt32 = function(i) {\n  this.accommodate(4);\n  this.data.setInt32(this.write, i);\n  this.write += 4;\n  return this;\n};\n\n/**\n * Puts a 16-bit integer in this buffer in little-endian order.\n *\n * @param i the 16-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt16Le = function(i) {\n  this.accommodate(2);\n  this.data.setInt16(this.write, i, true);\n  this.write += 2;\n  return this;\n};\n\n/**\n * Puts a 24-bit integer in this buffer in little-endian order.\n *\n * @param i the 24-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt24Le = function(i) {\n  this.accommodate(3);\n  this.data.setInt8(this.write, i >> 16 & 0xFF);\n  this.data.setInt16(this.write, i >> 8 & 0xFFFF, true);\n  this.write += 3;\n  return this;\n};\n\n/**\n * Puts a 32-bit integer in this buffer in little-endian order.\n *\n * @param i the 32-bit integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt32Le = function(i) {\n  this.accommodate(4);\n  this.data.setInt32(this.write, i, true);\n  this.write += 4;\n  return this;\n};\n\n/**\n * Puts an n-bit integer in this buffer in big-endian order.\n *\n * @param i the n-bit integer.\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putInt = function(i, n) {\n  _checkBitsParam(n);\n  this.accommodate(n / 8);\n  do {\n    n -= 8;\n    this.data.setInt8(this.write++, (i >> n) & 0xFF);\n  } while(n > 0);\n  return this;\n};\n\n/**\n * Puts a signed n-bit integer in this buffer in big-endian order. Two's\n * complement representation is used.\n *\n * @param i the n-bit integer.\n * @param n the number of bits in the integer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.putSignedInt = function(i, n) {\n  _checkBitsParam(n);\n  this.accommodate(n / 8);\n  if(i < 0) {\n    i += 2 << (n - 1);\n  }\n  return this.putInt(i, n);\n};\n\n/**\n * Gets a byte from this buffer and advances the read pointer by 1.\n *\n * @return the byte.\n */\nutil.DataBuffer.prototype.getByte = function() {\n  return this.data.getInt8(this.read++);\n};\n\n/**\n * Gets a uint16 from this buffer in big-endian order and advances the read\n * pointer by 2.\n *\n * @return the uint16.\n */\nutil.DataBuffer.prototype.getInt16 = function() {\n  var rval = this.data.getInt16(this.read);\n  this.read += 2;\n  return rval;\n};\n\n/**\n * Gets a uint24 from this buffer in big-endian order and advances the read\n * pointer by 3.\n *\n * @return the uint24.\n */\nutil.DataBuffer.prototype.getInt24 = function() {\n  var rval = (\n    this.data.getInt16(this.read) << 8 ^\n    this.data.getInt8(this.read + 2));\n  this.read += 3;\n  return rval;\n};\n\n/**\n * Gets a uint32 from this buffer in big-endian order and advances the read\n * pointer by 4.\n *\n * @return the word.\n */\nutil.DataBuffer.prototype.getInt32 = function() {\n  var rval = this.data.getInt32(this.read);\n  this.read += 4;\n  return rval;\n};\n\n/**\n * Gets a uint16 from this buffer in little-endian order and advances the read\n * pointer by 2.\n *\n * @return the uint16.\n */\nutil.DataBuffer.prototype.getInt16Le = function() {\n  var rval = this.data.getInt16(this.read, true);\n  this.read += 2;\n  return rval;\n};\n\n/**\n * Gets a uint24 from this buffer in little-endian order and advances the read\n * pointer by 3.\n *\n * @return the uint24.\n */\nutil.DataBuffer.prototype.getInt24Le = function() {\n  var rval = (\n    this.data.getInt8(this.read) ^\n    this.data.getInt16(this.read + 1, true) << 8);\n  this.read += 3;\n  return rval;\n};\n\n/**\n * Gets a uint32 from this buffer in little-endian order and advances the read\n * pointer by 4.\n *\n * @return the word.\n */\nutil.DataBuffer.prototype.getInt32Le = function() {\n  var rval = this.data.getInt32(this.read, true);\n  this.read += 4;\n  return rval;\n};\n\n/**\n * Gets an n-bit integer from this buffer in big-endian order and advances the\n * read pointer by n/8.\n *\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return the integer.\n */\nutil.DataBuffer.prototype.getInt = function(n) {\n  _checkBitsParam(n);\n  var rval = 0;\n  do {\n    // TODO: Use (rval * 0x100) if adding support for 33 to 53 bits.\n    rval = (rval << 8) + this.data.getInt8(this.read++);\n    n -= 8;\n  } while(n > 0);\n  return rval;\n};\n\n/**\n * Gets a signed n-bit integer from this buffer in big-endian order, using\n * two's complement, and advances the read pointer by n/8.\n *\n * @param n the number of bits in the integer (8, 16, 24, or 32).\n *\n * @return the integer.\n */\nutil.DataBuffer.prototype.getSignedInt = function(n) {\n  // getInt checks n\n  var x = this.getInt(n);\n  var max = 2 << (n - 2);\n  if(x >= max) {\n    x -= max << 1;\n  }\n  return x;\n};\n\n/**\n * Reads bytes out into a UTF-8 string and clears them from the buffer.\n *\n * @param count the number of bytes to read, undefined or null for all.\n *\n * @return a UTF-8 string of bytes.\n */\nutil.DataBuffer.prototype.getBytes = function(count) {\n  // TODO: deprecate this method, it is poorly named and\n  // this.toString('binary') replaces it\n  // add a toTypedArray()/toArrayBuffer() function\n  var rval;\n  if(count) {\n    // read count bytes\n    count = Math.min(this.length(), count);\n    rval = this.data.slice(this.read, this.read + count);\n    this.read += count;\n  } else if(count === 0) {\n    rval = '';\n  } else {\n    // read all bytes, optimize to only copy when needed\n    rval = (this.read === 0) ? this.data : this.data.slice(this.read);\n    this.clear();\n  }\n  return rval;\n};\n\n/**\n * Gets a UTF-8 encoded string of the bytes from this buffer without modifying\n * the read pointer.\n *\n * @param count the number of bytes to get, omit to get all.\n *\n * @return a string full of UTF-8 encoded characters.\n */\nutil.DataBuffer.prototype.bytes = function(count) {\n  // TODO: deprecate this method, it is poorly named, add \"getString()\"\n  return (typeof(count) === 'undefined' ?\n    this.data.slice(this.read) :\n    this.data.slice(this.read, this.read + count));\n};\n\n/**\n * Gets a byte at the given index without modifying the read pointer.\n *\n * @param i the byte index.\n *\n * @return the byte.\n */\nutil.DataBuffer.prototype.at = function(i) {\n  return this.data.getUint8(this.read + i);\n};\n\n/**\n * Puts a byte at the given index without modifying the read pointer.\n *\n * @param i the byte index.\n * @param b the byte to put.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.setAt = function(i, b) {\n  this.data.setUint8(i, b);\n  return this;\n};\n\n/**\n * Gets the last byte without modifying the read pointer.\n *\n * @return the last byte.\n */\nutil.DataBuffer.prototype.last = function() {\n  return this.data.getUint8(this.write - 1);\n};\n\n/**\n * Creates a copy of this buffer.\n *\n * @return the copy.\n */\nutil.DataBuffer.prototype.copy = function() {\n  return new util.DataBuffer(this);\n};\n\n/**\n * Compacts this buffer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.compact = function() {\n  if(this.read > 0) {\n    var src = new Uint8Array(this.data.buffer, this.read);\n    var dst = new Uint8Array(src.byteLength);\n    dst.set(src);\n    this.data = new DataView(dst);\n    this.write -= this.read;\n    this.read = 0;\n  }\n  return this;\n};\n\n/**\n * Clears this buffer.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.clear = function() {\n  this.data = new DataView(new ArrayBuffer(0));\n  this.read = this.write = 0;\n  return this;\n};\n\n/**\n * Shortens this buffer by triming bytes off of the end of this buffer.\n *\n * @param count the number of bytes to trim off.\n *\n * @return this buffer.\n */\nutil.DataBuffer.prototype.truncate = function(count) {\n  this.write = Math.max(0, this.length() - count);\n  this.read = Math.min(this.read, this.write);\n  return this;\n};\n\n/**\n * Converts this buffer to a hexadecimal string.\n *\n * @return a hexadecimal string.\n */\nutil.DataBuffer.prototype.toHex = function() {\n  var rval = '';\n  for(var i = this.read; i < this.data.byteLength; ++i) {\n    var b = this.data.getUint8(i);\n    if(b < 16) {\n      rval += '0';\n    }\n    rval += b.toString(16);\n  }\n  return rval;\n};\n\n/**\n * Converts this buffer to a string, using the given encoding. If no\n * encoding is given, 'utf8' (UTF-8) is used.\n *\n * @param [encoding] the encoding to use: 'binary', 'utf8', 'utf16', 'hex',\n *          'base64' (default: 'utf8').\n *\n * @return a string representation of the bytes in this buffer.\n */\nutil.DataBuffer.prototype.toString = function(encoding) {\n  var view = new Uint8Array(this.data, this.read, this.length());\n  encoding = encoding || 'utf8';\n\n  // encode to string\n  if(encoding === 'binary' || encoding === 'raw') {\n    return util.binary.raw.encode(view);\n  }\n  if(encoding === 'hex') {\n    return util.binary.hex.encode(view);\n  }\n  if(encoding === 'base64') {\n    return util.binary.base64.encode(view);\n  }\n\n  // decode to text\n  if(encoding === 'utf8') {\n    return util.text.utf8.decode(view);\n  }\n  if(encoding === 'utf16') {\n    return util.text.utf16.decode(view);\n  }\n\n  throw new Error('Invalid encoding: ' + encoding);\n};\n\n/** End Buffer w/UInt8Array backing */\n\n/**\n * Creates a buffer that stores bytes. A value may be given to put into the\n * buffer that is either a string of bytes or a UTF-16 string that will\n * be encoded using UTF-8 (to do the latter, specify 'utf8' as the encoding).\n *\n * @param [input] the bytes to wrap (as a string) or a UTF-16 string to encode\n *          as UTF-8.\n * @param [encoding] (default: 'raw', other: 'utf8').\n */\nutil.createBuffer = function(input, encoding) {\n  // TODO: deprecate, use new ByteBuffer() instead\n  encoding = encoding || 'raw';\n  if(input !== undefined && encoding === 'utf8') {\n    input = util.encodeUtf8(input);\n  }\n  return new util.ByteBuffer(input);\n};\n\n/**\n * Fills a string with a particular value. If you want the string to be a byte\n * string, pass in String.fromCharCode(theByte).\n *\n * @param c the character to fill the string with, use String.fromCharCode\n *          to fill the string with a byte value.\n * @param n the number of characters of value c to fill with.\n *\n * @return the filled string.\n */\nutil.fillString = function(c, n) {\n  var s = '';\n  while(n > 0) {\n    if(n & 1) {\n      s += c;\n    }\n    n >>>= 1;\n    if(n > 0) {\n      c += c;\n    }\n  }\n  return s;\n};\n\n/**\n * Performs a per byte XOR between two byte strings and returns the result as a\n * string of bytes.\n *\n * @param s1 first string of bytes.\n * @param s2 second string of bytes.\n * @param n the number of bytes to XOR.\n *\n * @return the XOR'd result.\n */\nutil.xorBytes = function(s1, s2, n) {\n  var s3 = '';\n  var b = '';\n  var t = '';\n  var i = 0;\n  var c = 0;\n  for(; n > 0; --n, ++i) {\n    b = s1.charCodeAt(i) ^ s2.charCodeAt(i);\n    if(c >= 10) {\n      s3 += t;\n      t = '';\n      c = 0;\n    }\n    t += String.fromCharCode(b);\n    ++c;\n  }\n  s3 += t;\n  return s3;\n};\n\n/**\n * Converts a hex string into a 'binary' encoded string of bytes.\n *\n * @param hex the hexadecimal string to convert.\n *\n * @return the binary-encoded string of bytes.\n */\nutil.hexToBytes = function(hex) {\n  // TODO: deprecate: \"Deprecated. Use util.binary.hex.decode instead.\"\n  var rval = '';\n  var i = 0;\n  if(hex.length & 1 == 1) {\n    // odd number of characters, convert first character alone\n    i = 1;\n    rval += String.fromCharCode(parseInt(hex[0], 16));\n  }\n  // convert 2 characters (1 byte) at a time\n  for(; i < hex.length; i += 2) {\n    rval += String.fromCharCode(parseInt(hex.substr(i, 2), 16));\n  }\n  return rval;\n};\n\n/**\n * Converts a 'binary' encoded string of bytes to hex.\n *\n * @param bytes the byte string to convert.\n *\n * @return the string of hexadecimal characters.\n */\nutil.bytesToHex = function(bytes) {\n  // TODO: deprecate: \"Deprecated. Use util.binary.hex.encode instead.\"\n  return util.createBuffer(bytes).toHex();\n};\n\n/**\n * Converts an 32-bit integer to 4-big-endian byte string.\n *\n * @param i the integer.\n *\n * @return the byte string.\n */\nutil.int32ToBytes = function(i) {\n  return (\n    String.fromCharCode(i >> 24 & 0xFF) +\n    String.fromCharCode(i >> 16 & 0xFF) +\n    String.fromCharCode(i >> 8 & 0xFF) +\n    String.fromCharCode(i & 0xFF));\n};\n\n// base64 characters, reverse mapping\nvar _base64 =\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nvar _base64Idx = [\n/*43 -43 = 0*/\n/*'+',  1,  2,  3,'/' */\n   62, -1, -1, -1, 63,\n\n/*'0','1','2','3','4','5','6','7','8','9' */\n   52, 53, 54, 55, 56, 57, 58, 59, 60, 61,\n\n/*15, 16, 17,'=', 19, 20, 21 */\n  -1, -1, -1, 64, -1, -1, -1,\n\n/*65 - 43 = 22*/\n/*'A','B','C','D','E','F','G','H','I','J','K','L','M', */\n   0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,\n\n/*'N','O','P','Q','R','S','T','U','V','W','X','Y','Z' */\n   13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,\n\n/*91 - 43 = 48 */\n/*48, 49, 50, 51, 52, 53 */\n  -1, -1, -1, -1, -1, -1,\n\n/*97 - 43 = 54*/\n/*'a','b','c','d','e','f','g','h','i','j','k','l','m' */\n   26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,\n\n/*'n','o','p','q','r','s','t','u','v','w','x','y','z' */\n   39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51\n];\n\n// base58 characters (Bitcoin alphabet)\nvar _base58 = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';\n\n/**\n * Base64 encodes a 'binary' encoded string of bytes.\n *\n * @param input the binary encoded string of bytes to base64-encode.\n * @param maxline the maximum number of encoded characters per line to use,\n *          defaults to none.\n *\n * @return the base64-encoded output.\n */\nutil.encode64 = function(input, maxline) {\n  // TODO: deprecate: \"Deprecated. Use util.binary.base64.encode instead.\"\n  var line = '';\n  var output = '';\n  var chr1, chr2, chr3;\n  var i = 0;\n  while(i < input.length) {\n    chr1 = input.charCodeAt(i++);\n    chr2 = input.charCodeAt(i++);\n    chr3 = input.charCodeAt(i++);\n\n    // encode 4 character group\n    line += _base64.charAt(chr1 >> 2);\n    line += _base64.charAt(((chr1 & 3) << 4) | (chr2 >> 4));\n    if(isNaN(chr2)) {\n      line += '==';\n    } else {\n      line += _base64.charAt(((chr2 & 15) << 2) | (chr3 >> 6));\n      line += isNaN(chr3) ? '=' : _base64.charAt(chr3 & 63);\n    }\n\n    if(maxline && line.length > maxline) {\n      output += line.substr(0, maxline) + '\\r\\n';\n      line = line.substr(maxline);\n    }\n  }\n  output += line;\n  return output;\n};\n\n/**\n * Base64 decodes a string into a 'binary' encoded string of bytes.\n *\n * @param input the base64-encoded input.\n *\n * @return the binary encoded string.\n */\nutil.decode64 = function(input) {\n  // TODO: deprecate: \"Deprecated. Use util.binary.base64.decode instead.\"\n\n  // remove all non-base64 characters\n  input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n\n  var output = '';\n  var enc1, enc2, enc3, enc4;\n  var i = 0;\n\n  while(i < input.length) {\n    enc1 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc2 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc3 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc4 = _base64Idx[input.charCodeAt(i++) - 43];\n\n    output += String.fromCharCode((enc1 << 2) | (enc2 >> 4));\n    if(enc3 !== 64) {\n      // decoded at least 2 bytes\n      output += String.fromCharCode(((enc2 & 15) << 4) | (enc3 >> 2));\n      if(enc4 !== 64) {\n        // decoded 3 bytes\n        output += String.fromCharCode(((enc3 & 3) << 6) | enc4);\n      }\n    }\n  }\n\n  return output;\n};\n\n/**\n * UTF-8 encodes the given UTF-16 encoded string (a standard JavaScript\n * string). Non-ASCII characters will be encoded as multiple bytes according\n * to UTF-8.\n *\n * @param str the string to encode.\n *\n * @return the UTF-8 encoded string.\n */\nutil.encodeUtf8 = function(str) {\n  return unescape(encodeURIComponent(str));\n};\n\n/**\n * Decodes a UTF-8 encoded string into a UTF-16 string.\n *\n * @param str the string to decode.\n *\n * @return the UTF-16 encoded string (standard JavaScript string).\n */\nutil.decodeUtf8 = function(str) {\n  return decodeURIComponent(escape(str));\n};\n\n// binary encoding/decoding tools\n// FIXME: Experimental. Do not use yet.\nutil.binary = {\n  raw: {},\n  hex: {},\n  base64: {},\n  base58: {},\n  baseN : {\n    encode: baseN.encode,\n    decode: baseN.decode\n  }\n};\n\n/**\n * Encodes a Uint8Array as a binary-encoded string. This encoding uses\n * a value between 0 and 255 for each character.\n *\n * @param bytes the Uint8Array to encode.\n *\n * @return the binary-encoded string.\n */\nutil.binary.raw.encode = function(bytes) {\n  return String.fromCharCode.apply(null, bytes);\n};\n\n/**\n * Decodes a binary-encoded string to a Uint8Array. This encoding uses\n * a value between 0 and 255 for each character.\n *\n * @param str the binary-encoded string to decode.\n * @param [output] an optional Uint8Array to write the output to; if it\n *          is too small, an exception will be thrown.\n * @param [offset] the start offset for writing to the output (default: 0).\n *\n * @return the Uint8Array or the number of bytes written if output was given.\n */\nutil.binary.raw.decode = function(str, output, offset) {\n  var out = output;\n  if(!out) {\n    out = new Uint8Array(str.length);\n  }\n  offset = offset || 0;\n  var j = offset;\n  for(var i = 0; i < str.length; ++i) {\n    out[j++] = str.charCodeAt(i);\n  }\n  return output ? (j - offset) : out;\n};\n\n/**\n * Encodes a 'binary' string, ArrayBuffer, DataView, TypedArray, or\n * ByteBuffer as a string of hexadecimal characters.\n *\n * @param bytes the bytes to convert.\n *\n * @return the string of hexadecimal characters.\n */\nutil.binary.hex.encode = util.bytesToHex;\n\n/**\n * Decodes a hex-encoded string to a Uint8Array.\n *\n * @param hex the hexadecimal string to convert.\n * @param [output] an optional Uint8Array to write the output to; if it\n *          is too small, an exception will be thrown.\n * @param [offset] the start offset for writing to the output (default: 0).\n *\n * @return the Uint8Array or the number of bytes written if output was given.\n */\nutil.binary.hex.decode = function(hex, output, offset) {\n  var out = output;\n  if(!out) {\n    out = new Uint8Array(Math.ceil(hex.length / 2));\n  }\n  offset = offset || 0;\n  var i = 0, j = offset;\n  if(hex.length & 1) {\n    // odd number of characters, convert first character alone\n    i = 1;\n    out[j++] = parseInt(hex[0], 16);\n  }\n  // convert 2 characters (1 byte) at a time\n  for(; i < hex.length; i += 2) {\n    out[j++] = parseInt(hex.substr(i, 2), 16);\n  }\n  return output ? (j - offset) : out;\n};\n\n/**\n * Base64-encodes a Uint8Array.\n *\n * @param input the Uint8Array to encode.\n * @param maxline the maximum number of encoded characters per line to use,\n *          defaults to none.\n *\n * @return the base64-encoded output string.\n */\nutil.binary.base64.encode = function(input, maxline) {\n  var line = '';\n  var output = '';\n  var chr1, chr2, chr3;\n  var i = 0;\n  while(i < input.byteLength) {\n    chr1 = input[i++];\n    chr2 = input[i++];\n    chr3 = input[i++];\n\n    // encode 4 character group\n    line += _base64.charAt(chr1 >> 2);\n    line += _base64.charAt(((chr1 & 3) << 4) | (chr2 >> 4));\n    if(isNaN(chr2)) {\n      line += '==';\n    } else {\n      line += _base64.charAt(((chr2 & 15) << 2) | (chr3 >> 6));\n      line += isNaN(chr3) ? '=' : _base64.charAt(chr3 & 63);\n    }\n\n    if(maxline && line.length > maxline) {\n      output += line.substr(0, maxline) + '\\r\\n';\n      line = line.substr(maxline);\n    }\n  }\n  output += line;\n  return output;\n};\n\n/**\n * Decodes a base64-encoded string to a Uint8Array.\n *\n * @param input the base64-encoded input string.\n * @param [output] an optional Uint8Array to write the output to; if it\n *          is too small, an exception will be thrown.\n * @param [offset] the start offset for writing to the output (default: 0).\n *\n * @return the Uint8Array or the number of bytes written if output was given.\n */\nutil.binary.base64.decode = function(input, output, offset) {\n  var out = output;\n  if(!out) {\n    out = new Uint8Array(Math.ceil(input.length / 4) * 3);\n  }\n\n  // remove all non-base64 characters\n  input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n\n  offset = offset || 0;\n  var enc1, enc2, enc3, enc4;\n  var i = 0, j = offset;\n\n  while(i < input.length) {\n    enc1 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc2 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc3 = _base64Idx[input.charCodeAt(i++) - 43];\n    enc4 = _base64Idx[input.charCodeAt(i++) - 43];\n\n    out[j++] = (enc1 << 2) | (enc2 >> 4);\n    if(enc3 !== 64) {\n      // decoded at least 2 bytes\n      out[j++] = ((enc2 & 15) << 4) | (enc3 >> 2);\n      if(enc4 !== 64) {\n        // decoded 3 bytes\n        out[j++] = ((enc3 & 3) << 6) | enc4;\n      }\n    }\n  }\n\n  // make sure result is the exact decoded length\n  return output ? (j - offset) : out.subarray(0, j);\n};\n\n// add support for base58 encoding/decoding with Bitcoin alphabet\nutil.binary.base58.encode = function(input, maxline) {\n  return util.binary.baseN.encode(input, _base58, maxline);\n};\nutil.binary.base58.decode = function(input, maxline) {\n  return util.binary.baseN.decode(input, _base58, maxline);\n};\n\n// text encoding/decoding tools\n// FIXME: Experimental. Do not use yet.\nutil.text = {\n  utf8: {},\n  utf16: {}\n};\n\n/**\n * Encodes the given string as UTF-8 in a Uint8Array.\n *\n * @param str the string to encode.\n * @param [output] an optional Uint8Array to write the output to; if it\n *          is too small, an exception will be thrown.\n * @param [offset] the start offset for writing to the output (default: 0).\n *\n * @return the Uint8Array or the number of bytes written if output was given.\n */\nutil.text.utf8.encode = function(str, output, offset) {\n  str = util.encodeUtf8(str);\n  var out = output;\n  if(!out) {\n    out = new Uint8Array(str.length);\n  }\n  offset = offset || 0;\n  var j = offset;\n  for(var i = 0; i < str.length; ++i) {\n    out[j++] = str.charCodeAt(i);\n  }\n  return output ? (j - offset) : out;\n};\n\n/**\n * Decodes the UTF-8 contents from a Uint8Array.\n *\n * @param bytes the Uint8Array to decode.\n *\n * @return the resulting string.\n */\nutil.text.utf8.decode = function(bytes) {\n  return util.decodeUtf8(String.fromCharCode.apply(null, bytes));\n};\n\n/**\n * Encodes the given string as UTF-16 in a Uint8Array.\n *\n * @param str the string to encode.\n * @param [output] an optional Uint8Array to write the output to; if it\n *          is too small, an exception will be thrown.\n * @param [offset] the start offset for writing to the output (default: 0).\n *\n * @return the Uint8Array or the number of bytes written if output was given.\n */\nutil.text.utf16.encode = function(str, output, offset) {\n  var out = output;\n  if(!out) {\n    out = new Uint8Array(str.length * 2);\n  }\n  var view = new Uint16Array(out.buffer);\n  offset = offset || 0;\n  var j = offset;\n  var k = offset;\n  for(var i = 0; i < str.length; ++i) {\n    view[k++] = str.charCodeAt(i);\n    j += 2;\n  }\n  return output ? (j - offset) : out;\n};\n\n/**\n * Decodes the UTF-16 contents from a Uint8Array.\n *\n * @param bytes the Uint8Array to decode.\n *\n * @return the resulting string.\n */\nutil.text.utf16.decode = function(bytes) {\n  return String.fromCharCode.apply(null, new Uint16Array(bytes.buffer));\n};\n\n/**\n * Deflates the given data using a flash interface.\n *\n * @param api the flash interface.\n * @param bytes the data.\n * @param raw true to return only raw deflate data, false to include zlib\n *          header and trailer.\n *\n * @return the deflated data as a string.\n */\nutil.deflate = function(api, bytes, raw) {\n  bytes = util.decode64(api.deflate(util.encode64(bytes)).rval);\n\n  // strip zlib header and trailer if necessary\n  if(raw) {\n    // zlib header is 2 bytes (CMF,FLG) where FLG indicates that\n    // there is a 4-byte DICT (alder-32) block before the data if\n    // its 5th bit is set\n    var start = 2;\n    var flg = bytes.charCodeAt(1);\n    if(flg & 0x20) {\n      start = 6;\n    }\n    // zlib trailer is 4 bytes of adler-32\n    bytes = bytes.substring(start, bytes.length - 4);\n  }\n\n  return bytes;\n};\n\n/**\n * Inflates the given data using a flash interface.\n *\n * @param api the flash interface.\n * @param bytes the data.\n * @param raw true if the incoming data has no zlib header or trailer and is\n *          raw DEFLATE data.\n *\n * @return the inflated data as a string, null on error.\n */\nutil.inflate = function(api, bytes, raw) {\n  // TODO: add zlib header and trailer if necessary/possible\n  var rval = api.inflate(util.encode64(bytes)).rval;\n  return (rval === null) ? null : util.decode64(rval);\n};\n\n/**\n * Sets a storage object.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n * @param obj the storage object, null to remove.\n */\nvar _setStorageObject = function(api, id, obj) {\n  if(!api) {\n    throw new Error('WebStorage not available.');\n  }\n\n  var rval;\n  if(obj === null) {\n    rval = api.removeItem(id);\n  } else {\n    // json-encode and base64-encode object\n    obj = util.encode64(JSON.stringify(obj));\n    rval = api.setItem(id, obj);\n  }\n\n  // handle potential flash error\n  if(typeof(rval) !== 'undefined' && rval.rval !== true) {\n    var error = new Error(rval.error.message);\n    error.id = rval.error.id;\n    error.name = rval.error.name;\n    throw error;\n  }\n};\n\n/**\n * Gets a storage object.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n *\n * @return the storage object entry or null if none exists.\n */\nvar _getStorageObject = function(api, id) {\n  if(!api) {\n    throw new Error('WebStorage not available.');\n  }\n\n  // get the existing entry\n  var rval = api.getItem(id);\n\n  /* Note: We check api.init because we can't do (api == localStorage)\n    on IE because of \"Class doesn't support Automation\" exception. Only\n    the flash api has an init method so this works too, but we need a\n    better solution in the future. */\n\n  // flash returns item wrapped in an object, handle special case\n  if(api.init) {\n    if(rval.rval === null) {\n      if(rval.error) {\n        var error = new Error(rval.error.message);\n        error.id = rval.error.id;\n        error.name = rval.error.name;\n        throw error;\n      }\n      // no error, but also no item\n      rval = null;\n    } else {\n      rval = rval.rval;\n    }\n  }\n\n  // handle decoding\n  if(rval !== null) {\n    // base64-decode and json-decode data\n    rval = JSON.parse(util.decode64(rval));\n  }\n\n  return rval;\n};\n\n/**\n * Stores an item in local storage.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n * @param key the key for the item.\n * @param data the data for the item (any javascript object/primitive).\n */\nvar _setItem = function(api, id, key, data) {\n  // get storage object\n  var obj = _getStorageObject(api, id);\n  if(obj === null) {\n    // create a new storage object\n    obj = {};\n  }\n  // update key\n  obj[key] = data;\n\n  // set storage object\n  _setStorageObject(api, id, obj);\n};\n\n/**\n * Gets an item from local storage.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n * @param key the key for the item.\n *\n * @return the item.\n */\nvar _getItem = function(api, id, key) {\n  // get storage object\n  var rval = _getStorageObject(api, id);\n  if(rval !== null) {\n    // return data at key\n    rval = (key in rval) ? rval[key] : null;\n  }\n\n  return rval;\n};\n\n/**\n * Removes an item from local storage.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n * @param key the key for the item.\n */\nvar _removeItem = function(api, id, key) {\n  // get storage object\n  var obj = _getStorageObject(api, id);\n  if(obj !== null && key in obj) {\n    // remove key\n    delete obj[key];\n\n    // see if entry has no keys remaining\n    var empty = true;\n    for(var prop in obj) {\n      empty = false;\n      break;\n    }\n    if(empty) {\n      // remove entry entirely if no keys are left\n      obj = null;\n    }\n\n    // set storage object\n    _setStorageObject(api, id, obj);\n  }\n};\n\n/**\n * Clears the local disk storage identified by the given ID.\n *\n * @param api the storage interface.\n * @param id the storage ID to use.\n */\nvar _clearItems = function(api, id) {\n  _setStorageObject(api, id, null);\n};\n\n/**\n * Calls a storage function.\n *\n * @param func the function to call.\n * @param args the arguments for the function.\n * @param location the location argument.\n *\n * @return the return value from the function.\n */\nvar _callStorageFunction = function(func, args, location) {\n  var rval = null;\n\n  // default storage types\n  if(typeof(location) === 'undefined') {\n    location = ['web', 'flash'];\n  }\n\n  // apply storage types in order of preference\n  var type;\n  var done = false;\n  var exception = null;\n  for(var idx in location) {\n    type = location[idx];\n    try {\n      if(type === 'flash' || type === 'both') {\n        if(args[0] === null) {\n          throw new Error('Flash local storage not available.');\n        }\n        rval = func.apply(this, args);\n        done = (type === 'flash');\n      }\n      if(type === 'web' || type === 'both') {\n        args[0] = localStorage;\n        rval = func.apply(this, args);\n        done = true;\n      }\n    } catch(ex) {\n      exception = ex;\n    }\n    if(done) {\n      break;\n    }\n  }\n\n  if(!done) {\n    throw exception;\n  }\n\n  return rval;\n};\n\n/**\n * Stores an item on local disk.\n *\n * The available types of local storage include 'flash', 'web', and 'both'.\n *\n * The type 'flash' refers to flash local storage (SharedObject). In order\n * to use flash local storage, the 'api' parameter must be valid. The type\n * 'web' refers to WebStorage, if supported by the browser. The type 'both'\n * refers to storing using both 'flash' and 'web', not just one or the\n * other.\n *\n * The location array should list the storage types to use in order of\n * preference:\n *\n * ['flash']: flash only storage\n * ['web']: web only storage\n * ['both']: try to store in both\n * ['flash','web']: store in flash first, but if not available, 'web'\n * ['web','flash']: store in web first, but if not available, 'flash'\n *\n * The location array defaults to: ['web', 'flash']\n *\n * @param api the flash interface, null to use only WebStorage.\n * @param id the storage ID to use.\n * @param key the key for the item.\n * @param data the data for the item (any javascript object/primitive).\n * @param location an array with the preferred types of storage to use.\n */\nutil.setItem = function(api, id, key, data, location) {\n  _callStorageFunction(_setItem, arguments, location);\n};\n\n/**\n * Gets an item on local disk.\n *\n * Set setItem() for details on storage types.\n *\n * @param api the flash interface, null to use only WebStorage.\n * @param id the storage ID to use.\n * @param key the key for the item.\n * @param location an array with the preferred types of storage to use.\n *\n * @return the item.\n */\nutil.getItem = function(api, id, key, location) {\n  return _callStorageFunction(_getItem, arguments, location);\n};\n\n/**\n * Removes an item on local disk.\n *\n * Set setItem() for details on storage types.\n *\n * @param api the flash interface.\n * @param id the storage ID to use.\n * @param key the key for the item.\n * @param location an array with the preferred types of storage to use.\n */\nutil.removeItem = function(api, id, key, location) {\n  _callStorageFunction(_removeItem, arguments, location);\n};\n\n/**\n * Clears the local disk storage identified by the given ID.\n *\n * Set setItem() for details on storage types.\n *\n * @param api the flash interface if flash is available.\n * @param id the storage ID to use.\n * @param location an array with the preferred types of storage to use.\n */\nutil.clearItems = function(api, id, location) {\n  _callStorageFunction(_clearItems, arguments, location);\n};\n\n/**\n * Parses the scheme, host, and port from an http(s) url.\n *\n * @param str the url string.\n *\n * @return the parsed url object or null if the url is invalid.\n */\nutil.parseUrl = function(str) {\n  // FIXME: this regex looks a bit broken\n  var regex = /^(https?):\\/\\/([^:&^\\/]*):?(\\d*)(.*)$/g;\n  regex.lastIndex = 0;\n  var m = regex.exec(str);\n  var url = (m === null) ? null : {\n    full: str,\n    scheme: m[1],\n    host: m[2],\n    port: m[3],\n    path: m[4]\n  };\n  if(url) {\n    url.fullHost = url.host;\n    if(url.port) {\n      if(url.port !== 80 && url.scheme === 'http') {\n        url.fullHost += ':' + url.port;\n      } else if(url.port !== 443 && url.scheme === 'https') {\n        url.fullHost += ':' + url.port;\n      }\n    } else if(url.scheme === 'http') {\n      url.port = 80;\n    } else if(url.scheme === 'https') {\n      url.port = 443;\n    }\n    url.full = url.scheme + '://' + url.fullHost;\n  }\n  return url;\n};\n\n/* Storage for query variables */\nvar _queryVariables = null;\n\n/**\n * Returns the window location query variables. Query is parsed on the first\n * call and the same object is returned on subsequent calls. The mapping\n * is from keys to an array of values. Parameters without values will have\n * an object key set but no value added to the value array. Values are\n * unescaped.\n *\n * ...?k1=v1&k2=v2:\n * {\n *   \"k1\": [\"v1\"],\n *   \"k2\": [\"v2\"]\n * }\n *\n * ...?k1=v1&k1=v2:\n * {\n *   \"k1\": [\"v1\", \"v2\"]\n * }\n *\n * ...?k1=v1&k2:\n * {\n *   \"k1\": [\"v1\"],\n *   \"k2\": []\n * }\n *\n * ...?k1=v1&k1:\n * {\n *   \"k1\": [\"v1\"]\n * }\n *\n * ...?k1&k1:\n * {\n *   \"k1\": []\n * }\n *\n * @param query the query string to parse (optional, default to cached\n *          results from parsing window location search query).\n *\n * @return object mapping keys to variables.\n */\nutil.getQueryVariables = function(query) {\n  var parse = function(q) {\n    var rval = {};\n    var kvpairs = q.split('&');\n    for(var i = 0; i < kvpairs.length; i++) {\n      var pos = kvpairs[i].indexOf('=');\n      var key;\n      var val;\n      if(pos > 0) {\n        key = kvpairs[i].substring(0, pos);\n        val = kvpairs[i].substring(pos + 1);\n      } else {\n        key = kvpairs[i];\n        val = null;\n      }\n      if(!(key in rval)) {\n        rval[key] = [];\n      }\n      // disallow overriding object prototype keys\n      if(!(key in Object.prototype) && val !== null) {\n        rval[key].push(unescape(val));\n      }\n    }\n    return rval;\n  };\n\n   var rval;\n   if(typeof(query) === 'undefined') {\n     // set cached variables if needed\n     if(_queryVariables === null) {\n       if(typeof(window) !== 'undefined' && window.location && window.location.search) {\n          // parse window search query\n          _queryVariables = parse(window.location.search.substring(1));\n       } else {\n          // no query variables available\n          _queryVariables = {};\n       }\n     }\n     rval = _queryVariables;\n   } else {\n     // parse given query\n     rval = parse(query);\n   }\n   return rval;\n};\n\n/**\n * Parses a fragment into a path and query. This method will take a URI\n * fragment and break it up as if it were the main URI. For example:\n *    /bar/baz?a=1&b=2\n * results in:\n *    {\n *       path: [\"bar\", \"baz\"],\n *       query: {\"k1\": [\"v1\"], \"k2\": [\"v2\"]}\n *    }\n *\n * @return object with a path array and query object.\n */\nutil.parseFragment = function(fragment) {\n  // default to whole fragment\n  var fp = fragment;\n  var fq = '';\n  // split into path and query if possible at the first '?'\n  var pos = fragment.indexOf('?');\n  if(pos > 0) {\n    fp = fragment.substring(0, pos);\n    fq = fragment.substring(pos + 1);\n  }\n  // split path based on '/' and ignore first element if empty\n  var path = fp.split('/');\n  if(path.length > 0 && path[0] === '') {\n    path.shift();\n  }\n  // convert query into object\n  var query = (fq === '') ? {} : util.getQueryVariables(fq);\n\n  return {\n    pathString: fp,\n    queryString: fq,\n    path: path,\n    query: query\n  };\n};\n\n/**\n * Makes a request out of a URI-like request string. This is intended to\n * be used where a fragment id (after a URI '#') is parsed as a URI with\n * path and query parts. The string should have a path beginning and\n * delimited by '/' and optional query parameters following a '?'. The\n * query should be a standard URL set of key value pairs delimited by\n * '&'. For backwards compatibility the initial '/' on the path is not\n * required. The request object has the following API, (fully described\n * in the method code):\n *    {\n *       path: <the path string part>.\n *       query: <the query string part>,\n *       getPath(i): get part or all of the split path array,\n *       getQuery(k, i): get part or all of a query key array,\n *       getQueryLast(k, _default): get last element of a query key array.\n *    }\n *\n * @return object with request parameters.\n */\nutil.makeRequest = function(reqString) {\n  var frag = util.parseFragment(reqString);\n  var req = {\n    // full path string\n    path: frag.pathString,\n    // full query string\n    query: frag.queryString,\n    /**\n     * Get path or element in path.\n     *\n     * @param i optional path index.\n     *\n     * @return path or part of path if i provided.\n     */\n    getPath: function(i) {\n      return (typeof(i) === 'undefined') ? frag.path : frag.path[i];\n    },\n    /**\n     * Get query, values for a key, or value for a key index.\n     *\n     * @param k optional query key.\n     * @param i optional query key index.\n     *\n     * @return query, values for a key, or value for a key index.\n     */\n    getQuery: function(k, i) {\n      var rval;\n      if(typeof(k) === 'undefined') {\n        rval = frag.query;\n      } else {\n        rval = frag.query[k];\n        if(rval && typeof(i) !== 'undefined') {\n           rval = rval[i];\n        }\n      }\n      return rval;\n    },\n    getQueryLast: function(k, _default) {\n      var rval;\n      var vals = req.getQuery(k);\n      if(vals) {\n        rval = vals[vals.length - 1];\n      } else {\n        rval = _default;\n      }\n      return rval;\n    }\n  };\n  return req;\n};\n\n/**\n * Makes a URI out of a path, an object with query parameters, and a\n * fragment. Uses jQuery.param() internally for query string creation.\n * If the path is an array, it will be joined with '/'.\n *\n * @param path string path or array of strings.\n * @param query object with query parameters. (optional)\n * @param fragment fragment string. (optional)\n *\n * @return string object with request parameters.\n */\nutil.makeLink = function(path, query, fragment) {\n  // join path parts if needed\n  path = jQuery.isArray(path) ? path.join('/') : path;\n\n  var qstr = jQuery.param(query || {});\n  fragment = fragment || '';\n  return path +\n    ((qstr.length > 0) ? ('?' + qstr) : '') +\n    ((fragment.length > 0) ? ('#' + fragment) : '');\n};\n\n/**\n * Follows a path of keys deep into an object hierarchy and set a value.\n * If a key does not exist or it's value is not an object, create an\n * object in it's place. This can be destructive to a object tree if\n * leaf nodes are given as non-final path keys.\n * Used to avoid exceptions from missing parts of the path.\n *\n * @param object the starting object.\n * @param keys an array of string keys.\n * @param value the value to set.\n */\nutil.setPath = function(object, keys, value) {\n  // need to start at an object\n  if(typeof(object) === 'object' && object !== null) {\n    var i = 0;\n    var len = keys.length;\n    while(i < len) {\n      var next = keys[i++];\n      if(i == len) {\n        // last\n        object[next] = value;\n      } else {\n        // more\n        var hasNext = (next in object);\n        if(!hasNext ||\n          (hasNext && typeof(object[next]) !== 'object') ||\n          (hasNext && object[next] === null)) {\n          object[next] = {};\n        }\n        object = object[next];\n      }\n    }\n  }\n};\n\n/**\n * Follows a path of keys deep into an object hierarchy and return a value.\n * If a key does not exist, create an object in it's place.\n * Used to avoid exceptions from missing parts of the path.\n *\n * @param object the starting object.\n * @param keys an array of string keys.\n * @param _default value to return if path not found.\n *\n * @return the value at the path if found, else default if given, else\n *         undefined.\n */\nutil.getPath = function(object, keys, _default) {\n  var i = 0;\n  var len = keys.length;\n  var hasNext = true;\n  while(hasNext && i < len &&\n    typeof(object) === 'object' && object !== null) {\n    var next = keys[i++];\n    hasNext = next in object;\n    if(hasNext) {\n      object = object[next];\n    }\n  }\n  return (hasNext ? object : _default);\n};\n\n/**\n * Follow a path of keys deep into an object hierarchy and delete the\n * last one. If a key does not exist, do nothing.\n * Used to avoid exceptions from missing parts of the path.\n *\n * @param object the starting object.\n * @param keys an array of string keys.\n */\nutil.deletePath = function(object, keys) {\n  // need to start at an object\n  if(typeof(object) === 'object' && object !== null) {\n    var i = 0;\n    var len = keys.length;\n    while(i < len) {\n      var next = keys[i++];\n      if(i == len) {\n        // last\n        delete object[next];\n      } else {\n        // more\n        if(!(next in object) ||\n          (typeof(object[next]) !== 'object') ||\n          (object[next] === null)) {\n           break;\n        }\n        object = object[next];\n      }\n    }\n  }\n};\n\n/**\n * Check if an object is empty.\n *\n * Taken from:\n * http://stackoverflow.com/questions/679915/how-do-i-test-for-an-empty-javascript-object-from-json/679937#679937\n *\n * @param object the object to check.\n */\nutil.isEmpty = function(obj) {\n  for(var prop in obj) {\n    if(obj.hasOwnProperty(prop)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n/**\n * Format with simple printf-style interpolation.\n *\n * %%: literal '%'\n * %s,%o: convert next argument into a string.\n *\n * @param format the string to format.\n * @param ... arguments to interpolate into the format string.\n */\nutil.format = function(format) {\n  var re = /%./g;\n  // current match\n  var match;\n  // current part\n  var part;\n  // current arg index\n  var argi = 0;\n  // collected parts to recombine later\n  var parts = [];\n  // last index found\n  var last = 0;\n  // loop while matches remain\n  while((match = re.exec(format))) {\n    part = format.substring(last, re.lastIndex - 2);\n    // don't add empty strings (ie, parts between %s%s)\n    if(part.length > 0) {\n      parts.push(part);\n    }\n    last = re.lastIndex;\n    // switch on % code\n    var code = match[0][1];\n    switch(code) {\n    case 's':\n    case 'o':\n      // check if enough arguments were given\n      if(argi < arguments.length) {\n        parts.push(arguments[argi++ + 1]);\n      } else {\n        parts.push('<?>');\n      }\n      break;\n    // FIXME: do proper formating for numbers, etc\n    //case 'f':\n    //case 'd':\n    case '%':\n      parts.push('%');\n      break;\n    default:\n      parts.push('<%' + code + '?>');\n    }\n  }\n  // add trailing part of format string\n  parts.push(format.substring(last));\n  return parts.join('');\n};\n\n/**\n * Formats a number.\n *\n * http://snipplr.com/view/5945/javascript-numberformat--ported-from-php/\n */\nutil.formatNumber = function(number, decimals, dec_point, thousands_sep) {\n  // http://kevin.vanzonneveld.net\n  // +   original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n  // +     bugfix by: Michael White (http://crestidg.com)\n  // +     bugfix by: Benjamin Lupton\n  // +     bugfix by: Allan Jensen (http://www.winternet.no)\n  // +    revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n  // *     example 1: number_format(1234.5678, 2, '.', '');\n  // *     returns 1: 1234.57\n\n  var n = number, c = isNaN(decimals = Math.abs(decimals)) ? 2 : decimals;\n  var d = dec_point === undefined ? ',' : dec_point;\n  var t = thousands_sep === undefined ?\n   '.' : thousands_sep, s = n < 0 ? '-' : '';\n  var i = parseInt((n = Math.abs(+n || 0).toFixed(c)), 10) + '';\n  var j = (i.length > 3) ? i.length % 3 : 0;\n  return s + (j ? i.substr(0, j) + t : '') +\n    i.substr(j).replace(/(\\d{3})(?=\\d)/g, '$1' + t) +\n    (c ? d + Math.abs(n - i).toFixed(c).slice(2) : '');\n};\n\n/**\n * Formats a byte size.\n *\n * http://snipplr.com/view/5949/format-humanize-file-byte-size-presentation-in-javascript/\n */\nutil.formatSize = function(size) {\n  if(size >= 1073741824) {\n    size = util.formatNumber(size / 1073741824, 2, '.', '') + ' GiB';\n  } else if(size >= 1048576) {\n    size = util.formatNumber(size / 1048576, 2, '.', '') + ' MiB';\n  } else if(size >= 1024) {\n    size = util.formatNumber(size / 1024, 0) + ' KiB';\n  } else {\n    size = util.formatNumber(size, 0) + ' bytes';\n  }\n  return size;\n};\n\n/**\n * Converts an IPv4 or IPv6 string representation into bytes (in network order).\n *\n * @param ip the IPv4 or IPv6 address to convert.\n *\n * @return the 4-byte IPv6 or 16-byte IPv6 address or null if the address can't\n *         be parsed.\n */\nutil.bytesFromIP = function(ip) {\n  if(ip.indexOf('.') !== -1) {\n    return util.bytesFromIPv4(ip);\n  }\n  if(ip.indexOf(':') !== -1) {\n    return util.bytesFromIPv6(ip);\n  }\n  return null;\n};\n\n/**\n * Converts an IPv4 string representation into bytes (in network order).\n *\n * @param ip the IPv4 address to convert.\n *\n * @return the 4-byte address or null if the address can't be parsed.\n */\nutil.bytesFromIPv4 = function(ip) {\n  ip = ip.split('.');\n  if(ip.length !== 4) {\n    return null;\n  }\n  var b = util.createBuffer();\n  for(var i = 0; i < ip.length; ++i) {\n    var num = parseInt(ip[i], 10);\n    if(isNaN(num)) {\n      return null;\n    }\n    b.putByte(num);\n  }\n  return b.getBytes();\n};\n\n/**\n * Converts an IPv6 string representation into bytes (in network order).\n *\n * @param ip the IPv6 address to convert.\n *\n * @return the 16-byte address or null if the address can't be parsed.\n */\nutil.bytesFromIPv6 = function(ip) {\n  var blanks = 0;\n  ip = ip.split(':').filter(function(e) {\n    if(e.length === 0) ++blanks;\n    return true;\n  });\n  var zeros = (8 - ip.length + blanks) * 2;\n  var b = util.createBuffer();\n  for(var i = 0; i < 8; ++i) {\n    if(!ip[i] || ip[i].length === 0) {\n      b.fillWithByte(0, zeros);\n      zeros = 0;\n      continue;\n    }\n    var bytes = util.hexToBytes(ip[i]);\n    if(bytes.length < 2) {\n      b.putByte(0);\n    }\n    b.putBytes(bytes);\n  }\n  return b.getBytes();\n};\n\n/**\n * Converts 4-bytes into an IPv4 string representation or 16-bytes into\n * an IPv6 string representation. The bytes must be in network order.\n *\n * @param bytes the bytes to convert.\n *\n * @return the IPv4 or IPv6 string representation if 4 or 16 bytes,\n *         respectively, are given, otherwise null.\n */\nutil.bytesToIP = function(bytes) {\n  if(bytes.length === 4) {\n    return util.bytesToIPv4(bytes);\n  }\n  if(bytes.length === 16) {\n    return util.bytesToIPv6(bytes);\n  }\n  return null;\n};\n\n/**\n * Converts 4-bytes into an IPv4 string representation. The bytes must be\n * in network order.\n *\n * @param bytes the bytes to convert.\n *\n * @return the IPv4 string representation or null for an invalid # of bytes.\n */\nutil.bytesToIPv4 = function(bytes) {\n  if(bytes.length !== 4) {\n    return null;\n  }\n  var ip = [];\n  for(var i = 0; i < bytes.length; ++i) {\n    ip.push(bytes.charCodeAt(i));\n  }\n  return ip.join('.');\n};\n\n/**\n * Converts 16-bytes into an IPv16 string representation. The bytes must be\n * in network order.\n *\n * @param bytes the bytes to convert.\n *\n * @return the IPv16 string representation or null for an invalid # of bytes.\n */\nutil.bytesToIPv6 = function(bytes) {\n  if(bytes.length !== 16) {\n    return null;\n  }\n  var ip = [];\n  var zeroGroups = [];\n  var zeroMaxGroup = 0;\n  for(var i = 0; i < bytes.length; i += 2) {\n    var hex = util.bytesToHex(bytes[i] + bytes[i + 1]);\n    // canonicalize zero representation\n    while(hex[0] === '0' && hex !== '0') {\n      hex = hex.substr(1);\n    }\n    if(hex === '0') {\n      var last = zeroGroups[zeroGroups.length - 1];\n      var idx = ip.length;\n      if(!last || idx !== last.end + 1) {\n        zeroGroups.push({start: idx, end: idx});\n      } else {\n        last.end = idx;\n        if((last.end - last.start) >\n          (zeroGroups[zeroMaxGroup].end - zeroGroups[zeroMaxGroup].start)) {\n          zeroMaxGroup = zeroGroups.length - 1;\n        }\n      }\n    }\n    ip.push(hex);\n  }\n  if(zeroGroups.length > 0) {\n    var group = zeroGroups[zeroMaxGroup];\n    // only shorten group of length > 0\n    if(group.end - group.start > 0) {\n      ip.splice(group.start, group.end - group.start + 1, '');\n      if(group.start === 0) {\n        ip.unshift('');\n      }\n      if(group.end === 7) {\n        ip.push('');\n      }\n    }\n  }\n  return ip.join(':');\n};\n\n/**\n * Estimates the number of processes that can be run concurrently. If\n * creating Web Workers, keep in mind that the main JavaScript process needs\n * its own core.\n *\n * @param options the options to use:\n *          update true to force an update (not use the cached value).\n * @param callback(err, max) called once the operation completes.\n */\nutil.estimateCores = function(options, callback) {\n  if(typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n  options = options || {};\n  if('cores' in util && !options.update) {\n    return callback(null, util.cores);\n  }\n  if(typeof navigator !== 'undefined' &&\n    'hardwareConcurrency' in navigator &&\n    navigator.hardwareConcurrency > 0) {\n    util.cores = navigator.hardwareConcurrency;\n    return callback(null, util.cores);\n  }\n  if(typeof Worker === 'undefined') {\n    // workers not available\n    util.cores = 1;\n    return callback(null, util.cores);\n  }\n  if(typeof Blob === 'undefined') {\n    // can't estimate, default to 2\n    util.cores = 2;\n    return callback(null, util.cores);\n  }\n\n  // create worker concurrency estimation code as blob\n  var blobUrl = URL.createObjectURL(new Blob(['(',\n    function() {\n      self.addEventListener('message', function(e) {\n        // run worker for 4 ms\n        var st = Date.now();\n        var et = st + 4;\n        while(Date.now() < et);\n        self.postMessage({st: st, et: et});\n      });\n    }.toString(),\n  ')()'], {type: 'application/javascript'}));\n\n  // take 5 samples using 16 workers\n  sample([], 5, 16);\n\n  function sample(max, samples, numWorkers) {\n    if(samples === 0) {\n      // get overlap average\n      var avg = Math.floor(max.reduce(function(avg, x) {\n        return avg + x;\n      }, 0) / max.length);\n      util.cores = Math.max(1, avg);\n      URL.revokeObjectURL(blobUrl);\n      return callback(null, util.cores);\n    }\n    map(numWorkers, function(err, results) {\n      max.push(reduce(numWorkers, results));\n      sample(max, samples - 1, numWorkers);\n    });\n  }\n\n  function map(numWorkers, callback) {\n    var workers = [];\n    var results = [];\n    for(var i = 0; i < numWorkers; ++i) {\n      var worker = new Worker(blobUrl);\n      worker.addEventListener('message', function(e) {\n        results.push(e.data);\n        if(results.length === numWorkers) {\n          for(var i = 0; i < numWorkers; ++i) {\n            workers[i].terminate();\n          }\n          callback(null, results);\n        }\n      });\n      workers.push(worker);\n    }\n    for(var i = 0; i < numWorkers; ++i) {\n      workers[i].postMessage(i);\n    }\n  }\n\n  function reduce(numWorkers, results) {\n    // find overlapping time windows\n    var overlaps = [];\n    for(var n = 0; n < numWorkers; ++n) {\n      var r1 = results[n];\n      var overlap = overlaps[n] = [];\n      for(var i = 0; i < numWorkers; ++i) {\n        if(n === i) {\n          continue;\n        }\n        var r2 = results[i];\n        if((r1.st > r2.st && r1.st < r2.et) ||\n          (r2.st > r1.st && r2.st < r1.et)) {\n          overlap.push(i);\n        }\n      }\n    }\n    // get maximum overlaps ... don't include overlapping worker itself\n    // as the main JS process was also being scheduled during the work and\n    // would have to be subtracted from the estimate anyway\n    return overlaps.reduce(function(max, overlap) {\n      return Math.max(max, overlap.length);\n    }, 0);\n  }\n};\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\n// TODO: convert to ES6 iterable\n\nmodule.exports = class Permutator {\n  /**\n   * A Permutator iterates over all possible permutations of the given array\n   * of elements.\n   *\n   * @param list the array of elements to iterate over.\n   */\n  constructor(list) {\n    // original array\n    this.list = list.sort();\n    // indicates whether there are more permutations\n    this.done = false;\n    // directional info for permutation algorithm\n    this.left = {};\n    for(let i = 0; i < list.length; ++i) {\n      this.left[list[i]] = true;\n    }\n  }\n\n  /**\n   * Returns true if there is another permutation.\n   *\n   * @return true if there is another permutation, false if not.\n   */\n  hasNext() {\n    return !this.done;\n  }\n\n  /**\n   * Gets the next permutation. Call hasNext() to ensure there is another one\n   * first.\n   *\n   * @return the next permutation.\n   */\n  next() {\n    // copy current permutation\n    const rval = this.list.slice();\n\n    /* Calculate the next permutation using the Steinhaus-Johnson-Trotter\n     permutation algorithm. */\n\n    // get largest mobile element k\n    // (mobile: element is greater than the one it is looking at)\n    let k = null;\n    let pos = 0;\n    const length = this.list.length;\n    for(let i = 0; i < length; ++i) {\n      const element = this.list[i];\n      const left = this.left[element];\n      if((k === null || element > k) &&\n        ((left && i > 0 && element > this.list[i - 1]) ||\n        (!left && i < (length - 1) && element > this.list[i + 1]))) {\n        k = element;\n        pos = i;\n      }\n    }\n\n    // no more permutations\n    if(k === null) {\n      this.done = true;\n    } else {\n      // swap k and the element it is looking at\n      const swap = this.left[k] ? pos - 1 : pos + 1;\n      this.list[pos] = this.list[swap];\n      this.list[swap] = k;\n\n      // reverse the direction of all elements larger than k\n      for(let i = 0; i < length; ++i) {\n        if(this.list[i] > k) {\n          this.left[this.list[i]] = !this.left[this.list[i]];\n        }\n      }\n    }\n\n    return rval;\n  }\n};\n\n","/*\n * Copyright (c) 2016 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst IdentifierIssuer = require('./IdentifierIssuer');\nconst MessageDigest = require('./MessageDigest');\nconst Permutator = require('./Permutator');\nconst NQuads = require('./NQuads');\nconst util = require('./util');\n\nconst POSITIONS = {subject: 's', object: 'o', graph: 'g'};\n\nmodule.exports = class URDNA2015Sync {\n  constructor() {\n    this.name = 'URDNA2015';\n    this.blankNodeInfo = {};\n    this.hashToBlankNodes = {};\n    this.canonicalIssuer = new IdentifierIssuer('_:c14n');\n    this.hashAlgorithm = 'sha256';\n    this.quads;\n  }\n\n  // 4.4) Normalization Algorithm\n  main(dataset) {\n    const self = this;\n    self.quads = dataset;\n\n    // 1) Create the normalization state.\n\n    // Note: Optimize by generating non-normalized blank node map concurrently.\n    const nonNormalized = {};\n\n    // 2) For every quad in input dataset:\n    for(const quad of dataset) {\n      // 2.1) For each blank node that occurs in the quad, add a reference\n      // to the quad using the blank node identifier in the blank node to\n      // quads map, creating a new entry if necessary.\n      self.forEachComponent(quad, component => {\n        if(component.termType !== 'BlankNode') {\n          return;\n        }\n        const id = component.value;\n        if(id in self.blankNodeInfo) {\n          self.blankNodeInfo[id].quads.push(quad);\n        } else {\n          nonNormalized[id] = true;\n          self.blankNodeInfo[id] = {quads: [quad]};\n        }\n      });\n    }\n\n    // 3) Create a list of non-normalized blank node identifiers\n    // non-normalized identifiers and populate it using the keys from the\n    // blank node to quads map.\n    // Note: We use a map here and it was generated during step 2.\n\n    // 4) Initialize simple, a boolean flag, to true.\n    let simple = true;\n\n    // 5) While simple is true, issue canonical identifiers for blank nodes:\n    while(simple) {\n      // 5.1) Set simple to false.\n      simple = false;\n\n      // 5.2) Clear hash to blank nodes map.\n      self.hashToBlankNodes = {};\n\n      // 5.3) For each blank node identifier identifier in non-normalized\n      // identifiers:\n      for(const id in nonNormalized) {\n        // 5.3.1) Create a hash, hash, according to the Hash First Degree\n        // Quads algorithm.\n        const hash = self.hashFirstDegreeQuads(id);\n\n        // 5.3.2) Add hash and identifier to hash to blank nodes map,\n        // creating a new entry if necessary.\n        if(hash in self.hashToBlankNodes) {\n          self.hashToBlankNodes[hash].push(id);\n        } else {\n          self.hashToBlankNodes[hash] = [id];\n        }\n      }\n\n      // 5.4) For each hash to identifier list mapping in hash to blank\n      // nodes map, lexicographically-sorted by hash:\n      const hashes = Object.keys(self.hashToBlankNodes).sort();\n      for(let i = 0; i < hashes.length; ++i) {\n        // 5.4.1) If the length of identifier list is greater than 1,\n        // continue to the next mapping.\n        const hash = hashes[i];\n        const idList = self.hashToBlankNodes[hash];\n        if(idList.length > 1) {\n          continue;\n        }\n\n        // 5.4.2) Use the Issue Identifier algorithm, passing canonical\n        // issuer and the single blank node identifier in identifier\n        // list, identifier, to issue a canonical replacement identifier\n        // for identifier.\n        // TODO: consider changing `getId` to `issue`\n        const id = idList[0];\n        self.canonicalIssuer.getId(id);\n\n        // 5.4.3) Remove identifier from non-normalized identifiers.\n        delete nonNormalized[id];\n\n        // 5.4.4) Remove hash from the hash to blank nodes map.\n        delete self.hashToBlankNodes[hash];\n\n        // 5.4.5) Set simple to true.\n        simple = true;\n      }\n    }\n\n    // 6) For each hash to identifier list mapping in hash to blank nodes map,\n    // lexicographically-sorted by hash:\n    const hashes = Object.keys(self.hashToBlankNodes).sort();\n    for(let i = 0; i < hashes.length; ++i) {\n      // 6.1) Create hash path list where each item will be a result of\n      // running the Hash N-Degree Quads algorithm.\n      const hashPathList = [];\n\n      // 6.2) For each blank node identifier identifier in identifier list:\n      const hash = hashes[i];\n      const idList = self.hashToBlankNodes[hash];\n      for(let j = 0; j < idList.length; ++j) {\n        // 6.2.1) If a canonical identifier has already been issued for\n        // identifier, continue to the next identifier.\n        const id = idList[j];\n        if(self.canonicalIssuer.hasId(id)) {\n          continue;\n        }\n\n        // 6.2.2) Create temporary issuer, an identifier issuer\n        // initialized with the prefix _:b.\n        const issuer = new IdentifierIssuer('_:b');\n\n        // 6.2.3) Use the Issue Identifier algorithm, passing temporary\n        // issuer and identifier, to issue a new temporary blank node\n        // identifier for identifier.\n        issuer.getId(id);\n\n        // 6.2.4) Run the Hash N-Degree Quads algorithm, passing\n        // temporary issuer, and append the result to the hash path list.\n        const result = self.hashNDegreeQuads(id, issuer);\n        hashPathList.push(result);\n      }\n\n      // 6.3) For each result in the hash path list,\n      // lexicographically-sorted by the hash in result:\n      // TODO: use `String.localeCompare`?\n      hashPathList.sort((a, b) =>\n        (a.hash < b.hash) ? -1 : ((a.hash > b.hash) ? 1 : 0));\n      for(let j = 0; j < hashPathList.length; ++j) {\n        // 6.3.1) For each blank node identifier, existing identifier,\n        // that was issued a temporary identifier by identifier issuer\n        // in result, issue a canonical identifier, in the same order,\n        // using the Issue Identifier algorithm, passing canonical\n        // issuer and existing identifier.\n        const result = hashPathList[j];\n        for(const existing in result.issuer.existing) {\n          self.canonicalIssuer.getId(existing);\n        }\n      }\n    }\n\n    /* Note: At this point all blank nodes in the set of RDF quads have been\n    assigned canonical identifiers, which have been stored in the canonical\n    issuer. Here each quad is updated by assigning each of its blank nodes\n    its new identifier. */\n\n    // 7) For each quad, quad, in input dataset:\n    const normalized = [];\n    for(let i = 0; i < self.quads.length; ++i) {\n      // 7.1) Create a copy, quad copy, of quad and replace any existing\n      // blank node identifiers using the canonical identifiers\n      // previously issued by canonical issuer.\n      // Note: We optimize away the copy here.\n      const quad = self.quads[i];\n      self.forEachComponent(quad, component => {\n        if(component.termType === 'BlankNode' &&\n          !component.value.startsWith(self.canonicalIssuer.prefix)) {\n          component.value = self.canonicalIssuer.getId(component.value);\n        }\n      });\n      // 7.2) Add quad copy to the normalized dataset.\n      normalized.push(NQuads.serializeQuad(quad));\n    }\n\n    // sort normalized output\n    normalized.sort();\n\n    // 8) Return the normalized dataset.\n    return normalized.join('');\n  }\n\n  // 4.6) Hash First Degree Quads\n  hashFirstDegreeQuads(id) {\n    const self = this;\n\n    // return cached hash\n    const info = self.blankNodeInfo[id];\n    if('hash' in info) {\n      return info.hash;\n    }\n\n    // 1) Initialize nquads to an empty list. It will be used to store quads in\n    // N-Quads format.\n    const nquads = [];\n\n    // 2) Get the list of quads `quads` associated with the reference blank node\n    // identifier in the blank node to quads map.\n    const quads = info.quads;\n\n    // 3) For each quad `quad` in `quads`:\n    for(let i = 0; i < quads.length; ++i) {\n      const quad = quads[i];\n\n      // 3.1) Serialize the quad in N-Quads format with the following special\n      // rule:\n\n      // 3.1.1) If any component in quad is an blank node, then serialize it\n      // using a special identifier as follows:\n      const copy = {predicate: quad.predicate};\n      self.forEachComponent(quad, (component, key) => {\n        // 3.1.2) If the blank node's existing blank node identifier matches\n        // the reference blank node identifier then use the blank node\n        // identifier _:a, otherwise, use the blank node identifier _:z.\n        copy[key] = self.modifyFirstDegreeComponent(id, component, key);\n      });\n      nquads.push(NQuads.serializeQuad(copy));\n    }\n\n    // 4) Sort nquads in lexicographical order.\n    nquads.sort();\n\n    // 5) Return the hash that results from passing the sorted, joined nquads\n    // through the hash algorithm.\n    const md = new MessageDigest(self.hashAlgorithm);\n    for(let i = 0; i < nquads.length; ++i) {\n      md.update(nquads[i]);\n    }\n    // TODO: represent as byte buffer instead to cut memory usage in half\n    info.hash = md.digest();\n    return info.hash;\n  }\n\n  // 4.7) Hash Related Blank Node\n  hashRelatedBlankNode(related, quad, issuer, position) {\n    const self = this;\n\n    // 1) Set the identifier to use for related, preferring first the canonical\n    // identifier for related if issued, second the identifier issued by issuer\n    // if issued, and last, if necessary, the result of the Hash First Degree\n    // Quads algorithm, passing related.\n    let id;\n    if(self.canonicalIssuer.hasId(related)) {\n      id = self.canonicalIssuer.getId(related);\n    } else if(issuer.hasId(related)) {\n      id = issuer.getId(related);\n    } else {\n      id = self.hashFirstDegreeQuads(related);\n    }\n\n    // 2) Initialize a string input to the value of position.\n    // Note: We use a hash object instead.\n    const md = new MessageDigest(self.hashAlgorithm);\n    md.update(position);\n\n    // 3) If position is not g, append <, the value of the predicate in quad,\n    // and > to input.\n    if(position !== 'g') {\n      md.update(self.getRelatedPredicate(quad));\n    }\n\n    // 4) Append identifier to input.\n    md.update(id);\n\n    // 5) Return the hash that results from passing input through the hash\n    // algorithm.\n    // TODO: represent as byte buffer instead to cut memory usage in half\n    return md.digest();\n  }\n\n  // 4.8) Hash N-Degree Quads\n  hashNDegreeQuads(id, issuer) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    // Note: 2) and 3) handled within `createHashToRelated`\n    const md = new MessageDigest(self.hashAlgorithm);\n    const hashToRelated = self.createHashToRelated(id, issuer);\n\n    // 4) Create an empty string, data to hash.\n    // Note: We created a hash object `md` above instead.\n\n    // 5) For each related hash to blank node list mapping in hash to related\n    // blank nodes map, sorted lexicographically by related hash:\n    const hashes = Object.keys(hashToRelated).sort();\n    for(let i = 0; i < hashes.length; ++i) {\n      // 5.1) Append the related hash to the data to hash.\n      const hash = hashes[i];\n      md.update(hash);\n\n      // 5.2) Create a string chosen path.\n      let chosenPath = '';\n\n      // 5.3) Create an unset chosen issuer variable.\n      let chosenIssuer;\n\n      // 5.4) For each permutation of blank node list:\n      const permutator = new Permutator(hashToRelated[hash]);\n      while(permutator.hasNext()) {\n        const permutation = permutator.next();\n\n        // 5.4.1) Create a copy of issuer, issuer copy.\n        let issuerCopy = issuer.clone();\n\n        // 5.4.2) Create a string path.\n        let path = '';\n\n        // 5.4.3) Create a recursion list, to store blank node identifiers\n        // that must be recursively processed by this algorithm.\n        const recursionList = [];\n\n        // 5.4.4) For each related in permutation:\n        let nextPermutation = false;\n        for(let j = 0; j < permutation.length; ++j) {\n          // 5.4.4.1) If a canonical identifier has been issued for\n          // related, append it to path.\n          const related = permutation[j];\n          if(self.canonicalIssuer.hasId(related)) {\n            path += self.canonicalIssuer.getId(related);\n          } else {\n            // 5.4.4.2) Otherwise:\n            // 5.4.4.2.1) If issuer copy has not issued an identifier for\n            // related, append related to recursion list.\n            if(!issuerCopy.hasId(related)) {\n              recursionList.push(related);\n            }\n            // 5.4.4.2.2) Use the Issue Identifier algorithm, passing\n            // issuer copy and related and append the result to path.\n            path += issuerCopy.getId(related);\n          }\n\n          // 5.4.4.3) If chosen path is not empty and the length of path\n          // is greater than or equal to the length of chosen path and\n          // path is lexicographically greater than chosen path, then\n          // skip to the next permutation.\n          if(chosenPath.length !== 0 &&\n            path.length >= chosenPath.length && path > chosenPath) {\n            nextPermutation = true;\n            break;\n          }\n        }\n\n        if(nextPermutation) {\n          continue;\n        }\n\n        // 5.4.5) For each related in recursion list:\n        for(let j = 0; j < recursionList.length; ++j) {\n          // 5.4.5.1) Set result to the result of recursively executing\n          // the Hash N-Degree Quads algorithm, passing related for\n          // identifier and issuer copy for path identifier issuer.\n          const related = recursionList[j];\n          const result = self.hashNDegreeQuads(related, issuerCopy);\n\n          // 5.4.5.2) Use the Issue Identifier algorithm, passing issuer\n          // copy and related and append the result to path.\n          path += issuerCopy.getId(related);\n\n          // 5.4.5.3) Append <, the hash in result, and > to path.\n          path += '<' + result.hash + '>';\n\n          // 5.4.5.4) Set issuer copy to the identifier issuer in\n          // result.\n          issuerCopy = result.issuer;\n\n          // 5.4.5.5) If chosen path is not empty and the length of path\n          // is greater than or equal to the length of chosen path and\n          // path is lexicographically greater than chosen path, then\n          // skip to the next permutation.\n          if(chosenPath.length !== 0 &&\n            path.length >= chosenPath.length && path > chosenPath) {\n            nextPermutation = true;\n            break;\n          }\n        }\n\n        if(nextPermutation) {\n          continue;\n        }\n\n        // 5.4.6) If chosen path is empty or path is lexicographically\n        // less than chosen path, set chosen path to path and chosen\n        // issuer to issuer copy.\n        if(chosenPath.length === 0 || path < chosenPath) {\n          chosenPath = path;\n          chosenIssuer = issuerCopy;\n        }\n      }\n\n      // 5.5) Append chosen path to data to hash.\n      md.update(chosenPath);\n\n      // 5.6) Replace issuer, by reference, with chosen issuer.\n      issuer = chosenIssuer;\n    }\n\n    // 6) Return issuer and the hash that results from passing data to hash\n    // through the hash algorithm.\n    return {hash: md.digest(), issuer};\n  }\n\n  // helper for modifying component during Hash First Degree Quads\n  modifyFirstDegreeComponent(id, component) {\n    if(component.termType !== 'BlankNode') {\n      return component;\n    }\n    component = util.clone(component);\n    component.value = (component.value === id ? '_:a' : '_:z');\n    return component;\n  }\n\n  // helper for getting a related predicate\n  getRelatedPredicate(quad) {\n    return '<' + quad.predicate.value + '>';\n  }\n\n  // helper for creating hash to related blank nodes map\n  createHashToRelated(id, issuer) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    const hashToRelated = {};\n\n    // 2) Get a reference, quads, to the list of quads in the blank node to\n    // quads map for the key identifier.\n    const quads = self.blankNodeInfo[id].quads;\n\n    // 3) For each quad in quads:\n    for(let i = 0; i < quads.length; ++i) {\n      // 3.1) For each component in quad, if component is the subject, object,\n      // and graph name and it is a blank node that is not identified by\n      // identifier:\n      const quad = quads[i];\n      for(const key in quad) {\n        const component = quad[key];\n        if(key === 'predicate' ||\n          !(component.termType === 'BlankNode' && component.value !== id)) {\n          continue;\n        }\n        // 3.1.1) Set hash to the result of the Hash Related Blank Node\n        // algorithm, passing the blank node identifier for component as\n        // related, quad, path identifier issuer as issuer, and position as\n        // either s, o, or g based on whether component is a subject, object,\n        // graph name, respectively.\n        const related = component.value;\n        const position = POSITIONS[key];\n        const hash = self.hashRelatedBlankNode(related, quad, issuer, position);\n\n        // 3.1.2) Add a mapping of hash to the blank node identifier for\n        // component to hash to related blank nodes map, adding an entry as\n        // necessary.\n        if(hash in hashToRelated) {\n          hashToRelated[hash].push(related);\n        } else {\n          hashToRelated[hash] = [related];\n        }\n      }\n    }\n\n    return hashToRelated;\n  }\n\n  // helper that iterates over quad components (skips predicate)\n  forEachComponent(quad, op) {\n    for(const key in quad) {\n      // skip `predicate`\n      if(key === 'predicate') {\n        continue;\n      }\n      op(quad[key], key, quad);\n    }\n  }\n};\n","function DefaultGraph () {\n  this.value = ''\n}\n\nDefaultGraph.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType\n}\n\nDefaultGraph.prototype.termType = 'DefaultGraph'\n\nmodule.exports = DefaultGraph\n","function NamedNode (iri) {\n  this.value = iri\n}\n\nNamedNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nNamedNode.prototype.termType = 'NamedNode'\n\nmodule.exports = NamedNode\n","import IStop from \"../../fetcher/stops/IStop\";\nimport { DistanceM } from \"../../interfaces/units\";\n\nexport class Footpath {\n    public static create(id: string) {\n        return new Footpath(id);\n    }\n\n    public from: string;\n    public to: string;\n    public distance: DistanceM;\n    public id: string;\n\n    constructor(id: string) {\n        this.id = id;\n    }\n}\n\nexport interface IFootpathIndex {\n    [id: string]: Footpath;\n}\n","import { RDF } from \"../../uri/constants\";\nimport URI from \"../../uri/uri\";\nimport { IEntity, ISemiEntity } from \"../common\";\nimport { IThingViewResult } from \"../results/common\";\nimport { SingleThingViewResult } from \"../results/single\";\n\nexport class ThingView<T extends ISemiEntity> {\n    private filters: Array<(entity: IEntity) => boolean> = [];\n    private mappings = {};\n    private nestedViews = {};\n    private showId = true;\n    private resultObject: IThingViewResult<T>;\n\n    constructor(private entityType: (id?: string) => T) {\n        this.resultObject = this.createResultObject();\n    }\n\n    public addEntity(entity: T) {\n        this.resultObject.addEntity(entity);\n    }\n\n    public getContents() {\n        return this.resultObject.getContents();\n    }\n\n    public hideId() {\n        this.showId = false;\n    }\n\n    public addFilter(fn: (Entity) => boolean) {\n        this.filters.push(fn);\n    }\n\n    public addMapping(from, to, view?: ThingView<any>) {\n        this.mappings[from] = to;\n        this.nestedViews[from] = view;\n    }\n\n    public process(entity: IEntity): T {\n        if (this._filter(entity)) {\n            return this._map(entity);\n        }\n    }\n\n    public createResultObject(): IThingViewResult<T> {\n        return new SingleThingViewResult();\n    }\n\n    private _filter(entity: IEntity) {\n        let ok = true;\n        for (const fn of this.filters) {\n            if (!fn(entity)) {\n                ok = false;\n                break;\n            }\n        }\n        return ok;\n    }\n\n    private _makeList(element: IEntity): any[] {\n        let current = element;\n        const list = [current[URI.inNS(RDF, \"first\")]];\n        let rest = current[URI.inNS(RDF, \"rest\")];\n\n        while (rest && rest !== URI.inNS(RDF, \"nil\")) {\n            current = rest;\n            list.push(current[URI.inNS(RDF, \"first\")]);\n            rest = current[URI.inNS(RDF, \"rest\")];\n        }\n\n        return list;\n    }\n\n    private _flattenLists(entity: IEntity) {\n        for (const kv of Object.entries(entity)) {\n            const [field, entityValue] = kv;\n            if (Array.isArray(entityValue)) {\n                for (const v of entityValue.entries()) {\n                    const [valueElementIndex, valueElement] = v;\n                    if (valueElement[URI.inNS(RDF, \"first\")]) {\n                        const list = this._makeList(valueElement);\n                        entityValue[valueElementIndex] = list;\n                    }\n                }\n            }\n            if (entityValue[URI.inNS(RDF, \"first\")]) {\n                // this value should become an array\n                entity[field] = this._makeList(entityValue);\n            }\n        }\n    }\n\n    private _map(entity: IEntity): T {\n        this._flattenLists(entity);\n\n        let result;\n        if (this.showId) {\n            result = this.entityType(entity.id);\n        } else {\n            result = this.entityType();\n        }\n\n        for (const kv of Object.entries(entity)) {\n            const field = kv[0];\n            let value = kv[1];\n            const fieldView = this.nestedViews[field];\n            if (fieldView) {\n                if (Array.isArray(value)) {\n                    value = value.map((v) => fieldView.process(v));\n                } else {\n                    value = fieldView.process(value);\n                }\n            }\n            const destinationField = this.mappings[field];\n            if (destinationField) {\n                result[destinationField] = value;\n            }\n        }\n        return result;\n    }\n}\n","import ILocation from \"../../interfaces/ILocation\";\nimport { RoutableTileCoordinate } from \"./coordinate\";\n\nfunction tile_to_lat(coordinate: RoutableTileCoordinate) {\n    // from https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames\n    const n = Math.PI - 2 * Math.PI * coordinate.y / Math.pow(2, coordinate.zoom);\n    return (180 / Math.PI * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n))));\n}\n\nfunction tile_to_long(coordinate: RoutableTileCoordinate) {\n    // from https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames\n    return (coordinate.x / Math.pow(2, coordinate.zoom) * 360 - 180);\n}\n\nexport class RoutableTile {\n    public id: string;\n    public coordinate?: RoutableTileCoordinate;\n    protected nodes: Set<string>;\n    protected ways: Set<string>;\n\n    constructor(id: string, nodes: Set<string>, ways: Set<string>) {\n        this.id = id;\n        this.nodes = nodes;\n        this.ways = ways;\n    }\n\n    public getWays() {\n        return this.ways;\n    }\n\n    public getNodes() {\n        return this.nodes;\n    }\n\n    public contains(location: ILocation): boolean {\n        const top = tile_to_lat(this.coordinate);\n        const left = tile_to_long(this.coordinate);\n\n        const next = new RoutableTileCoordinate(this.coordinate.zoom, this.coordinate.x + 1, this.coordinate.y + 1);\n\n        const bottom = tile_to_lat(next);\n        const right = tile_to_long(next);\n\n        if (location.latitude > top || location.latitude < bottom) {\n            return false;\n        } else if (location.longitude < left || location.longitude > right) {\n            return false;\n        }\n        return true;\n    }\n}\n\nexport interface IRoutableTileIndex {\n    [id: string]: Promise<RoutableTile>;\n}\n","import { injectable } from \"inversify\";\nimport PathfindingGraph from \"../graph\";\nimport { IShortestPathAlgorithm, IShortestPathInstance } from \"../pathfinder\";\nimport { DijkstraInstance } from \"./DijkstraInstance\";\n\n@injectable()\nexport class Dijkstra implements IShortestPathAlgorithm {\n    public createInstance(graph: PathfindingGraph): IShortestPathInstance {\n        return new DijkstraInstance(graph);\n    }\n}\n","enum DropOffType {\n  Regular = \"gtfs:Regular\",\n  NotAvailable = \"gtfs:NotAvailable\",\n  MustPhone = \"gtfs:MustPhone\",\n  MustCoordinateWithDriver = \"gtfs:MustCoordinateWithDriver\",\n}\n\nexport default DropOffType;\n","enum ReachableStopsFinderMode {\n  Source = \"source\",\n  Target = \"target\",\n}\n\nexport default ReachableStopsFinderMode;\n","import { AsyncIterator } from \"asynciterator\";\n\n/**\n * AsyncIterator that merges a number of source asynciterators based on the passed selector function.\n *\n * The selector function gets passed an array of values read from each of the asynciterators.\n * Values can be undefined if their respective source iterator has ended.\n * The selector function should return the index in that array of the value to select.\n */\nexport default class MergeIterator<T> extends AsyncIterator<T> {\n  private readonly sourceIterators: Array<AsyncIterator<T>>;\n  private readonly selector: (values: T[]) => number;\n  private readonly condensed: boolean;\n\n  private values: T[];\n  private waitingForFill: boolean[];\n\n  /**\n   * @param sourceIterators\n   * @param selector\n   * @param condensed When true, undefined values are filtered from the array passed to the selector function\n   */\n  constructor(sourceIterators: Array<AsyncIterator<T>>, selector: (values: T[]) => number, condensed = false) {\n    super();\n\n    this.sourceIterators = sourceIterators;\n    this.selector = selector;\n\n    this.values = Array(this.sourceIterators.length).fill(undefined);\n    this.waitingForFill = Array(this.sourceIterators.length).fill(false);\n    this.readable = true;\n    this.condensed = condensed;\n    this.addListeners();\n  }\n\n  public read(): T {\n    const allFilled = this.fillValues();\n\n    if (!allFilled) {\n      this.readable = false;\n\n      return null;\n    }\n\n    let selectedIndex: number;\n\n    if (this.condensed) {\n      const { values, indexMap } = this.getCondensedValues();\n\n      selectedIndex = indexMap[this.selector(values)];\n\n    } else {\n      selectedIndex = this.selector(this.values);\n    }\n\n    const item = this.values[selectedIndex];\n    this.values[selectedIndex] = undefined;\n\n    this.readable = false;\n\n    return item;\n  }\n\n  public close() {\n    for (const iterator of this.sourceIterators) {\n      iterator.close();\n    }\n\n    super.close();\n  }\n\n  private fillValues(): boolean {\n\n    const allWaiting = this.waitingForFill.every((waiting) => waiting);\n\n    if (allWaiting) {\n      return false;\n    }\n\n    const allFilled = this.values.every((value) => value !== undefined);\n\n    if (allFilled) {\n      return true;\n    }\n\n    const allEnded = this.sourceIterators.every((iterator) => iterator.ended);\n\n    if (allEnded) {\n      return false;\n    }\n\n    let filledValues = 0;\n\n    const filled = () => {\n      filledValues++;\n\n      if (filledValues === this.sourceIterators.length) {\n        this.readable = true;\n      }\n    };\n\n    for (let sourceIndex = 0; sourceIndex < this.sourceIterators.length; sourceIndex++) {\n\n      if (this.sourceIterators[sourceIndex].ended) {\n        filled();\n        continue;\n      }\n\n      if (this.values[sourceIndex] !== undefined && this.values[sourceIndex] !== null) {\n        filled();\n\n      } else {\n        this.fillValue(sourceIndex, filled);\n      }\n    }\n\n    return filledValues === this.sourceIterators.length;\n  }\n\n  private fillValue(sourceIndex: number, filled: () => void) {\n    const iterator = this.sourceIterators[sourceIndex];\n    const value = iterator.read();\n\n    if (value || (!iterator.closed && iterator.readable)) {\n      this.values[sourceIndex] = value;\n      filled();\n    } else {\n      const shouldWait = !this.waitingForFill[sourceIndex];\n\n      if (shouldWait) {\n        this.waitingForFill[sourceIndex] = true;\n\n        this.waitForValue(sourceIndex, filled);\n      }\n    }\n  }\n\n  private waitForValue(sourceIndex, filled: () => void) {\n    const iterator = this.sourceIterators[sourceIndex];\n\n    if (iterator.ended) {\n      filled();\n      return;\n    }\n\n    iterator.once(\"readable\", () => {\n      const value = iterator.read();\n\n      if (value === null) {\n        this.waitForValue(sourceIndex, filled);\n\n      } else {\n        this.values[sourceIndex] = value;\n        this.waitingForFill[sourceIndex] = false;\n        filled();\n      }\n    });\n  }\n\n  private getCondensedValues() {\n    const values = [];\n    const indexMap = [];\n\n    this.values\n      .forEach((value: T, originalIndex: number) => {\n        if (value !== undefined && value !== null) {\n          values.push(value);\n          indexMap.push(originalIndex);\n        }\n      }, {});\n\n    return { values, indexMap };\n  }\n\n  private addListeners() {\n    const self = this;\n\n    for (const iterator of this.sourceIterators) {\n      iterator.on(\"end\", () => {\n        const allEnded = this.sourceIterators.every((iter) => iter.ended);\n\n        if (allEnded) {\n          this.close();\n        }\n      });\n    }\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\n\n/**\n * Utility class with functions to operate on AsyncIterator instances\n */\nexport default class Iterators {\n\n  /**\n   * Returns an array representation of an AsyncIterator.\n   * Assumes the iterator will end sometime\n   */\n  public static toArray<T>(iterator: AsyncIterator<T>): Promise<T[]> {\n    const array = [];\n    iterator.each((item: T) => array.push(item));\n\n    return new Promise((resolve) => {\n      iterator.on(\"end\", () => resolve(array));\n    });\n  }\n\n  /**\n   * Returns the first element of an AsyncIterator.\n   */\n  public static getFirst<T>(iterator: AsyncIterator<T>): Promise<T> {\n    return new Promise((resolve) => {\n      iterator.on(\"readable\", () => {\n        resolve(iterator.read());\n      });\n    });\n  }\n\n  /**\n   * Iterates over elements of an AsyncIterator, returning the first element ´predicate´ returns truthy for.\n   */\n  public static find<T>(iterator: AsyncIterator<T>, predicate: (element: T) => boolean): Promise<T> {\n    return new Promise((resolve, reject) => {\n      iterator.on(\"readable\", () => {\n        let element = iterator.read();\n\n        while (element && !predicate(element)) {\n          element = iterator.read();\n        }\n\n        if (element) {\n          resolve(element);\n        }\n      });\n\n      iterator.on(\"end\", () => resolve(null));\n    });\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { PromiseProxyIterator } from \"asynciterator-promiseproxy\";\nimport { EventEmitter } from \"events\";\nimport { inject, injectable, interfaces } from \"inversify\";\nimport Defaults from \"../../Defaults\";\nimport InvalidQueryError from \"../../errors/InvalidQueryError\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport IQuery from \"../../interfaces/IQuery\";\nimport Path from \"../../planner/Path\";\nimport IPublicTransportPlanner from \"../../planner/public-transport/IPublicTransportPlanner\";\nimport IRoadPlanner from \"../../planner/road/IRoadPlanner\";\nimport TYPES from \"../../types\";\nimport FilterUniqueIterator from \"../../util/iterators/FilterUniqueIterator\";\nimport FlatMapIterator from \"../../util/iterators/FlatMapIterator\";\nimport Units from \"../../util/Units\";\nimport ILocationResolver from \"../ILocationResolver\";\nimport IQueryRunner from \"../IQueryRunner\";\nimport IResolvedQuery from \"../IResolvedQuery\";\nimport ExponentialQueryIterator from \"./ExponentialQueryIterator\";\n\n/**\n * To improve the user perceived performance, the query gets split into subqueries\n * with exponentially increasing time frames:\n *\n * ```\n * minimumDepartureTime + 15 minutes, 30 minutes, 60 minutes, 120 minutes...\n * ```\n *\n * In the current implementation, the `maximumArrivalTime` is ignored\n */\n@injectable()\nexport default class QueryRunnerExponential implements IQueryRunner {\n  private readonly locationResolver: ILocationResolver;\n  private readonly publicTransportPlannerFactory: interfaces.Factory<IPublicTransportPlanner>;\n  private readonly eventBus: EventEmitter;\n  private readonly roadPlanner: IRoadPlanner;\n\n  constructor(\n    @inject(TYPES.LocationResolver)\n    locationResolver: ILocationResolver,\n    @inject(TYPES.PublicTransportPlannerFactory)\n    publicTransportPlannerFactory: interfaces.Factory<IPublicTransportPlanner>,\n    @inject(TYPES.RoadPlanner)\n    roadPlanner: IRoadPlanner,\n  ) {\n    this.eventBus = EventBus.getInstance();\n    this.locationResolver = locationResolver;\n    this.publicTransportPlannerFactory = publicTransportPlannerFactory;\n    this.roadPlanner = roadPlanner;\n  }\n\n  public async run(query: IQuery): Promise<AsyncIterator<IPath>> {\n    const baseQuery: IResolvedQuery = await this.resolveBaseQuery(query);\n\n    if (baseQuery.roadNetworkOnly) {\n      return this.roadPlanner.plan(baseQuery);\n    } else {\n      const queryIterator = new ExponentialQueryIterator(baseQuery, 15 * 60 * 1000);\n\n      const subqueryIterator = new FlatMapIterator<IResolvedQuery, IPath>(\n        queryIterator,\n        this.runSubquery.bind(this),\n      );\n\n      return new FilterUniqueIterator<IPath>(subqueryIterator, Path.compareEquals);\n    }\n  }\n\n  private runSubquery(query: IResolvedQuery): AsyncIterator<IPath> {\n    // TODO investigate if publicTransportPlanner can be reused or reuse some of its aggregated data\n    this.eventBus.emit(EventType.SubQuery, query);\n\n    const planner = this.publicTransportPlannerFactory() as IPublicTransportPlanner;\n\n    return new PromiseProxyIterator(() => planner.plan(query));\n  }\n\n  private async resolveEndpoint(endpoint: string | string[] | ILocation | ILocation[]): Promise<ILocation[]> {\n\n    if (Array.isArray(endpoint)) {\n      const promises = (endpoint as Array<string | ILocation>)\n        .map((singleEndpoint: string | ILocation) =>\n          this.locationResolver.resolve(singleEndpoint),\n        );\n\n      return await Promise.all(promises);\n\n    } else {\n      return [await this.locationResolver.resolve(endpoint)];\n    }\n  }\n\n  private async resolveBaseQuery(query: IQuery): Promise<IResolvedQuery> {\n    // tslint:disable:trailing-comma\n    const {\n      minimumWalkingSpeed, maximumWalkingSpeed, walkingSpeed,\n      maximumWalkingDuration, maximumWalkingDistance,\n      minimumTransferDuration, maximumTransferDuration, maximumTransferDistance,\n      maximumTransfers,\n      minimumDepartureTime,\n      ...other\n    } = query;\n    // tslint:enable:trailing-comma\n\n    // make a deep copy of these\n    let { from, to } = other;\n    from = JSON.parse(JSON.stringify(from));\n    to = JSON.parse(JSON.stringify(to));\n\n    const resolvedQuery: IResolvedQuery = Object.assign({}, other as IResolvedQuery);\n\n    resolvedQuery.minimumDepartureTime = minimumDepartureTime || new Date();\n\n    try {\n      resolvedQuery.from = await this.resolveEndpoint(from);\n      resolvedQuery.to = await this.resolveEndpoint(to);\n    } catch (e) {\n      return Promise.reject(new InvalidQueryError(e));\n    }\n\n    resolvedQuery.minimumWalkingSpeed = minimumWalkingSpeed || walkingSpeed || Defaults.defaultMinimumWalkingSpeed;\n    resolvedQuery.maximumWalkingSpeed = maximumWalkingSpeed || walkingSpeed || Defaults.defaultMaximumWalkingSpeed;\n\n    resolvedQuery.maximumWalkingDuration = maximumWalkingDuration ||\n      Units.toDuration(maximumWalkingDistance, resolvedQuery.minimumWalkingSpeed) || Defaults.defaultWalkingDuration;\n\n    resolvedQuery.minimumTransferDuration = minimumTransferDuration || Defaults.defaultMinimumTransferDuration;\n    resolvedQuery.maximumTransferDuration = maximumTransferDuration ||\n      Units.toDuration(maximumTransferDistance, resolvedQuery.minimumWalkingSpeed) ||\n      Defaults.defaultMaximumTransferDuration;\n\n    resolvedQuery.maximumTransfers = maximumTransfers || Defaults.defaultMaximumTransfers;\n\n    return resolvedQuery;\n  }\n}\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./lib/PromiseProxyIterator\"));\n//# sourceMappingURL=index.js.map","import Units from \"./util/Units\";\n\n/**\n * This class holds the default [[IQuery]]/[[IResolvedQuery]] parameters\n */\nexport default class Defaults {\n  public static readonly defaultMinimumWalkingSpeed = 3;\n  public static readonly defaultMaximumWalkingSpeed = 6;\n  public static readonly defaultWalkingDuration = Units.fromMinutes(10);\n  public static readonly defaultMinimumTransferDuration = Units.fromMinutes(1);\n  public static readonly defaultMaximumTransferDuration = Units.fromMinutes(25);\n  public static readonly defaultMaximumTransfers = 4;\n}\n","import EventType from \"../events/EventType\";\n\nexport default class InvalidQueryError extends Error {\n  public eventType = EventType.InvalidQuery;\n}\n","export default class LocationResolverError extends Error {\n\n}\n","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar robustSum = require(\"robust-sum\")\nvar robustScale = require(\"robust-scale\")\nvar robustSubtract = require(\"robust-subtract\")\n\nvar NUM_EXPAND = 5\n\nvar EPSILON     = 1.1102230246251565e-16\nvar ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON\nvar ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length-1)\n  for(var i=1; i<m.length; ++i) {\n    var r = result[i-1] = new Array(m.length-1)\n    for(var j=0,k=0; j<m.length; ++j) {\n      if(j === c) {\n        continue\n      }\n      r[k++] = m[i][j]\n    }\n  }\n  return result\n}\n\nfunction matrix(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = new Array(n)\n    for(var j=0; j<n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", (n-i-1), \"]\"].join(\"\")\n    }\n  }\n  return result\n}\n\nfunction sign(n) {\n  if(n & 1) {\n    return \"-\"\n  }\n  return \"\"\n}\n\nfunction generateSum(expr) {\n  if(expr.length === 1) {\n    return expr[0]\n  } else if(expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\")\n  } else {\n    var m = expr.length>>1\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\")\n  }\n}\n\nfunction determinant(m) {\n  if(m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")]\n  } else {\n    var expr = []\n    for(var i=0; i<m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"))\n    }\n    return expr\n  }\n}\n\nfunction orientation(n) {\n  var pos = []\n  var neg = []\n  var m = matrix(n)\n  var args = []\n  for(var i=0; i<n; ++i) {\n    if((i&1)===0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)))\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)))\n    }\n    args.push(\"m\" + i)\n  }\n  var posExpr = generateSum(pos)\n  var negExpr = generateSum(neg)\n  var funcName = \"orientation\" + n + \"Exact\"\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\")\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code)\n  return proc(robustSum, twoProduct, robustScale, robustSubtract)\n}\n\nvar orientation3Exact = orientation(3)\nvar orientation4Exact = orientation(4)\n\nvar CACHED = [\n  function orientation0() { return 0 },\n  function orientation1() { return 0 },\n  function orientation2(a, b) { \n    return b[0] - a[0]\n  },\n  function orientation3(a, b, c) {\n    var l = (a[1] - c[1]) * (b[0] - c[0])\n    var r = (a[0] - c[0]) * (b[1] - c[1])\n    var det = l - r\n    var s\n    if(l > 0) {\n      if(r <= 0) {\n        return det\n      } else {\n        s = l + r\n      }\n    } else if(l < 0) {\n      if(r >= 0) {\n        return det\n      } else {\n        s = -(l + r)\n      }\n    } else {\n      return det\n    }\n    var tol = ERRBOUND3 * s\n    if(det >= tol || det <= -tol) {\n      return det\n    }\n    return orientation3Exact(a, b, c)\n  },\n  function orientation4(a,b,c,d) {\n    var adx = a[0] - d[0]\n    var bdx = b[0] - d[0]\n    var cdx = c[0] - d[0]\n    var ady = a[1] - d[1]\n    var bdy = b[1] - d[1]\n    var cdy = c[1] - d[1]\n    var adz = a[2] - d[2]\n    var bdz = b[2] - d[2]\n    var cdz = c[2] - d[2]\n    var bdxcdy = bdx * cdy\n    var cdxbdy = cdx * bdy\n    var cdxady = cdx * ady\n    var adxcdy = adx * cdy\n    var adxbdy = adx * bdy\n    var bdxady = bdx * ady\n    var det = adz * (bdxcdy - cdxbdy) \n            + bdz * (cdxady - adxcdy)\n            + cdz * (adxbdy - bdxady)\n    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)\n                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)\n                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)\n    var tol = ERRBOUND4 * permanent\n    if ((det > tol) || (-det > tol)) {\n      return det\n    }\n    return orientation4Exact(a,b,c,d)\n  }\n]\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length]\n  if(!proc) {\n    proc = CACHED[args.length] = orientation(args.length)\n  }\n  return proc.apply(undefined, args)\n}\n\nfunction generateOrientationProc() {\n  while(CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length))\n  }\n  var args = []\n  var procArgs = [\"slow\"]\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    args.push(\"a\" + i)\n    procArgs.push(\"o\" + i)\n  }\n  var code = [\n    \"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"\n  ]\n  for(var i=2; i<=NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\")\n  }\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\")\n  procArgs.push(code.join(\"\"))\n\n  var proc = Function.apply(undefined, procArgs)\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i]\n  }\n}\n\ngenerateOrientationProc()","\"use strict\"\n\nmodule.exports = twoProduct\n\nvar SPLITTER = +(Math.pow(2, 27) + 1.0)\n\nfunction twoProduct(a, b, result) {\n  var x = a * b\n\n  var c = SPLITTER * a\n  var abig = c - a\n  var ahi = c - abig\n  var alo = a - ahi\n\n  var d = SPLITTER * b\n  var bbig = d - b\n  var bhi = d - bbig\n  var blo = b - bhi\n\n  var err1 = x - (ahi * bhi)\n  var err2 = err1 - (alo * bhi)\n  var err3 = err2 - (ahi * blo)\n\n  var y = alo * blo - err3\n\n  if(result) {\n    result[0] = y\n    result[1] = x\n    return result\n  }\n\n  return [ y, x ]\n}","import basicTrainProfile from \"../../configs/basic_train\";\nimport Planner from \"./Planner\";\n\nexport default class BasicTrainPlanner extends Planner {\n    constructor() {\n        super(basicTrainProfile);\n    }\n}\n","import { injectable } from \"inversify\";\nimport ReachableStopsFinderMode from \"../../enums/ReachableStopsFinderMode\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport { DurationMs, SpeedKmH } from \"../../interfaces/units\";\nimport IReachableStopsFinder, { IReachableStop } from \"./IReachableStopsFinder\";\n\n/**\n * This [[IReachableStopsFinder]] just returns the passed source or target stop.\n *\n * This can be a valid strategy to optimize speed if the user doesn't want to travel by foot to another stop\n */\n@injectable()\nexport default class ReachableStopsFinderOnlySelf implements IReachableStopsFinder {\n\n  public async findReachableStops(\n    sourceOrTargetStop: IStop,\n    mode: ReachableStopsFinderMode,\n    maximumDuration: DurationMs,\n    minimumSpeed: SpeedKmH,\n  ): Promise<IReachableStop[]> {\n    return [{ stop: sourceOrTargetStop, duration: 0 }];\n  }\n}\n","import dissectProfile from \"../../configs/dissect\";\nimport Planner from \"./Planner\";\n\nexport default class DissectPlanner extends Planner {\n    constructor() {\n        super(dissectProfile);\n    }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { inject, injectable } from \"inversify\";\nimport Catalog from \"../../Catalog\";\nimport IConnection from \"../../entities/connections/connections\";\nimport { LinkedConnectionsPage } from \"../../entities/connections/page\";\nimport TYPES, { ConnectionsFetcherFactory } from \"../../types\";\nimport MergeIterator from \"../../util/iterators/MergeIterator\";\nimport ConnectionsProviderDefault from \"./ConnectionsProviderDefault\";\nimport IConnectionsIteratorOptions from \"./IConnectionsIteratorOptions\";\nimport IConnectionsProvider from \"./IConnectionsProvider\";\n\n@injectable()\nexport default class ConnectionsProviderMerge implements IConnectionsProvider {\n\n  private static forwardsConnectionSelector(connections: IConnection[]): number {\n    if (connections.length === 1) {\n      return 0;\n    }\n\n    let earliestIndex = 0;\n    const earliest = connections[earliestIndex];\n\n    for (let i = 1; i < connections.length; i++) {\n      const connection = connections[i];\n\n      if (connection.departureTime < earliest.departureTime) {\n        earliestIndex = i;\n      }\n    }\n\n    return earliestIndex;\n  }\n\n  private static backwardsConnectionsSelector(connections: IConnection[]): number {\n    if (connections.length === 1) {\n      return 0;\n    }\n\n    let latestIndex = 0;\n    const latest = connections[latestIndex];\n\n    for (let i = 1; i < connections.length; i++) {\n      const connection = connections[i];\n\n      if (connection.departureTime > latest.departureTime) {\n        latestIndex = i;\n      }\n    }\n\n    return latestIndex;\n  }\n\n  private defaultProviders: IConnectionsProvider[];\n\n  constructor(\n    @inject(TYPES.ConnectionsFetcherFactory) connectionsFetcherFactory: ConnectionsFetcherFactory,\n    @inject(TYPES.Catalog) catalog: Catalog,\n  ) {\n    this.defaultProviders = [];\n\n    for (const { accessUrl, travelMode } of catalog.connectionsSourceConfigs) {\n      const subCatalog = new Catalog();\n      subCatalog.addConnectionsSource(accessUrl, travelMode);\n      this.defaultProviders.push(new ConnectionsProviderDefault(connectionsFetcherFactory, subCatalog));\n    }\n  }\n\n  public prefetchConnections(): void {\n    return;\n  }\n\n  public createIterator(options: IConnectionsIteratorOptions): AsyncIterator<IConnection> {\n    const iterators = this.defaultProviders\n      .map((provider) => provider.createIterator(options));\n\n    const selector = options.backward ?\n      ConnectionsProviderMerge.backwardsConnectionsSelector\n      :\n      ConnectionsProviderMerge.forwardsConnectionSelector;\n\n    return new MergeIterator(iterators, selector, true);\n  }\n\n  public getByUrl(url: string): Promise<LinkedConnectionsPage> {\n    // TODO, if needed this can delegate the call to one of the sub providers\n    throw new Error(\"Not implemented yet\");\n  }\n\n  public getByTime(date: Date): Promise<LinkedConnectionsPage> {\n    throw new Error(\"Method not implemented because the semantics would be ambiguous.\");\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport { Footpath, IFootpathIndex } from \"../../entities/footpaths/footpath\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport { lat_to_tile, long_to_tile } from \"../../util/Tiles\";\nimport IStop from \"../stops/IStop\";\nimport IFootpathsProvider from \"./IFootpathsProvider\";\n\nconst ZOOM = 12;\n\ninterface ITiledFootpathIndex {\n    [id: string]: Promise<IFootpathIndex>;\n}\n\n@injectable()\nexport default class FootpathsProviderRaw implements IFootpathsProvider {\n    protected paths: ITiledFootpathIndex;\n\n    constructor() {\n        this.paths = {};\n    }\n\n    public async get(stop: IStop): Promise<IFootpathIndex> {\n        const tileId = this.getIdForLocation(ZOOM, stop);\n        if (!this.paths[tileId]) {\n            this.paths[tileId] = this.getByUrl(tileId);\n        }\n\n        return this.paths[tileId];\n    }\n\n    public getIdForLocation(zoom: number, location: ILocation): string {\n        const y = lat_to_tile(location.latitude, zoom);\n        const x = long_to_tile(location.longitude, zoom);\n        const coordinate = new RoutableTileCoordinate(zoom, x, y);\n        return this.getIdForTileCoords(coordinate);\n    }\n\n    public getIdForTileCoords(coordinate: RoutableTileCoordinate): string {\n        return `https://hdelva.be/stops/distances/${coordinate.zoom}/${coordinate.x}/${coordinate.y}`;\n    }\n\n    public getByLocation(zoom: number, location: ILocation): Promise<IFootpathIndex> {\n        const y = lat_to_tile(location.latitude, zoom);\n        const x = long_to_tile(location.longitude, zoom);\n        const coordinate = new RoutableTileCoordinate(zoom, x, y);\n        return this.getByTileCoords(coordinate);\n    }\n\n    public async getByTileCoords(coordinate: RoutableTileCoordinate): Promise<IFootpathIndex> {\n        const url = this.getIdForTileCoords(coordinate);\n        return await this.getByUrl(url);\n    }\n\n    protected async getByUrl(url: string): Promise<IFootpathIndex> {\n        const response = await fetch(url);\n        const responseText = await response.text();\n\n        const footpaths: IFootpathIndex = {};\n\n        if (response.status !== 200) {\n            EventBus.getInstance().emit(EventType.Warning, `${url} responded with status code ${response.status}`);\n        }\n\n        if (response.status === 200 && responseText) {\n            const blob = JSON.parse(responseText);\n\n            for (const entity of blob[\"@graph\"]) {\n                const id = entity[\"@id\"];\n                const footpath = new Footpath(id);\n                footpath.to = entity[\"planner:destination\"];\n                footpath.from = entity[\"planner:source\"];\n                footpath.distance = entity[\"planner:distance\"];\n                footpaths[id] = footpath;\n            }\n        }\n\n        return footpaths;\n    }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport transitCarProfile from \"../../configs/transit_car\";\nimport IPath from \"../../interfaces/IPath\";\nimport IQuery from \"../../interfaces/IQuery\";\nimport Planner from \"./Planner\";\n\nexport default class TransitCarPlanner extends Planner {\n    constructor() {\n        super(transitCarProfile);\n        this.setProfileID(\"http://hdelva.be/profile/car\");\n    }\n\n    public query(query: IQuery): AsyncIterator<IPath> {\n        query.roadNetworkOnly = true;\n        return super.query(query);\n    }\n}\n","import triangleDemoProfile from \"../../configs/triangle_demo\";\nimport Planner from \"./Planner\";\n\nexport default class TriangleDemoPlanner extends Planner {\n    constructor() {\n        super(triangleDemoProfile);\n    }\n}\n","\nconst EPSILON = Math.pow(2, -52);\n\nexport default class Delaunator {\n\n    static from(points, getX, getY) {\n        if (!getX) getX = defaultGetX;\n        if (!getY) getY = defaultGetY;\n\n        const n = points.length;\n        const coords = new Float64Array(n * 2);\n\n        for (let i = 0; i < n; i++) {\n            const p = points[i];\n            coords[2 * i] = getX(p);\n            coords[2 * i + 1] = getY(p);\n        }\n\n        return new Delaunator(coords);\n    }\n\n    constructor(coords) {\n        let minX = Infinity;\n        let minY = Infinity;\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n\n        const n = coords.length >> 1;\n        const ids = this.ids = new Uint32Array(n);\n\n        if (n > 0 && typeof coords[0] !== 'number') throw new Error('Expected coords to contain numbers.');\n\n        this.coords = coords;\n\n        for (let i = 0; i < n; i++) {\n            const x = coords[2 * i];\n            const y = coords[2 * i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n            ids[i] = i;\n        }\n\n        const cx = (minX + maxX) / 2;\n        const cy = (minY + maxY) / 2;\n\n        let minDist = Infinity;\n        let i0, i1, i2;\n\n        // pick a seed point close to the centroid\n        for (let i = 0; i < n; i++) {\n            const d = dist(cx, cy, coords[2 * i], coords[2 * i + 1]);\n            if (d < minDist) {\n                i0 = i;\n                minDist = d;\n            }\n        }\n        const i0x = coords[2 * i0];\n        const i0y = coords[2 * i0 + 1];\n\n        minDist = Infinity;\n\n        // find the point closest to the seed\n        for (let i = 0; i < n; i++) {\n            if (i === i0) continue;\n            const d = dist(i0x, i0y, coords[2 * i], coords[2 * i + 1]);\n            if (d < minDist && d > 0) {\n                i1 = i;\n                minDist = d;\n            }\n        }\n        let i1x = coords[2 * i1];\n        let i1y = coords[2 * i1 + 1];\n\n        let minRadius = Infinity;\n\n        // find the third point which forms the smallest circumcircle with the first two\n        for (let i = 0; i < n; i++) {\n            if (i === i0 || i === i1) continue;\n            const r = circumradius(i0x, i0y, i1x, i1y, coords[2 * i], coords[2 * i + 1]);\n            if (r < minRadius) {\n                i2 = i;\n                minRadius = r;\n            }\n        }\n        let i2x = coords[2 * i2];\n        let i2y = coords[2 * i2 + 1];\n\n        if (minRadius === Infinity) {\n            throw new Error('No Delaunay triangulation exists for this input.');\n        }\n\n        // swap the order of the seed points for counter-clockwise orientation\n        if (orient(i0x, i0y, i1x, i1y, i2x, i2y)) {\n            const i = i1;\n            const x = i1x;\n            const y = i1y;\n            i1 = i2;\n            i1x = i2x;\n            i1y = i2y;\n            i2 = i;\n            i2x = x;\n            i2y = y;\n        }\n\n        const center = circumcenter(i0x, i0y, i1x, i1y, i2x, i2y);\n        this._cx = center.x;\n        this._cy = center.y;\n\n        // sort the points by distance from the seed triangle circumcenter\n        quicksort(ids, coords, 0, ids.length - 1, center.x, center.y);\n\n        // initialize a hash table for storing edges of the advancing convex hull\n        this._hashSize = Math.ceil(Math.sqrt(n));\n        this._hash = new Array(this._hashSize);\n\n        // initialize a circular doubly-linked list that will hold an advancing convex hull\n        let e = this.hull = insertNode(coords, i0);\n        this._hashEdge(e);\n        e.t = 0;\n        e = insertNode(coords, i1, e);\n        this._hashEdge(e);\n        e.t = 1;\n        e = insertNode(coords, i2, e);\n        this._hashEdge(e);\n        e.t = 2;\n\n        const maxTriangles = 2 * n - 5;\n        const triangles = this.triangles = new Uint32Array(maxTriangles * 3);\n        const halfedges = this.halfedges = new Int32Array(maxTriangles * 3);\n\n        this.trianglesLen = 0;\n\n        this._addTriangle(i0, i1, i2, -1, -1, -1);\n\n        for (let k = 0, xp, yp; k < ids.length; k++) {\n            const i = ids[k];\n            const x = coords[2 * i];\n            const y = coords[2 * i + 1];\n\n            // skip near-duplicate points\n            if (k > 0 && Math.abs(x - xp) <= EPSILON && Math.abs(y - yp) <= EPSILON) continue;\n            xp = x;\n            yp = y;\n\n            // skip seed triangle points\n            if (i === i0 || i === i1 || i === i2) continue;\n\n            // find a visible edge on the convex hull using edge hash\n            const startKey = this._hashKey(x, y);\n            let key = startKey;\n            let start;\n            do {\n                start = this._hash[key];\n                key = (key + 1) % this._hashSize;\n            } while ((!start || start.removed) && key !== startKey);\n\n            start = start.prev;\n            e = start;\n            while (!orient(x, y, e.x, e.y, e.next.x, e.next.y)) {\n                e = e.next;\n                if (e === start) {\n                    e = null;\n                    break;\n                }\n            }\n            // likely a near-duplicate point; skip it\n            if (!e) continue;\n\n            const walkBack = e === start;\n\n            // add the first triangle from the point\n            let t = this._addTriangle(e.i, i, e.next.i, -1, -1, e.t);\n\n            e.t = t; // keep track of boundary triangles on the hull\n            e = insertNode(coords, i, e);\n\n            // recursively flip triangles from the point until they satisfy the Delaunay condition\n            e.t = this._legalize(t + 2);\n\n            // walk forward through the hull, adding more triangles and flipping recursively\n            let q = e.next;\n            while (orient(x, y, q.x, q.y, q.next.x, q.next.y)) {\n                t = this._addTriangle(q.i, i, q.next.i, q.prev.t, -1, q.t);\n                q.prev.t = this._legalize(t + 2);\n                this.hull = removeNode(q);\n                q = q.next;\n            }\n\n            if (walkBack) {\n                // walk backward from the other side, adding more triangles and flipping\n                q = e.prev;\n                while (orient(x, y, q.prev.x, q.prev.y, q.x, q.y)) {\n                    t = this._addTriangle(q.prev.i, i, q.i, -1, q.t, q.prev.t);\n                    this._legalize(t + 2);\n                    q.prev.t = t;\n                    this.hull = removeNode(q);\n                    q = q.prev;\n                }\n            }\n\n            // save the two new edges in the hash table\n            this._hashEdge(e);\n            this._hashEdge(e.prev);\n        }\n\n        // trim typed triangle mesh arrays\n        this.triangles = triangles.subarray(0, this.trianglesLen);\n        this.halfedges = halfedges.subarray(0, this.trianglesLen);\n    }\n\n    _hashEdge(e) {\n        this._hash[this._hashKey(e.x, e.y)] = e;\n    }\n\n    _hashKey(x, y) {\n        return Math.floor(pseudoAngle(x - this._cx, y - this._cy) * this._hashSize) % this._hashSize;\n    }\n\n    _legalize(a) {\n        const {triangles, coords, halfedges} = this;\n\n        const b = halfedges[a];\n\n        /* if the pair of triangles doesn't satisfy the Delaunay condition\n         * (p1 is inside the circumcircle of [p0, pl, pr]), flip them,\n         * then do the same check/flip recursively for the new pair of triangles\n         *\n         *           pl                    pl\n         *          /||\\                  /  \\\n         *       al/ || \\bl            al/    \\a\n         *        /  ||  \\              /      \\\n         *       /  a||b  \\    flip    /___ar___\\\n         *     p0\\   ||   /p1   =>   p0\\---bl---/p1\n         *        \\  ||  /              \\      /\n         *       ar\\ || /br             b\\    /br\n         *          \\||/                  \\  /\n         *           pr                    pr\n         */\n        const a0 = a - a % 3;\n        const b0 = b - b % 3;\n\n        const al = a0 + (a + 1) % 3;\n        const ar = a0 + (a + 2) % 3;\n        const bl = b0 + (b + 2) % 3;\n\n        if (b === -1) return ar;\n\n        const p0 = triangles[ar];\n        const pr = triangles[a];\n        const pl = triangles[al];\n        const p1 = triangles[bl];\n\n        const illegal = inCircle(\n            coords[2 * p0], coords[2 * p0 + 1],\n            coords[2 * pr], coords[2 * pr + 1],\n            coords[2 * pl], coords[2 * pl + 1],\n            coords[2 * p1], coords[2 * p1 + 1]);\n\n        if (illegal) {\n            triangles[a] = p1;\n            triangles[b] = p0;\n\n            const hbl = halfedges[bl];\n\n            // edge swapped on the other side of the hull (rare); fix the halfedge reference\n            if (hbl === -1) {\n                let e = this.hull;\n                do {\n                    if (e.t === bl) {\n                        e.t = a;\n                        break;\n                    }\n                    e = e.next;\n                } while (e !== this.hull);\n            }\n            this._link(a, hbl);\n            this._link(b, halfedges[ar]);\n            this._link(ar, bl);\n\n            const br = b0 + (b + 1) % 3;\n\n            this._legalize(a);\n            return this._legalize(br);\n        }\n\n        return ar;\n    }\n\n    _link(a, b) {\n        this.halfedges[a] = b;\n        if (b !== -1) this.halfedges[b] = a;\n    }\n\n    // add a new triangle given vertex indices and adjacent half-edge ids\n    _addTriangle(i0, i1, i2, a, b, c) {\n        const t = this.trianglesLen;\n\n        this.triangles[t] = i0;\n        this.triangles[t + 1] = i1;\n        this.triangles[t + 2] = i2;\n\n        this._link(t, a);\n        this._link(t + 1, b);\n        this._link(t + 2, c);\n\n        this.trianglesLen += 3;\n\n        return t;\n    }\n}\n\n// monotonically increases with real angle, but doesn't need expensive trigonometry\nfunction pseudoAngle(dx, dy) {\n    const p = dx / (Math.abs(dx) + Math.abs(dy));\n    return (dy > 0 ? 3 - p : 1 + p) / 4; // [0..1]\n}\n\nfunction dist(ax, ay, bx, by) {\n    const dx = ax - bx;\n    const dy = ay - by;\n    return dx * dx + dy * dy;\n}\n\nfunction orient(px, py, qx, qy, rx, ry) {\n    return (qy - py) * (rx - qx) - (qx - px) * (ry - qy) < 0;\n}\n\nfunction inCircle(ax, ay, bx, by, cx, cy, px, py) {\n    const dx = ax - px;\n    const dy = ay - py;\n    const ex = bx - px;\n    const ey = by - py;\n    const fx = cx - px;\n    const fy = cy - py;\n\n    const ap = dx * dx + dy * dy;\n    const bp = ex * ex + ey * ey;\n    const cp = fx * fx + fy * fy;\n\n    return dx * (ey * cp - bp * fy) -\n           dy * (ex * cp - bp * fx) +\n           ap * (ex * fy - ey * fx) < 0;\n}\n\nfunction circumradius(ax, ay, bx, by, cx, cy) {\n    const dx = bx - ax;\n    const dy = by - ay;\n    const ex = cx - ax;\n    const ey = cy - ay;\n\n    const bl = dx * dx + dy * dy;\n    const cl = ex * ex + ey * ey;\n    const d = dx * ey - dy * ex;\n\n    const x = (ey * bl - dy * cl) * 0.5 / d;\n    const y = (dx * cl - ex * bl) * 0.5 / d;\n\n    return bl && cl && d && (x * x + y * y) || Infinity;\n}\n\nfunction circumcenter(ax, ay, bx, by, cx, cy) {\n    const dx = bx - ax;\n    const dy = by - ay;\n    const ex = cx - ax;\n    const ey = cy - ay;\n\n    const bl = dx * dx + dy * dy;\n    const cl = ex * ex + ey * ey;\n    const d = dx * ey - dy * ex;\n\n    const x = ax + (ey * bl - dy * cl) * 0.5 / d;\n    const y = ay + (dx * cl - ex * bl) * 0.5 / d;\n\n    return {x, y};\n}\n\n// create a new node in a doubly linked list\nfunction insertNode(coords, i, prev) {\n    const node = {\n        i,\n        x: coords[2 * i],\n        y: coords[2 * i + 1],\n        t: 0,\n        prev: null,\n        next: null,\n        removed: false\n    };\n\n    if (!prev) {\n        node.prev = node;\n        node.next = node;\n\n    } else {\n        node.next = prev.next;\n        node.prev = prev;\n        prev.next.prev = node;\n        prev.next = node;\n    }\n    return node;\n}\n\nfunction removeNode(node) {\n    node.prev.next = node.next;\n    node.next.prev = node.prev;\n    node.removed = true;\n    return node.prev;\n}\n\nfunction quicksort(ids, coords, left, right, cx, cy) {\n    let i, j, temp;\n\n    if (right - left <= 20) {\n        for (i = left + 1; i <= right; i++) {\n            temp = ids[i];\n            j = i - 1;\n            while (j >= left && compare(coords, ids[j], temp, cx, cy) > 0) ids[j + 1] = ids[j--];\n            ids[j + 1] = temp;\n        }\n    } else {\n        const median = (left + right) >> 1;\n        i = left + 1;\n        j = right;\n        swap(ids, median, i);\n        if (compare(coords, ids[left], ids[right], cx, cy) > 0) swap(ids, left, right);\n        if (compare(coords, ids[i], ids[right], cx, cy) > 0) swap(ids, i, right);\n        if (compare(coords, ids[left], ids[i], cx, cy) > 0) swap(ids, left, i);\n\n        temp = ids[i];\n        while (true) {\n            do i++; while (compare(coords, ids[i], temp, cx, cy) < 0);\n            do j--; while (compare(coords, ids[j], temp, cx, cy) > 0);\n            if (j < i) break;\n            swap(ids, i, j);\n        }\n        ids[left + 1] = ids[j];\n        ids[j] = temp;\n\n        if (right - i + 1 >= j - left) {\n            quicksort(ids, coords, i, right, cx, cy);\n            quicksort(ids, coords, left, j - 1, cx, cy);\n        } else {\n            quicksort(ids, coords, left, j - 1, cx, cy);\n            quicksort(ids, coords, i, right, cx, cy);\n        }\n    }\n}\n\nfunction compare(coords, i, j, cx, cy) {\n    const d1 = dist(coords[2 * i], coords[2 * i + 1], cx, cy);\n    const d2 = dist(coords[2 * j], coords[2 * j + 1], cx, cy);\n    return (d1 - d2) || (coords[2 * i] - coords[2 * j]) || (coords[2 * i + 1] - coords[2 * j + 1]);\n}\n\nfunction swap(arr, i, j) {\n    const tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultGetX(p) {\n    return p[0];\n}\nfunction defaultGetY(p) {\n    return p[1];\n}\n","const epsilon = 1e-6;\n\nexport default class Path {\n  constructor() {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n  }\n  moveTo(x, y) {\n    this._ += `M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  }\n  lineTo(x, y) {\n    this._ += `L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arc(x, y, r) {\n    x = +x, y = +y, r = +r;\n    const x0 = x + r;\n    const y0 = y;\n    if (r < 0) throw new Error(\"negative radius\");\n    if (this._x1 === null) this._ += `M${x0},${y0}`;\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) this._ += \"L\" + x0 + \",\" + y0;\n    if (!r) return;\n    this._ += `A${r},${r},0,1,1,${x - r},${y}A${r},${r},0,1,1,${this._x1 = x0},${this._y1 = y0}`;\n  }\n  rect(x, y, w, h) {\n    this._ += `M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${+w}v${+h}h${-w}Z`;\n  }\n  value() {\n    return this._ || null;\n  }\n}\n","export default class Polygon {\n  constructor() {\n    this._ = [];\n  }\n  moveTo(x, y) {\n    this._.push([x, y]);\n  }\n  closePath() {\n    this._.push(this._[0].slice());\n  }\n  lineTo(x, y) {\n    this._.push([x, y]);\n  }\n  value() {\n    return this._.length ? this._ : null;\n  }\n}\n","import Path from \"./path.js\";\nimport Polygon from \"./polygon.js\";\n\nexport default class Voronoi {\n  constructor(delaunay, [xmin, ymin, xmax, ymax] = [0, 0, 960, 500]) {\n    if (!((xmax = +xmax) >= (xmin = +xmin)) || !((ymax = +ymax) >= (ymin = +ymin))) throw new Error(\"invalid bounds\");\n    const {points, hull, triangles} = this.delaunay = delaunay;\n    const circumcenters = this.circumcenters = new Float64Array(triangles.length / 3 * 2);\n    const vectors = this.vectors = new Float64Array(points.length * 2);\n    this.xmax = xmax, this.xmin = xmin;\n    this.ymax = ymax, this.ymin = ymin;\n\n    // Compute circumcenters.\n    for (let i = 0, j = 0, n = triangles.length; i < n; i += 3, j += 2) {\n      const t1 = triangles[i] * 2;\n      const t2 = triangles[i + 1] * 2;\n      const t3 = triangles[i + 2] * 2;\n      const x1 = points[t1];\n      const y1 = points[t1 + 1];\n      const x2 = points[t2];\n      const y2 = points[t2 + 1];\n      const x3 = points[t3];\n      const y3 = points[t3 + 1];\n      const a2 = x1 - x2;\n      const a3 = x1 - x3;\n      const b2 = y1 - y2;\n      const b3 = y1 - y3;\n      const d1 = x1 * x1 + y1 * y1;\n      const d2 = d1 - x2 * x2 - y2 * y2;\n      const d3 = d1 - x3 * x3 - y3 * y3;\n      const ab = (a3 * b2 - a2 * b3) * 2;\n      circumcenters[j] = (b2 * d3 - b3 * d2) / ab;\n      circumcenters[j + 1] = (a3 * d2 - a2 * d3) / ab;\n    }\n\n    // Compute exterior cell rays.\n    let node = hull;\n    let p0, p1 = node.i * 4;\n    let x0, x1 = node.x;\n    let y0, y1 = node.y;\n    do {\n      node = node.next, p0 = p1, x0 = x1, y0 = y1, p1 = node.i * 4, x1 = node.x, y1 = node.y;\n      vectors[p0 + 2] = vectors[p1] = y0 - y1;\n      vectors[p0 + 3] = vectors[p1 + 1] = x1 - x0;\n    } while (node !== hull);\n  }\n  render(context) {\n    const buffer = context == null ? context = new Path : undefined;\n    const {delaunay: {halfedges, hull}, circumcenters, vectors} = this;\n    for (let i = 0, n = halfedges.length; i < n; ++i) {\n      const j = halfedges[i];\n      if (j < i) continue;\n      const ti = Math.floor(i / 3) * 2;\n      const tj = Math.floor(j / 3) * 2;\n      const xi = circumcenters[ti];\n      const yi = circumcenters[ti + 1];\n      const xj = circumcenters[tj];\n      const yj = circumcenters[tj + 1];\n      this._renderSegment(xi, yi, xj, yj, context);\n    }\n    let node = hull;\n    do {\n      node = node.next;\n      const t = Math.floor(node.t / 3) * 2;\n      const x = circumcenters[t];\n      const y = circumcenters[t + 1];\n      const v = node.i * 4;\n      const p = this._project(x, y, vectors[v + 2], vectors[v + 3]);\n      if (p) this._renderSegment(x, y, p[0], p[1], context);\n    } while (node !== hull);\n    return buffer && buffer.value();\n  }\n  renderBounds(context) {\n    const buffer = context == null ? context = new Path : undefined;\n    context.rect(this.xmin, this.ymin, this.xmax - this.xmin, this.ymax - this.ymin);\n    return buffer && buffer.value();\n  }\n  renderCell(i, context) {\n    const buffer = context == null ? context = new Path : undefined;\n    const points = this._clip(i);\n    if (points === null) return;\n    context.moveTo(points[0], points[1]);\n    for (let i = 2, n = points.length; i < n; i += 2) {\n      context.lineTo(points[i], points[i + 1]);\n    }\n    context.closePath();\n    return buffer && buffer.value();\n  }\n  *cellPolygons() {\n    const {delaunay: {points}} = this;\n    for (let i = 0, n = points.length / 2; i < n; ++i) {\n      const cell = this.cellPolygon(i);\n      if (cell) yield cell;\n    }\n  }\n  cellPolygon(i) {\n    const polygon = new Polygon;\n    this.renderCell(i, polygon);\n    return polygon.value();\n  }\n  _renderSegment(x0, y0, x1, y1, context) {\n    let S;\n    const c0 = this._regioncode(x0, y0);\n    const c1 = this._regioncode(x1, y1);\n    if (c0 === 0 && c1 === 0) {\n      context.moveTo(x0, y0);\n      context.lineTo(x1, y1);\n    } else if (S = this._clipSegment(x0, y0, x1, y1, c0, c1)) {\n      context.moveTo(S[0], S[1]);\n      context.lineTo(S[2], S[3]);\n    }\n  }\n  contains(i, x, y) {\n    if ((x = +x, x !== x) || (y = +y, y !== y)) return false;\n    return this.delaunay._step(i, x, y) === i;\n  }\n  _cell(i) {\n    const {circumcenters, delaunay: {inedges, halfedges, triangles}} = this;\n    const e0 = inedges[i];\n    if (e0 === -1) return null; // coincident point\n    const points = [];\n    let e = e0;\n    do {\n      const t = Math.floor(e / 3);\n      points.push(circumcenters[t * 2], circumcenters[t * 2 + 1]);\n      e = e % 3 === 2 ? e - 2 : e + 1;\n      if (triangles[e] !== i) break; // bad triangulation\n      e = halfedges[e];\n    } while (e !== e0 && e !== -1);\n    return points;\n  }\n  _clip(i) {\n    const points = this._cell(i);\n    if (points === null) return null;\n    const {vectors: V} = this;\n    const v = i * 4;\n    return V[v] || V[v + 1]\n        ? this._clipInfinite(i, points, V[v], V[v + 1], V[v + 2], V[v + 3])\n        : this._clipFinite(i, points);\n  }\n  _clipFinite(i, points) {\n    const n = points.length;\n    let P = null;\n    let x0, y0, x1 = points[n - 2], y1 = points[n - 1];\n    let c0, c1 = this._regioncode(x1, y1);\n    let e0, e1;\n    for (let j = 0; j < n; j += 2) {\n      x0 = x1, y0 = y1, x1 = points[j], y1 = points[j + 1];\n      c0 = c1, c1 = this._regioncode(x1, y1);\n      if (c0 === 0 && c1 === 0) {\n        e0 = e1, e1 = 0;\n        if (P) P.push(x1, y1);\n        else P = [x1, y1];\n      } else {\n        let S, sx0, sy0, sx1, sy1;\n        if (c0 === 0) {\n          if ((S = this._clipSegment(x0, y0, x1, y1, c0, c1)) === null) continue;\n          [sx0, sy0, sx1, sy1] = S;\n        } else {\n          if ((S = this._clipSegment(x1, y1, x0, y0, c1, c0)) === null) continue;\n          [sx1, sy1, sx0, sy0] = S;\n          e0 = e1, e1 = this._edgecode(sx0, sy0);\n          if (e0 && e1) this._edge(i, e0, e1, P, P.length);\n          if (P) P.push(sx0, sy0);\n          else P = [sx0, sy0];\n        }\n        e0 = e1, e1 = this._edgecode(sx1, sy1);\n        if (e0 && e1) this._edge(i, e0, e1, P, P.length);\n        if (P) P.push(sx1, sy1);\n        else P = [sx1, sy1];\n      }\n    }\n    if (P) {\n      e0 = e1, e1 = this._edgecode(P[0], P[1]);\n      if (e0 && e1) this._edge(i, e0, e1, P, P.length);\n    } else if (this.contains(i, (this.xmin + this.xmax) / 2, (this.ymin + this.ymax) / 2)) {\n      return [this.xmax, this.ymin, this.xmax, this.ymax, this.xmin, this.ymax, this.xmin, this.ymin];\n    }\n    return P;\n  }\n  _clipSegment(x0, y0, x1, y1, c0, c1) {\n    while (true) {\n      if (c0 === 0 && c1 === 0) return [x0, y0, x1, y1];\n      if (c0 & c1) return null;\n      let x, y, c = c0 || c1;\n      if (c & 0b1000) x = x0 + (x1 - x0) * (this.ymax - y0) / (y1 - y0), y = this.ymax;\n      else if (c & 0b0100) x = x0 + (x1 - x0) * (this.ymin - y0) / (y1 - y0), y = this.ymin;\n      else if (c & 0b0010) y = y0 + (y1 - y0) * (this.xmax - x0) / (x1 - x0), x = this.xmax;\n      else y = y0 + (y1 - y0) * (this.xmin - x0) / (x1 - x0), x = this.xmin;\n      if (c0) x0 = x, y0 = y, c0 = this._regioncode(x0, y0);\n      else x1 = x, y1 = y, c1 = this._regioncode(x1, y1);\n    }\n  }\n  _clipInfinite(i, points, vx0, vy0, vxn, vyn) {\n    let P = Array.from(points), p;\n    if (p = this._project(P[0], P[1], vx0, vy0)) P.unshift(p[0], p[1]);\n    if (p = this._project(P[P.length - 2], P[P.length - 1], vxn, vyn)) P.push(p[0], p[1]);\n    if (P = this._clipFinite(i, P)) {\n      for (let j = 0, n = P.length, c0, c1 = this._edgecode(P[n - 2], P[n - 1]); j < n; j += 2) {\n        c0 = c1, c1 = this._edgecode(P[j], P[j + 1]);\n        if (c0 && c1) j = this._edge(i, c0, c1, P, j), n = P.length;\n      }\n    } else if (this.contains(i, (this.xmin + this.xmax) / 2, (this.ymin + this.ymax) / 2)) {\n      P = [this.xmin, this.ymin, this.xmax, this.ymin, this.xmax, this.ymax, this.xmin, this.ymax];\n    }\n    return P;\n  }\n  _edge(i, e0, e1, P, j) {\n    while (e0 !== e1) {\n      let x, y;\n      switch (e0) {\n        case 0b0101: e0 = 0b0100; continue; // top-left\n        case 0b0100: e0 = 0b0110, x = this.xmax, y = this.ymin; break; // top\n        case 0b0110: e0 = 0b0010; continue; // top-right\n        case 0b0010: e0 = 0b1010, x = this.xmax, y = this.ymax; break; // right\n        case 0b1010: e0 = 0b1000; continue; // bottom-right\n        case 0b1000: e0 = 0b1001, x = this.xmin, y = this.ymax; break; // bottom\n        case 0b1001: e0 = 0b0001; continue; // bottom-left\n        case 0b0001: e0 = 0b0101, x = this.xmin, y = this.ymin; break; // left\n      }\n      if ((P[j] !== x || P[j + 1] !== y) && this.contains(i, x, y)) {\n        P.splice(j, 0, x, y), j += 2;\n      }\n    }\n    return j;\n  }\n  _project(x0, y0, vx, vy) {\n    let t = Infinity, c, x, y;\n    if (vy < 0) { // top\n      if (y0 <= this.ymin) return null;\n      if ((c = (this.ymin - y0) / vy) < t) y = this.ymin, x = x0 + (t = c) * vx;\n    } else if (vy > 0) { // bottom\n      if (y0 >= this.ymax) return null;\n      if ((c = (this.ymax - y0) / vy) < t) y = this.ymax, x = x0 + (t = c) * vx;\n    }\n    if (vx > 0) { // right\n      if (x0 >= this.xmax) return null;\n      if ((c = (this.xmax - x0) / vx) < t) x = this.xmax, y = y0 + (t = c) * vy;\n    } else if (vx < 0) { // left\n      if (x0 <= this.xmin) return null;\n      if ((c = (this.xmin - x0) / vx) < t) x = this.xmin, y = y0 + (t = c) * vy;\n    }\n    return [x, y];\n  }\n  _edgecode(x, y) {\n    return (x === this.xmin ? 0b0001\n        : x === this.xmax ? 0b0010 : 0b0000)\n        | (y === this.ymin ? 0b0100\n        : y === this.ymax ? 0b1000 : 0b0000);\n  }\n  _regioncode(x, y) {\n    return (x < this.xmin ? 0b0001\n        : x > this.xmax ? 0b0010 : 0b0000)\n        | (y < this.ymin ? 0b0100\n        : y > this.ymax ? 0b1000 : 0b0000);\n  }\n}\n","import Delaunator from \"delaunator\";\nimport Path from \"./path.js\";\nimport Polygon from \"./polygon.js\";\nimport Voronoi from \"./voronoi.js\";\n\nconst tau = 2 * Math.PI;\n\nfunction pointX(p) {\n  return p[0];\n}\n\nfunction pointY(p) {\n  return p[1];\n}\n\nexport default class Delaunay {\n  constructor(points) {\n    const {halfedges, hull, triangles} = new Delaunator(points);\n    this.points = points;\n    this.halfedges = halfedges;\n    this.hull = hull;\n    this.triangles = triangles;\n    const inedges = this.inedges = new Int32Array(points.length / 2).fill(-1);\n    const outedges = this.outedges = new Int32Array(points.length / 2).fill(-1);\n\n    // Compute an index from each point to an (arbitrary) incoming halfedge.\n    for (let e = 0, n = halfedges.length; e < n; ++e) {\n      inedges[triangles[e % 3 === 2 ? e - 2 : e + 1]] = e;\n    }\n\n    // For points on the hull, index both the incoming and outgoing halfedges.\n    let node0, node1 = hull;\n    do {\n      node0 = node1, node1 = node1.next;\n      inedges[node1.i] = node0.t;\n      outedges[node0.i] = node1.t;\n    } while (node1 !== hull);\n  }\n  voronoi(bounds) {\n    return new Voronoi(this, bounds);\n  }\n  *neighbors(i) {\n    const {inedges, outedges, halfedges, triangles} = this;\n    const e0 = inedges[i];\n    if (e0 === -1) return; // coincident point\n    let e = e0;\n    do {\n      yield triangles[e];\n      e = e % 3 === 2 ? e - 2 : e + 1;\n      if (triangles[e] !== i) return; // bad triangulation\n      e = halfedges[e];\n      if (e === -1) return yield triangles[outedges[i]];\n    } while (e !== e0);\n  }\n  find(x, y, i = 0) {\n    if ((x = +x, x !== x) || (y = +y, y !== y)) return -1;\n    let c;\n    while ((c = this._step(i, x, y)) >= 0 && c !== i) i = c;\n    return c;\n  }\n  _step(i, x, y) {\n    const {inedges, points} = this;\n    if (inedges[i] === -1) return -1; // coincident point\n    let c = i;\n    let dc = (x - points[i * 2]) ** 2 + (y - points[i * 2 + 1]) ** 2;\n    for (const t of this.neighbors(i)) {\n      const dt = (x - points[t * 2]) ** 2 + (y - points[t * 2 + 1]) ** 2;\n      if (dt < dc) dc = dt, c = t;\n    }\n    return c;\n  }\n  render(context) {\n    const buffer = context == null ? context = new Path : undefined;\n    const {points, halfedges, triangles} = this;\n    for (let i = 0, n = halfedges.length; i < n; ++i) {\n      const j = halfedges[i];\n      if (j < i) continue;\n      const ti = triangles[i] * 2;\n      const tj = triangles[j] * 2;\n      context.moveTo(points[ti], points[ti + 1]);\n      context.lineTo(points[tj], points[tj + 1]);\n    }\n    this.renderHull(context);\n    return buffer && buffer.value();\n  }\n  renderPoints(context, r = 2) {\n    const buffer = context == null ? context = new Path : undefined;\n    const {points} = this;\n    for (let i = 0, n = points.length; i < n; i += 2) {\n      const x = points[i], y = points[i + 1];\n      context.moveTo(x + r, y);\n      context.arc(x, y, r, 0, tau);\n    }\n    return buffer && buffer.value();\n  }\n  renderHull(context) {\n    const buffer = context == null ? context = new Path : undefined;\n    const {hull} = this;\n    let node = hull;\n    context.moveTo(node.x, node.y);\n    while (node = node.next, node !== hull) context.lineTo(node.x, node.y);\n    context.closePath();\n    return buffer && buffer.value();\n  }\n  hullPolygon() {\n    const polygon = new Polygon;\n    this.renderHull(polygon);\n    return polygon.value();\n  }\n  renderTriangle(i, context) {\n    const buffer = context == null ? context = new Path : undefined;\n    const {points, triangles} = this;\n    const t0 = triangles[i *= 3] * 2;\n    const t1 = triangles[i + 1] * 2;\n    const t2 = triangles[i + 2] * 2;\n    context.moveTo(points[t0], points[t0 + 1]);\n    context.lineTo(points[t1], points[t1 + 1]);\n    context.lineTo(points[t2], points[t2 + 1]);\n    context.closePath();\n    return buffer && buffer.value();\n  }\n  *trianglePolygons() {\n    const {triangles} = this;\n    for (let i = 0, n = triangles.length / 3; i < n; ++i) {\n      yield this.trianglePolygon(i);\n    }\n  }\n  trianglePolygon(i) {\n    const polygon = new Polygon;\n    this.renderTriangle(i, polygon);\n    return polygon.value();\n  }\n}\n\nDelaunay.from = function(points, fx = pointX, fy = pointY, that) {\n  return new Delaunay(\"length\" in points\n      ? flatArray(points, fx, fy, that)\n      : Float64Array.from(flatIterable(points, fx, fy, that)));\n};\n\nfunction flatArray(points, fx, fy, that) {\n  const n = points.length;\n  const array = new Float64Array(n * 2);\n  for (let i = 0; i < n; ++i) {\n    const p = points[i];\n    array[i * 2] = fx.call(that, p, i, points);\n    array[i * 2 + 1] = fy.call(that, p, i, points);\n  }\n  return array;\n}\n\nfunction* flatIterable(points, fx, fy, that) {\n  let i = 0;\n  for (const p of points) {\n    yield fx.call(that, p, i, points);\n    yield fy.call(that, p, i, points);\n    ++i;\n  }\n}\n","export {default as Delaunay} from \"./delaunay.js\";\nexport {default as Voronoi} from \"./voronoi.js\";\n","var support = {\n  searchParams: 'URLSearchParams' in self,\n  iterable: 'Symbol' in self && 'iterator' in Symbol,\n  blob:\n    'FileReader' in self &&\n    'Blob' in self &&\n    (function() {\n      try {\n        new Blob()\n        return true\n      } catch (e) {\n        return false\n      }\n    })(),\n  formData: 'FormData' in self,\n  arrayBuffer: 'ArrayBuffer' in self\n}\n\nfunction isDataView(obj) {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nif (support.arrayBuffer) {\n  var viewClasses = [\n    '[object Int8Array]',\n    '[object Uint8Array]',\n    '[object Uint8ClampedArray]',\n    '[object Int16Array]',\n    '[object Uint16Array]',\n    '[object Int32Array]',\n    '[object Uint32Array]',\n    '[object Float32Array]',\n    '[object Float64Array]'\n  ]\n\n  var isArrayBufferView =\n    ArrayBuffer.isView ||\n    function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name)\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n    throw new TypeError('Invalid character in header field name')\n  }\n  return name.toLowerCase()\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value)\n  }\n  return value\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  var iterator = {\n    next: function() {\n      var value = items.shift()\n      return {done: value === undefined, value: value}\n    }\n  }\n\n  if (support.iterable) {\n    iterator[Symbol.iterator] = function() {\n      return iterator\n    }\n  }\n\n  return iterator\n}\n\nexport function Headers(headers) {\n  this.map = {}\n\n  if (headers instanceof Headers) {\n    headers.forEach(function(value, name) {\n      this.append(name, value)\n    }, this)\n  } else if (Array.isArray(headers)) {\n    headers.forEach(function(header) {\n      this.append(header[0], header[1])\n    }, this)\n  } else if (headers) {\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\n      this.append(name, headers[name])\n    }, this)\n  }\n}\n\nHeaders.prototype.append = function(name, value) {\n  name = normalizeName(name)\n  value = normalizeValue(value)\n  var oldValue = this.map[name]\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\n}\n\nHeaders.prototype['delete'] = function(name) {\n  delete this.map[normalizeName(name)]\n}\n\nHeaders.prototype.get = function(name) {\n  name = normalizeName(name)\n  return this.has(name) ? this.map[name] : null\n}\n\nHeaders.prototype.has = function(name) {\n  return this.map.hasOwnProperty(normalizeName(name))\n}\n\nHeaders.prototype.set = function(name, value) {\n  this.map[normalizeName(name)] = normalizeValue(value)\n}\n\nHeaders.prototype.forEach = function(callback, thisArg) {\n  for (var name in this.map) {\n    if (this.map.hasOwnProperty(name)) {\n      callback.call(thisArg, this.map[name], name, this)\n    }\n  }\n}\n\nHeaders.prototype.keys = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push(name)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.values = function() {\n  var items = []\n  this.forEach(function(value) {\n    items.push(value)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.entries = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push([name, value])\n  })\n  return iteratorFor(items)\n}\n\nif (support.iterable) {\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n}\n\nfunction consumed(body) {\n  if (body.bodyUsed) {\n    return Promise.reject(new TypeError('Already read'))\n  }\n  body.bodyUsed = true\n}\n\nfunction fileReaderReady(reader) {\n  return new Promise(function(resolve, reject) {\n    reader.onload = function() {\n      resolve(reader.result)\n    }\n    reader.onerror = function() {\n      reject(reader.error)\n    }\n  })\n}\n\nfunction readBlobAsArrayBuffer(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nfunction readBlobAsText(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nfunction readArrayBufferAsText(buf) {\n  var view = new Uint8Array(buf)\n  var chars = new Array(view.length)\n\n  for (var i = 0; i < view.length; i++) {\n    chars[i] = String.fromCharCode(view[i])\n  }\n  return chars.join('')\n}\n\nfunction bufferClone(buf) {\n  if (buf.slice) {\n    return buf.slice(0)\n  } else {\n    var view = new Uint8Array(buf.byteLength)\n    view.set(new Uint8Array(buf))\n    return view.buffer\n  }\n}\n\nfunction Body() {\n  this.bodyUsed = false\n\n  this._initBody = function(body) {\n    this._bodyInit = body\n    if (!body) {\n      this._bodyText = ''\n    } else if (typeof body === 'string') {\n      this._bodyText = body\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n      this._bodyBlob = body\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n      this._bodyFormData = body\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n      this._bodyText = body.toString()\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n      this._bodyArrayBuffer = bufferClone(body.buffer)\n      // IE 10-11 can't handle a DataView body.\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n      this._bodyArrayBuffer = bufferClone(body)\n    } else {\n      this._bodyText = body = Object.prototype.toString.call(body)\n    }\n\n    if (!this.headers.get('content-type')) {\n      if (typeof body === 'string') {\n        this.headers.set('content-type', 'text/plain;charset=UTF-8')\n      } else if (this._bodyBlob && this._bodyBlob.type) {\n        this.headers.set('content-type', this._bodyBlob.type)\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n      }\n    }\n  }\n\n  if (support.blob) {\n    this.blob = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return Promise.resolve(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as blob')\n      } else {\n        return Promise.resolve(new Blob([this._bodyText]))\n      }\n    }\n\n    this.arrayBuffer = function() {\n      if (this._bodyArrayBuffer) {\n        return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n      } else {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n    }\n  }\n\n  this.text = function() {\n    var rejected = consumed(this)\n    if (rejected) {\n      return rejected\n    }\n\n    if (this._bodyBlob) {\n      return readBlobAsText(this._bodyBlob)\n    } else if (this._bodyArrayBuffer) {\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n    } else if (this._bodyFormData) {\n      throw new Error('could not read FormData body as text')\n    } else {\n      return Promise.resolve(this._bodyText)\n    }\n  }\n\n  if (support.formData) {\n    this.formData = function() {\n      return this.text().then(decode)\n    }\n  }\n\n  this.json = function() {\n    return this.text().then(JSON.parse)\n  }\n\n  return this\n}\n\n// HTTP methods whose capitalization should be normalized\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\nfunction normalizeMethod(method) {\n  var upcased = method.toUpperCase()\n  return methods.indexOf(upcased) > -1 ? upcased : method\n}\n\nexport function Request(input, options) {\n  options = options || {}\n  var body = options.body\n\n  if (input instanceof Request) {\n    if (input.bodyUsed) {\n      throw new TypeError('Already read')\n    }\n    this.url = input.url\n    this.credentials = input.credentials\n    if (!options.headers) {\n      this.headers = new Headers(input.headers)\n    }\n    this.method = input.method\n    this.mode = input.mode\n    this.signal = input.signal\n    if (!body && input._bodyInit != null) {\n      body = input._bodyInit\n      input.bodyUsed = true\n    }\n  } else {\n    this.url = String(input)\n  }\n\n  this.credentials = options.credentials || this.credentials || 'same-origin'\n  if (options.headers || !this.headers) {\n    this.headers = new Headers(options.headers)\n  }\n  this.method = normalizeMethod(options.method || this.method || 'GET')\n  this.mode = options.mode || this.mode || null\n  this.signal = options.signal || this.signal\n  this.referrer = null\n\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n    throw new TypeError('Body not allowed for GET or HEAD requests')\n  }\n  this._initBody(body)\n}\n\nRequest.prototype.clone = function() {\n  return new Request(this, {body: this._bodyInit})\n}\n\nfunction decode(body) {\n  var form = new FormData()\n  body\n    .trim()\n    .split('&')\n    .forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nfunction parseHeaders(rawHeaders) {\n  var headers = new Headers()\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n  // https://tools.ietf.org/html/rfc7230#section-3.2\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n  preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n    var parts = line.split(':')\n    var key = parts.shift().trim()\n    if (key) {\n      var value = parts.join(':').trim()\n      headers.append(key, value)\n    }\n  })\n  return headers\n}\n\nBody.call(Request.prototype)\n\nexport function Response(bodyInit, options) {\n  if (!options) {\n    options = {}\n  }\n\n  this.type = 'default'\n  this.status = options.status === undefined ? 200 : options.status\n  this.ok = this.status >= 200 && this.status < 300\n  this.statusText = 'statusText' in options ? options.statusText : 'OK'\n  this.headers = new Headers(options.headers)\n  this.url = options.url || ''\n  this._initBody(bodyInit)\n}\n\nBody.call(Response.prototype)\n\nResponse.prototype.clone = function() {\n  return new Response(this._bodyInit, {\n    status: this.status,\n    statusText: this.statusText,\n    headers: new Headers(this.headers),\n    url: this.url\n  })\n}\n\nResponse.error = function() {\n  var response = new Response(null, {status: 0, statusText: ''})\n  response.type = 'error'\n  return response\n}\n\nvar redirectStatuses = [301, 302, 303, 307, 308]\n\nResponse.redirect = function(url, status) {\n  if (redirectStatuses.indexOf(status) === -1) {\n    throw new RangeError('Invalid status code')\n  }\n\n  return new Response(null, {status: status, headers: {location: url}})\n}\n\nexport var DOMException = self.DOMException\ntry {\n  new DOMException()\n} catch (err) {\n  DOMException = function(message, name) {\n    this.message = message\n    this.name = name\n    var error = Error(message)\n    this.stack = error.stack\n  }\n  DOMException.prototype = Object.create(Error.prototype)\n  DOMException.prototype.constructor = DOMException\n}\n\nexport function fetch(input, init) {\n  return new Promise(function(resolve, reject) {\n    var request = new Request(input, init)\n\n    if (request.signal && request.signal.aborted) {\n      return reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    var xhr = new XMLHttpRequest()\n\n    function abortXhr() {\n      xhr.abort()\n    }\n\n    xhr.onload = function() {\n      var options = {\n        status: xhr.status,\n        statusText: xhr.statusText,\n        headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n      }\n      options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n      var body = 'response' in xhr ? xhr.response : xhr.responseText\n      resolve(new Response(body, options))\n    }\n\n    xhr.onerror = function() {\n      reject(new TypeError('Network request failed'))\n    }\n\n    xhr.ontimeout = function() {\n      reject(new TypeError('Network request failed'))\n    }\n\n    xhr.onabort = function() {\n      reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    xhr.open(request.method, request.url, true)\n\n    if (request.credentials === 'include') {\n      xhr.withCredentials = true\n    } else if (request.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    if ('responseType' in xhr && support.blob) {\n      xhr.responseType = 'blob'\n    }\n\n    request.headers.forEach(function(value, name) {\n      xhr.setRequestHeader(name, value)\n    })\n\n    if (request.signal) {\n      request.signal.addEventListener('abort', abortXhr)\n\n      xhr.onreadystatechange = function() {\n        // DONE (success or failure)\n        if (xhr.readyState === 4) {\n          request.signal.removeEventListener('abort', abortXhr)\n        }\n      }\n    }\n\n    xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n  })\n}\n\nfetch.polyfill = true\n\nif (!self.fetch) {\n  self.fetch = fetch\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_1 = require(\"../bindings/binding\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_reader_1 = require(\"../planning/metadata_reader\");\nvar planner_1 = require(\"../planning/planner\");\nvar resolver_1 = require(\"../resolution/resolver\");\nvar binding_to_syntax_1 = require(\"../syntax/binding_to_syntax\");\nvar id_1 = require(\"../utils/id\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar container_snapshot_1 = require(\"./container_snapshot\");\nvar lookup_1 = require(\"./lookup\");\nvar Container = (function () {\n    function Container(containerOptions) {\n        var options = containerOptions || {};\n        if (typeof options !== \"object\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\n        }\n        if (options.defaultScope === undefined) {\n            options.defaultScope = literal_types_1.BindingScopeEnum.Transient;\n        }\n        else if (options.defaultScope !== literal_types_1.BindingScopeEnum.Singleton &&\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Transient &&\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Request) {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\n        }\n        if (options.autoBindInjectable === undefined) {\n            options.autoBindInjectable = false;\n        }\n        else if (typeof options.autoBindInjectable !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\n        }\n        if (options.skipBaseClassChecks === undefined) {\n            options.skipBaseClassChecks = false;\n        }\n        else if (typeof options.skipBaseClassChecks !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\n        }\n        this.options = {\n            autoBindInjectable: options.autoBindInjectable,\n            defaultScope: options.defaultScope,\n            skipBaseClassChecks: options.skipBaseClassChecks\n        };\n        this.id = id_1.id();\n        this._bindingDictionary = new lookup_1.Lookup();\n        this._snapshots = [];\n        this._middleware = null;\n        this.parent = null;\n        this._metadataReader = new metadata_reader_1.MetadataReader();\n    }\n    Container.merge = function (container1, container2) {\n        var container = new Container();\n        var bindingDictionary = planner_1.getBindingDictionary(container);\n        var bindingDictionary1 = planner_1.getBindingDictionary(container1);\n        var bindingDictionary2 = planner_1.getBindingDictionary(container2);\n        function copyDictionary(origin, destination) {\n            origin.traverse(function (key, value) {\n                value.forEach(function (binding) {\n                    destination.add(binding.serviceIdentifier, binding.clone());\n                });\n            });\n        }\n        copyDictionary(bindingDictionary1, bindingDictionary);\n        copyDictionary(bindingDictionary2, bindingDictionary);\n        return container;\n    };\n    Container.prototype.load = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var getHelpers = this._getContainerModuleHelpersFactory();\n        for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\n            var currentModule = modules_1[_a];\n            var containerModuleHelpers = getHelpers(currentModule.id);\n            currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction);\n        }\n    };\n    Container.prototype.loadAsync = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        getHelpers = this._getContainerModuleHelpersFactory();\n                        _a = 0, modules_2 = modules;\n                        _b.label = 1;\n                    case 1:\n                        if (!(_a < modules_2.length)) return [3, 4];\n                        currentModule = modules_2[_a];\n                        containerModuleHelpers = getHelpers(currentModule.id);\n                        return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction)];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3:\n                        _a++;\n                        return [3, 1];\n                    case 4: return [2];\n                }\n            });\n        });\n    };\n    Container.prototype.unload = function () {\n        var _this = this;\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var conditionFactory = function (expected) { return function (item) {\n            return item.moduleId === expected;\n        }; };\n        modules.forEach(function (module) {\n            var condition = conditionFactory(module.id);\n            _this._bindingDictionary.removeByCondition(condition);\n        });\n    };\n    Container.prototype.bind = function (serviceIdentifier) {\n        var scope = this.options.defaultScope || literal_types_1.BindingScopeEnum.Transient;\n        var binding = new binding_1.Binding(serviceIdentifier, scope);\n        this._bindingDictionary.add(serviceIdentifier, binding);\n        return new binding_to_syntax_1.BindingToSyntax(binding);\n    };\n    Container.prototype.rebind = function (serviceIdentifier) {\n        this.unbind(serviceIdentifier);\n        return this.bind(serviceIdentifier);\n    };\n    Container.prototype.unbind = function (serviceIdentifier) {\n        try {\n            this._bindingDictionary.remove(serviceIdentifier);\n        }\n        catch (e) {\n            throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + serialization_1.getServiceIdentifierAsString(serviceIdentifier));\n        }\n    };\n    Container.prototype.unbindAll = function () {\n        this._bindingDictionary = new lookup_1.Lookup();\n    };\n    Container.prototype.isBound = function (serviceIdentifier) {\n        var bound = this._bindingDictionary.hasKey(serviceIdentifier);\n        if (!bound && this.parent) {\n            bound = this.parent.isBound(serviceIdentifier);\n        }\n        return bound;\n    };\n    Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\n        return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\n        var bound = false;\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\n            var request_1 = planner_1.createMockRequest(this, serviceIdentifier, key, value);\n            bound = bindings.some(function (b) { return b.constraint(request_1); });\n        }\n        if (!bound && this.parent) {\n            bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\n        }\n        return bound;\n    };\n    Container.prototype.snapshot = function () {\n        this._snapshots.push(container_snapshot_1.ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware));\n    };\n    Container.prototype.restore = function () {\n        var snapshot = this._snapshots.pop();\n        if (snapshot === undefined) {\n            throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\n        }\n        this._bindingDictionary = snapshot.bindings;\n        this._middleware = snapshot.middleware;\n    };\n    Container.prototype.createChild = function (containerOptions) {\n        var child = new Container(containerOptions || this.options);\n        child.parent = this;\n        return child;\n    };\n    Container.prototype.applyMiddleware = function () {\n        var middlewares = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            middlewares[_i] = arguments[_i];\n        }\n        var initial = (this._middleware) ? this._middleware : this._planAndResolve();\n        this._middleware = middlewares.reduce(function (prev, curr) { return curr(prev); }, initial);\n    };\n    Container.prototype.applyCustomMetadataReader = function (metadataReader) {\n        this._metadataReader = metadataReader;\n    };\n    Container.prototype.get = function (serviceIdentifier) {\n        return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getNamed = function (serviceIdentifier, named) {\n        return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.getAll = function (serviceIdentifier) {\n        return this._get(true, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getAllNamed = function (serviceIdentifier, named) {\n        return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.resolve = function (constructorFunction) {\n        var tempContainer = this.createChild();\n        tempContainer.bind(constructorFunction).toSelf();\n        return tempContainer.get(constructorFunction);\n    };\n    Container.prototype._getContainerModuleHelpersFactory = function () {\n        var _this = this;\n        var setModuleId = function (bindingToSyntax, moduleId) {\n            bindingToSyntax._binding.moduleId = moduleId;\n        };\n        var getBindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _bind = _this.bind.bind(_this);\n                var bindingToSyntax = _bind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        var getUnbindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _unbind = _this.unbind.bind(_this);\n                _unbind(serviceIdentifier);\n            };\n        };\n        var getIsboundFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _isBound = _this.isBound.bind(_this);\n                return _isBound(serviceIdentifier);\n            };\n        };\n        var getRebindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _rebind = _this.rebind.bind(_this);\n                var bindingToSyntax = _rebind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        return function (mId) { return ({\n            bindFunction: getBindFunction(mId),\n            isboundFunction: getIsboundFunction(mId),\n            rebindFunction: getRebindFunction(mId),\n            unbindFunction: getUnbindFunction(mId)\n        }); };\n    };\n    Container.prototype._get = function (avoidConstraints, isMultiInject, targetType, serviceIdentifier, key, value) {\n        var result = null;\n        var defaultArgs = {\n            avoidConstraints: avoidConstraints,\n            contextInterceptor: function (context) { return context; },\n            isMultiInject: isMultiInject,\n            key: key,\n            serviceIdentifier: serviceIdentifier,\n            targetType: targetType,\n            value: value\n        };\n        if (this._middleware) {\n            result = this._middleware(defaultArgs);\n            if (result === undefined || result === null) {\n                throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\n            }\n        }\n        else {\n            result = this._planAndResolve()(defaultArgs);\n        }\n        return result;\n    };\n    Container.prototype._planAndResolve = function () {\n        var _this = this;\n        return function (args) {\n            var context = planner_1.plan(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\n            context = args.contextInterceptor(context);\n            var result = resolver_1.resolve(context);\n            return result;\n        };\n    };\n    return Container;\n}());\nexports.Container = Container;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar id_1 = require(\"../utils/id\");\nvar Binding = (function () {\n    function Binding(serviceIdentifier, scope) {\n        this.id = id_1.id();\n        this.activated = false;\n        this.serviceIdentifier = serviceIdentifier;\n        this.scope = scope;\n        this.type = literal_types_1.BindingTypeEnum.Invalid;\n        this.constraint = function (request) { return true; };\n        this.implementationType = null;\n        this.cache = null;\n        this.factory = null;\n        this.provider = null;\n        this.onActivation = null;\n        this.dynamicValue = null;\n    }\n    Binding.prototype.clone = function () {\n        var clone = new Binding(this.serviceIdentifier, this.scope);\n        clone.activated = false;\n        clone.implementationType = this.implementationType;\n        clone.dynamicValue = this.dynamicValue;\n        clone.scope = this.scope;\n        clone.type = this.type;\n        clone.factory = this.factory;\n        clone.provider = this.provider;\n        clone.constraint = this.constraint;\n        clone.onActivation = this.onActivation;\n        clone.cache = this.cache;\n        return clone;\n    };\n    return Binding;\n}());\nexports.Binding = Binding;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_count_1 = require(\"../bindings/binding_count\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar exceptions_1 = require(\"../utils/exceptions\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar context_1 = require(\"./context\");\nvar metadata_1 = require(\"./metadata\");\nvar plan_1 = require(\"./plan\");\nvar reflection_utils_1 = require(\"./reflection_utils\");\nvar request_1 = require(\"./request\");\nvar target_1 = require(\"./target\");\nfunction getBindingDictionary(cntnr) {\n    return cntnr._bindingDictionary;\n}\nexports.getBindingDictionary = getBindingDictionary;\nfunction _createTarget(isMultiInject, targetType, serviceIdentifier, name, key, value) {\n    var metadataKey = isMultiInject ? METADATA_KEY.MULTI_INJECT_TAG : METADATA_KEY.INJECT_TAG;\n    var injectMetadata = new metadata_1.Metadata(metadataKey, serviceIdentifier);\n    var target = new target_1.Target(targetType, name, serviceIdentifier, injectMetadata);\n    if (key !== undefined) {\n        var tagMetadata = new metadata_1.Metadata(key, value);\n        target.metadata.push(tagMetadata);\n    }\n    return target;\n}\nfunction _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target) {\n    var bindings = getBindings(context.container, target.serviceIdentifier);\n    var activeBindings = [];\n    if (bindings.length === binding_count_1.BindingCount.NoBindingsAvailable &&\n        context.container.options.autoBindInjectable &&\n        typeof target.serviceIdentifier === \"function\" &&\n        metadataReader.getConstructorMetadata(target.serviceIdentifier).compilerGeneratedMetadata) {\n        context.container.bind(target.serviceIdentifier).toSelf();\n        bindings = getBindings(context.container, target.serviceIdentifier);\n    }\n    if (!avoidConstraints) {\n        activeBindings = bindings.filter(function (binding) {\n            var request = new request_1.Request(binding.serviceIdentifier, context, parentRequest, binding, target);\n            return binding.constraint(request);\n        });\n    }\n    else {\n        activeBindings = bindings;\n    }\n    _validateActiveBindingCount(target.serviceIdentifier, activeBindings, target, context.container);\n    return activeBindings;\n}\nfunction _validateActiveBindingCount(serviceIdentifier, bindings, target, container) {\n    switch (bindings.length) {\n        case binding_count_1.BindingCount.NoBindingsAvailable:\n            if (target.isOptional()) {\n                return bindings;\n            }\n            else {\n                var serviceIdentifierString = serialization_1.getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.NOT_REGISTERED;\n                msg += serialization_1.listMetadataForTarget(serviceIdentifierString, target);\n                msg += serialization_1.listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n        case binding_count_1.BindingCount.OnlyOneBindingAvailable:\n            if (!target.isArray()) {\n                return bindings;\n            }\n        case binding_count_1.BindingCount.MultipleBindingsAvailable:\n        default:\n            if (!target.isArray()) {\n                var serviceIdentifierString = serialization_1.getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.AMBIGUOUS_MATCH + \" \" + serviceIdentifierString;\n                msg += serialization_1.listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n            else {\n                return bindings;\n            }\n    }\n}\nfunction _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, parentRequest, target) {\n    var activeBindings;\n    var childRequest;\n    if (parentRequest === null) {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, null, target);\n        childRequest = new request_1.Request(serviceIdentifier, context, null, activeBindings, target);\n        var thePlan = new plan_1.Plan(context, childRequest);\n        context.addPlan(thePlan);\n    }\n    else {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target);\n        childRequest = parentRequest.addChildRequest(target.serviceIdentifier, activeBindings, target);\n    }\n    activeBindings.forEach(function (binding) {\n        var subChildRequest = null;\n        if (target.isArray()) {\n            subChildRequest = childRequest.addChildRequest(binding.serviceIdentifier, binding, target);\n        }\n        else {\n            if (binding.cache) {\n                return;\n            }\n            subChildRequest = childRequest;\n        }\n        if (binding.type === literal_types_1.BindingTypeEnum.Instance && binding.implementationType !== null) {\n            var dependencies = reflection_utils_1.getDependencies(metadataReader, binding.implementationType);\n            if (!context.container.options.skipBaseClassChecks) {\n                var baseClassDependencyCount = reflection_utils_1.getBaseClassDependencyCount(metadataReader, binding.implementationType);\n                if (dependencies.length < baseClassDependencyCount) {\n                    var error = ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH(reflection_utils_1.getFunctionName(binding.implementationType));\n                    throw new Error(error);\n                }\n            }\n            dependencies.forEach(function (dependency) {\n                _createSubRequests(metadataReader, false, dependency.serviceIdentifier, context, subChildRequest, dependency);\n            });\n        }\n    });\n}\nfunction getBindings(container, serviceIdentifier) {\n    var bindings = [];\n    var bindingDictionary = getBindingDictionary(container);\n    if (bindingDictionary.hasKey(serviceIdentifier)) {\n        bindings = bindingDictionary.get(serviceIdentifier);\n    }\n    else if (container.parent !== null) {\n        bindings = getBindings(container.parent, serviceIdentifier);\n    }\n    return bindings;\n}\nfunction plan(metadataReader, container, isMultiInject, targetType, serviceIdentifier, key, value, avoidConstraints) {\n    if (avoidConstraints === void 0) { avoidConstraints = false; }\n    var context = new context_1.Context(container);\n    var target = _createTarget(isMultiInject, targetType, serviceIdentifier, \"\", key, value);\n    try {\n        _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, null, target);\n        return context;\n    }\n    catch (error) {\n        if (exceptions_1.isStackOverflowExeption(error)) {\n            if (context.plan) {\n                serialization_1.circularDependencyToException(context.plan.rootRequest);\n            }\n        }\n        throw error;\n    }\n}\nexports.plan = plan;\nfunction createMockRequest(container, serviceIdentifier, key, value) {\n    var target = new target_1.Target(literal_types_1.TargetTypeEnum.Variable, \"\", serviceIdentifier, new metadata_1.Metadata(key, value));\n    var context = new context_1.Context(container);\n    var request = new request_1.Request(serviceIdentifier, context, null, [], target);\n    return request;\n}\nexports.createMockRequest = createMockRequest;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BindingCount = {\n    MultipleBindingsAvailable: 2,\n    NoBindingsAvailable: 0,\n    OnlyOneBindingAvailable: 1\n};\nexports.BindingCount = BindingCount;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar Context = (function () {\n    function Context(container) {\n        this.id = id_1.id();\n        this.container = container;\n    }\n    Context.prototype.addPlan = function (plan) {\n        this.plan = plan;\n    };\n    Context.prototype.setCurrentRequest = function (currentRequest) {\n        this.currentRequest = currentRequest;\n    };\n    return Context;\n}());\nexports.Context = Context;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Plan = (function () {\n    function Plan(parentContext, rootRequest) {\n        this.parentContext = parentContext;\n        this.rootRequest = rootRequest;\n    }\n    return Plan;\n}());\nexports.Plan = Plan;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar inject_1 = require(\"../annotation/inject\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar serialization_1 = require(\"../utils/serialization\");\nexports.getFunctionName = serialization_1.getFunctionName;\nvar target_1 = require(\"./target\");\nfunction getDependencies(metadataReader, func) {\n    var constructorName = serialization_1.getFunctionName(func);\n    var targets = getTargets(metadataReader, constructorName, func, false);\n    return targets;\n}\nexports.getDependencies = getDependencies;\nfunction getTargets(metadataReader, constructorName, func, isBaseClass) {\n    var metadata = metadataReader.getConstructorMetadata(func);\n    var serviceIdentifiers = metadata.compilerGeneratedMetadata;\n    if (serviceIdentifiers === undefined) {\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" \" + constructorName + \".\";\n        throw new Error(msg);\n    }\n    var constructorArgsMetadata = metadata.userGeneratedMetadata;\n    var keys = Object.keys(constructorArgsMetadata);\n    var hasUserDeclaredUnknownInjections = (func.length === 0 && keys.length > 0);\n    var iterations = (hasUserDeclaredUnknownInjections) ? keys.length : func.length;\n    var constructorTargets = getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations);\n    var propertyTargets = getClassPropsAsTargets(metadataReader, func);\n    var targets = constructorTargets.concat(propertyTargets);\n    return targets;\n}\nfunction getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata) {\n    var targetMetadata = constructorArgsMetadata[index.toString()] || [];\n    var metadata = formatTargetMetadata(targetMetadata);\n    var isManaged = metadata.unmanaged !== true;\n    var serviceIdentifier = serviceIdentifiers[index];\n    var injectIdentifier = (metadata.inject || metadata.multiInject);\n    serviceIdentifier = (injectIdentifier) ? (injectIdentifier) : serviceIdentifier;\n    if (serviceIdentifier instanceof inject_1.LazyServiceIdentifer) {\n        serviceIdentifier = serviceIdentifier.unwrap();\n    }\n    if (isManaged) {\n        var isObject = serviceIdentifier === Object;\n        var isFunction = serviceIdentifier === Function;\n        var isUndefined = serviceIdentifier === undefined;\n        var isUnknownType = (isObject || isFunction || isUndefined);\n        if (!isBaseClass && isUnknownType) {\n            var msg = ERROR_MSGS.MISSING_INJECT_ANNOTATION + \" argument \" + index + \" in class \" + constructorName + \".\";\n            throw new Error(msg);\n        }\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ConstructorArgument, metadata.targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        return target;\n    }\n    return null;\n}\nfunction getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations) {\n    var targets = [];\n    for (var i = 0; i < iterations; i++) {\n        var index = i;\n        var target = getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata);\n        if (target !== null) {\n            targets.push(target);\n        }\n    }\n    return targets;\n}\nfunction getClassPropsAsTargets(metadataReader, constructorFunc) {\n    var classPropsMetadata = metadataReader.getPropertiesMetadata(constructorFunc);\n    var targets = [];\n    var keys = Object.keys(classPropsMetadata);\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        var targetMetadata = classPropsMetadata[key];\n        var metadata = formatTargetMetadata(classPropsMetadata[key]);\n        var targetName = metadata.targetName || key;\n        var serviceIdentifier = (metadata.inject || metadata.multiInject);\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ClassProperty, targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        targets.push(target);\n    }\n    var baseConstructor = Object.getPrototypeOf(constructorFunc.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseTargets = getClassPropsAsTargets(metadataReader, baseConstructor);\n        targets = targets.concat(baseTargets);\n    }\n    return targets;\n}\nfunction getBaseClassDependencyCount(metadataReader, func) {\n    var baseConstructor = Object.getPrototypeOf(func.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseConstructorName = serialization_1.getFunctionName(baseConstructor);\n        var targets = getTargets(metadataReader, baseConstructorName, baseConstructor, true);\n        var metadata = targets.map(function (t) {\n            return t.metadata.filter(function (m) {\n                return m.key === METADATA_KEY.UNMANAGED_TAG;\n            });\n        });\n        var unmanagedCount = [].concat.apply([], metadata).length;\n        var dependencyCount = targets.length - unmanagedCount;\n        if (dependencyCount > 0) {\n            return dependencyCount;\n        }\n        else {\n            return getBaseClassDependencyCount(metadataReader, baseConstructor);\n        }\n    }\n    else {\n        return 0;\n    }\n}\nexports.getBaseClassDependencyCount = getBaseClassDependencyCount;\nfunction formatTargetMetadata(targetMetadata) {\n    var targetMetadataMap = {};\n    targetMetadata.forEach(function (m) {\n        targetMetadataMap[m.key.toString()] = m.value;\n    });\n    return {\n        inject: targetMetadataMap[METADATA_KEY.INJECT_TAG],\n        multiInject: targetMetadataMap[METADATA_KEY.MULTI_INJECT_TAG],\n        targetName: targetMetadataMap[METADATA_KEY.NAME_TAG],\n        unmanaged: targetMetadataMap[METADATA_KEY.UNMANAGED_TAG]\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar QueryableString = (function () {\n    function QueryableString(str) {\n        this.str = str;\n    }\n    QueryableString.prototype.startsWith = function (searchString) {\n        return this.str.indexOf(searchString) === 0;\n    };\n    QueryableString.prototype.endsWith = function (searchString) {\n        var reverseString = \"\";\n        var reverseSearchString = searchString.split(\"\").reverse().join(\"\");\n        reverseString = this.str.split(\"\").reverse().join(\"\");\n        return this.startsWith.call({ str: reverseString }, reverseSearchString);\n    };\n    QueryableString.prototype.contains = function (searchString) {\n        return (this.str.indexOf(searchString) !== -1);\n    };\n    QueryableString.prototype.equals = function (compareString) {\n        return this.str === compareString;\n    };\n    QueryableString.prototype.value = function () {\n        return this.str;\n    };\n    return QueryableString;\n}());\nexports.QueryableString = QueryableString;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar Request = (function () {\n    function Request(serviceIdentifier, parentContext, parentRequest, bindings, target) {\n        this.id = id_1.id();\n        this.serviceIdentifier = serviceIdentifier;\n        this.parentContext = parentContext;\n        this.parentRequest = parentRequest;\n        this.target = target;\n        this.childRequests = [];\n        this.bindings = (Array.isArray(bindings) ? bindings : [bindings]);\n        this.requestScope = parentRequest === null\n            ? new Map()\n            : null;\n    }\n    Request.prototype.addChildRequest = function (serviceIdentifier, bindings, target) {\n        var child = new Request(serviceIdentifier, this.parentContext, this, bindings, target);\n        this.childRequests.push(child);\n        return child;\n    };\n    return Request;\n}());\nexports.Request = Request;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar exceptions_1 = require(\"../utils/exceptions\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar instantiation_1 = require(\"./instantiation\");\nvar invokeFactory = function (factoryType, serviceIdentifier, fn) {\n    try {\n        return fn();\n    }\n    catch (error) {\n        if (exceptions_1.isStackOverflowExeption(error)) {\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY(factoryType, serviceIdentifier.toString()));\n        }\n        else {\n            throw error;\n        }\n    }\n};\nvar _resolveRequest = function (requestScope) {\n    return function (request) {\n        request.parentContext.setCurrentRequest(request);\n        var bindings = request.bindings;\n        var childRequests = request.childRequests;\n        var targetIsAnArray = request.target && request.target.isArray();\n        var targetParentIsNotAnArray = !request.parentRequest ||\n            !request.parentRequest.target ||\n            !request.target ||\n            !request.parentRequest.target.matchesArray(request.target.serviceIdentifier);\n        if (targetIsAnArray && targetParentIsNotAnArray) {\n            return childRequests.map(function (childRequest) {\n                var _f = _resolveRequest(requestScope);\n                return _f(childRequest);\n            });\n        }\n        else {\n            var result = null;\n            if (request.target.isOptional() && bindings.length === 0) {\n                return undefined;\n            }\n            var binding_1 = bindings[0];\n            var isSingleton = binding_1.scope === literal_types_1.BindingScopeEnum.Singleton;\n            var isRequestSingleton = binding_1.scope === literal_types_1.BindingScopeEnum.Request;\n            if (isSingleton && binding_1.activated) {\n                return binding_1.cache;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                requestScope.has(binding_1.id)) {\n                return requestScope.get(binding_1.id);\n            }\n            if (binding_1.type === literal_types_1.BindingTypeEnum.ConstantValue) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Function) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Constructor) {\n                result = binding_1.implementationType;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.DynamicValue && binding_1.dynamicValue !== null) {\n                result = invokeFactory(\"toDynamicValue\", binding_1.serviceIdentifier, function () { return binding_1.dynamicValue(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Factory && binding_1.factory !== null) {\n                result = invokeFactory(\"toFactory\", binding_1.serviceIdentifier, function () { return binding_1.factory(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Provider && binding_1.provider !== null) {\n                result = invokeFactory(\"toProvider\", binding_1.serviceIdentifier, function () { return binding_1.provider(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Instance && binding_1.implementationType !== null) {\n                result = instantiation_1.resolveInstance(binding_1.implementationType, childRequests, _resolveRequest(requestScope));\n            }\n            else {\n                var serviceIdentifier = serialization_1.getServiceIdentifierAsString(request.serviceIdentifier);\n                throw new Error(ERROR_MSGS.INVALID_BINDING_TYPE + \" \" + serviceIdentifier);\n            }\n            if (typeof binding_1.onActivation === \"function\") {\n                result = binding_1.onActivation(request.parentContext, result);\n            }\n            if (isSingleton) {\n                binding_1.cache = result;\n                binding_1.activated = true;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                !requestScope.has(binding_1.id)) {\n                requestScope.set(binding_1.id, result);\n            }\n            return result;\n        }\n    };\n};\nfunction resolve(context) {\n    var _f = _resolveRequest(context.plan.rootRequest.requestScope);\n    return _f(context.plan.rootRequest);\n}\nexports.resolve = resolve;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar error_msgs_1 = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction _injectProperties(instance, childRequests, resolveRequest) {\n    var propertyInjectionsRequests = childRequests.filter(function (childRequest) {\n        return (childRequest.target !== null &&\n            childRequest.target.type === literal_types_1.TargetTypeEnum.ClassProperty);\n    });\n    var propertyInjections = propertyInjectionsRequests.map(resolveRequest);\n    propertyInjectionsRequests.forEach(function (r, index) {\n        var propertyName = \"\";\n        propertyName = r.target.name.value();\n        var injection = propertyInjections[index];\n        instance[propertyName] = injection;\n    });\n    return instance;\n}\nfunction _createInstance(Func, injections) {\n    return new (Func.bind.apply(Func, [void 0].concat(injections)))();\n}\nfunction _postConstruct(constr, result) {\n    if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\n        var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\n        try {\n            result[data.value]();\n        }\n        catch (e) {\n            throw new Error(error_msgs_1.POST_CONSTRUCT_ERROR(constr.name, e.message));\n        }\n    }\n}\nfunction resolveInstance(constr, childRequests, resolveRequest) {\n    var result = null;\n    if (childRequests.length > 0) {\n        var constructorInjectionsRequests = childRequests.filter(function (childRequest) {\n            return (childRequest.target !== null && childRequest.target.type === literal_types_1.TargetTypeEnum.ConstructorArgument);\n        });\n        var constructorInjections = constructorInjectionsRequests.map(resolveRequest);\n        result = _createInstance(constr, constructorInjections);\n        result = _injectProperties(result, childRequests, resolveRequest);\n    }\n    else {\n        result = new constr();\n    }\n    _postConstruct(constr, result);\n    return result;\n}\nexports.resolveInstance = resolveInstance;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar binding_in_when_on_syntax_1 = require(\"./binding_in_when_on_syntax\");\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\nvar BindingToSyntax = (function () {\n    function BindingToSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingToSyntax.prototype.to = function (constructor) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Instance;\n        this._binding.implementationType = constructor;\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toSelf = function () {\n        if (typeof this._binding.serviceIdentifier !== \"function\") {\n            throw new Error(\"\" + ERROR_MSGS.INVALID_TO_SELF_VALUE);\n        }\n        var self = this._binding.serviceIdentifier;\n        return this.to(self);\n    };\n    BindingToSyntax.prototype.toConstantValue = function (value) {\n        this._binding.type = literal_types_1.BindingTypeEnum.ConstantValue;\n        this._binding.cache = value;\n        this._binding.dynamicValue = null;\n        this._binding.implementationType = null;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toDynamicValue = function (func) {\n        this._binding.type = literal_types_1.BindingTypeEnum.DynamicValue;\n        this._binding.cache = null;\n        this._binding.dynamicValue = func;\n        this._binding.implementationType = null;\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toConstructor = function (constructor) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Constructor;\n        this._binding.implementationType = constructor;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFactory = function (factory) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\n        this._binding.factory = factory;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFunction = function (func) {\n        if (typeof func !== \"function\") {\n            throw new Error(ERROR_MSGS.INVALID_FUNCTION_BINDING);\n        }\n        var bindingWhenOnSyntax = this.toConstantValue(func);\n        this._binding.type = literal_types_1.BindingTypeEnum.Function;\n        return bindingWhenOnSyntax;\n    };\n    BindingToSyntax.prototype.toAutoFactory = function (serviceIdentifier) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\n        this._binding.factory = function (context) {\n            var autofactory = function () { return context.container.get(serviceIdentifier); };\n            return autofactory;\n        };\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toProvider = function (provider) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Provider;\n        this._binding.provider = provider;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toService = function (service) {\n        this.toDynamicValue(function (context) { return context.container.get(service); });\n    };\n    return BindingToSyntax;\n}());\nexports.BindingToSyntax = BindingToSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_in_syntax_1 = require(\"./binding_in_syntax\");\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingInWhenOnSyntax = (function () {\n    function BindingInWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\n        this._bindingInSyntax = new binding_in_syntax_1.BindingInSyntax(binding);\n    }\n    BindingInWhenOnSyntax.prototype.inRequestScope = function () {\n        return this._bindingInSyntax.inRequestScope();\n    };\n    BindingInWhenOnSyntax.prototype.inSingletonScope = function () {\n        return this._bindingInSyntax.inSingletonScope();\n    };\n    BindingInWhenOnSyntax.prototype.inTransientScope = function () {\n        return this._bindingInSyntax.inTransientScope();\n    };\n    BindingInWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingInWhenOnSyntax;\n}());\nexports.BindingInWhenOnSyntax = BindingInWhenOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\nvar BindingInSyntax = (function () {\n    function BindingInSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingInSyntax.prototype.inRequestScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Request;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inSingletonScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inTransientScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Transient;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    return BindingInSyntax;\n}());\nexports.BindingInSyntax = BindingInSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ContainerSnapshot = (function () {\n    function ContainerSnapshot() {\n    }\n    ContainerSnapshot.of = function (bindings, middleware) {\n        var snapshot = new ContainerSnapshot();\n        snapshot.bindings = bindings;\n        snapshot.middleware = middleware;\n        return snapshot;\n    };\n    return ContainerSnapshot;\n}());\nexports.ContainerSnapshot = ContainerSnapshot;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar Lookup = (function () {\n    function Lookup() {\n        this._map = new Map();\n    }\n    Lookup.prototype.getMap = function () {\n        return this._map;\n    };\n    Lookup.prototype.add = function (serviceIdentifier, value) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (value === null || value === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            entry.push(value);\n            this._map.set(serviceIdentifier, entry);\n        }\n        else {\n            this._map.set(serviceIdentifier, [value]);\n        }\n    };\n    Lookup.prototype.get = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            return entry;\n        }\n        else {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.remove = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (!this._map.delete(serviceIdentifier)) {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.removeByCondition = function (condition) {\n        var _this = this;\n        this._map.forEach(function (entries, key) {\n            var updatedEntries = entries.filter(function (entry) { return !condition(entry); });\n            if (updatedEntries.length > 0) {\n                _this._map.set(key, updatedEntries);\n            }\n            else {\n                _this._map.delete(key);\n            }\n        });\n    };\n    Lookup.prototype.hasKey = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        return this._map.has(serviceIdentifier);\n    };\n    Lookup.prototype.clone = function () {\n        var copy = new Lookup();\n        this._map.forEach(function (value, key) {\n            value.forEach(function (b) { return copy.add(key, b.clone()); });\n        });\n        return copy;\n    };\n    Lookup.prototype.traverse = function (func) {\n        this._map.forEach(function (value, key) {\n            func(key, value);\n        });\n    };\n    return Lookup;\n}());\nexports.Lookup = Lookup;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar ContainerModule = (function () {\n    function ContainerModule(registry) {\n        this.id = id_1.id();\n        this.registry = registry;\n    }\n    return ContainerModule;\n}());\nexports.ContainerModule = ContainerModule;\nvar AsyncContainerModule = (function () {\n    function AsyncContainerModule(registry) {\n        this.id = id_1.id();\n        this.registry = registry;\n    }\n    return AsyncContainerModule;\n}());\nexports.AsyncContainerModule = AsyncContainerModule;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERRORS_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction injectable() {\n    return function (target) {\n        if (Reflect.hasOwnMetadata(METADATA_KEY.PARAM_TYPES, target)) {\n            throw new Error(ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR);\n        }\n        var types = Reflect.getMetadata(METADATA_KEY.DESIGN_PARAM_TYPES, target) || [];\n        Reflect.defineMetadata(METADATA_KEY.PARAM_TYPES, types, target);\n        return target;\n    };\n}\nexports.injectable = injectable;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction tagged(metadataKey, metadataValue) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(metadataKey, metadataValue);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.tagged = tagged;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction named(name) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, name);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.named = named;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction optional() {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.OPTIONAL_TAG, true);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.optional = optional;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction unmanaged() {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.UNMANAGED_TAG, true);\n        decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n    };\n}\nexports.unmanaged = unmanaged;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction multiInject(serviceIdentifier) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.MULTI_INJECT_TAG, serviceIdentifier);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.multiInject = multiInject;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction targetName(name) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.NAME_TAG, name);\n        decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n    };\n}\nexports.targetName = targetName;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERRORS_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nfunction postConstruct() {\n    return function (target, propertyKey, descriptor) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.POST_CONSTRUCT, propertyKey);\n        if (Reflect.hasOwnMetadata(METADATA_KEY.POST_CONSTRUCT, target.constructor)) {\n            throw new Error(ERRORS_MSGS.MULTIPLE_POST_CONSTRUCT_METHODS);\n        }\n        Reflect.defineMetadata(METADATA_KEY.POST_CONSTRUCT, metadata, target.constructor);\n    };\n}\nexports.postConstruct = postConstruct;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.multiBindToService = function (container) {\n    return function (service) {\n        return function () {\n            var types = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                types[_i] = arguments[_i];\n            }\n            return types.forEach(function (t) { return container.bind(t).toService(service); });\n        };\n    };\n};\n","import IConnection from \"./connections\";\n\nexport class LinkedConnectionsPage {\n    public id: string;\n    private previousPageId: string;\n    private nextPageId: string;\n    private connections: IConnection[];\n\n    constructor(id: string, connections: IConnection[], previousPageId: string, nextPageId: string) {\n        this.id = id;\n        this.previousPageId = previousPageId;\n        this.nextPageId = nextPageId;\n        this.connections = connections;\n    }\n\n    public getConnections(): IConnection[] {\n        return this.connections;\n    }\n\n    public getPreviousPageId(): string {\n        return this.previousPageId;\n    }\n\n    public getNextPageId(): string {\n        return this.nextPageId;\n    }\n\n    public getLowerBound(): Date {\n        return this.connections[0].departureTime;\n    }\n\n    public getUpperBound(): Date {\n        return this.connections[this.connections.length - 1].departureTime;\n    }\n}\n\nexport interface ILinkedConnectionsPageIndex {\n    [id: string]: Promise<LinkedConnectionsPage>;\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport IConnection from \"../../entities/connections/connections\";\nimport { LinkedConnectionsPage } from \"../../entities/connections/page\";\nimport IConnectionsIteratorOptions from \"./IConnectionsIteratorOptions\";\nimport IConnectionsProvider from \"./IConnectionsProvider\";\n\nexport default class BackwardConnectionIterator extends AsyncIterator<IConnection> {\n\n    private connectionsProvider: IConnectionsProvider;\n    private options: IConnectionsIteratorOptions;\n\n    private waiting: boolean;\n    private currentPage: LinkedConnectionsPage;\n    private currentIndex: number;\n\n    constructor(\n        provider: IConnectionsProvider,\n        options: IConnectionsIteratorOptions,\n        beginUrl: string,\n    ) {\n        super();\n\n        this.connectionsProvider = provider;\n        this.options = options;\n        this.waiting = false;\n        this.fetchPage(beginUrl);\n    }\n\n    public async fetchPage(url) {\n        if (!this.waiting) {\n            // start fetching a page\n            this.readable = false;\n            this.waiting = true;\n            this.currentPage = null;\n            this.currentPage = await this.connectionsProvider.getByUrl(url);\n            this.waiting = false;\n            this.currentIndex = this.currentPage.getConnections().length - 1;\n            this.readable = true;\n\n            if (this.currentPage.getPreviousPageId()) {\n                // prefetch the next page to reduce IO\n                this.connectionsProvider.getByUrl(this.currentPage.getPreviousPageId());\n            }\n        }\n    }\n\n    public read(): IConnection {\n        if (this.closed) {\n            return undefined;\n        }\n\n        if (this.waiting) {\n            // waiting for the next page to be fetched\n            this.readable = false;\n            return undefined;\n        }\n\n        if (this.currentIndex < 0) {\n            // end of this page, fetch the next one\n            this.fetchPage(this.currentPage.getPreviousPageId());\n            return undefined;\n        }\n\n        const item = this.currentPage.getConnections()[this.currentIndex];\n        this.currentIndex -= 1;\n\n        if (this.options.lowerBoundDate && item.departureTime < this.options.lowerBoundDate) {\n            // no more relevant connections\n            this.close();\n        }\n\n        return item;\n    }\n}\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","import { AsyncIterator } from \"asynciterator\";\nimport IConnection from \"../../entities/connections/connections\";\nimport { LinkedConnectionsPage } from \"../../entities/connections/page\";\nimport IConnectionsIteratorOptions from \"./IConnectionsIteratorOptions\";\nimport IConnectionsProvider from \"./IConnectionsProvider\";\n\nexport default class ForwardConnectionIterator extends AsyncIterator<IConnection> {\n\n    private connectionsProvider: IConnectionsProvider;\n    private options: IConnectionsIteratorOptions;\n\n    private waiting: boolean;\n    private currentPage: LinkedConnectionsPage;\n    private currentIndex: number;\n\n    constructor(\n        provider: IConnectionsProvider,\n        options: IConnectionsIteratorOptions,\n        beginUrl: string,\n    ) {\n        super();\n\n        this.connectionsProvider = provider;\n        this.options = options;\n        this.waiting = false;\n        this.fetchPage(beginUrl);\n    }\n\n    public async fetchPage(url) {\n        if (!this.waiting) {\n            // start fetching a page\n            this.readable = false;\n            this.waiting = true;\n            this.currentPage = null;\n            this.currentPage = await this.connectionsProvider.getByUrl(url);\n            this.waiting = false;\n            this.currentIndex = 0;\n            this.readable = true;\n\n            if (this.currentPage.getNextPageId()) {\n                // prefetch the next page to reduce IO\n                this.connectionsProvider.getByUrl(this.currentPage.getNextPageId());\n            }\n        }\n    }\n\n    public read(): IConnection {\n        if (this.closed) {\n            return undefined;\n        }\n\n        if (this.waiting) {\n            // waiting for the next page to be fetched\n            this.readable = false;\n            return undefined;\n        }\n\n        if (this.currentIndex >= this.currentPage.getConnections().length) {\n            // end of this page, fetch the next one\n            this.fetchPage(this.currentPage.getNextPageId());\n            return undefined;\n        }\n\n        const item = this.currentPage.getConnections()[this.currentIndex];\n        this.currentIndex += 1;\n\n        if (this.options.upperBoundDate && item.departureTime > this.options.upperBoundDate) {\n            // no more relevant connections\n            this.close();\n        }\n\n        return item;\n    }\n}\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","/*! @license ©2013 Ruben Verborgh, 2016 Pieter Colpaert - Data Science Lab / iMinds / Ghent University */\n/** A HttpFetcher downloads documents through HTTP. This is the browser implementation */\n\nvar q = require('q'),\n  http = require('http'),\n  https = require('https'),\n  util = require('util'),\n  URLParser = require('url'),\n  EventEmitter = require('events');\n\n// Creates a new HttpFetcher - maxParallel is handled by the browser, so we'll ignore it\nfunction HttpFetcher(accept, customHeaders) {\n  EventEmitter.call(this);\n  this._accept = accept || 'application/ld+json;q=1.0';\n  this._customHeaders = customHeaders || {};\n}\n\nutil.inherits(HttpFetcher, EventEmitter);\n\n// Returns a promise for the HTTP GET request's result\nHttpFetcher.prototype.get = function (url) {\n  return this.request(url, 'GET');\n};\n\n// Returns a promise for the HTTP request's result\nHttpFetcher.prototype.request = function (url, methodName) {\n  this.emit('request', url);\n  var method = methodName || 'GET', requestId = methodName + url;\n\n  var self = this, deferred = q.defer();\n  var parsedUrl = URLParser.parse(url);\n  var headers = { 'Accept': this._accept };\n  if (Object.keys(self._customHeaders).length > 0) {\n    for (let [k, v] of Object.entries(self._customHeaders)) {\n      headers[k] = v;\n    }\n  }\n  var settings = { hostname: parsedUrl.hostname, port: parsedUrl.port, path: parsedUrl.path, headers: headers, withCredentials: false, method: method };\n\n  var executionResponse = function (res) {\n    var responseStream = res;\n    var responseBody = '';\n    var chunks = [];\n    var totalBytes = 0;\n    responseStream.on('data', function (chunk) {\n      totalBytes += chunk.length;\n      chunks.push(chunk);\n    });\n    res.on('error', function (error) {\n      onResponse(error);\n    });\n    responseStream.on('end', function () {\n      //TODO: this count is after extraction from e.g., gzip...\n      self.emit('downloaded', { url: url, totalBytes: totalBytes });\n      onResponse(null, res, chunks.join(''));\n    })\n  };\n  var request = {};\n  if (parsedUrl.protocol === 'https:') {\n    request = https.request(settings, executionResponse);\n  } else if (parsedUrl.protocol === 'http:') {\n    request = http.request(settings, executionResponse);\n  } else {\n    console.error('Only http or https supported. Not ' + parsedUrl.protocol);\n  }\n  request.on('error', function (e) {\n    deferred.reject(e);\n  });\n  request.end(null);\n\n  // Response callback\n  function onResponse(error, response, body) {\n    // Hack to get the in browser response URL after redirects\n    // Different responses with 2 different modes: fetch and xhr\n    // See also: https://github.com/jhiesey/stream-http/issues/39\n    var responseUrl;\n    if (request._xhr) {\n      responseUrl = request._xhr.responseURL;\n    } else {\n      responseUrl = request._fetchResponse.url;\n    }\n    self.emit('response', responseUrl);\n    // Return result through the deferred\n    if (error) {\n      return deferred.reject(new Error(error));\n    }\n    if (response.statusCode >= 500) {\n      return deferred.reject(new Error('Request failed: ' + url));\n    }\n    var contentType = /^[^;]+/.exec(response.headers['content-type'] || 'text/html')[0];\n    // for the url, take the last redirect url that can be found if there was a redirect\n    deferred.resolve({ url: responseUrl, type: contentType, body: body, status: response.statusCode });\n  }\n  return deferred.promise;\n};\n\n// Cancels all pending requests\nHttpFetcher.prototype.cancelAll = function () {\n};\n\nmodule.exports = HttpFetcher;\n","var capability = require('./capability')\nvar inherits = require('inherits')\nvar response = require('./response')\nvar stream = require('readable-stream')\nvar toArrayBuffer = require('to-arraybuffer')\n\nvar IncomingMessage = response.IncomingMessage\nvar rStates = response.readyStates\n\nfunction decideMode (preferBinary, useFetch) {\n\tif (capability.fetch && useFetch) {\n\t\treturn 'fetch'\n\t} else if (capability.mozchunkedarraybuffer) {\n\t\treturn 'moz-chunked-arraybuffer'\n\t} else if (capability.msstream) {\n\t\treturn 'ms-stream'\n\t} else if (capability.arraybuffer && preferBinary) {\n\t\treturn 'arraybuffer'\n\t} else if (capability.vbArray && preferBinary) {\n\t\treturn 'text:vbarray'\n\t} else {\n\t\treturn 'text'\n\t}\n}\n\nvar ClientRequest = module.exports = function (opts) {\n\tvar self = this\n\tstream.Writable.call(self)\n\n\tself._opts = opts\n\tself._body = []\n\tself._headers = {}\n\tif (opts.auth)\n\t\tself.setHeader('Authorization', 'Basic ' + new Buffer(opts.auth).toString('base64'))\n\tObject.keys(opts.headers).forEach(function (name) {\n\t\tself.setHeader(name, opts.headers[name])\n\t})\n\n\tvar preferBinary\n\tvar useFetch = true\n\tif (opts.mode === 'disable-fetch' || ('requestTimeout' in opts && !capability.abortController)) {\n\t\t// If the use of XHR should be preferred. Not typically needed.\n\t\tuseFetch = false\n\t\tpreferBinary = true\n\t} else if (opts.mode === 'prefer-streaming') {\n\t\t// If streaming is a high priority but binary compatibility and\n\t\t// the accuracy of the 'content-type' header aren't\n\t\tpreferBinary = false\n\t} else if (opts.mode === 'allow-wrong-content-type') {\n\t\t// If streaming is more important than preserving the 'content-type' header\n\t\tpreferBinary = !capability.overrideMimeType\n\t} else if (!opts.mode || opts.mode === 'default' || opts.mode === 'prefer-fast') {\n\t\t// Use binary if text streaming may corrupt data or the content-type header, or for speed\n\t\tpreferBinary = true\n\t} else {\n\t\tthrow new Error('Invalid value for opts.mode')\n\t}\n\tself._mode = decideMode(preferBinary, useFetch)\n\tself._fetchTimer = null\n\n\tself.on('finish', function () {\n\t\tself._onFinish()\n\t})\n}\n\ninherits(ClientRequest, stream.Writable)\n\nClientRequest.prototype.setHeader = function (name, value) {\n\tvar self = this\n\tvar lowerName = name.toLowerCase()\n\t// This check is not necessary, but it prevents warnings from browsers about setting unsafe\n\t// headers. To be honest I'm not entirely sure hiding these warnings is a good thing, but\n\t// http-browserify did it, so I will too.\n\tif (unsafeHeaders.indexOf(lowerName) !== -1)\n\t\treturn\n\n\tself._headers[lowerName] = {\n\t\tname: name,\n\t\tvalue: value\n\t}\n}\n\nClientRequest.prototype.getHeader = function (name) {\n\tvar header = this._headers[name.toLowerCase()]\n\tif (header)\n\t\treturn header.value\n\treturn null\n}\n\nClientRequest.prototype.removeHeader = function (name) {\n\tvar self = this\n\tdelete self._headers[name.toLowerCase()]\n}\n\nClientRequest.prototype._onFinish = function () {\n\tvar self = this\n\n\tif (self._destroyed)\n\t\treturn\n\tvar opts = self._opts\n\n\tvar headersObj = self._headers\n\tvar body = null\n\tif (opts.method !== 'GET' && opts.method !== 'HEAD') {\n\t\tif (capability.arraybuffer) {\n\t\t\tbody = toArrayBuffer(Buffer.concat(self._body))\n\t\t} else if (capability.blobConstructor) {\n\t\t\tbody = new global.Blob(self._body.map(function (buffer) {\n\t\t\t\treturn toArrayBuffer(buffer)\n\t\t\t}), {\n\t\t\t\ttype: (headersObj['content-type'] || {}).value || ''\n\t\t\t})\n\t\t} else {\n\t\t\t// get utf8 string\n\t\t\tbody = Buffer.concat(self._body).toString()\n\t\t}\n\t}\n\n\t// create flattened list of headers\n\tvar headersList = []\n\tObject.keys(headersObj).forEach(function (keyName) {\n\t\tvar name = headersObj[keyName].name\n\t\tvar value = headersObj[keyName].value\n\t\tif (Array.isArray(value)) {\n\t\t\tvalue.forEach(function (v) {\n\t\t\t\theadersList.push([name, v])\n\t\t\t})\n\t\t} else {\n\t\t\theadersList.push([name, value])\n\t\t}\n\t})\n\n\tif (self._mode === 'fetch') {\n\t\tvar signal = null\n\t\tvar fetchTimer = null\n\t\tif (capability.abortController) {\n\t\t\tvar controller = new AbortController()\n\t\t\tsignal = controller.signal\n\t\t\tself._fetchAbortController = controller\n\n\t\t\tif ('requestTimeout' in opts && opts.requestTimeout !== 0) {\n\t\t\t\tself._fetchTimer = global.setTimeout(function () {\n\t\t\t\t\tself.emit('requestTimeout')\n\t\t\t\t\tif (self._fetchAbortController)\n\t\t\t\t\t\tself._fetchAbortController.abort()\n\t\t\t\t}, opts.requestTimeout)\n\t\t\t}\n\t\t}\n\n\t\tglobal.fetch(self._opts.url, {\n\t\t\tmethod: self._opts.method,\n\t\t\theaders: headersList,\n\t\t\tbody: body || undefined,\n\t\t\tmode: 'cors',\n\t\t\tcredentials: opts.withCredentials ? 'include' : 'same-origin',\n\t\t\tsignal: signal\n\t\t}).then(function (response) {\n\t\t\tself._fetchResponse = response\n\t\t\tself._connect()\n\t\t}, function (reason) {\n\t\t\tglobal.clearTimeout(self._fetchTimer)\n\t\t\tif (!self._destroyed)\n\t\t\t\tself.emit('error', reason)\n\t\t})\n\t} else {\n\t\tvar xhr = self._xhr = new global.XMLHttpRequest()\n\t\ttry {\n\t\t\txhr.open(self._opts.method, self._opts.url, true)\n\t\t} catch (err) {\n\t\t\tprocess.nextTick(function () {\n\t\t\t\tself.emit('error', err)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\t// Can't set responseType on really old browsers\n\t\tif ('responseType' in xhr)\n\t\t\txhr.responseType = self._mode.split(':')[0]\n\n\t\tif ('withCredentials' in xhr)\n\t\t\txhr.withCredentials = !!opts.withCredentials\n\n\t\tif (self._mode === 'text' && 'overrideMimeType' in xhr)\n\t\t\txhr.overrideMimeType('text/plain; charset=x-user-defined')\n\n\t\tif ('requestTimeout' in opts) {\n\t\t\txhr.timeout = opts.requestTimeout\n\t\t\txhr.ontimeout = function () {\n\t\t\t\tself.emit('requestTimeout')\n\t\t\t}\n\t\t}\n\n\t\theadersList.forEach(function (header) {\n\t\t\txhr.setRequestHeader(header[0], header[1])\n\t\t})\n\n\t\tself._response = null\n\t\txhr.onreadystatechange = function () {\n\t\t\tswitch (xhr.readyState) {\n\t\t\t\tcase rStates.LOADING:\n\t\t\t\tcase rStates.DONE:\n\t\t\t\t\tself._onXHRProgress()\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\t// Necessary for streaming in Firefox, since xhr.response is ONLY defined\n\t\t// in onprogress, not in onreadystatechange with xhr.readyState = 3\n\t\tif (self._mode === 'moz-chunked-arraybuffer') {\n\t\t\txhr.onprogress = function () {\n\t\t\t\tself._onXHRProgress()\n\t\t\t}\n\t\t}\n\n\t\txhr.onerror = function () {\n\t\t\tif (self._destroyed)\n\t\t\t\treturn\n\t\t\tself.emit('error', new Error('XHR error'))\n\t\t}\n\n\t\ttry {\n\t\t\txhr.send(body)\n\t\t} catch (err) {\n\t\t\tprocess.nextTick(function () {\n\t\t\t\tself.emit('error', err)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t}\n}\n\n/**\n * Checks if xhr.status is readable and non-zero, indicating no error.\n * Even though the spec says it should be available in readyState 3,\n * accessing it throws an exception in IE8\n */\nfunction statusValid (xhr) {\n\ttry {\n\t\tvar status = xhr.status\n\t\treturn (status !== null && status !== 0)\n\t} catch (e) {\n\t\treturn false\n\t}\n}\n\nClientRequest.prototype._onXHRProgress = function () {\n\tvar self = this\n\n\tif (!statusValid(self._xhr) || self._destroyed)\n\t\treturn\n\n\tif (!self._response)\n\t\tself._connect()\n\n\tself._response._onXHRProgress()\n}\n\nClientRequest.prototype._connect = function () {\n\tvar self = this\n\n\tif (self._destroyed)\n\t\treturn\n\n\tself._response = new IncomingMessage(self._xhr, self._fetchResponse, self._mode, self._fetchTimer)\n\tself._response.on('error', function(err) {\n\t\tself.emit('error', err)\n\t})\n\n\tself.emit('response', self._response)\n}\n\nClientRequest.prototype._write = function (chunk, encoding, cb) {\n\tvar self = this\n\n\tself._body.push(chunk)\n\tcb()\n}\n\nClientRequest.prototype.abort = ClientRequest.prototype.destroy = function () {\n\tvar self = this\n\tself._destroyed = true\n\tglobal.clearTimeout(self._fetchTimer)\n\tif (self._response)\n\t\tself._response._destroyed = true\n\tif (self._xhr)\n\t\tself._xhr.abort()\n\telse if (self._fetchAbortController)\n\t\tself._fetchAbortController.abort()\n}\n\nClientRequest.prototype.end = function (data, encoding, cb) {\n\tvar self = this\n\tif (typeof data === 'function') {\n\t\tcb = data\n\t\tdata = undefined\n\t}\n\n\tstream.Writable.prototype.end.call(self, data, encoding, cb)\n}\n\nClientRequest.prototype.flushHeaders = function () {}\nClientRequest.prototype.setTimeout = function () {}\nClientRequest.prototype.setNoDelay = function () {}\nClientRequest.prototype.setSocketKeepAlive = function () {}\n\n// Taken from http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader%28%29-method\nvar unsafeHeaders = [\n\t'accept-charset',\n\t'accept-encoding',\n\t'access-control-request-headers',\n\t'access-control-request-method',\n\t'connection',\n\t'content-length',\n\t'cookie',\n\t'cookie2',\n\t'date',\n\t'dnt',\n\t'expect',\n\t'host',\n\t'keep-alive',\n\t'origin',\n\t'referer',\n\t'te',\n\t'trailer',\n\t'transfer-encoding',\n\t'upgrade',\n\t'via'\n]\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Buffer = require('safe-buffer').Buffer;\nvar util = require('util');\n\nfunction copyBuffer(src, target, offset) {\n  src.copy(target, offset);\n}\n\nmodule.exports = function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n\n  BufferList.prototype.push = function push(v) {\n    var entry = { data: v, next: null };\n    if (this.length > 0) this.tail.next = entry;else this.head = entry;\n    this.tail = entry;\n    ++this.length;\n  };\n\n  BufferList.prototype.unshift = function unshift(v) {\n    var entry = { data: v, next: this.head };\n    if (this.length === 0) this.tail = entry;\n    this.head = entry;\n    ++this.length;\n  };\n\n  BufferList.prototype.shift = function shift() {\n    if (this.length === 0) return;\n    var ret = this.head.data;\n    if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n    --this.length;\n    return ret;\n  };\n\n  BufferList.prototype.clear = function clear() {\n    this.head = this.tail = null;\n    this.length = 0;\n  };\n\n  BufferList.prototype.join = function join(s) {\n    if (this.length === 0) return '';\n    var p = this.head;\n    var ret = '' + p.data;\n    while (p = p.next) {\n      ret += s + p.data;\n    }return ret;\n  };\n\n  BufferList.prototype.concat = function concat(n) {\n    if (this.length === 0) return Buffer.alloc(0);\n    if (this.length === 1) return this.head.data;\n    var ret = Buffer.allocUnsafe(n >>> 0);\n    var p = this.head;\n    var i = 0;\n    while (p) {\n      copyBuffer(p.data, ret, i);\n      i += p.data.length;\n      p = p.next;\n    }\n    return ret;\n  };\n\n  return BufferList;\n}();\n\nif (util && util.inspect && util.inspect.custom) {\n  module.exports.prototype[util.inspect.custom] = function () {\n    var obj = util.inspect({ length: this.length });\n    return this.constructor.name + ' ' + obj;\n  };\n}","\n/**\n * Module exports.\n */\n\nmodule.exports = deprecate;\n\n/**\n * Mark that a method should not be used.\n * Returns a modified function which warns once by default.\n *\n * If `localStorage.noDeprecation = true` is set, then it is a no-op.\n *\n * If `localStorage.throwDeprecation = true` is set, then deprecated functions\n * will throw an Error when invoked.\n *\n * If `localStorage.traceDeprecation = true` is set, then deprecated functions\n * will invoke `console.trace()` instead of `console.error()`.\n *\n * @param {Function} fn - the function to deprecate\n * @param {String} msg - the string to print to the console when `fn` is invoked\n * @returns {Function} a new \"deprecated\" version of `fn`\n * @api public\n */\n\nfunction deprecate (fn, msg) {\n  if (config('noDeprecation')) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (config('throwDeprecation')) {\n        throw new Error(msg);\n      } else if (config('traceDeprecation')) {\n        console.trace(msg);\n      } else {\n        console.warn(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n}\n\n/**\n * Checks `localStorage` for boolean values for the given `name`.\n *\n * @param {String} name\n * @returns {Boolean}\n * @api private\n */\n\nfunction config (name) {\n  // accessing global.localStorage can trigger a DOMException in sandboxed iframes\n  try {\n    if (!global.localStorage) return false;\n  } catch (_) {\n    return false;\n  }\n  var val = global.localStorage[name];\n  if (null == val) return false;\n  return String(val).toLowerCase() === 'true';\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\n\nvar Transform = require('./_stream_transform');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(PassThrough, Transform);\n\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n\n  Transform.call(this, options);\n}\n\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","var Buffer = require('buffer').Buffer\n\nmodule.exports = function (buf) {\n\t// If the buffer is backed by a Uint8Array, a faster version will work\n\tif (buf instanceof Uint8Array) {\n\t\t// If the buffer isn't a subarray, return the underlying ArrayBuffer\n\t\tif (buf.byteOffset === 0 && buf.byteLength === buf.buffer.byteLength) {\n\t\t\treturn buf.buffer\n\t\t} else if (typeof buf.buffer.slice === 'function') {\n\t\t\t// Otherwise we need to get a proper copy\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength)\n\t\t}\n\t}\n\n\tif (Buffer.isBuffer(buf)) {\n\t\t// This is the slow version that will work with any Buffer\n\t\t// implementation (even in old browsers)\n\t\tvar arrayCopy = new Uint8Array(buf.length)\n\t\tvar len = buf.length\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tarrayCopy[i] = buf[i]\n\t\t}\n\t\treturn arrayCopy.buffer\n\t} else {\n\t\tthrow new Error('Argument must be a Buffer')\n\t}\n}\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","module.exports = {\n  \"100\": \"Continue\",\n  \"101\": \"Switching Protocols\",\n  \"102\": \"Processing\",\n  \"200\": \"OK\",\n  \"201\": \"Created\",\n  \"202\": \"Accepted\",\n  \"203\": \"Non-Authoritative Information\",\n  \"204\": \"No Content\",\n  \"205\": \"Reset Content\",\n  \"206\": \"Partial Content\",\n  \"207\": \"Multi-Status\",\n  \"208\": \"Already Reported\",\n  \"226\": \"IM Used\",\n  \"300\": \"Multiple Choices\",\n  \"301\": \"Moved Permanently\",\n  \"302\": \"Found\",\n  \"303\": \"See Other\",\n  \"304\": \"Not Modified\",\n  \"305\": \"Use Proxy\",\n  \"307\": \"Temporary Redirect\",\n  \"308\": \"Permanent Redirect\",\n  \"400\": \"Bad Request\",\n  \"401\": \"Unauthorized\",\n  \"402\": \"Payment Required\",\n  \"403\": \"Forbidden\",\n  \"404\": \"Not Found\",\n  \"405\": \"Method Not Allowed\",\n  \"406\": \"Not Acceptable\",\n  \"407\": \"Proxy Authentication Required\",\n  \"408\": \"Request Timeout\",\n  \"409\": \"Conflict\",\n  \"410\": \"Gone\",\n  \"411\": \"Length Required\",\n  \"412\": \"Precondition Failed\",\n  \"413\": \"Payload Too Large\",\n  \"414\": \"URI Too Long\",\n  \"415\": \"Unsupported Media Type\",\n  \"416\": \"Range Not Satisfiable\",\n  \"417\": \"Expectation Failed\",\n  \"418\": \"I'm a teapot\",\n  \"421\": \"Misdirected Request\",\n  \"422\": \"Unprocessable Entity\",\n  \"423\": \"Locked\",\n  \"424\": \"Failed Dependency\",\n  \"425\": \"Unordered Collection\",\n  \"426\": \"Upgrade Required\",\n  \"428\": \"Precondition Required\",\n  \"429\": \"Too Many Requests\",\n  \"431\": \"Request Header Fields Too Large\",\n  \"451\": \"Unavailable For Legal Reasons\",\n  \"500\": \"Internal Server Error\",\n  \"501\": \"Not Implemented\",\n  \"502\": \"Bad Gateway\",\n  \"503\": \"Service Unavailable\",\n  \"504\": \"Gateway Timeout\",\n  \"505\": \"HTTP Version Not Supported\",\n  \"506\": \"Variant Also Negotiates\",\n  \"507\": \"Insufficient Storage\",\n  \"508\": \"Loop Detected\",\n  \"509\": \"Bandwidth Limit Exceeded\",\n  \"510\": \"Not Extended\",\n  \"511\": \"Network Authentication Required\"\n}\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","var http = require('http')\nvar url = require('url')\n\nvar https = module.exports\n\nfor (var key in http) {\n  if (http.hasOwnProperty(key)) https[key] = http[key]\n}\n\nhttps.request = function (params, cb) {\n  params = validateParams(params)\n  return http.request.call(this, params, cb)\n}\n\nhttps.get = function (params, cb) {\n  params = validateParams(params)\n  return http.get.call(this, params, cb)\n}\n\nfunction validateParams (params) {\n  if (typeof params === 'string') {\n    params = url.parse(params)\n  }\n  if (!params.protocol) {\n    params.protocol = 'https:'\n  }\n  if (params.protocol !== 'https:') {\n    throw new Error('Protocol \"' + params.protocol + '\" not supported. Expected \"https:\"')\n  }\n  return params\n}\n","const jsonld = require('jsonld');\nconst DataFactory = require('@rdfjs/data-model')\n\nmodule.exports = class {\n\n  constructor (options) {\n    this.documentIRI = options.documentIRI;\n    this.factory = options.factory || DataFactory;\n  }\n  \n  term (plainTerm) {\n    switch (plainTerm.termType) {\n      case 'NamedNode':\n        return DataFactory.namedNode(plainTerm.value)\n      case 'BlankNode':\n        return DataFactory.blankNode(plainTerm.value.substr(2))\n      case 'Literal':\n        return DataFactory.literal(plainTerm.value, plainTerm.language || DataFactory.namedNode(plainTerm.datatype.value))\n      case 'DefaultGraph':\n        return DataFactory.defaultGraph()\n      default:\n        throw Error('unknown termType: ' + plainTerm.termType)\n    }\n  }\n  \n  addEqualsMethodToQuad (quad) {\n    quad.subject = this.term(quad.subject);\n    quad.predicate = this.term(quad.predicate);\n    quad.object = this.term(quad.object);\n    quad.graph = this.term(quad.graph);\n    return quad;\n  }\n\n  parse (document, callback) {\n    jsonld.toRDF(JSON.parse(document), {base: this.documentIRI}, (error, quads) => {\n      for (var index in quads) {\n        var quad = quads[index];\n        \n        callback(null, this.addEqualsMethodToQuad(quad));\n        if (index == quads.length-1 ) {\n          //This is the end\n          callback(null, null);\n        }\n      }\n      if (error) {\n        callback(error);\n      }\n    });\n  }\n}\n","/**\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst util = require('./util');\n\nmodule.exports = class AsyncAlgorithm {\n  constructor({\n    maxCallStackDepth = 500,\n    maxTotalCallStackDepth = 0xFFFFFFFF,\n    // milliseconds\n    timeSlice = 10\n  } = {}) {\n    this.schedule = {};\n    this.schedule.MAX_DEPTH = maxCallStackDepth;\n    this.schedule.MAX_TOTAL_DEPTH = maxTotalCallStackDepth;\n    this.schedule.depth = 0;\n    this.schedule.totalDepth = 0;\n    this.schedule.timeSlice = timeSlice;\n  }\n\n  // do some work in a time slice, but in serial\n  doWork(fn, callback) {\n    const schedule = this.schedule;\n\n    if(schedule.totalDepth >= schedule.MAX_TOTAL_DEPTH) {\n      return callback(new Error(\n        'Maximum total call stack depth exceeded; canonicalization aborting.'));\n    }\n\n    (function work() {\n      if(schedule.depth === schedule.MAX_DEPTH) {\n        // stack too deep, run on next tick\n        schedule.depth = 0;\n        schedule.running = false;\n        return util.nextTick(work);\n      }\n\n      // if not yet running, force run\n      const now = Date.now();\n      if(!schedule.running) {\n        schedule.start = Date.now();\n        schedule.deadline = schedule.start + schedule.timeSlice;\n      }\n\n      // TODO: should also include an estimate of expectedWorkTime\n      if(now < schedule.deadline) {\n        schedule.running = true;\n        schedule.depth++;\n        schedule.totalDepth++;\n        return fn((err, result) => {\n          schedule.depth--;\n          schedule.totalDepth--;\n          callback(err, result);\n        });\n      }\n\n      // not enough time left in this slice, run after letting browser\n      // do some other things\n      schedule.depth = 0;\n      schedule.running = false;\n      util.setImmediate(work);\n    })();\n  }\n\n  // asynchronously loop\n  forEach(iterable, fn, callback) {\n    const self = this;\n    let iterator;\n    let idx = 0;\n    let length;\n    if(Array.isArray(iterable)) {\n      length = iterable.length;\n      iterator = () => {\n        if(idx === length) {\n          return false;\n        }\n        iterator.value = iterable[idx++];\n        iterator.key = idx;\n        return true;\n      };\n    } else {\n      const keys = Object.keys(iterable);\n      length = keys.length;\n      iterator = () => {\n        if(idx === length) {\n          return false;\n        }\n        iterator.key = keys[idx++];\n        iterator.value = iterable[iterator.key];\n        return true;\n      };\n    }\n\n    (function iterate(err) {\n      if(err) {\n        return callback(err);\n      }\n      if(iterator()) {\n        return self.doWork(() => fn(iterator.value, iterator.key, iterate));\n      }\n      callback();\n    })();\n  }\n\n  // asynchronous waterfall\n  waterfall(fns, callback) {\n    const self = this;\n    self.forEach(\n      fns, (fn, idx, callback) => self.doWork(fn, callback), callback);\n  }\n\n  // asynchronous while\n  whilst(condition, fn, callback) {\n    const self = this;\n    (function loop(err) {\n      if(err) {\n        return callback(err);\n      }\n      if(!condition()) {\n        return callback();\n      }\n      self.doWork(fn, loop);\n    })();\n  }\n};\n","/**\n * Secure Hash Algorithm with 160-bit digest (SHA-1) implementation.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2015 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./md');\nrequire('./util');\n\nvar sha1 = module.exports = forge.sha1 = forge.sha1 || {};\nforge.md.sha1 = forge.md.algorithms.sha1 = sha1;\n\n/**\n * Creates a SHA-1 message digest object.\n *\n * @return a message digest object.\n */\nsha1.create = function() {\n  // do initialization as necessary\n  if(!_initialized) {\n    _init();\n  }\n\n  // SHA-1 state contains five 32-bit integers\n  var _state = null;\n\n  // input buffer\n  var _input = forge.util.createBuffer();\n\n  // used for word storage\n  var _w = new Array(80);\n\n  // message digest object\n  var md = {\n    algorithm: 'sha1',\n    blockLength: 64,\n    digestLength: 20,\n    // 56-bit length of message so far (does not including padding)\n    messageLength: 0,\n    // true message length\n    fullMessageLength: null,\n    // size of message length in bytes\n    messageLengthSize: 8\n  };\n\n  /**\n   * Starts the digest.\n   *\n   * @return this digest object.\n   */\n  md.start = function() {\n    // up to 56-bit message length for convenience\n    md.messageLength = 0;\n\n    // full message length (set md.messageLength64 for backwards-compatibility)\n    md.fullMessageLength = md.messageLength64 = [];\n    var int32s = md.messageLengthSize / 4;\n    for(var i = 0; i < int32s; ++i) {\n      md.fullMessageLength.push(0);\n    }\n    _input = forge.util.createBuffer();\n    _state = {\n      h0: 0x67452301,\n      h1: 0xEFCDAB89,\n      h2: 0x98BADCFE,\n      h3: 0x10325476,\n      h4: 0xC3D2E1F0\n    };\n    return md;\n  };\n  // start digest automatically for first time\n  md.start();\n\n  /**\n   * Updates the digest with the given message input. The given input can\n   * treated as raw input (no encoding will be applied) or an encoding of\n   * 'utf8' maybe given to encode the input using UTF-8.\n   *\n   * @param msg the message input to update with.\n   * @param encoding the encoding to use (default: 'raw', other: 'utf8').\n   *\n   * @return this digest object.\n   */\n  md.update = function(msg, encoding) {\n    if(encoding === 'utf8') {\n      msg = forge.util.encodeUtf8(msg);\n    }\n\n    // update message length\n    var len = msg.length;\n    md.messageLength += len;\n    len = [(len / 0x100000000) >>> 0, len >>> 0];\n    for(var i = md.fullMessageLength.length - 1; i >= 0; --i) {\n      md.fullMessageLength[i] += len[1];\n      len[1] = len[0] + ((md.fullMessageLength[i] / 0x100000000) >>> 0);\n      md.fullMessageLength[i] = md.fullMessageLength[i] >>> 0;\n      len[0] = ((len[1] / 0x100000000) >>> 0);\n    }\n\n    // add bytes to input buffer\n    _input.putBytes(msg);\n\n    // process bytes\n    _update(_state, _w, _input);\n\n    // compact input buffer every 2K or if empty\n    if(_input.read > 2048 || _input.length() === 0) {\n      _input.compact();\n    }\n\n    return md;\n  };\n\n  /**\n   * Produces the digest.\n   *\n   * @return a byte buffer containing the digest value.\n   */\n  md.digest = function() {\n    /* Note: Here we copy the remaining bytes in the input buffer and\n    add the appropriate SHA-1 padding. Then we do the final update\n    on a copy of the state so that if the user wants to get\n    intermediate digests they can do so. */\n\n    /* Determine the number of bytes that must be added to the message\n    to ensure its length is congruent to 448 mod 512. In other words,\n    the data to be digested must be a multiple of 512 bits (or 128 bytes).\n    This data includes the message, some padding, and the length of the\n    message. Since the length of the message will be encoded as 8 bytes (64\n    bits), that means that the last segment of the data must have 56 bytes\n    (448 bits) of message and padding. Therefore, the length of the message\n    plus the padding must be congruent to 448 mod 512 because\n    512 - 128 = 448.\n\n    In order to fill up the message length it must be filled with\n    padding that begins with 1 bit followed by all 0 bits. Padding\n    must *always* be present, so if the message length is already\n    congruent to 448 mod 512, then 512 padding bits must be added. */\n\n    var finalBlock = forge.util.createBuffer();\n    finalBlock.putBytes(_input.bytes());\n\n    // compute remaining size to be digested (include message length size)\n    var remaining = (\n      md.fullMessageLength[md.fullMessageLength.length - 1] +\n      md.messageLengthSize);\n\n    // add padding for overflow blockSize - overflow\n    // _padding starts with 1 byte with first bit is set (byte value 128), then\n    // there may be up to (blockSize - 1) other pad bytes\n    var overflow = remaining & (md.blockLength - 1);\n    finalBlock.putBytes(_padding.substr(0, md.blockLength - overflow));\n\n    // serialize message length in bits in big-endian order; since length\n    // is stored in bytes we multiply by 8 and add carry from next int\n    var next, carry;\n    var bits = md.fullMessageLength[0] * 8;\n    for(var i = 0; i < md.fullMessageLength.length - 1; ++i) {\n      next = md.fullMessageLength[i + 1] * 8;\n      carry = (next / 0x100000000) >>> 0;\n      bits += carry;\n      finalBlock.putInt32(bits >>> 0);\n      bits = next >>> 0;\n    }\n    finalBlock.putInt32(bits);\n\n    var s2 = {\n      h0: _state.h0,\n      h1: _state.h1,\n      h2: _state.h2,\n      h3: _state.h3,\n      h4: _state.h4\n    };\n    _update(s2, _w, finalBlock);\n    var rval = forge.util.createBuffer();\n    rval.putInt32(s2.h0);\n    rval.putInt32(s2.h1);\n    rval.putInt32(s2.h2);\n    rval.putInt32(s2.h3);\n    rval.putInt32(s2.h4);\n    return rval;\n  };\n\n  return md;\n};\n\n// sha-1 padding bytes not initialized yet\nvar _padding = null;\nvar _initialized = false;\n\n/**\n * Initializes the constant tables.\n */\nfunction _init() {\n  // create padding\n  _padding = String.fromCharCode(128);\n  _padding += forge.util.fillString(String.fromCharCode(0x00), 64);\n\n  // now initialized\n  _initialized = true;\n}\n\n/**\n * Updates a SHA-1 state with the given byte buffer.\n *\n * @param s the SHA-1 state to update.\n * @param w the array to use to store words.\n * @param bytes the byte buffer to update with.\n */\nfunction _update(s, w, bytes) {\n  // consume 512 bit (64 byte) chunks\n  var t, a, b, c, d, e, f, i;\n  var len = bytes.length();\n  while(len >= 64) {\n    // the w array will be populated with sixteen 32-bit big-endian words\n    // and then extended into 80 32-bit words according to SHA-1 algorithm\n    // and for 32-79 using Max Locktyukhin's optimization\n\n    // initialize hash value for this chunk\n    a = s.h0;\n    b = s.h1;\n    c = s.h2;\n    d = s.h3;\n    e = s.h4;\n\n    // round 1\n    for(i = 0; i < 16; ++i) {\n      t = bytes.getInt32();\n      w[i] = t;\n      f = d ^ (b & (c ^ d));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x5A827999 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    for(; i < 20; ++i) {\n      t = (w[i - 3] ^ w[i - 8] ^ w[i - 14] ^ w[i - 16]);\n      t = (t << 1) | (t >>> 31);\n      w[i] = t;\n      f = d ^ (b & (c ^ d));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x5A827999 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 2\n    for(; i < 32; ++i) {\n      t = (w[i - 3] ^ w[i - 8] ^ w[i - 14] ^ w[i - 16]);\n      t = (t << 1) | (t >>> 31);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x6ED9EBA1 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    for(; i < 40; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x6ED9EBA1 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 3\n    for(; i < 60; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = (b & c) | (d & (b ^ c));\n      t = ((a << 5) | (a >>> 27)) + f + e + 0x8F1BBCDC + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n    // round 4\n    for(; i < 80; ++i) {\n      t = (w[i - 6] ^ w[i - 16] ^ w[i - 28] ^ w[i - 32]);\n      t = (t << 2) | (t >>> 30);\n      w[i] = t;\n      f = b ^ c ^ d;\n      t = ((a << 5) | (a >>> 27)) + f + e + 0xCA62C1D6 + t;\n      e = d;\n      d = c;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      c = ((b << 30) | (b >>> 2)) >>> 0;\n      b = a;\n      a = t;\n    }\n\n    // update hash state\n    s.h0 = (s.h0 + a) | 0;\n    s.h1 = (s.h1 + b) | 0;\n    s.h2 = (s.h2 + c) | 0;\n    s.h3 = (s.h3 + d) | 0;\n    s.h4 = (s.h4 + e) | 0;\n\n    len -= 64;\n  }\n}\n","/**\n * Base-N/Base-X encoding/decoding functions.\n *\n * Original implementation from base-x:\n * https://github.com/cryptocoinjs/base-x\n *\n * Which is MIT licensed:\n *\n * The MIT License (MIT)\n *\n * Copyright base-x contributors (c) 2016\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nvar api = {};\nmodule.exports = api;\n\n// baseN alphabet indexes\nvar _reverseAlphabets = {};\n\n/**\n * BaseN-encodes a Uint8Array using the given alphabet.\n *\n * @param input the Uint8Array to encode.\n * @param maxline the maximum number of encoded characters per line to use,\n *          defaults to none.\n *\n * @return the baseN-encoded output string.\n */\napi.encode = function(input, alphabet, maxline) {\n  if(typeof alphabet !== 'string') {\n    throw new TypeError('\"alphabet\" must be a string.');\n  }\n  if(maxline !== undefined && typeof maxline !== 'number') {\n    throw new TypeError('\"maxline\" must be a number.');\n  }\n\n  var output = '';\n\n  if(!(input instanceof Uint8Array)) {\n    // assume forge byte buffer\n    output = _encodeWithByteBuffer(input, alphabet);\n  } else {\n    var i = 0;\n    var base = alphabet.length;\n    var first = alphabet.charAt(0);\n    var digits = [0];\n    for(i = 0; i < input.length; ++i) {\n      for(var j = 0, carry = input[i]; j < digits.length; ++j) {\n        carry += digits[j] << 8;\n        digits[j] = carry % base;\n        carry = (carry / base) | 0;\n      }\n\n      while(carry > 0) {\n        digits.push(carry % base);\n        carry = (carry / base) | 0;\n      }\n    }\n\n    // deal with leading zeros\n    for(i = 0; input[i] === 0 && i < input.length - 1; ++i) {\n      output += first;\n    }\n    // convert digits to a string\n    for(i = digits.length - 1; i >= 0; --i) {\n      output += alphabet[digits[i]];\n    }\n  }\n\n  if(maxline) {\n    var regex = new RegExp('.{1,' + maxline + '}', 'g');\n    output = output.match(regex).join('\\r\\n');\n  }\n\n  return output;\n};\n\n/**\n * Decodes a baseN-encoded (using the given alphabet) string to a\n * Uint8Array.\n *\n * @param input the baseN-encoded input string.\n *\n * @return the Uint8Array.\n */\napi.decode = function(input, alphabet) {\n  if(typeof input !== 'string') {\n    throw new TypeError('\"input\" must be a string.');\n  }\n  if(typeof alphabet !== 'string') {\n    throw new TypeError('\"alphabet\" must be a string.');\n  }\n\n  var table = _reverseAlphabets[alphabet];\n  if(!table) {\n    // compute reverse alphabet\n    table = _reverseAlphabets[alphabet] = [];\n    for(var i = 0; i < alphabet.length; ++i) {\n      table[alphabet.charCodeAt(i)] = i;\n    }\n  }\n\n  // remove whitespace characters\n  input = input.replace(/\\s/g, '');\n\n  var base = alphabet.length;\n  var first = alphabet.charAt(0);\n  var bytes = [0];\n  for(var i = 0; i < input.length; i++) {\n    var value = table[input.charCodeAt(i)];\n    if(value === undefined) {\n      return;\n    }\n\n    for(var j = 0, carry = value; j < bytes.length; ++j) {\n      carry += bytes[j] * base;\n      bytes[j] = carry & 0xff;\n      carry >>= 8;\n    }\n\n    while(carry > 0) {\n      bytes.push(carry & 0xff);\n      carry >>= 8;\n    }\n  }\n\n  // deal with leading zeros\n  for(var k = 0; input[k] === first && k < input.length - 1; ++k) {\n    bytes.push(0);\n  }\n\n  if(typeof Buffer !== 'undefined') {\n    return Buffer.from(bytes.reverse());\n  }\n\n  return new Uint8Array(bytes.reverse());\n};\n\nfunction _encodeWithByteBuffer(input, alphabet) {\n  var i = 0;\n  var base = alphabet.length;\n  var first = alphabet.charAt(0);\n  var digits = [0];\n  for(i = 0; i < input.length(); ++i) {\n    for(var j = 0, carry = input.at(i); j < digits.length; ++j) {\n      carry += digits[j] << 8;\n      digits[j] = carry % base;\n      carry = (carry / base) | 0;\n    }\n\n    while(carry > 0) {\n      digits.push(carry % base);\n      carry = (carry / base) | 0;\n    }\n  }\n\n  var output = '';\n\n  // deal with leading zeros\n  for(i = 0; input.at(i) === 0 && i < input.length() - 1; ++i) {\n    output += first;\n  }\n  // convert digits to a string\n  for(i = digits.length - 1; i >= 0; --i) {\n    output += alphabet[digits[i]];\n  }\n\n  return output;\n}\n","/**\n * Secure Hash Algorithm with 256-bit digest (SHA-256) implementation.\n *\n * See FIPS 180-2 for details.\n *\n * @author Dave Longley\n *\n * Copyright (c) 2010-2015 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./md');\nrequire('./util');\n\nvar sha256 = module.exports = forge.sha256 = forge.sha256 || {};\nforge.md.sha256 = forge.md.algorithms.sha256 = sha256;\n\n/**\n * Creates a SHA-256 message digest object.\n *\n * @return a message digest object.\n */\nsha256.create = function() {\n  // do initialization as necessary\n  if(!_initialized) {\n    _init();\n  }\n\n  // SHA-256 state contains eight 32-bit integers\n  var _state = null;\n\n  // input buffer\n  var _input = forge.util.createBuffer();\n\n  // used for word storage\n  var _w = new Array(64);\n\n  // message digest object\n  var md = {\n    algorithm: 'sha256',\n    blockLength: 64,\n    digestLength: 32,\n    // 56-bit length of message so far (does not including padding)\n    messageLength: 0,\n    // true message length\n    fullMessageLength: null,\n    // size of message length in bytes\n    messageLengthSize: 8\n  };\n\n  /**\n   * Starts the digest.\n   *\n   * @return this digest object.\n   */\n  md.start = function() {\n    // up to 56-bit message length for convenience\n    md.messageLength = 0;\n\n    // full message length (set md.messageLength64 for backwards-compatibility)\n    md.fullMessageLength = md.messageLength64 = [];\n    var int32s = md.messageLengthSize / 4;\n    for(var i = 0; i < int32s; ++i) {\n      md.fullMessageLength.push(0);\n    }\n    _input = forge.util.createBuffer();\n    _state = {\n      h0: 0x6A09E667,\n      h1: 0xBB67AE85,\n      h2: 0x3C6EF372,\n      h3: 0xA54FF53A,\n      h4: 0x510E527F,\n      h5: 0x9B05688C,\n      h6: 0x1F83D9AB,\n      h7: 0x5BE0CD19\n    };\n    return md;\n  };\n  // start digest automatically for first time\n  md.start();\n\n  /**\n   * Updates the digest with the given message input. The given input can\n   * treated as raw input (no encoding will be applied) or an encoding of\n   * 'utf8' maybe given to encode the input using UTF-8.\n   *\n   * @param msg the message input to update with.\n   * @param encoding the encoding to use (default: 'raw', other: 'utf8').\n   *\n   * @return this digest object.\n   */\n  md.update = function(msg, encoding) {\n    if(encoding === 'utf8') {\n      msg = forge.util.encodeUtf8(msg);\n    }\n\n    // update message length\n    var len = msg.length;\n    md.messageLength += len;\n    len = [(len / 0x100000000) >>> 0, len >>> 0];\n    for(var i = md.fullMessageLength.length - 1; i >= 0; --i) {\n      md.fullMessageLength[i] += len[1];\n      len[1] = len[0] + ((md.fullMessageLength[i] / 0x100000000) >>> 0);\n      md.fullMessageLength[i] = md.fullMessageLength[i] >>> 0;\n      len[0] = ((len[1] / 0x100000000) >>> 0);\n    }\n\n    // add bytes to input buffer\n    _input.putBytes(msg);\n\n    // process bytes\n    _update(_state, _w, _input);\n\n    // compact input buffer every 2K or if empty\n    if(_input.read > 2048 || _input.length() === 0) {\n      _input.compact();\n    }\n\n    return md;\n  };\n\n  /**\n   * Produces the digest.\n   *\n   * @return a byte buffer containing the digest value.\n   */\n  md.digest = function() {\n    /* Note: Here we copy the remaining bytes in the input buffer and\n    add the appropriate SHA-256 padding. Then we do the final update\n    on a copy of the state so that if the user wants to get\n    intermediate digests they can do so. */\n\n    /* Determine the number of bytes that must be added to the message\n    to ensure its length is congruent to 448 mod 512. In other words,\n    the data to be digested must be a multiple of 512 bits (or 128 bytes).\n    This data includes the message, some padding, and the length of the\n    message. Since the length of the message will be encoded as 8 bytes (64\n    bits), that means that the last segment of the data must have 56 bytes\n    (448 bits) of message and padding. Therefore, the length of the message\n    plus the padding must be congruent to 448 mod 512 because\n    512 - 128 = 448.\n\n    In order to fill up the message length it must be filled with\n    padding that begins with 1 bit followed by all 0 bits. Padding\n    must *always* be present, so if the message length is already\n    congruent to 448 mod 512, then 512 padding bits must be added. */\n\n    var finalBlock = forge.util.createBuffer();\n    finalBlock.putBytes(_input.bytes());\n\n    // compute remaining size to be digested (include message length size)\n    var remaining = (\n      md.fullMessageLength[md.fullMessageLength.length - 1] +\n      md.messageLengthSize);\n\n    // add padding for overflow blockSize - overflow\n    // _padding starts with 1 byte with first bit is set (byte value 128), then\n    // there may be up to (blockSize - 1) other pad bytes\n    var overflow = remaining & (md.blockLength - 1);\n    finalBlock.putBytes(_padding.substr(0, md.blockLength - overflow));\n\n    // serialize message length in bits in big-endian order; since length\n    // is stored in bytes we multiply by 8 and add carry from next int\n    var next, carry;\n    var bits = md.fullMessageLength[0] * 8;\n    for(var i = 0; i < md.fullMessageLength.length - 1; ++i) {\n      next = md.fullMessageLength[i + 1] * 8;\n      carry = (next / 0x100000000) >>> 0;\n      bits += carry;\n      finalBlock.putInt32(bits >>> 0);\n      bits = next >>> 0;\n    }\n    finalBlock.putInt32(bits);\n\n    var s2 = {\n      h0: _state.h0,\n      h1: _state.h1,\n      h2: _state.h2,\n      h3: _state.h3,\n      h4: _state.h4,\n      h5: _state.h5,\n      h6: _state.h6,\n      h7: _state.h7\n    };\n    _update(s2, _w, finalBlock);\n    var rval = forge.util.createBuffer();\n    rval.putInt32(s2.h0);\n    rval.putInt32(s2.h1);\n    rval.putInt32(s2.h2);\n    rval.putInt32(s2.h3);\n    rval.putInt32(s2.h4);\n    rval.putInt32(s2.h5);\n    rval.putInt32(s2.h6);\n    rval.putInt32(s2.h7);\n    return rval;\n  };\n\n  return md;\n};\n\n// sha-256 padding bytes not initialized yet\nvar _padding = null;\nvar _initialized = false;\n\n// table of constants\nvar _k = null;\n\n/**\n * Initializes the constant tables.\n */\nfunction _init() {\n  // create padding\n  _padding = String.fromCharCode(128);\n  _padding += forge.util.fillString(String.fromCharCode(0x00), 64);\n\n  // create K table for SHA-256\n  _k = [\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,\n    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,\n    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,\n    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2];\n\n  // now initialized\n  _initialized = true;\n}\n\n/**\n * Updates a SHA-256 state with the given byte buffer.\n *\n * @param s the SHA-256 state to update.\n * @param w the array to use to store words.\n * @param bytes the byte buffer to update with.\n */\nfunction _update(s, w, bytes) {\n  // consume 512 bit (64 byte) chunks\n  var t1, t2, s0, s1, ch, maj, i, a, b, c, d, e, f, g, h;\n  var len = bytes.length();\n  while(len >= 64) {\n    // the w array will be populated with sixteen 32-bit big-endian words\n    // and then extended into 64 32-bit words according to SHA-256\n    for(i = 0; i < 16; ++i) {\n      w[i] = bytes.getInt32();\n    }\n    for(; i < 64; ++i) {\n      // XOR word 2 words ago rot right 17, rot right 19, shft right 10\n      t1 = w[i - 2];\n      t1 =\n        ((t1 >>> 17) | (t1 << 15)) ^\n        ((t1 >>> 19) | (t1 << 13)) ^\n        (t1 >>> 10);\n      // XOR word 15 words ago rot right 7, rot right 18, shft right 3\n      t2 = w[i - 15];\n      t2 =\n        ((t2 >>> 7) | (t2 << 25)) ^\n        ((t2 >>> 18) | (t2 << 14)) ^\n        (t2 >>> 3);\n      // sum(t1, word 7 ago, t2, word 16 ago) modulo 2^32\n      w[i] = (t1 + w[i - 7] + t2 + w[i - 16]) | 0;\n    }\n\n    // initialize hash value for this chunk\n    a = s.h0;\n    b = s.h1;\n    c = s.h2;\n    d = s.h3;\n    e = s.h4;\n    f = s.h5;\n    g = s.h6;\n    h = s.h7;\n\n    // round function\n    for(i = 0; i < 64; ++i) {\n      // Sum1(e)\n      s1 =\n        ((e >>> 6) | (e << 26)) ^\n        ((e >>> 11) | (e << 21)) ^\n        ((e >>> 25) | (e << 7));\n      // Ch(e, f, g) (optimized the same way as SHA-1)\n      ch = g ^ (e & (f ^ g));\n      // Sum0(a)\n      s0 =\n        ((a >>> 2) | (a << 30)) ^\n        ((a >>> 13) | (a << 19)) ^\n        ((a >>> 22) | (a << 10));\n      // Maj(a, b, c) (optimized the same way as SHA-1)\n      maj = (a & b) | (c & (a ^ b));\n\n      // main algorithm\n      t1 = h + s1 + ch + _k[i] + w[i];\n      t2 = s0 + maj;\n      h = g;\n      g = f;\n      f = e;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      // can't truncate with `| 0`\n      e = (d + t1) >>> 0;\n      d = c;\n      c = b;\n      b = a;\n      // `>>> 0` necessary to avoid iOS/Safari 10 optimization bug\n      // can't truncate with `| 0`\n      a = (t1 + t2) >>> 0;\n    }\n\n    // update hash state\n    s.h0 = (s.h0 + a) | 0;\n    s.h1 = (s.h1 + b) | 0;\n    s.h2 = (s.h2 + c) | 0;\n    s.h3 = (s.h3 + d) | 0;\n    s.h4 = (s.h4 + e) | 0;\n    s.h5 = (s.h5 + f) | 0;\n    s.h6 = (s.h6 + g) | 0;\n    s.h7 = (s.h7 + h) | 0;\n    len -= 64;\n  }\n}\n","/*\n * Copyright (c) 2016-2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst URDNA2015 = require('./URDNA2015');\nconst util = require('./util');\n\nmodule.exports = class URDNA2012 extends URDNA2015 {\n  constructor(options) {\n    super(options);\n    this.name = 'URGNA2012';\n    this.hashAlgorithm = 'sha1';\n  }\n\n  // helper for modifying component during Hash First Degree Quads\n  modifyFirstDegreeComponent(id, component, key) {\n    if(component.termType !== 'BlankNode') {\n      return component;\n    }\n    component = util.clone(component);\n    if(key === 'name') {\n      component.value = '_:g';\n    } else {\n      component.value = (component.value === id ? '_:a' : '_:z');\n    }\n    return component;\n  }\n\n  // helper for getting a related predicate\n  getRelatedPredicate(quad) {\n    return quad.predicate.value;\n  }\n\n  // helper for creating hash to related blank nodes map\n  createHashToRelated(id, issuer, callback) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    const hashToRelated = {};\n\n    // 2) Get a reference, quads, to the list of quads in the blank node to\n    // quads map for the key identifier.\n    const quads = self.blankNodeInfo[id].quads;\n\n    // 3) For each quad in quads:\n    self.forEach(quads, (quad, idx, callback) => {\n      // 3.1) If the quad's subject is a blank node that does not match\n      // identifier, set hash to the result of the Hash Related Blank Node\n      // algorithm, passing the blank node identifier for subject as related,\n      // quad, path identifier issuer as issuer, and p as position.\n      let position;\n      let related;\n      if(quad.subject.termType === 'BlankNode' && quad.subject.value !== id) {\n        related = quad.subject.value;\n        position = 'p';\n      } else if(\n        quad.object.termType === 'BlankNode' && quad.object.value !== id) {\n        // 3.2) Otherwise, if quad's object is a blank node that does not match\n        // identifier, to the result of the Hash Related Blank Node algorithm,\n        // passing the blank node identifier for object as related, quad, path\n        // identifier issuer as issuer, and r as position.\n        related = quad.object.value;\n        position = 'r';\n      } else {\n        // 3.3) Otherwise, continue to the next quad.\n        return callback();\n      }\n      // 3.4) Add a mapping of hash to the blank node identifier for the\n      // component that matched (subject or object) to hash to related blank\n      // nodes map, adding an entry as necessary.\n      self.hashRelatedBlankNode(\n        related, quad, issuer, position, (err, hash) => {\n        if(err) {\n          return callback(err);\n        }\n        if(hash in hashToRelated) {\n          hashToRelated[hash].push(related);\n        } else {\n          hashToRelated[hash] = [related];\n        }\n        callback();\n      });\n    }, err => callback(err, hashToRelated));\n  }\n};\n","/*\n * Copyright (c) 2016 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst URDNA2015Sync = require('./URDNA2015Sync');\nconst util = require('./util');\n\nmodule.exports = class URDNA2012Sync extends URDNA2015Sync {\n  constructor() {\n    super();\n    this.name = 'URGNA2012';\n    this.hashAlgorithm = 'sha1';\n  }\n\n  // helper for modifying component during Hash First Degree Quads\n  modifyFirstDegreeComponent(id, component, key) {\n    if(component.termType !== 'BlankNode') {\n      return component;\n    }\n    component = util.clone(component);\n    if(key === 'name') {\n      component.value = '_:g';\n    } else {\n      component.value = (component.value === id ? '_:a' : '_:z');\n    }\n    return component;\n  }\n\n  // helper for getting a related predicate\n  getRelatedPredicate(quad) {\n    return quad.predicate.value;\n  }\n\n  // helper for creating hash to related blank nodes map\n  createHashToRelated(id, issuer) {\n    const self = this;\n\n    // 1) Create a hash to related blank nodes map for storing hashes that\n    // identify related blank nodes.\n    const hashToRelated = {};\n\n    // 2) Get a reference, quads, to the list of quads in the blank node to\n    // quads map for the key identifier.\n    const quads = self.blankNodeInfo[id].quads;\n\n    // 3) For each quad in quads:\n    for(let i = 0; i < quads.length; ++i) {\n      // 3.1) If the quad's subject is a blank node that does not match\n      // identifier, set hash to the result of the Hash Related Blank Node\n      // algorithm, passing the blank node identifier for subject as related,\n      // quad, path identifier issuer as issuer, and p as position.\n      const quad = quads[i];\n      let position;\n      let related;\n      if(quad.subject.termType === 'BlankNode' && quad.subject.value !== id) {\n        related = quad.subject.value;\n        position = 'p';\n      } else if(\n        quad.object.termType === 'BlankNode' && quad.object.value !== id) {\n        // 3.2) Otherwise, if quad's object is a blank node that does not match\n        // identifier, to the result of the Hash Related Blank Node algorithm,\n        // passing the blank node identifier for object as related, quad, path\n        // identifier issuer as issuer, and r as position.\n        related = quad.object.value;\n        position = 'r';\n      } else {\n        // 3.3) Otherwise, continue to the next quad.\n        continue;\n      }\n      // 3.4) Add a mapping of hash to the blank node identifier for the\n      // component that matched (subject or object) to hash to related blank\n      // nodes map, adding an entry as necessary.\n      const hash = self.hashRelatedBlankNode(related, quad, issuer, position);\n      if(hash in hashToRelated) {\n        hashToRelated[hash].push(related);\n      } else {\n        hashToRelated[hash] = [related];\n      }\n    }\n\n    return hashToRelated;\n  }\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\n// TODO: move `NQuads` to its own package\nmodule.exports = require('rdf-canonize').NQuads;\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n/* global Node, XMLSerializer */\n'use strict';\n\nconst {\n  RDF_LANGSTRING,\n  RDF_PLAIN_LITERAL,\n  RDF_OBJECT,\n  RDF_XML_LITERAL,\n  XSD_STRING,\n} = require('./constants');\n\nlet _Node;\nif(typeof Node !== 'undefined') {\n  _Node = Node;\n} else {\n  _Node = {\n    ELEMENT_NODE: 1,\n    ATTRIBUTE_NODE: 2,\n    TEXT_NODE: 3,\n    CDATA_SECTION_NODE: 4,\n    ENTITY_REFERENCE_NODE: 5,\n    ENTITY_NODE: 6,\n    PROCESSING_INSTRUCTION_NODE: 7,\n    COMMENT_NODE: 8,\n    DOCUMENT_NODE: 9,\n    DOCUMENT_TYPE_NODE: 10,\n    DOCUMENT_FRAGMENT_NODE: 11,\n    NOTATION_NODE: 12\n  };\n}\n\nmodule.exports = class Rdfa {\n  /**\n   * Parses the RDF dataset found via the data object from the RDFa API.\n   *\n   * @param data the RDFa API data object.\n   *\n   * @return the RDF dataset.\n   */\n  parse(data) {\n    const dataset = {};\n    dataset['@default'] = [];\n\n    const subjects = data.getSubjects();\n    for(let si = 0; si < subjects.length; ++si) {\n      const subject = subjects[si];\n      if(subject === null) {\n        continue;\n      }\n\n      // get all related triples\n      const triples = data.getSubjectTriples(subject);\n      if(triples === null) {\n        continue;\n      }\n      const predicates = triples.predicates;\n      for(const predicate in predicates) {\n        // iterate over objects\n        const objects = predicates[predicate].objects;\n        for(let oi = 0; oi < objects.length; ++oi) {\n          const object = objects[oi];\n\n          // create RDF triple\n          const triple = {};\n\n          // add subject\n          if(subject.indexOf('_:') === 0) {\n            triple.subject = {type: 'blank node', value: subject};\n          } else {\n            triple.subject = {type: 'IRI', value: subject};\n          }\n\n          // add predicate\n          if(predicate.indexOf('_:') === 0) {\n            triple.predicate = {type: 'blank node', value: predicate};\n          } else {\n            triple.predicate = {type: 'IRI', value: predicate};\n          }\n\n          // serialize XML literal\n          let value = object.value;\n          if(object.type === RDF_XML_LITERAL) {\n            // initialize XMLSerializer\n            const XMLSerializer = getXMLSerializerClass();\n            const serializer = new XMLSerializer();\n            value = '';\n            for(let x = 0; x < object.value.length; x++) {\n              if(object.value[x].nodeType === _Node.ELEMENT_NODE) {\n                value += serializer.serializeToString(object.value[x]);\n              } else if(object.value[x].nodeType === _Node.TEXT_NODE) {\n                value += object.value[x].nodeValue;\n              }\n            }\n          }\n\n          // add object\n          triple.object = {};\n\n          // object is an IRI\n          if(object.type === RDF_OBJECT) {\n            if(object.value.indexOf('_:') === 0) {\n              triple.object.type = 'blank node';\n            } else {\n              triple.object.type = 'IRI';\n            }\n          } else {\n            // object is a literal\n            triple.object.type = 'literal';\n            if(object.type === RDF_PLAIN_LITERAL) {\n              if(object.language) {\n                triple.object.datatype = RDF_LANGSTRING;\n                triple.object.language = object.language;\n              } else {\n                triple.object.datatype = XSD_STRING;\n              }\n            } else {\n              triple.object.datatype = object.type;\n            }\n          }\n          triple.object.value = value;\n\n          // add triple to dataset in default graph\n          dataset['@default'].push(triple);\n        }\n      }\n    }\n\n    return dataset;\n  }\n};\n\nfunction getXMLSerializerClass() {\n  if(typeof XMLSerializer === 'undefined') {\n    return require('xmldom').XMLSerializer;\n  }\n  return XMLSerializer;\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst JsonLdError = require('./JsonLdError');\n\nconst {\n  isArray: _isArray,\n  isObject: _isObject,\n  isEmptyObject: _isEmptyObject,\n  isString: _isString,\n  isUndefined: _isUndefined\n} = require('./types');\n\nconst {\n  isList: _isList,\n  isValue: _isValue,\n  isGraph: _isGraph\n} = require('./graphTypes');\n\nconst {\n  expandIri: _expandIri,\n  getContextValue: _getContextValue,\n  isKeyword: _isKeyword,\n  process: _processContext\n} = require('./context');\n\nconst {\n  isAbsolute: _isAbsoluteIri\n} = require('./url');\n\nconst {\n  addValue: _addValue,\n  asArray: _asArray,\n  getValues: _getValues,\n  validateTypeValue: _validateTypeValue\n} = require('./util');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Recursively expands an element using the given context. Any context in\n * the element will be removed. All context URLs must have been retrieved\n * before calling this method.\n *\n * @param activeCtx the context to use.\n * @param activeProperty the property for the element, null for none.\n * @param element the element to expand.\n * @param options the expansion options.\n * @param insideList true if the element is a list, false if not.\n * @param insideIndex true if the element is inside an index container,\n *          false if not.\n * @param typeScopedContext an optional type-scoped active context for\n *          expanding values of nodes that were expressed according to\n *          a type-scoped context.\n * @param expansionMap(info) a function that can be used to custom map\n *          unmappable values (or to throw an error when they are detected);\n *          if this function returns `undefined` then the default behavior\n *          will be used.\n *\n * @return a Promise that resolves to the expanded value.\n */\napi.expand = ({\n  activeCtx,\n  activeProperty = null,\n  element,\n  options = {},\n  insideList = false,\n  insideIndex = false,\n  typeScopedContext = null,\n  expansionMap = () => undefined\n}) => {\n  // nothing to expand\n  if(element === null || element === undefined) {\n    return null;\n  }\n\n  // disable framing if activeProperty is @default\n  if(activeProperty === '@default') {\n    options = Object.assign({}, options, {isFrame: false});\n  }\n\n  if(!_isArray(element) && !_isObject(element)) {\n    // drop free-floating scalars that are not in lists unless custom mapped\n    if(!insideList && (activeProperty === null ||\n      _expandIri(activeCtx, activeProperty, {vocab: true},\n        options) === '@graph')) {\n      // TODO: use `await` to support async\n      const mapped = expansionMap({\n        unmappedValue: element,\n        activeCtx,\n        activeProperty,\n        options,\n        insideList\n      });\n      if(mapped === undefined) {\n        return null;\n      }\n      return mapped;\n    }\n\n    // expand element according to value expansion rules\n    return _expandValue({activeCtx, activeProperty, value: element, options});\n  }\n\n  // recursively expand array\n  if(_isArray(element)) {\n    let rval = [];\n    const container = _getContextValue(\n      activeCtx, activeProperty, '@container') || [];\n    insideList = insideList || container.includes('@list');\n    for(let i = 0; i < element.length; ++i) {\n      // expand element\n      let e = api.expand({\n        activeCtx,\n        activeProperty,\n        element: element[i],\n        options,\n        expansionMap,\n        insideIndex,\n        typeScopedContext\n      });\n      if(insideList && (_isArray(e) || _isList(e))) {\n        // lists of lists are illegal\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; lists of lists are not permitted.',\n          'jsonld.SyntaxError', {code: 'list of lists'});\n      }\n\n      if(e === null) {\n        // TODO: add `await` for async support\n        e = expansionMap({\n          unmappedValue: element[i],\n          activeCtx,\n          activeProperty,\n          parent: element,\n          index: i,\n          options,\n          expandedParent: rval,\n          insideList\n        });\n        if(e === undefined) {\n          continue;\n        }\n      }\n\n      if(_isArray(e)) {\n        rval = rval.concat(e);\n      } else {\n        rval.push(e);\n      }\n    }\n    return rval;\n  }\n\n  // recursively expand object:\n\n  // first, expand the active property\n  const expandedActiveProperty = _expandIri(\n    activeCtx, activeProperty, {vocab: true}, options);\n\n  // second, determine if any type-scoped context should be reverted; it\n  // should only be reverted when the following are all true:\n  // 1. `element` is not a value or subject reference\n  // 2. `insideIndex` is false\n  typeScopedContext = typeScopedContext ||\n    (activeCtx.previousContext ? activeCtx : null);\n  let keys = Object.keys(element).sort();\n  let mustRevert = !insideIndex;\n  if(mustRevert && typeScopedContext && keys.length <= 2 &&\n    !keys.includes('@context')) {\n    for(const key of keys) {\n      const expandedProperty = _expandIri(\n        typeScopedContext, key, {vocab: true}, options);\n      if(expandedProperty === '@value') {\n        // value found, ensure type-scoped context is used to expand it\n        mustRevert = false;\n        activeCtx = typeScopedContext;\n        break;\n      }\n      if(expandedProperty === '@id' && keys.length === 1) {\n        // subject reference found, do not revert\n        mustRevert = false;\n        break;\n      }\n    }\n  }\n\n  if(mustRevert) {\n    // revert type scoped context\n    activeCtx = activeCtx.revertTypeScopedContext();\n  }\n\n  // if element has a context, process it\n  if('@context' in element) {\n    activeCtx = _processContext(\n      {activeCtx, localCtx: element['@context'], options});\n  }\n\n  // look for scoped contexts on `@type`\n  for(const key of keys) {\n    const expandedProperty = _expandIri(activeCtx, key, {vocab: true}, options);\n    if(expandedProperty === '@type') {\n      // set scoped contexts from @type\n      // avoid sorting if possible\n      const value = element[key];\n      const types =\n        Array.isArray(value) ?\n          (value.length > 1 ? value.slice().sort() : value) : [value];\n      for(const type of types) {\n        const ctx = _getContextValue(\n          activeCtx.previousContext || activeCtx, type, '@context');\n        if(!_isUndefined(ctx)) {\n          activeCtx = _processContext({\n            activeCtx,\n            localCtx: ctx,\n            options,\n            isTypeScopedContext: true\n          });\n        }\n      }\n    }\n  }\n\n  // process each key and value in element, ignoring @nest content\n  let rval = {};\n  _expandObject({\n    activeCtx,\n    activeProperty,\n    expandedActiveProperty,\n    element,\n    expandedParent: rval,\n    options,\n    insideList,\n    typeScopedContext,\n    expansionMap});\n\n  // get property count on expanded output\n  keys = Object.keys(rval);\n  let count = keys.length;\n\n  if('@value' in rval) {\n    // @value must only have @language or @type\n    if('@type' in rval && '@language' in rval) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; an element containing \"@value\" may not ' +\n        'contain both \"@type\" and \"@language\".',\n        'jsonld.SyntaxError', {code: 'invalid value object', element: rval});\n    }\n    let validCount = count - 1;\n    if('@type' in rval) {\n      validCount -= 1;\n    }\n    if('@index' in rval) {\n      validCount -= 1;\n    }\n    if('@language' in rval) {\n      validCount -= 1;\n    }\n    if(validCount !== 0) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; an element containing \"@value\" may only ' +\n        'have an \"@index\" property and at most one other property ' +\n        'which can be \"@type\" or \"@language\".',\n        'jsonld.SyntaxError', {code: 'invalid value object', element: rval});\n    }\n    const values = rval['@value'] === null ? [] : _asArray(rval['@value']);\n    const types = _getValues(rval, '@type');\n\n    // drop null @values unless custom mapped\n    if(values.length === 0) {\n      // TODO: use `await` to support async\n      const mapped = expansionMap({\n        unmappedValue: rval,\n        activeCtx,\n        activeProperty,\n        element,\n        options,\n        insideList\n      });\n      if(mapped !== undefined) {\n        rval = mapped;\n      } else {\n        rval = null;\n      }\n    } else if(!values.every(v => (_isString(v) || _isEmptyObject(v))) &&\n      '@language' in rval) {\n      // if @language is present, @value must be a string\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; only strings may be language-tagged.',\n        'jsonld.SyntaxError',\n        {code: 'invalid language-tagged value', element: rval});\n    } else if(!types.every(t =>\n      (_isAbsoluteIri(t) && !(_isString(t) && t.indexOf('_:') === 0) ||\n      _isEmptyObject(t)))) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; an element containing \"@value\" and \"@type\" ' +\n        'must have an absolute IRI for the value of \"@type\".',\n        'jsonld.SyntaxError', {code: 'invalid typed value', element: rval});\n    }\n  } else if('@type' in rval && !_isArray(rval['@type'])) {\n    // convert @type to an array\n    rval['@type'] = [rval['@type']];\n  } else if('@set' in rval || '@list' in rval) {\n    // handle @set and @list\n    if(count > 1 && !(count === 2 && '@index' in rval)) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; if an element has the property \"@set\" ' +\n        'or \"@list\", then it can have at most one other property that is ' +\n        '\"@index\".', 'jsonld.SyntaxError',\n        {code: 'invalid set or list object', element: rval});\n    }\n    // optimize away @set\n    if('@set' in rval) {\n      rval = rval['@set'];\n      keys = Object.keys(rval);\n      count = keys.length;\n    }\n  } else if(count === 1 && '@language' in rval) {\n    // drop objects with only @language unless custom mapped\n    // TODO: use `await` to support async\n    const mapped = expansionMap(rval, {\n      unmappedValue: rval,\n      activeCtx,\n      activeProperty,\n      element,\n      options,\n      insideList\n    });\n    if(mapped !== undefined) {\n      rval = mapped;\n    } else {\n      rval = null;\n    }\n  }\n\n  // drop certain top-level objects that do not occur in lists, unless custom\n  // mapped\n  if(_isObject(rval) &&\n    !options.keepFreeFloatingNodes && !insideList &&\n    (activeProperty === null || expandedActiveProperty === '@graph')) {\n    // drop empty object, top-level @value/@list, or object with only @id\n    if(count === 0 || '@value' in rval || '@list' in rval ||\n      (count === 1 && '@id' in rval)) {\n      // TODO: use `await` to support async\n      const mapped = expansionMap({\n        unmappedValue: rval,\n        activeCtx,\n        activeProperty,\n        element,\n        options,\n        insideList\n      });\n      if(mapped !== undefined) {\n        rval = mapped;\n      } else {\n        rval = null;\n      }\n    }\n  }\n\n  return rval;\n};\n\n/**\n * Expand each key and value of element adding to result\n *\n * @param activeCtx the context to use.\n * @param activeProperty the property for the element.\n * @param expandedActiveProperty the expansion of activeProperty\n * @param element the element to expand.\n * @param expandedParent the expanded result into which to add values.\n * @param options the expansion options.\n * @param insideList true if the element is a list, false if not.\n * @param expansionMap(info) a function that can be used to custom map\n *          unmappable values (or to throw an error when they are detected);\n *          if this function returns `undefined` then the default behavior\n *          will be used.\n */\nfunction _expandObject({\n  activeCtx,\n  activeProperty,\n  expandedActiveProperty,\n  element,\n  expandedParent,\n  options = {},\n  insideList,\n  expansionMap\n}) {\n  const keys = Object.keys(element).sort();\n  const nests = [];\n  for(const key of keys) {\n    let value = element[key];\n    let expandedValue;\n\n    // skip @context\n    if(key === '@context') {\n      continue;\n    }\n\n    // expand property\n    let expandedProperty = _expandIri(activeCtx, key, {vocab: true}, options);\n\n    // drop non-absolute IRI keys that aren't keywords unless custom mapped\n    if(expandedProperty === null ||\n      !(_isAbsoluteIri(expandedProperty) || _isKeyword(expandedProperty))) {\n      // TODO: use `await` to support async\n      expandedProperty = expansionMap({\n        unmappedProperty: key,\n        activeCtx,\n        activeProperty,\n        parent: element,\n        options,\n        insideList,\n        value,\n        expandedParent\n      });\n      if(expandedProperty === undefined) {\n        continue;\n      }\n    }\n\n    if(_isKeyword(expandedProperty)) {\n      if(expandedActiveProperty === '@reverse') {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; a keyword cannot be used as a @reverse ' +\n          'property.', 'jsonld.SyntaxError',\n          {code: 'invalid reverse property map', value});\n      }\n      if(expandedProperty in expandedParent) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; colliding keywords detected.',\n          'jsonld.SyntaxError',\n          {code: 'colliding keywords', keyword: expandedProperty});\n      }\n    }\n\n    // syntax error if @id is not a string\n    if(expandedProperty === '@id') {\n      if(!_isString(value)) {\n        if(!options.isFrame) {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; \"@id\" value must a string.',\n            'jsonld.SyntaxError', {code: 'invalid @id value', value});\n        }\n        if(_isObject(value)) {\n          // empty object is a wildcard\n          if(!_isEmptyObject(value)) {\n            throw new JsonLdError(\n              'Invalid JSON-LD syntax; \"@id\" value an empty object or array ' +\n              'of strings, if framing',\n              'jsonld.SyntaxError', {code: 'invalid @id value', value});\n          }\n        } else if(_isArray(value)) {\n          if(!value.every(v => _isString(v))) {\n            throw new JsonLdError(\n              'Invalid JSON-LD syntax; \"@id\" value an empty object or array ' +\n              'of strings, if framing',\n              'jsonld.SyntaxError', {code: 'invalid @id value', value});\n          }\n        } else {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; \"@id\" value an empty object or array ' +\n            'of strings, if framing',\n            'jsonld.SyntaxError', {code: 'invalid @id value', value});\n        }\n      }\n\n      _addValue(\n        expandedParent, '@id',\n        _asArray(value).map(v =>\n          _isString(v) ? _expandIri(activeCtx, v, {base: true}, options) : v),\n        {propertyIsArray: options.isFrame});\n      continue;\n    }\n\n    if(expandedProperty === '@type') {\n      _validateTypeValue(value);\n      _addValue(\n        expandedParent, '@type',\n        _asArray(value).map(v =>\n          _isString(v) ?\n            _expandIri(activeCtx.previousContext || activeCtx, v,\n              {base: true, vocab: true}, options) : v),\n        {propertyIsArray: options.isFrame});\n      continue;\n    }\n\n    // @graph must be an array or an object\n    if(expandedProperty === '@graph' &&\n      !(_isObject(value) || _isArray(value))) {\n      throw new JsonLdError(\n        'Invalid JSON-LD syntax; \"@graph\" value must not be an ' +\n        'object or an array.',\n        'jsonld.SyntaxError', {code: 'invalid @graph value', value});\n    }\n\n    // @value must not be an object or an array (unless framing)\n    if(expandedProperty === '@value') {\n      if((_isObject(value) || _isArray(value)) && !options.isFrame) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; \"@value\" value must not be an ' +\n          'object or an array.',\n          'jsonld.SyntaxError',\n          {code: 'invalid value object value', value});\n      }\n\n      _addValue(\n        expandedParent, '@value', value, {propertyIsArray: options.isFrame});\n      continue;\n    }\n\n    // @language must be a string\n    if(expandedProperty === '@language') {\n      if(value === null) {\n        // drop null @language values, they expand as if they didn't exist\n        continue;\n      }\n      if(!_isString(value) && !options.isFrame) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; \"@language\" value must be a string.',\n          'jsonld.SyntaxError',\n          {code: 'invalid language-tagged string', value});\n      }\n      // ensure language value is lowercase\n      value = _asArray(value).map(v => _isString(v) ? v.toLowerCase() : v);\n\n      _addValue(\n        expandedParent, '@language', value, {propertyIsArray: options.isFrame});\n      continue;\n    }\n\n    // @index must be a string\n    if(expandedProperty === '@index') {\n      if(!_isString(value)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; \"@index\" value must be a string.',\n          'jsonld.SyntaxError',\n          {code: 'invalid @index value', value});\n      }\n      _addValue(expandedParent, '@index', value);\n      continue;\n    }\n\n    // @reverse must be an object\n    if(expandedProperty === '@reverse') {\n      if(!_isObject(value)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; \"@reverse\" value must be an object.',\n          'jsonld.SyntaxError', {code: 'invalid @reverse value', value});\n      }\n\n      expandedValue = api.expand({\n        activeCtx,\n        activeProperty:\n        '@reverse',\n        element: value,\n        options,\n        expansionMap\n      });\n      // properties double-reversed\n      if('@reverse' in expandedValue) {\n        for(const property in expandedValue['@reverse']) {\n          _addValue(\n            expandedParent, property, expandedValue['@reverse'][property],\n            {propertyIsArray: true});\n        }\n      }\n\n      // FIXME: can this be merged with code below to simplify?\n      // merge in all reversed properties\n      let reverseMap = expandedParent['@reverse'] || null;\n      for(const property in expandedValue) {\n        if(property === '@reverse') {\n          continue;\n        }\n        if(reverseMap === null) {\n          reverseMap = expandedParent['@reverse'] = {};\n        }\n        _addValue(reverseMap, property, [], {propertyIsArray: true});\n        const items = expandedValue[property];\n        for(let ii = 0; ii < items.length; ++ii) {\n          const item = items[ii];\n          if(_isValue(item) || _isList(item)) {\n            throw new JsonLdError(\n              'Invalid JSON-LD syntax; \"@reverse\" value must not be a ' +\n              '@value or an @list.', 'jsonld.SyntaxError',\n              {code: 'invalid reverse property value', value: expandedValue});\n          }\n          _addValue(reverseMap, property, item, {propertyIsArray: true});\n        }\n      }\n\n      continue;\n    }\n\n    // nested keys\n    if(expandedProperty === '@nest') {\n      nests.push(key);\n      continue;\n    }\n\n    // use potential scoped context for key\n    let termCtx = activeCtx;\n    const ctx = _getContextValue(activeCtx, key, '@context');\n    if(!_isUndefined(ctx)) {\n      // Note: spec's `from term` var is named `isPropertyTermScopedContext`\n      termCtx = _processContext({\n        activeCtx,\n        localCtx: ctx,\n        isPropertyTermScopedContext: true,\n        options\n      });\n    }\n\n    const container = _getContextValue(termCtx, key, '@container') || [];\n\n    if(container.includes('@language') && _isObject(value)) {\n      // handle language map container (skip if value is not an object)\n      expandedValue = _expandLanguageMap(termCtx, value, options);\n    } else if(container.includes('@index') && _isObject(value)) {\n      // handle index container (skip if value is not an object)\n      const asGraph = container.includes('@graph');\n      expandedValue = _expandIndexMap({\n        activeCtx: termCtx,\n        options,\n        activeProperty: key,\n        value,\n        expansionMap,\n        asGraph,\n        indexKey: '@index'\n      });\n    } else if(container.includes('@id') && _isObject(value)) {\n      // handle id container (skip if value is not an object)\n      const asGraph = container.includes('@graph');\n      expandedValue = _expandIndexMap({\n        activeCtx: termCtx,\n        options,\n        activeProperty: key,\n        value,\n        expansionMap,\n        asGraph,\n        indexKey: '@id'\n      });\n    } else if(container.includes('@type') && _isObject(value)) {\n      // handle type container (skip if value is not an object)\n      expandedValue = _expandIndexMap({\n        // since container is `@type`, revert type scoped context when expanding\n        activeCtx: termCtx.revertTypeScopedContext(),\n        options,\n        activeProperty: key,\n        value,\n        expansionMap,\n        asGraph: false,\n        indexKey: '@type'\n      });\n    } else {\n      // recurse into @list or @set\n      const isList = (expandedProperty === '@list');\n      if(isList || expandedProperty === '@set') {\n        let nextActiveProperty = activeProperty;\n        if(isList && expandedActiveProperty === '@graph') {\n          nextActiveProperty = null;\n        }\n        expandedValue = api.expand({\n          activeCtx: termCtx,\n          activeProperty: nextActiveProperty,\n          element: value,\n          options,\n          insideList: isList,\n          expansionMap\n        });\n        if(isList && _isList(expandedValue)) {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; lists of lists are not permitted.',\n            'jsonld.SyntaxError', {code: 'list of lists'});\n        }\n      } else {\n        // recursively expand value with key as new active property\n        expandedValue = api.expand({\n          activeCtx: termCtx,\n          activeProperty: key,\n          element: value,\n          options,\n          insideList: false,\n          expansionMap\n        });\n      }\n    }\n\n    // drop null values if property is not @value\n    if(expandedValue === null && expandedProperty !== '@value') {\n      // TODO: use `await` to support async\n      expandedValue = expansionMap({\n        unmappedValue: value,\n        expandedProperty,\n        activeCtx: termCtx,\n        activeProperty,\n        parent: element,\n        options,\n        insideList,\n        key,\n        expandedParent\n      });\n      if(expandedValue === undefined) {\n        continue;\n      }\n    }\n\n    // convert expanded value to @list if container specifies it\n    if(expandedProperty !== '@list' && !_isList(expandedValue) &&\n      container.includes('@list')) {\n      // ensure expanded value in @list is an array\n      expandedValue = {'@list': _asArray(expandedValue)};\n    }\n\n    // convert expanded value to @graph if container specifies it\n    // and value is not, itself, a graph\n    // index cases handled above\n    if(container.includes('@graph') &&\n      !container.some(key => key === '@id' || key === '@index')) {\n      // ensure expanded values are arrays\n      expandedValue = _asArray(expandedValue)\n        .map(v => _isGraph(v) ? v : {'@graph': _asArray(v)});\n    }\n\n    // FIXME: can this be merged with code above to simplify?\n    // merge in reverse properties\n    if(termCtx.mappings.has(key) && termCtx.mappings.get(key).reverse) {\n      const reverseMap =\n        expandedParent['@reverse'] = expandedParent['@reverse'] || {};\n      expandedValue = _asArray(expandedValue);\n      for(let ii = 0; ii < expandedValue.length; ++ii) {\n        const item = expandedValue[ii];\n        if(_isValue(item) || _isList(item)) {\n          throw new JsonLdError(\n            'Invalid JSON-LD syntax; \"@reverse\" value must not be a ' +\n            '@value or an @list.', 'jsonld.SyntaxError',\n            {code: 'invalid reverse property value', value: expandedValue});\n        }\n        _addValue(reverseMap, expandedProperty, item, {propertyIsArray: true});\n      }\n      continue;\n    }\n\n    // add value for property\n    // use an array except for certain keywords\n    const useArray =\n      !['@index', '@id', '@type', '@value', '@language']\n        .includes(expandedProperty);\n    _addValue(expandedParent, expandedProperty, expandedValue, {\n      propertyIsArray: useArray\n    });\n  }\n\n  // expand each nested key\n  for(const key of nests) {\n    const nestedValues = _isArray(element[key]) ? element[key] : [element[key]];\n    for(const nv of nestedValues) {\n      if(!_isObject(nv) || Object.keys(nv).some(k =>\n        _expandIri(activeCtx, k, {vocab: true}, options) === '@value')) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; nested value must be a node object.',\n          'jsonld.SyntaxError',\n          {code: 'invalid @nest value', value: nv});\n      }\n      _expandObject({\n        activeCtx,\n        activeProperty,\n        expandedActiveProperty,\n        element: nv,\n        expandedParent,\n        options,\n        insideList,\n        expansionMap});\n    }\n  }\n}\n\n/**\n * Expands the given value by using the coercion and keyword rules in the\n * given context.\n *\n * @param activeCtx the active context to use.\n * @param activeProperty the active property the value is associated with.\n * @param value the value to expand.\n * @param {Object} [options] - processing options.\n *\n * @return the expanded value.\n */\nfunction _expandValue({activeCtx, activeProperty, value, options}) {\n  // nothing to expand\n  if(value === null || value === undefined) {\n    return null;\n  }\n\n  // special-case expand @id and @type (skips '@id' expansion)\n  const expandedProperty = _expandIri(\n    activeCtx, activeProperty, {vocab: true}, options);\n  if(expandedProperty === '@id') {\n    return _expandIri(activeCtx, value, {base: true}, options);\n  } else if(expandedProperty === '@type') {\n    return _expandIri(activeCtx, value, {vocab: true, base: true}, options);\n  }\n\n  // get type definition from context\n  const type = _getContextValue(activeCtx, activeProperty, '@type');\n\n  // do @id expansion (automatic for @graph)\n  if((type === '@id' || expandedProperty === '@graph') && _isString(value)) {\n    return {'@id': _expandIri(activeCtx, value, {base: true}, options)};\n  }\n  // do @id expansion w/vocab\n  if(type === '@vocab' && _isString(value)) {\n    return {\n      '@id': _expandIri(activeCtx, value, {vocab: true, base: true}, options)\n    };\n  }\n\n  // do not expand keyword values\n  if(_isKeyword(expandedProperty)) {\n    return value;\n  }\n\n  const rval = {};\n\n  if(type && !['@id', '@vocab'].includes(type)) {\n    // other type\n    rval['@type'] = type;\n  } else if(_isString(value)) {\n    // check for language tagging for strings\n    const language = _getContextValue(activeCtx, activeProperty, '@language');\n    if(language !== null) {\n      rval['@language'] = language;\n    }\n  }\n  // do conversion of values that aren't basic JSON types to strings\n  if(!['boolean', 'number', 'string'].includes(typeof value)) {\n    value = value.toString();\n  }\n  rval['@value'] = value;\n\n  return rval;\n}\n\n/**\n * Expands a language map.\n *\n * @param activeCtx the active context to use.\n * @param languageMap the language map to expand.\n * @param {Object} [options] - processing options.\n *\n * @return the expanded language map.\n */\nfunction _expandLanguageMap(activeCtx, languageMap, options) {\n  const rval = [];\n  const keys = Object.keys(languageMap).sort();\n  for(const key of keys) {\n    const expandedKey = _expandIri(activeCtx, key, {vocab: true}, options);\n    let val = languageMap[key];\n    if(!_isArray(val)) {\n      val = [val];\n    }\n    for(const item of val) {\n      if(item === null) {\n        // null values are allowed (8.5) but ignored (3.1)\n        continue;\n      }\n      if(!_isString(item)) {\n        throw new JsonLdError(\n          'Invalid JSON-LD syntax; language map values must be strings.',\n          'jsonld.SyntaxError',\n          {code: 'invalid language map value', languageMap});\n      }\n      const val = {'@value': item};\n      if(expandedKey !== '@none') {\n        val['@language'] = key.toLowerCase();\n      }\n      rval.push(val);\n    }\n  }\n  return rval;\n}\n\nfunction _expandIndexMap(\n  {activeCtx, options, activeProperty, value, expansionMap, asGraph,\n    indexKey}) {\n  const rval = [];\n  const keys = Object.keys(value).sort();\n  const isTypeIndex = indexKey === '@type';\n  for(let key of keys) {\n    // if indexKey is @type, there may be a context defined for it\n    if(isTypeIndex) {\n      const ctx = _getContextValue(activeCtx, key, '@context');\n      if(!_isUndefined(ctx)) {\n        activeCtx = _processContext({\n          activeCtx,\n          localCtx: ctx,\n          isTypeScopedContext: true,\n          options\n        });\n      }\n    }\n\n    let val = value[key];\n    if(!_isArray(val)) {\n      val = [val];\n    }\n\n    // expand for @type, but also for @none\n    const expandedKey = _expandIri(activeCtx, key, {vocab: true}, options);\n    if(indexKey === '@id') {\n      // expand document relative\n      key = _expandIri(activeCtx, key, {base: true}, options);\n    } else if(isTypeIndex) {\n      key = expandedKey;\n    }\n\n    val = api.expand({\n      activeCtx,\n      activeProperty,\n      element: val,\n      options,\n      insideList: false,\n      insideIndex: true,\n      expansionMap\n    });\n    for(let item of val) {\n      // If this is also a @graph container, turn items into graphs\n      if(asGraph && !_isGraph(item)) {\n        item = {'@graph': [item]};\n      }\n      if(indexKey === '@type') {\n        if(expandedKey === '@none') {\n          // ignore @none\n        } else if(item['@type']) {\n          item['@type'] = [key].concat(item['@type']);\n        } else {\n          item['@type'] = [key];\n        }\n      } else if(expandedKey !== '@none' && !(indexKey in item)) {\n        item[indexKey] = key;\n      }\n      rval.push(item);\n    }\n  }\n  return rval;\n}\n","/*\n * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {clone} = require('./util');\n\nmodule.exports = class ActiveContextCache {\n  /**\n   * Creates an active context cache.\n   *\n   * @param size the maximum size of the cache.\n   */\n  constructor(size = 100) {\n    this.order = [];\n    this.cache = new Map();\n    this.size = size;\n  }\n\n  get(activeCtx, localCtx) {\n    const level1 = this.cache.get(activeCtx);\n    if(level1) {\n      const key = JSON.stringify(localCtx);\n      const result = level1.get(key);\n      return result || null;\n    }\n    return null;\n  }\n\n  set(activeCtx, localCtx, result) {\n    if(this.order.length === this.size) {\n      const entry = this.order.shift();\n      this.cache.get(entry.activeCtx).delete(entry.localCtx);\n    }\n    const key = JSON.stringify(localCtx);\n    this.order.push({activeCtx, localCtx: key});\n    let level1 = this.cache.get(activeCtx);\n    if(!level1) {\n      level1 = new Map();\n      this.cache.set(activeCtx, level1);\n    }\n    level1.set(key, clone(result));\n  }\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {\n  isSubjectReference: _isSubjectReference\n} = require('./graphTypes');\n\nconst {\n  createMergedNodeMap: _createMergedNodeMap\n} = require('./nodeMap');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Performs JSON-LD flattening.\n *\n * @param input the expanded JSON-LD to flatten.\n *\n * @return the flattened output.\n */\napi.flatten = input => {\n  const defaultGraph = _createMergedNodeMap(input);\n\n  // produce flattened output\n  const flattened = [];\n  const keys = Object.keys(defaultGraph).sort();\n  for(let ki = 0; ki < keys.length; ++ki) {\n    const node = defaultGraph[keys[ki]];\n    // only add full subjects to top-level\n    if(!_isSubjectReference(node)) {\n      flattened.push(node);\n    }\n  }\n  return flattened;\n};\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst graphTypes = require('./graphTypes');\nconst types = require('./types');\nconst util = require('./util');\n\n// constants\nconst {\n  // RDF,\n  RDF_LIST,\n  RDF_FIRST,\n  RDF_REST,\n  RDF_NIL,\n  RDF_TYPE,\n  // RDF_PLAIN_LITERAL,\n  // RDF_XML_LITERAL,\n  // RDF_OBJECT,\n  // RDF_LANGSTRING,\n\n  // XSD,\n  XSD_BOOLEAN,\n  XSD_DOUBLE,\n  XSD_INTEGER,\n  XSD_STRING,\n} = require('./constants');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Converts an RDF dataset to JSON-LD.\n *\n * @param dataset the RDF dataset.\n * @param options the RDF serialization options.\n *\n * @return a Promise that resolves to the JSON-LD output.\n */\napi.fromRDF = async (\n  dataset, {useRdfType = false, useNativeTypes = false}) => {\n  const defaultGraph = {};\n  const graphMap = {'@default': defaultGraph};\n  const referencedOnce = {};\n\n  for(const quad of dataset) {\n    // TODO: change 'name' to 'graph'\n    const name = (quad.graph.termType === 'DefaultGraph') ?\n      '@default' : quad.graph.value;\n    if(!(name in graphMap)) {\n      graphMap[name] = {};\n    }\n    if(name !== '@default' && !(name in defaultGraph)) {\n      defaultGraph[name] = {'@id': name};\n    }\n\n    const nodeMap = graphMap[name];\n\n    // get subject, predicate, object\n    const s = quad.subject.value;\n    const p = quad.predicate.value;\n    const o = quad.object;\n\n    if(!(s in nodeMap)) {\n      nodeMap[s] = {'@id': s};\n    }\n    const node = nodeMap[s];\n\n    const objectIsNode = o.termType.endsWith('Node');\n    if(objectIsNode && !(o.value in nodeMap)) {\n      nodeMap[o.value] = {'@id': o.value};\n    }\n\n    if(p === RDF_TYPE && !useRdfType && objectIsNode) {\n      util.addValue(node, '@type', o.value, {propertyIsArray: true});\n      continue;\n    }\n\n    const value = _RDFToObject(o, useNativeTypes);\n    util.addValue(node, p, value, {propertyIsArray: true});\n\n    // object may be an RDF list/partial list node but we can't know easily\n    // until all triples are read\n    if(objectIsNode) {\n      if(o.value === RDF_NIL) {\n        // track rdf:nil uniquely per graph\n        const object = nodeMap[o.value];\n        if(!('usages' in object)) {\n          object.usages = [];\n        }\n        object.usages.push({\n          node,\n          property: p,\n          value\n        });\n      } else if(o.value in referencedOnce) {\n        // object referenced more than once\n        referencedOnce[o.value] = false;\n      } else {\n        // keep track of single reference\n        referencedOnce[o.value] = {\n          node,\n          property: p,\n          value\n        };\n      }\n    }\n  }\n\n  /*\n  for(let name in dataset) {\n    const graph = dataset[name];\n    if(!(name in graphMap)) {\n      graphMap[name] = {};\n    }\n    if(name !== '@default' && !(name in defaultGraph)) {\n      defaultGraph[name] = {'@id': name};\n    }\n    const nodeMap = graphMap[name];\n    for(let ti = 0; ti < graph.length; ++ti) {\n      const triple = graph[ti];\n\n      // get subject, predicate, object\n      const s = triple.subject.value;\n      const p = triple.predicate.value;\n      const o = triple.object;\n\n      if(!(s in nodeMap)) {\n        nodeMap[s] = {'@id': s};\n      }\n      const node = nodeMap[s];\n\n      const objectIsId = (o.type === 'IRI' || o.type === 'blank node');\n      if(objectIsId && !(o.value in nodeMap)) {\n        nodeMap[o.value] = {'@id': o.value};\n      }\n\n      if(p === RDF_TYPE && !useRdfType && objectIsId) {\n        util.addValue(node, '@type', o.value, {propertyIsArray: true});\n        continue;\n      }\n\n      const value = _RDFToObject(o, useNativeTypes);\n      util.addValue(node, p, value, {propertyIsArray: true});\n\n      // object may be an RDF list/partial list node but we can't know easily\n      // until all triples are read\n      if(objectIsId) {\n        if(o.value === RDF_NIL) {\n          // track rdf:nil uniquely per graph\n          const object = nodeMap[o.value];\n          if(!('usages' in object)) {\n            object.usages = [];\n          }\n          object.usages.push({\n            node: node,\n            property: p,\n            value: value\n          });\n        } else if(o.value in referencedOnce) {\n          // object referenced more than once\n          referencedOnce[o.value] = false;\n        } else {\n          // keep track of single reference\n          referencedOnce[o.value] = {\n            node: node,\n            property: p,\n            value: value\n          };\n        }\n      }\n    }\n  }*/\n\n  // convert linked lists to @list arrays\n  for(const name in graphMap) {\n    const graphObject = graphMap[name];\n\n    // no @lists to be converted, continue\n    if(!(RDF_NIL in graphObject)) {\n      continue;\n    }\n\n    // iterate backwards through each RDF list\n    const nil = graphObject[RDF_NIL];\n    if(!nil.usages) {\n      continue;\n    }\n    for(let usage of nil.usages) {\n      let node = usage.node;\n      let property = usage.property;\n      let head = usage.value;\n      const list = [];\n      const listNodes = [];\n\n      // ensure node is a well-formed list node; it must:\n      // 1. Be referenced only once.\n      // 2. Have an array for rdf:first that has 1 item.\n      // 3. Have an array for rdf:rest that has 1 item.\n      // 4. Have no keys other than: @id, rdf:first, rdf:rest, and,\n      //   optionally, @type where the value is rdf:List.\n      let nodeKeyCount = Object.keys(node).length;\n      while(property === RDF_REST &&\n        types.isObject(referencedOnce[node['@id']]) &&\n        types.isArray(node[RDF_FIRST]) && node[RDF_FIRST].length === 1 &&\n        types.isArray(node[RDF_REST]) && node[RDF_REST].length === 1 &&\n        (nodeKeyCount === 3 ||\n          (nodeKeyCount === 4 && types.isArray(node['@type']) &&\n          node['@type'].length === 1 && node['@type'][0] === RDF_LIST))) {\n        list.push(node[RDF_FIRST][0]);\n        listNodes.push(node['@id']);\n\n        // get next node, moving backwards through list\n        usage = referencedOnce[node['@id']];\n        node = usage.node;\n        property = usage.property;\n        head = usage.value;\n        nodeKeyCount = Object.keys(node).length;\n\n        // if node is not a blank node, then list head found\n        if(!graphTypes.isBlankNode(node)) {\n          break;\n        }\n      }\n\n      // the list is nested in another list\n      if(property === RDF_FIRST) {\n        // empty list\n        if(node['@id'] === RDF_NIL) {\n          // can't convert rdf:nil to a @list object because it would\n          // result in a list of lists which isn't supported\n          continue;\n        }\n\n        // preserve list head\n        if(RDF_REST in graphObject[head['@id']]) {\n          head = graphObject[head['@id']][RDF_REST][0];\n        }\n\n        list.pop();\n        listNodes.pop();\n      }\n\n      // transform list into @list object\n      delete head['@id'];\n      head['@list'] = list.reverse();\n      for(const listNode of listNodes) {\n        delete graphObject[listNode];\n      }\n    }\n\n    delete nil.usages;\n  }\n\n  const result = [];\n  const subjects = Object.keys(defaultGraph).sort();\n  for(const subject of subjects) {\n    const node = defaultGraph[subject];\n    if(subject in graphMap) {\n      const graph = node['@graph'] = [];\n      const graphObject = graphMap[subject];\n      const graphSubjects = Object.keys(graphObject).sort();\n      for(const graphSubject of graphSubjects) {\n        const node = graphObject[graphSubject];\n        // only add full subjects to top-level\n        if(!graphTypes.isSubjectReference(node)) {\n          graph.push(node);\n        }\n      }\n    }\n    // only add full subjects to top-level\n    if(!graphTypes.isSubjectReference(node)) {\n      result.push(node);\n    }\n  }\n\n  return result;\n};\n\n/**\n * Converts an RDF triple object to a JSON-LD object.\n *\n * @param o the RDF triple object to convert.\n * @param useNativeTypes true to output native types, false not to.\n *\n * @return the JSON-LD object.\n */\nfunction _RDFToObject(o, useNativeTypes) {\n  // convert NamedNode/BlankNode object to JSON-LD\n  if(o.termType.endsWith('Node')) {\n    return {'@id': o.value};\n  }\n\n  // convert literal to JSON-LD\n  const rval = {'@value': o.value};\n\n  // add language\n  if(o.language) {\n    rval['@language'] = o.language;\n  } else {\n    let type = o.datatype.value;\n    if(!type) {\n      type = XSD_STRING;\n    }\n    // use native types for certain xsd types\n    if(useNativeTypes) {\n      if(type === XSD_BOOLEAN) {\n        if(rval['@value'] === 'true') {\n          rval['@value'] = true;\n        } else if(rval['@value'] === 'false') {\n          rval['@value'] = false;\n        }\n      } else if(types.isNumeric(rval['@value'])) {\n        if(type === XSD_INTEGER) {\n          const i = parseInt(rval['@value'], 10);\n          if(i.toFixed(0) === rval['@value']) {\n            rval['@value'] = i;\n          }\n        } else if(type === XSD_DOUBLE) {\n          rval['@value'] = parseFloat(rval['@value']);\n        }\n      }\n      // do not add native type\n      if(![XSD_BOOLEAN, XSD_INTEGER, XSD_DOUBLE, XSD_STRING].includes(type)) {\n        rval['@type'] = type;\n      }\n    } else if(type !== XSD_STRING) {\n      rval['@type'] = type;\n    }\n  }\n\n  return rval;\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {createNodeMap} = require('./nodeMap');\nconst {isKeyword} = require('./context');\nconst graphTypes = require('./graphTypes');\nconst types = require('./types');\nconst util = require('./util');\n\nconst {\n  // RDF,\n  // RDF_LIST,\n  RDF_FIRST,\n  RDF_REST,\n  RDF_NIL,\n  RDF_TYPE,\n  // RDF_PLAIN_LITERAL,\n  // RDF_XML_LITERAL,\n  // RDF_OBJECT,\n  RDF_LANGSTRING,\n\n  // XSD,\n  XSD_BOOLEAN,\n  XSD_DOUBLE,\n  XSD_INTEGER,\n  XSD_STRING,\n} = require('./constants');\n\nconst {\n  isAbsolute: _isAbsoluteIri\n} = require('./url');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Outputs an RDF dataset for the expanded JSON-LD input.\n *\n * @param input the expanded JSON-LD input.\n * @param options the RDF serialization options.\n *\n * @return the RDF dataset.\n */\napi.toRDF = (input, options) => {\n  // create node map for default graph (and any named graphs)\n  const issuer = new util.IdentifierIssuer('_:b');\n  const nodeMap = {'@default': {}};\n  createNodeMap(input, nodeMap, '@default', issuer);\n\n  const dataset = [];\n  const graphNames = Object.keys(nodeMap).sort();\n  for(const graphName of graphNames) {\n    let graphTerm;\n    if(graphName === '@default') {\n      graphTerm = {termType: 'DefaultGraph', value: ''};\n    } else if(_isAbsoluteIri(graphName)) {\n      if(graphName.startsWith('_:')) {\n        graphTerm = {termType: 'BlankNode'};\n      } else {\n        graphTerm = {termType: 'NamedNode'};\n      }\n      graphTerm.value = graphName;\n    } else {\n      // skip relative IRIs (not valid RDF)\n      continue;\n    }\n    _graphToRDF(dataset, nodeMap[graphName], graphTerm, issuer, options);\n  }\n\n  return dataset;\n};\n\n/**\n * Adds RDF quads for a particular graph to the given dataset.\n *\n * @param dataset the dataset to append RDF quads to.\n * @param graph the graph to create RDF quads for.\n * @param graphTerm the graph term for each quad.\n * @param issuer a IdentifierIssuer for assigning blank node names.\n * @param options the RDF serialization options.\n *\n * @return the array of RDF triples for the given graph.\n */\nfunction _graphToRDF(dataset, graph, graphTerm, issuer, options) {\n  const ids = Object.keys(graph).sort();\n  for(let i = 0; i < ids.length; ++i) {\n    const id = ids[i];\n    const node = graph[id];\n    const properties = Object.keys(node).sort();\n    for(let property of properties) {\n      const items = node[property];\n      if(property === '@type') {\n        property = RDF_TYPE;\n      } else if(isKeyword(property)) {\n        continue;\n      }\n\n      for(const item of items) {\n        // RDF subject\n        const subject = {\n          termType: id.startsWith('_:') ? 'BlankNode' : 'NamedNode',\n          value: id\n        };\n\n        // skip relative IRI subjects (not valid RDF)\n        if(!_isAbsoluteIri(id)) {\n          continue;\n        }\n\n        // RDF predicate\n        const predicate = {\n          termType: property.startsWith('_:') ? 'BlankNode' : 'NamedNode',\n          value: property\n        };\n\n        // skip relative IRI predicates (not valid RDF)\n        if(!_isAbsoluteIri(property)) {\n          continue;\n        }\n\n        // skip blank node predicates unless producing generalized RDF\n        if(predicate.termType === 'BlankNode' &&\n          !options.produceGeneralizedRdf) {\n          continue;\n        }\n\n        // convert @list to triples\n        if(graphTypes.isList(item)) {\n          _listToRDF(\n            item['@list'], issuer, subject, predicate, dataset, graphTerm);\n        } else {\n          // convert value or node object to triple\n          const object = _objectToRDF(item);\n          // skip null objects (they are relative IRIs)\n          if(object) {\n            dataset.push({\n              subject,\n              predicate,\n              object,\n              graph: graphTerm\n            });\n          }\n        }\n      }\n    }\n  }\n}\n\n/**\n * Converts a @list value into linked list of blank node RDF quads\n * (an RDF collection).\n *\n * @param list the @list value.\n * @param issuer a IdentifierIssuer for assigning blank node names.\n * @param subject the subject for the head of the list.\n * @param predicate the predicate for the head of the list.\n * @param dataset the array of quads to append to.\n * @param graphTerm the graph term for each quad.\n */\nfunction _listToRDF(list, issuer, subject, predicate, dataset, graphTerm) {\n  const first = {termType: 'NamedNode', value: RDF_FIRST};\n  const rest = {termType: 'NamedNode', value: RDF_REST};\n  const nil = {termType: 'NamedNode', value: RDF_NIL};\n\n  for(const item of list) {\n    const blankNode = {termType: 'BlankNode', value: issuer.getId()};\n    dataset.push({\n      subject,\n      predicate,\n      object: blankNode,\n      graph: graphTerm\n    });\n\n    subject = blankNode;\n    predicate = first;\n    const object = _objectToRDF(item);\n\n    // skip null objects (they are relative IRIs)\n    if(object) {\n      dataset.push({\n        subject,\n        predicate,\n        object,\n        graph: graphTerm\n      });\n    }\n\n    predicate = rest;\n  }\n\n  dataset.push({\n    subject,\n    predicate,\n    object: nil,\n    graph: graphTerm\n  });\n}\n\n/**\n * Converts a JSON-LD value object to an RDF literal or a JSON-LD string or\n * node object to an RDF resource.\n *\n * @param item the JSON-LD value or node object.\n *\n * @return the RDF literal or RDF resource.\n */\nfunction _objectToRDF(item) {\n  const object = {};\n\n  // convert value object to RDF\n  if(graphTypes.isValue(item)) {\n    object.termType = 'Literal';\n    object.value = undefined;\n    object.datatype = {\n      termType: 'NamedNode'\n    };\n    let value = item['@value'];\n    const datatype = item['@type'] || null;\n\n    // convert to XSD datatypes as appropriate\n    if(types.isBoolean(value)) {\n      object.value = value.toString();\n      object.datatype.value = datatype || XSD_BOOLEAN;\n    } else if(types.isDouble(value) || datatype === XSD_DOUBLE) {\n      if(!types.isDouble(value)) {\n        value = parseFloat(value);\n      }\n      // canonical double representation\n      object.value = value.toExponential(15).replace(/(\\d)0*e\\+?/, '$1E');\n      object.datatype.value = datatype || XSD_DOUBLE;\n    } else if(types.isNumber(value)) {\n      object.value = value.toFixed(0);\n      object.datatype.value = datatype || XSD_INTEGER;\n    } else if('@language' in item) {\n      object.value = value;\n      object.datatype.value = datatype || RDF_LANGSTRING;\n      object.language = item['@language'];\n    } else {\n      object.value = value;\n      object.datatype.value = datatype || XSD_STRING;\n    }\n  } else {\n    // convert string/node object to RDF\n    const id = types.isObject(item) ? item['@id'] : item;\n    object.termType = id.startsWith('_:') ? 'BlankNode' : 'NamedNode';\n    object.value = id;\n  }\n\n  // skip relative IRIs, not valid RDF\n  if(object.termType === 'NamedNode' && !_isAbsoluteIri(object.value)) {\n    return null;\n  }\n\n  return object;\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {isKeyword} = require('./context');\nconst graphTypes = require('./graphTypes');\nconst types = require('./types');\nconst util = require('./util');\nconst JsonLdError = require('./JsonLdError');\nconst {\n  createNodeMap: _createNodeMap,\n  mergeNodeMapGraphs: _mergeNodeMapGraphs\n} = require('./nodeMap');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Performs JSON-LD `merged` framing.\n *\n * @param input the expanded JSON-LD to frame.\n * @param frame the expanded JSON-LD frame to use.\n * @param options the framing options.\n *\n * @return the framed output.\n */\napi.frameMergedOrDefault = (input, frame, options) => {\n  // create framing state\n  const state = {\n    options,\n    graph: '@default',\n    graphMap: {'@default': {}},\n    graphStack: [],\n    subjectStack: [],\n    link: {},\n    bnodeMap: {}\n  };\n\n  // produce a map of all graphs and name each bnode\n  // FIXME: currently uses subjects from @merged graph only\n  const issuer = new util.IdentifierIssuer('_:b');\n  _createNodeMap(input, state.graphMap, '@default', issuer);\n  if(options.merged) {\n    state.graphMap['@merged'] = _mergeNodeMapGraphs(state.graphMap);\n    state.graph = '@merged';\n  }\n  state.subjects = state.graphMap[state.graph];\n\n  // frame the subjects\n  const framed = [];\n  api.frame(state, Object.keys(state.subjects).sort(), frame, framed);\n\n  // If pruning blank nodes, find those to prune\n  if(options.pruneBlankNodeIdentifiers) {\n    // remove all blank nodes appearing only once, done in compaction\n    options.bnodesToClear =\n      Object.keys(state.bnodeMap).filter(id => state.bnodeMap[id].length === 1);\n  }\n\n  return framed;\n};\n\n/**\n * Frames subjects according to the given frame.\n *\n * @param state the current framing state.\n * @param subjects the subjects to filter.\n * @param frame the frame.\n * @param parent the parent subject or top-level array.\n * @param property the parent property, initialized to null.\n */\napi.frame = (state, subjects, frame, parent, property = null) => {\n  // validate the frame\n  _validateFrame(frame);\n  frame = frame[0];\n\n  // get flags for current frame\n  const options = state.options;\n  const flags = {\n    embed: _getFrameFlag(frame, options, 'embed'),\n    explicit: _getFrameFlag(frame, options, 'explicit'),\n    requireAll: _getFrameFlag(frame, options, 'requireAll')\n  };\n\n  // filter out subjects that match the frame\n  const matches = _filterSubjects(state, subjects, frame, flags);\n\n  // add matches to output\n  const ids = Object.keys(matches).sort();\n  for(const id of ids) {\n    const subject = matches[id];\n\n    if(flags.embed === '@link' && id in state.link) {\n      // TODO: may want to also match an existing linked subject against\n      // the current frame ... so different frames could produce different\n      // subjects that are only shared in-memory when the frames are the same\n\n      // add existing linked subject\n      _addFrameOutput(parent, property, state.link[id]);\n      continue;\n    }\n\n    /* Note: In order to treat each top-level match as a compartmentalized\n    result, clear the unique embedded subjects map when the property is null,\n    which only occurs at the top-level. */\n    if(property === null) {\n      state.uniqueEmbeds = {[state.graph]: {}};\n    } else {\n      state.uniqueEmbeds[state.graph] = state.uniqueEmbeds[state.graph] || {};\n    }\n\n    // start output for subject\n    const output = {};\n    output['@id'] = id;\n    if(id.indexOf('_:') === 0) {\n      util.addValue(state.bnodeMap, id, output, {propertyIsArray: true});\n    }\n    state.link[id] = output;\n\n    // if embed is @never or if a circular reference would be created by an\n    // embed, the subject cannot be embedded, just add the reference;\n    // note that a circular reference won't occur when the embed flag is\n    // `@link` as the above check will short-circuit before reaching this point\n    if(flags.embed === '@never' ||\n      _createsCircularReference(subject, state.graph, state.subjectStack)) {\n      _addFrameOutput(parent, property, output);\n      continue;\n    }\n\n    // if only the last match should be embedded\n    if(flags.embed === '@last') {\n      // remove any existing embed\n      if(id in state.uniqueEmbeds[state.graph]) {\n        _removeEmbed(state, id);\n      }\n      state.uniqueEmbeds[state.graph][id] =\n        {parent, property};\n    }\n\n    // push matching subject onto stack to enable circular embed checks\n    state.subjectStack.push({subject, graph: state.graph});\n\n    // subject is also the name of a graph\n    if(id in state.graphMap) {\n      let recurse = false;\n      let subframe = null;\n      if(!('@graph' in frame)) {\n        recurse = state.graph !== '@merged';\n        subframe = {};\n      } else {\n        subframe = frame['@graph'][0];\n        if(!types.isObject(subframe)) {\n          subframe = {};\n        }\n        recurse = !(id === '@merged' || id === '@default');\n      }\n\n      if(recurse) {\n        state.graphStack.push(state.graph);\n        state.graph = id;\n        // recurse into graph\n        api.frame(\n          state,\n          Object.keys(state.graphMap[id]).sort(), [subframe], output, '@graph');\n        state.graph = state.graphStack.pop;\n      }\n    }\n\n    // iterate over subject properties\n    for(const prop of Object.keys(subject).sort()) {\n      // copy keywords to output\n      if(isKeyword(prop)) {\n        output[prop] = util.clone(subject[prop]);\n\n        if(prop === '@type') {\n          // count bnode values of @type\n          for(const type of subject['@type']) {\n            if(type.indexOf('_:') === 0) {\n              util.addValue(\n                state.bnodeMap, type, output, {propertyIsArray: true});\n            }\n          }\n        }\n        continue;\n      }\n\n      // explicit is on and property isn't in the frame, skip processing\n      if(flags.explicit && !(prop in frame)) {\n        continue;\n      }\n\n      // add objects\n      for(let o of subject[prop]) {\n        const subframe = (prop in frame ?\n          frame[prop] : _createImplicitFrame(flags));\n\n        // recurse into list\n        if(graphTypes.isList(o)) {\n          // add empty list\n          const list = {'@list': []};\n          _addFrameOutput(output, prop, list);\n\n          // add list objects\n          const src = o['@list'];\n          for(const n in src) {\n            o = src[n];\n            if(graphTypes.isSubjectReference(o)) {\n              const subframe = (prop in frame ?\n                frame[prop][0]['@list'] : _createImplicitFrame(flags));\n              // recurse into subject reference\n              api.frame(state, [o['@id']], subframe, list, '@list');\n            } else {\n              // include other values automatically\n              _addFrameOutput(list, '@list', util.clone(o));\n            }\n          }\n          continue;\n        }\n\n        if(graphTypes.isSubjectReference(o)) {\n          // recurse into subject reference\n          api.frame(state, [o['@id']], subframe, output, prop);\n        } else if(_valueMatch(subframe[0], o)) {\n          // include other values, if they match\n          _addFrameOutput(output, prop, util.clone(o));\n        }\n      }\n    }\n\n    // handle defaults\n    for(const prop of Object.keys(frame).sort()) {\n      // skip keywords\n      if(isKeyword(prop)) {\n        continue;\n      }\n\n      // if omit default is off, then include default values for properties\n      // that appear in the next frame but are not in the matching subject\n      const next = frame[prop][0] || {};\n      const omitDefaultOn = _getFrameFlag(next, options, 'omitDefault');\n      if(!omitDefaultOn && !(prop in output)) {\n        let preserve = '@null';\n        if('@default' in next) {\n          preserve = util.clone(next['@default']);\n        }\n        if(!types.isArray(preserve)) {\n          preserve = [preserve];\n        }\n        output[prop] = [{'@preserve': preserve}];\n      }\n    }\n\n    // if embed reverse values by finding nodes having this subject as a value\n    // of the associated property\n    if('@reverse' in frame) {\n      for(const reverseProp of Object.keys(frame['@reverse']).sort()) {\n        const subframe = frame['@reverse'][reverseProp];\n        for(const subject of Object.keys(state.subjects)) {\n          const nodeValues =\n            util.getValues(state.subjects[subject], reverseProp);\n          if(nodeValues.some(v => v['@id'] === id)) {\n            // node has property referencing this subject, recurse\n            output['@reverse'] = output['@reverse'] || {};\n            util.addValue(\n              output['@reverse'], reverseProp, [], {propertyIsArray: true});\n            api.frame(\n              state, [subject], subframe, output['@reverse'][reverseProp],\n              property);\n          }\n        }\n      }\n    }\n\n    // add output to parent\n    _addFrameOutput(parent, property, output);\n\n    // pop matching subject from circular ref-checking stack\n    state.subjectStack.pop();\n  }\n};\n\n/**\n * Creates an implicit frame when recursing through subject matches. If\n * a frame doesn't have an explicit frame for a particular property, then\n * a wildcard child frame will be created that uses the same flags that the\n * parent frame used.\n *\n * @param flags the current framing flags.\n *\n * @return the implicit frame.\n */\nfunction _createImplicitFrame(flags) {\n  const frame = {};\n  for(const key in flags) {\n    if(flags[key] !== undefined) {\n      frame['@' + key] = [flags[key]];\n    }\n  }\n  return [frame];\n}\n\n/**\n * Checks the current subject stack to see if embedding the given subject\n * would cause a circular reference.\n *\n * @param subjectToEmbed the subject to embed.\n * @param graph the graph the subject to embed is in.\n * @param subjectStack the current stack of subjects.\n *\n * @return true if a circular reference would be created, false if not.\n */\nfunction _createsCircularReference(subjectToEmbed, graph, subjectStack) {\n  for(let i = subjectStack.length - 1; i >= 0; --i) {\n    const subject = subjectStack[i];\n    if(subject.graph === graph &&\n      subject.subject['@id'] === subjectToEmbed['@id']) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Gets the frame flag value for the given flag name.\n *\n * @param frame the frame.\n * @param options the framing options.\n * @param name the flag name.\n *\n * @return the flag value.\n */\nfunction _getFrameFlag(frame, options, name) {\n  const flag = '@' + name;\n  let rval = (flag in frame ? frame[flag][0] : options[name]);\n  if(name === 'embed') {\n    // default is \"@last\"\n    // backwards-compatibility support for \"embed\" maps:\n    // true => \"@last\"\n    // false => \"@never\"\n    if(rval === true) {\n      rval = '@last';\n    } else if(rval === false) {\n      rval = '@never';\n    } else if(rval !== '@always' && rval !== '@never' && rval !== '@link') {\n      rval = '@last';\n    }\n  }\n  return rval;\n}\n\n/**\n * Validates a JSON-LD frame, throwing an exception if the frame is invalid.\n *\n * @param frame the frame to validate.\n */\nfunction _validateFrame(frame) {\n  if(!types.isArray(frame) || frame.length !== 1 || !types.isObject(frame[0])) {\n    throw new JsonLdError(\n      'Invalid JSON-LD syntax; a JSON-LD frame must be a single object.',\n      'jsonld.SyntaxError', {frame});\n  }\n}\n\n/**\n * Returns a map of all of the subjects that match a parsed frame.\n *\n * @param state the current framing state.\n * @param subjects the set of subjects to filter.\n * @param frame the parsed frame.\n * @param flags the frame flags.\n *\n * @return all of the matched subjects.\n */\nfunction _filterSubjects(state, subjects, frame, flags) {\n  // filter subjects in @id order\n  const rval = {};\n  for(const id of subjects) {\n    const subject = state.graphMap[state.graph][id];\n    if(_filterSubject(state, subject, frame, flags)) {\n      rval[id] = subject;\n    }\n  }\n  return rval;\n}\n\n/**\n * Returns true if the given subject matches the given frame.\n *\n * Matches either based on explicit type inclusion where the node has any\n * type listed in the frame. If the frame has empty types defined matches\n * nodes not having a @type. If the frame has a type of {} defined matches\n * nodes having any type defined.\n *\n * Otherwise, does duck typing, where the node must have all of the\n * properties defined in the frame.\n *\n * @param state the current framing state.\n * @param subject the subject to check.\n * @param frame the frame to check.\n * @param flags the frame flags.\n *\n * @return true if the subject matches, false if not.\n */\nfunction _filterSubject(state, subject, frame, flags) {\n  // check ducktype\n  let wildcard = true;\n  let matchesSome = false;\n\n  for(const key in frame) {\n    let matchThis = false;\n    const nodeValues = util.getValues(subject, key);\n    const isEmpty = util.getValues(frame, key).length === 0;\n\n    if(isKeyword(key)) {\n      // skip non-@id and non-@type\n      if(key !== '@id' && key !== '@type') {\n        continue;\n      }\n      wildcard = false;\n\n      // check @id for a specific @id value\n      if(key === '@id') {\n        // if @id is not a wildcard and is not empty, then match or not on\n        // specific value\n        if(frame['@id'].length >= 0 && !types.isEmptyObject(frame['@id'][0])) {\n          return frame['@id'].includes(nodeValues[0]);\n        }\n        matchThis = true;\n        continue;\n      }\n\n      // check @type (object value means 'any' type, fall through to ducktyping)\n      if('@type' in frame) {\n        if(isEmpty) {\n          if(nodeValues.length > 0) {\n            // don't match on no @type\n            return false;\n          }\n          matchThis = true;\n        } else if(frame['@type'].length === 1 &&\n          types.isEmptyObject(frame['@type'][0])) {\n          // match on wildcard @type\n          matchThis = nodeValues.length > 0;\n        } else {\n          // match on a specific @type\n          for(const type of frame['@type']) {\n            if(nodeValues.some(tt => tt === type)) {\n              return true;\n            }\n          }\n          return false;\n        }\n      }\n    }\n\n    // Forc a copy of this frame entry so it can be manipulated\n    const thisFrame = util.getValues(frame, key)[0];\n    let hasDefault = false;\n    if(thisFrame) {\n      _validateFrame([thisFrame]);\n      hasDefault = '@default' in thisFrame;\n    }\n\n    // no longer a wildcard pattern if frame has any non-keyword properties\n    wildcard = false;\n\n    // skip, but allow match if node has no value for property, and frame has a\n    // default value\n    if(nodeValues.length === 0 && hasDefault) {\n      continue;\n    }\n\n    // if frame value is empty, don't match if subject has any value\n    if(nodeValues.length > 0 && isEmpty) {\n      return false;\n    }\n\n    if(thisFrame === undefined) {\n      // node does not match if values is not empty and the value of property\n      // in frame is match none.\n      if(nodeValues.length > 0) {\n        return false;\n      }\n      matchThis = true;\n    } else if(types.isObject(thisFrame)) {\n      // node matches if values is not empty and the value of property in frame\n      // is wildcard\n      matchThis = nodeValues.length > 0;\n    } else {\n      if(graphTypes.isValue(thisFrame)) {\n        // match on any matching value\n        matchThis = nodeValues.some(nv => _valueMatch(thisFrame, nv));\n      } else if(graphTypes.isSubject(thisFrame) ||\n        graphTypes.isSubjectReference(thisFrame)) {\n        matchThis =\n          nodeValues.some(nv => _nodeMatch(state, thisFrame, nv, flags));\n      } else if(graphTypes.isList(thisFrame)) {\n        const listValue = thisFrame['@list'][0];\n        if(graphTypes.isList(nodeValues[0])) {\n          const nodeListValues = nodeValues[0]['@list'];\n\n          if(graphTypes.isValue(listValue)) {\n            // match on any matching value\n            matchThis = nodeListValues.some(lv => _valueMatch(listValue, lv));\n          } else if(graphTypes.isSubject(listValue) ||\n            graphTypes.isSubjectReference(listValue)) {\n            matchThis = nodeListValues.some(lv => _nodeMatch(\n              state, listValue, lv, flags));\n          }\n        } else {\n          // value must be a list to match\n          matchThis = false;\n        }\n      }\n    }\n\n    // all non-defaulted values must match if requireAll is set\n    if(!matchThis && flags.requireAll) {\n      return false;\n    }\n\n    matchesSome = matchesSome || matchThis;\n  }\n\n  // return true if wildcard or subject matches some properties\n  return wildcard || matchesSome;\n}\n\n/**\n * Removes an existing embed.\n *\n * @param state the current framing state.\n * @param id the @id of the embed to remove.\n */\nfunction _removeEmbed(state, id) {\n  // get existing embed\n  const embeds = state.uniqueEmbeds[state.graph];\n  const embed = embeds[id];\n  const parent = embed.parent;\n  const property = embed.property;\n\n  // create reference to replace embed\n  const subject = {'@id': id};\n\n  // remove existing embed\n  if(types.isArray(parent)) {\n    // replace subject with reference\n    for(let i = 0; i < parent.length; ++i) {\n      if(util.compareValues(parent[i], subject)) {\n        parent[i] = subject;\n        break;\n      }\n    }\n  } else {\n    // replace subject with reference\n    const useArray = types.isArray(parent[property]);\n    util.removeValue(parent, property, subject, {propertyIsArray: useArray});\n    util.addValue(parent, property, subject, {propertyIsArray: useArray});\n  }\n\n  // recursively remove dependent dangling embeds\n  const removeDependents = id => {\n    // get embed keys as a separate array to enable deleting keys in map\n    const ids = Object.keys(embeds);\n    for(const next of ids) {\n      if(next in embeds && types.isObject(embeds[next].parent) &&\n        embeds[next].parent['@id'] === id) {\n        delete embeds[next];\n        removeDependents(next);\n      }\n    }\n  };\n  removeDependents(id);\n}\n\n/**\n * Adds framing output to the given parent.\n *\n * @param parent the parent to add to.\n * @param property the parent property.\n * @param output the output to add.\n */\nfunction _addFrameOutput(parent, property, output) {\n  if(types.isObject(parent)) {\n    util.addValue(parent, property, output, {propertyIsArray: true});\n  } else {\n    parent.push(output);\n  }\n}\n\n/**\n * Node matches if it is a node, and matches the pattern as a frame.\n *\n * @param state the current framing state.\n * @param pattern used to match value\n * @param value to check\n * @param flags the frame flags.\n */\nfunction _nodeMatch(state, pattern, value, flags) {\n  if(!('@id' in value)) {\n    return false;\n  }\n  const nodeObject = state.subjects[value['@id']];\n  return nodeObject && _filterSubject(state, nodeObject, pattern, flags);\n}\n\n/**\n * Value matches if it is a value and matches the value pattern\n *\n * * `pattern` is empty\n * * @values are the same, or `pattern[@value]` is a wildcard, and\n * * @types are the same or `value[@type]` is not null\n *   and `pattern[@type]` is `{}`, or `value[@type]` is null\n *   and `pattern[@type]` is null or `[]`, and\n * * @languages are the same or `value[@language]` is not null\n *   and `pattern[@language]` is `{}`, or `value[@language]` is null\n *   and `pattern[@language]` is null or `[]`.\n *\n * @param pattern used to match value\n * @param value to check\n */\nfunction _valueMatch(pattern, value) {\n  const v1 = value['@value'];\n  const t1 = value['@type'];\n  const l1 = value['@language'];\n  const v2 = pattern['@value'] ?\n    (types.isArray(pattern['@value']) ?\n      pattern['@value'] : [pattern['@value']]) :\n    [];\n  const t2 = pattern['@type'] ?\n    (types.isArray(pattern['@type']) ?\n      pattern['@type'] : [pattern['@type']]) :\n    [];\n  const l2 = pattern['@language'] ?\n    (types.isArray(pattern['@language']) ?\n      pattern['@language'] : [pattern['@language']]) :\n    [];\n\n  if(v2.length === 0 && t2.length === 0 && l2.length === 0) {\n    return true;\n  }\n  if(!(v2.includes(v1) || types.isEmptyObject(v2[0]))) {\n    return false;\n  }\n  if(!(!t1 && t2.length === 0 || t2.includes(t1) || t1 &&\n    types.isEmptyObject(t2[0]))) {\n    return false;\n  }\n  if(!(!l1 && l2.length === 0 || l2.includes(l1) || l1 &&\n    types.isEmptyObject(l2[0]))) {\n    return false;\n  }\n  return true;\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst JsonLdError = require('./JsonLdError');\n\nconst {\n  isArray: _isArray,\n  isObject: _isObject,\n  isString: _isString,\n  isUndefined: _isUndefined\n} = require('./types');\n\nconst {\n  isList: _isList,\n  isValue: _isValue,\n  isGraph: _isGraph,\n  isSimpleGraph: _isSimpleGraph,\n  isSubjectReference: _isSubjectReference\n} = require('./graphTypes');\n\nconst {\n  expandIri: _expandIri,\n  getContextValue: _getContextValue,\n  isKeyword: _isKeyword,\n  process: _processContext\n} = require('./context');\n\nconst {\n  removeBase: _removeBase\n} = require('./url');\n\nconst {\n  addValue: _addValue,\n  asArray: _asArray,\n  compareShortestLeast: _compareShortestLeast\n} = require('./util');\n\nconst api = {};\nmodule.exports = api;\n\n/**\n * Recursively compacts an element using the given active context. All values\n * must be in expanded form before this method is called.\n *\n * @param activeCtx the active context to use.\n * @param activeProperty the compacted property associated with the element\n *          to compact, null for none.\n * @param element the element to compact.\n * @param options the compaction options.\n * @param compactionMap the compaction map to use.\n *\n * @return the compacted value.\n */\napi.compact = ({\n  activeCtx,\n  activeProperty = null,\n  element,\n  options = {},\n  compactionMap = () => undefined\n}) => {\n  // recursively compact array\n  if(_isArray(element)) {\n    let rval = [];\n    for(let i = 0; i < element.length; ++i) {\n      // compact, dropping any null values unless custom mapped\n      let compacted = api.compact({\n        activeCtx,\n        activeProperty,\n        element: element[i],\n        options,\n        compactionMap\n      });\n      if(compacted === null) {\n        // TODO: use `await` to support async\n        compacted = compactionMap({\n          unmappedValue: element[i],\n          activeCtx,\n          activeProperty,\n          parent: element,\n          index: i,\n          options\n        });\n        if(compacted === undefined) {\n          continue;\n        }\n      }\n      rval.push(compacted);\n    }\n    if(options.compactArrays && rval.length === 1) {\n      // use single element if no container is specified\n      const container = _getContextValue(\n        activeCtx, activeProperty, '@container') || [];\n      if(container.length === 0) {\n        rval = rval[0];\n      }\n    }\n    return rval;\n  }\n\n  // use any scoped context on activeProperty\n  const ctx = _getContextValue(activeCtx, activeProperty, '@context');\n  if(!_isUndefined(ctx)) {\n    // Note: spec's `from term` var is named `isPropertyTermScopedContext`\n    activeCtx = _processContext({\n      activeCtx,\n      localCtx: ctx,\n      isPropertyTermScopedContext: true,\n      options\n    });\n  }\n\n  // recursively compact object\n  if(_isObject(element)) {\n    if(options.link && '@id' in element &&\n      options.link.hasOwnProperty(element['@id'])) {\n      // check for a linked element to reuse\n      const linked = options.link[element['@id']];\n      for(let i = 0; i < linked.length; ++i) {\n        if(linked[i].expanded === element) {\n          return linked[i].compacted;\n        }\n      }\n    }\n\n    // do value compaction on @values and subject references\n    if(_isValue(element) || _isSubjectReference(element)) {\n      const rval =\n        api.compactValue({activeCtx, activeProperty, value: element, options});\n      if(options.link && _isSubjectReference(element)) {\n        // store linked element\n        if(!(options.link.hasOwnProperty(element['@id']))) {\n          options.link[element['@id']] = [];\n        }\n        options.link[element['@id']].push({expanded: element, compacted: rval});\n      }\n      return rval;\n    }\n\n    // FIXME: avoid misuse of active property as an expanded property?\n    const insideReverse = (activeProperty === '@reverse');\n\n    const rval = {};\n\n    // revert type scoped context\n    activeCtx = activeCtx.revertTypeScopedContext();\n\n    if(options.link && '@id' in element) {\n      // store linked element\n      if(!options.link.hasOwnProperty(element['@id'])) {\n        options.link[element['@id']] = [];\n      }\n      options.link[element['@id']].push({expanded: element, compacted: rval});\n    }\n\n    // apply any context defined on an alias of @type\n    // if key is @type and any compacted value is a term having a local\n    // context, overlay that context\n    let types = element['@type'] || [];\n    if(types.length > 1) {\n      types = Array.from(types).sort();\n    }\n    // find all type-scoped contexts based on current context, prior to\n    // updating it\n    const typeContext = activeCtx;\n    for(const type of types) {\n      const compactedType = api.compactIri(\n        {activeCtx: typeContext, iri: type, relativeTo: {vocab: true}});\n\n      // Use any type-scoped context defined on this value\n      const ctx = _getContextValue(typeContext, compactedType, '@context');\n      if(!_isUndefined(ctx)) {\n        activeCtx = _processContext({\n          activeCtx,\n          localCtx: ctx,\n          options,\n          isTypeScopedContext: true\n        });\n      }\n    }\n\n    // process element keys in order\n    const keys = Object.keys(element).sort();\n    for(const expandedProperty of keys) {\n      const expandedValue = element[expandedProperty];\n\n      // compact @id and @type(s)\n      if(expandedProperty === '@id' || expandedProperty === '@type') {\n        // if using a type-scoped context, resolve type values against previous\n        // context\n        const isType = expandedProperty === '@type';\n        const valueContext = isType ?\n          (activeCtx.previousContext || activeCtx) : activeCtx;\n        let compactedValue = _asArray(expandedValue).map(\n          expandedIri => api.compactIri({\n            activeCtx: valueContext,\n            iri: expandedIri,\n            relativeTo: {vocab: isType}\n          }));\n        if(compactedValue.length === 1) {\n          compactedValue = compactedValue[0];\n        }\n\n        // use keyword alias and add value\n        const alias = api.compactIri(\n          {activeCtx, iri: expandedProperty, relativeTo: {vocab: true}});\n        const isArray = _isArray(compactedValue) && expandedValue.length === 0;\n        _addValue(rval, alias, compactedValue, {propertyIsArray: isArray});\n        continue;\n      }\n\n      // handle @reverse\n      if(expandedProperty === '@reverse') {\n        // recursively compact expanded value\n        const compactedValue = api.compact({\n          activeCtx,\n          activeProperty: '@reverse',\n          element: expandedValue,\n          options,\n          compactionMap\n        });\n\n        // handle double-reversed properties\n        for(const compactedProperty in compactedValue) {\n          if(activeCtx.mappings.has(compactedProperty) &&\n            activeCtx.mappings.get(compactedProperty).reverse) {\n            const value = compactedValue[compactedProperty];\n            const container = _getContextValue(\n              activeCtx, compactedProperty, '@container') || [];\n            const useArray = (\n              container.includes('@set') || !options.compactArrays);\n            _addValue(\n              rval, compactedProperty, value, {propertyIsArray: useArray});\n            delete compactedValue[compactedProperty];\n          }\n        }\n\n        if(Object.keys(compactedValue).length > 0) {\n          // use keyword alias and add value\n          const alias = api.compactIri({\n            activeCtx,\n            iri: expandedProperty,\n            relativeTo: {vocab: true}\n          });\n          _addValue(rval, alias, compactedValue);\n        }\n\n        continue;\n      }\n\n      if(expandedProperty === '@preserve') {\n        // compact using activeProperty\n        const compactedValue = api.compact({\n          activeCtx,\n          activeProperty,\n          element: expandedValue,\n          options,\n          compactionMap});\n\n        if(!(_isArray(compactedValue) && compactedValue.length === 0)) {\n          _addValue(rval, expandedProperty, compactedValue);\n        }\n        continue;\n      }\n\n      // handle @index property\n      if(expandedProperty === '@index') {\n        // drop @index if inside an @index container\n        const container = _getContextValue(\n          activeCtx, activeProperty, '@container') || [];\n        if(container.includes('@index')) {\n          continue;\n        }\n\n        // use keyword alias and add value\n        const alias = api.compactIri({\n          activeCtx,\n          iri: expandedProperty,\n          relativeTo: {vocab: true}\n        });\n        _addValue(rval, alias, expandedValue);\n        continue;\n      }\n\n      // skip array processing for keywords that aren't @graph or @list\n      if(expandedProperty !== '@graph' && expandedProperty !== '@list' &&\n        _isKeyword(expandedProperty)) {\n        // use keyword alias and add value as is\n        const alias = api.compactIri({\n          activeCtx,\n          iri: expandedProperty,\n          relativeTo: {vocab: true}\n        });\n        _addValue(rval, alias, expandedValue);\n        continue;\n      }\n\n      // Note: expanded value must be an array due to expansion algorithm.\n      if(!_isArray(expandedValue)) {\n        throw new JsonLdError(\n          'JSON-LD expansion error; expanded value must be an array.',\n          'jsonld.SyntaxError');\n      }\n\n      // preserve empty arrays\n      if(expandedValue.length === 0) {\n        const itemActiveProperty = api.compactIri({\n          activeCtx,\n          iri: expandedProperty,\n          value: expandedValue,\n          relativeTo: {vocab: true},\n          reverse: insideReverse\n        });\n        const nestProperty = activeCtx.mappings.has(itemActiveProperty) ?\n          activeCtx.mappings.get(itemActiveProperty)['@nest'] : null;\n        let nestResult = rval;\n        if(nestProperty) {\n          _checkNestProperty(activeCtx, nestProperty, options);\n          if(!_isObject(rval[nestProperty])) {\n            rval[nestProperty] = {};\n          }\n          nestResult = rval[nestProperty];\n        }\n        _addValue(\n          nestResult, itemActiveProperty, expandedValue, {\n            propertyIsArray: true\n          });\n      }\n\n      // recusively process array values\n      for(const expandedItem of expandedValue) {\n        // compact property and get container type\n        const itemActiveProperty = api.compactIri({\n          activeCtx,\n          iri: expandedProperty,\n          value: expandedItem,\n          relativeTo: {vocab: true},\n          reverse: insideReverse\n        });\n\n        // if itemActiveProperty is a @nest property, add values to nestResult,\n        // otherwise rval\n        const nestProperty = activeCtx.mappings.has(itemActiveProperty) ?\n          activeCtx.mappings.get(itemActiveProperty)['@nest'] : null;\n        let nestResult = rval;\n        if(nestProperty) {\n          _checkNestProperty(activeCtx, nestProperty, options);\n          if(!_isObject(rval[nestProperty])) {\n            rval[nestProperty] = {};\n          }\n          nestResult = rval[nestProperty];\n        }\n\n        const container = _getContextValue(\n          activeCtx, itemActiveProperty, '@container') || [];\n\n        // get simple @graph or @list value if appropriate\n        const isGraph = _isGraph(expandedItem);\n        const isList = _isList(expandedItem);\n        let inner;\n        if(isList) {\n          inner = expandedItem['@list'];\n        } else if(isGraph) {\n          inner = expandedItem['@graph'];\n        }\n\n        // recursively compact expanded item\n        let compactedItem = api.compact({\n          activeCtx,\n          activeProperty: itemActiveProperty,\n          element: (isList || isGraph) ? inner : expandedItem,\n          options,\n          compactionMap\n        });\n\n        // handle @list\n        if(isList) {\n          // ensure @list value is an array\n          if(!_isArray(compactedItem)) {\n            compactedItem = [compactedItem];\n          }\n\n          if(!container.includes('@list')) {\n            // wrap using @list alias\n            compactedItem = {\n              [api.compactIri({\n                activeCtx,\n                iri: '@list',\n                relativeTo: {vocab: true}\n              })]: compactedItem\n            };\n\n            // include @index from expanded @list, if any\n            if('@index' in expandedItem) {\n              compactedItem[api.compactIri({\n                activeCtx,\n                iri: '@index',\n                relativeTo: {vocab: true}\n              })] = expandedItem['@index'];\n            }\n          } else if(nestResult.hasOwnProperty(itemActiveProperty)) {\n            // can't use @list container for more than 1 list\n            throw new JsonLdError(\n              'JSON-LD compact error; property has a \"@list\" @container ' +\n              'rule but there is more than a single @list that matches ' +\n              'the compacted term in the document. Compaction might mix ' +\n              'unwanted items into the list.',\n              'jsonld.SyntaxError', {code: 'compaction to list of lists'});\n          }\n        }\n\n        // Graph object compaction cases\n        if(isGraph) {\n          if(container.includes('@graph') && (container.includes('@id') ||\n            container.includes('@index') && _isSimpleGraph(expandedItem))) {\n            // get or create the map object\n            let mapObject;\n            if(nestResult.hasOwnProperty(itemActiveProperty)) {\n              mapObject = nestResult[itemActiveProperty];\n            } else {\n              nestResult[itemActiveProperty] = mapObject = {};\n            }\n\n            // index on @id or @index or alias of @none\n            const key = (container.includes('@id') ?\n              expandedItem['@id'] : expandedItem['@index']) ||\n              api.compactIri({activeCtx, iri: '@none', vocab: true});\n            // add compactedItem to map, using value of `@id` or a new blank\n            // node identifier\n\n            _addValue(\n              mapObject, key, compactedItem, {\n                propertyIsArray:\n                  (!options.compactArrays || container.includes('@set'))\n              });\n          } else if(container.includes('@graph') &&\n            _isSimpleGraph(expandedItem)) {\n            // container includes @graph but not @id or @index and value is a\n            // simple graph object add compact value\n            _addValue(\n              nestResult, itemActiveProperty, compactedItem, {\n                propertyIsArray:\n                  (!options.compactArrays || container.includes('@set'))\n              });\n          } else {\n            // wrap using @graph alias, remove array if only one item and\n            // compactArrays not set\n            if(_isArray(compactedItem) && compactedItem.length === 1 &&\n              options.compactArrays) {\n              compactedItem = compactedItem[0];\n            }\n            compactedItem = {\n              [api.compactIri({\n                activeCtx,\n                iri: '@graph',\n                relativeTo: {vocab: true}\n              })]: compactedItem\n            };\n\n            // include @id from expanded graph, if any\n            if('@id' in expandedItem) {\n              compactedItem[api.compactIri({\n                activeCtx,\n                iri: '@id',\n                relativeTo: {vocab: true}\n              })] = expandedItem['@id'];\n            }\n\n            // include @index from expanded graph, if any\n            if('@index' in expandedItem) {\n              compactedItem[api.compactIri({\n                activeCtx,\n                iri: '@index',\n                relativeTo: {vocab: true}\n              })] = expandedItem['@index'];\n            }\n            _addValue(\n              nestResult, itemActiveProperty, compactedItem, {\n                propertyIsArray:\n                  (!options.compactArrays || container.includes('@set'))\n              });\n          }\n        } else if(container.includes('@language') ||\n          container.includes('@index') || container.includes('@id') ||\n          container.includes('@type')) {\n          // handle language and index maps\n          // get or create the map object\n          let mapObject;\n          if(nestResult.hasOwnProperty(itemActiveProperty)) {\n            mapObject = nestResult[itemActiveProperty];\n          } else {\n            nestResult[itemActiveProperty] = mapObject = {};\n          }\n\n          let key;\n          if(container.includes('@language')) {\n          // if container is a language map, simplify compacted value to\n          // a simple string\n            if(_isValue(compactedItem)) {\n              compactedItem = compactedItem['@value'];\n            }\n            key = expandedItem['@language'];\n          } else if(container.includes('@index')) {\n            key = expandedItem['@index'];\n          } else if(container.includes('@id')) {\n            const idKey = api.compactIri({activeCtx, iri: '@id', vocab: true});\n            key = compactedItem[idKey];\n            delete compactedItem[idKey];\n          } else if(container.includes('@type')) {\n            const typeKey = api.compactIri({\n              activeCtx,\n              iri: '@type',\n              vocab: true\n            });\n            let types;\n            [key, ...types] = _asArray(compactedItem[typeKey] || []);\n            switch(types.length) {\n              case 0:\n                delete compactedItem[typeKey];\n                break;\n              case 1:\n                compactedItem[typeKey] = types[0];\n                break;\n              default:\n                compactedItem[typeKey] = types;\n                break;\n            }\n          }\n\n          // if compacting this value which has no key, index on @none\n          if(!key) {\n            key = api.compactIri({activeCtx, iri: '@none', vocab: true});\n          }\n          // add compact value to map object using key from expanded value\n          // based on the container type\n          _addValue(\n            mapObject, key, compactedItem, {\n              propertyIsArray: container.includes('@set')\n            });\n        } else {\n          // use an array if: compactArrays flag is false,\n          // @container is @set or @list , value is an empty\n          // array, or key is @graph\n          const isArray = (!options.compactArrays ||\n            container.includes('@set') || container.includes('@list') ||\n            (_isArray(compactedItem) && compactedItem.length === 0) ||\n            expandedProperty === '@list' || expandedProperty === '@graph');\n\n          // add compact value\n          _addValue(\n            nestResult, itemActiveProperty, compactedItem,\n            {propertyIsArray: isArray});\n        }\n      }\n    }\n\n    return rval;\n  }\n\n  // only primitives remain which are already compact\n  return element;\n};\n\n/**\n * Compacts an IRI or keyword into a term or prefix if it can be. If the\n * IRI has an associated value it may be passed.\n *\n * @param activeCtx the active context to use.\n * @param iri the IRI to compact.\n * @param value the value to check or null.\n * @param relativeTo options for how to compact IRIs:\n *          vocab: true to split after @vocab, false not to.\n * @param reverse true if a reverse property is being compacted, false if not.\n *\n * @return the compacted term, prefix, keyword alias, or the original IRI.\n */\napi.compactIri = ({\n  activeCtx,\n  iri,\n  value = null,\n  relativeTo = {vocab: false},\n  reverse = false\n}) => {\n  // can't compact null\n  if(iri === null) {\n    return iri;\n  }\n\n  // if context is from a property term scoped context composed with a\n  // type-scoped context, then use the previous context instead\n  if(activeCtx.isPropertyTermScoped && activeCtx.previousContext) {\n    activeCtx = activeCtx.previousContext;\n  }\n\n  const inverseCtx = activeCtx.getInverse();\n\n  // if term is a keyword, it may be compacted to a simple alias\n  if(_isKeyword(iri) &&\n    iri in inverseCtx &&\n    '@none' in inverseCtx[iri] &&\n    '@type' in inverseCtx[iri]['@none'] &&\n    '@none' in inverseCtx[iri]['@none']['@type']) {\n    return inverseCtx[iri]['@none']['@type']['@none'];\n  }\n\n  // use inverse context to pick a term if iri is relative to vocab\n  if(relativeTo.vocab && iri in inverseCtx) {\n    const defaultLanguage = activeCtx['@language'] || '@none';\n\n    // prefer @index if available in value\n    const containers = [];\n    if(_isObject(value) && '@index' in value && !('@graph' in value)) {\n      containers.push('@index', '@index@set');\n    }\n\n    // if value is a preserve object, use its value\n    if(_isObject(value) && '@preserve' in value) {\n      value = value['@preserve'][0];\n    }\n\n    // prefer most specific container including @graph, prefering @set\n    // variations\n    if(_isGraph(value)) {\n      // favor indexmap if the graph is indexed\n      if('@index' in value) {\n        containers.push(\n          '@graph@index', '@graph@index@set', '@index', '@index@set');\n      }\n      // favor idmap if the graph is has an @id\n      if('@id' in value) {\n        containers.push(\n          '@graph@id', '@graph@id@set');\n      }\n      containers.push('@graph', '@graph@set', '@set');\n      // allow indexmap if the graph is not indexed\n      if(!('@index' in value)) {\n        containers.push(\n          '@graph@index', '@graph@index@set', '@index', '@index@set');\n      }\n      // allow idmap if the graph does not have an @id\n      if(!('@id' in value)) {\n        containers.push('@graph@id', '@graph@id@set');\n      }\n    } else if(_isObject(value) && !_isValue(value)) {\n      containers.push('@id', '@id@set', '@type', '@set@type');\n    }\n\n    // defaults for term selection based on type/language\n    let typeOrLanguage = '@language';\n    let typeOrLanguageValue = '@null';\n\n    if(reverse) {\n      typeOrLanguage = '@type';\n      typeOrLanguageValue = '@reverse';\n      containers.push('@set');\n    } else if(_isList(value)) {\n      // choose the most specific term that works for all elements in @list\n      // only select @list containers if @index is NOT in value\n      if(!('@index' in value)) {\n        containers.push('@list');\n      }\n      const list = value['@list'];\n      if(list.length === 0) {\n        // any empty list can be matched against any term that uses the\n        // @list container regardless of @type or @language\n        typeOrLanguage = '@any';\n        typeOrLanguageValue = '@none';\n      } else {\n        let commonLanguage = (list.length === 0) ? defaultLanguage : null;\n        let commonType = null;\n        for(let i = 0; i < list.length; ++i) {\n          const item = list[i];\n          let itemLanguage = '@none';\n          let itemType = '@none';\n          if(_isValue(item)) {\n            if('@language' in item) {\n              itemLanguage = item['@language'];\n            } else if('@type' in item) {\n              itemType = item['@type'];\n            } else {\n              // plain literal\n              itemLanguage = '@null';\n            }\n          } else {\n            itemType = '@id';\n          }\n          if(commonLanguage === null) {\n            commonLanguage = itemLanguage;\n          } else if(itemLanguage !== commonLanguage && _isValue(item)) {\n            commonLanguage = '@none';\n          }\n          if(commonType === null) {\n            commonType = itemType;\n          } else if(itemType !== commonType) {\n            commonType = '@none';\n          }\n          // there are different languages and types in the list, so choose\n          // the most generic term, no need to keep iterating the list\n          if(commonLanguage === '@none' && commonType === '@none') {\n            break;\n          }\n        }\n        commonLanguage = commonLanguage || '@none';\n        commonType = commonType || '@none';\n        if(commonType !== '@none') {\n          typeOrLanguage = '@type';\n          typeOrLanguageValue = commonType;\n        } else {\n          typeOrLanguageValue = commonLanguage;\n        }\n      }\n    } else {\n      if(_isValue(value)) {\n        if('@language' in value && !('@index' in value)) {\n          containers.push('@language', '@language@set');\n          typeOrLanguageValue = value['@language'];\n        } else if('@type' in value) {\n          typeOrLanguage = '@type';\n          typeOrLanguageValue = value['@type'];\n        }\n      } else {\n        typeOrLanguage = '@type';\n        typeOrLanguageValue = '@id';\n      }\n      containers.push('@set');\n    }\n\n    // do term selection\n    containers.push('@none');\n\n    // an index map can be used to index values using @none, so add as a low\n    // priority\n    if(_isObject(value) && !('@index' in value)) {\n      // allow indexing even if no @index present\n      containers.push('@index', '@index@set');\n    }\n\n    // values without type or language can use @language map\n    if(_isValue(value) && Object.keys(value).length === 1) {\n      // allow indexing even if no @index present\n      containers.push('@language', '@language@set');\n    }\n\n    const term = _selectTerm(\n      activeCtx, iri, value, containers, typeOrLanguage, typeOrLanguageValue);\n    if(term !== null) {\n      return term;\n    }\n  }\n\n  // no term match, use @vocab if available\n  if(relativeTo.vocab) {\n    if('@vocab' in activeCtx) {\n      // determine if vocab is a prefix of the iri\n      const vocab = activeCtx['@vocab'];\n      if(iri.indexOf(vocab) === 0 && iri !== vocab) {\n        // use suffix as relative iri if it is not a term in the active context\n        const suffix = iri.substr(vocab.length);\n        if(!activeCtx.mappings.has(suffix)) {\n          return suffix;\n        }\n      }\n    }\n  }\n\n  // no term or @vocab match, check for possible CURIEs\n  let choice = null;\n  // TODO: make FastCurieMap a class with a method to do this lookup\n  const partialMatches = [];\n  let iriMap = activeCtx.fastCurieMap;\n  // check for partial matches of against `iri`, which means look until\n  // iri.length - 1, not full length\n  const maxPartialLength = iri.length - 1;\n  for(let i = 0; i < maxPartialLength && iri[i] in iriMap; ++i) {\n    iriMap = iriMap[iri[i]];\n    if('' in iriMap) {\n      partialMatches.push(iriMap[''][0]);\n    }\n  }\n  // check partial matches in reverse order to prefer longest ones first\n  for(let i = partialMatches.length - 1; i >= 0; --i) {\n    const entry = partialMatches[i];\n    const terms = entry.terms;\n    for(const term of terms) {\n      // a CURIE is usable if:\n      // 1. it has no mapping, OR\n      // 2. value is null, which means we're not compacting an @value, AND\n      //   the mapping matches the IRI\n      const curie = term + ':' + iri.substr(entry.iri.length);\n      const isUsableCurie = (activeCtx.mappings.get(term)._prefix &&\n        (!activeCtx.mappings.has(curie) ||\n        (value === null && activeCtx.mappings.get(curie)['@id'] === iri)));\n\n      // select curie if it is shorter or the same length but lexicographically\n      // less than the current choice\n      if(isUsableCurie && (choice === null ||\n        _compareShortestLeast(curie, choice) < 0)) {\n        choice = curie;\n      }\n    }\n  }\n\n  // return chosen curie\n  if(choice !== null) {\n    return choice;\n  }\n\n  // compact IRI relative to base\n  if(!relativeTo.vocab) {\n    return _removeBase(activeCtx['@base'], iri);\n  }\n\n  // return IRI as is\n  return iri;\n};\n\n/**\n * Performs value compaction on an object with '@value' or '@id' as the only\n * property.\n *\n * @param activeCtx the active context.\n * @param activeProperty the active property that points to the value.\n * @param value the value to compact.\n * @param {Object} [options] - processing options.\n *\n * @return the compaction result.\n */\napi.compactValue = ({activeCtx, activeProperty, value, options}) => {\n  // value is a @value\n  if(_isValue(value)) {\n    // get context rules\n    const type = _getContextValue(activeCtx, activeProperty, '@type');\n    const language = _getContextValue(activeCtx, activeProperty, '@language');\n    const container =\n      _getContextValue(activeCtx, activeProperty, '@container') || [];\n\n    // whether or not the value has an @index that must be preserved\n    const preserveIndex = '@index' in value && !container.includes('@index');\n\n    // if there's no @index to preserve ...\n    if(!preserveIndex) {\n      // matching @type or @language specified in context, compact value\n      if(value['@type'] === type || value['@language'] === language) {\n        return value['@value'];\n      }\n    }\n\n    // return just the value of @value if all are true:\n    // 1. @value is the only key or @index isn't being preserved\n    // 2. there is no default language or @value is not a string or\n    //   the key has a mapping with a null @language\n    const keyCount = Object.keys(value).length;\n    const isValueOnlyKey = (keyCount === 1 ||\n      (keyCount === 2 && '@index' in value && !preserveIndex));\n    const hasDefaultLanguage = ('@language' in activeCtx);\n    const isValueString = _isString(value['@value']);\n    const hasNullMapping = (activeCtx.mappings.has(activeProperty) &&\n      activeCtx.mappings.get(activeProperty)['@language'] === null);\n    if(isValueOnlyKey &&\n      (!hasDefaultLanguage || !isValueString || hasNullMapping)) {\n      return value['@value'];\n    }\n\n    const rval = {};\n\n    // preserve @index\n    if(preserveIndex) {\n      rval[api.compactIri({\n        activeCtx,\n        iri: '@index',\n        relativeTo: {vocab: true}\n      })] = value['@index'];\n    }\n\n    if('@type' in value) {\n      // compact @type IRI\n      rval[api.compactIri({\n        activeCtx,\n        iri: '@type',\n        relativeTo: {vocab: true}\n      })] = api.compactIri(\n        {activeCtx, iri: value['@type'], relativeTo: {vocab: true}});\n    } else if('@language' in value) {\n      // alias @language\n      rval[api.compactIri({\n        activeCtx,\n        iri: '@language',\n        relativeTo: {vocab: true}\n      })] = value['@language'];\n    }\n\n    // alias @value\n    rval[api.compactIri({\n      activeCtx,\n      iri: '@value',\n      relativeTo: {vocab: true}\n    })] = value['@value'];\n\n    return rval;\n  }\n\n  // value is a subject reference\n  const expandedProperty = _expandIri(activeCtx, activeProperty, {vocab: true},\n    options);\n  const type = _getContextValue(activeCtx, activeProperty, '@type');\n  const compacted = api.compactIri(\n    {activeCtx, iri: value['@id'], relativeTo: {vocab: type === '@vocab'}});\n\n  // compact to scalar\n  if(type === '@id' || type === '@vocab' || expandedProperty === '@graph') {\n    return compacted;\n  }\n\n  return {\n    [api.compactIri({\n      activeCtx,\n      iri: '@id',\n      relativeTo: {vocab: true}\n    })]: compacted\n  };\n};\n\n/**\n * Removes the @preserve keywords as the last step of the compaction\n * algorithm when it is running on framed output.\n *\n * @param ctx the active context used to compact the input.\n * @param input the framed, compacted output.\n * @param options the compaction options used.\n *\n * @return the resulting output.\n */\napi.removePreserve = (ctx, input, options) => {\n  // recurse through arrays\n  if(_isArray(input)) {\n    const output = [];\n    for(let i = 0; i < input.length; ++i) {\n      const result = api.removePreserve(ctx, input[i], options);\n      // drop nulls from arrays\n      if(result !== null) {\n        output.push(result);\n      }\n    }\n    input = output;\n  } else if(_isObject(input)) {\n    // remove @preserve\n    if('@preserve' in input) {\n      if(input['@preserve'] === '@null') {\n        return null;\n      }\n      return input['@preserve'];\n    }\n\n    // skip @values\n    if(_isValue(input)) {\n      return input;\n    }\n\n    // recurse through @lists\n    if(_isList(input)) {\n      input['@list'] = api.removePreserve(ctx, input['@list'], options);\n      return input;\n    }\n\n    // handle in-memory linked nodes\n    const idAlias = api.compactIri({\n      activeCtx: ctx,\n      iri: '@id',\n      relativeTo: {vocab: true}\n    });\n    if(input.hasOwnProperty(idAlias)) {\n      const id = input[idAlias];\n      if(options.link.hasOwnProperty(id)) {\n        const idx = options.link[id].indexOf(input);\n        if(idx !== -1) {\n          // already visited\n          return options.link[id][idx];\n        }\n        // prevent circular visitation\n        options.link[id].push(input);\n      } else {\n        // prevent circular visitation\n        options.link[id] = [input];\n      }\n    }\n\n    // recurse through properties\n    const graphAlias = api.compactIri({\n      activeCtx: ctx,\n      iri: '@graph',\n      relativeTo: {vocab: true}\n    });\n    for(const prop in input) {\n      // potentially remove the id, if it is an unreference bnode\n      if(prop === idAlias && options.bnodesToClear.includes(input[prop])) {\n        delete input[idAlias];\n        continue;\n      }\n\n      let result = api.removePreserve(ctx, input[prop], options);\n      const container = _getContextValue(ctx, prop, '@container') || [];\n      if(options.compactArrays && _isArray(result) && result.length === 1 &&\n        container.length === 0 && prop !== graphAlias) {\n        result = result[0];\n      }\n      input[prop] = result;\n    }\n  }\n  return input;\n};\n\n/**\n * Picks the preferred compaction term from the given inverse context entry.\n *\n * @param activeCtx the active context.\n * @param iri the IRI to pick the term for.\n * @param value the value to pick the term for.\n * @param containers the preferred containers.\n * @param typeOrLanguage either '@type' or '@language'.\n * @param typeOrLanguageValue the preferred value for '@type' or '@language'.\n *\n * @return the preferred term.\n */\nfunction _selectTerm(\n  activeCtx, iri, value, containers, typeOrLanguage, typeOrLanguageValue) {\n  if(typeOrLanguageValue === null) {\n    typeOrLanguageValue = '@null';\n  }\n\n  // preferences for the value of @type or @language\n  const prefs = [];\n\n  // determine prefs for @id based on whether or not value compacts to a term\n  if((typeOrLanguageValue === '@id' || typeOrLanguageValue === '@reverse') &&\n    _isSubjectReference(value)) {\n    // prefer @reverse first\n    if(typeOrLanguageValue === '@reverse') {\n      prefs.push('@reverse');\n    }\n    // try to compact value to a term\n    const term = api.compactIri(\n      {activeCtx, iri: value['@id'], relativeTo: {vocab: true}});\n    if(activeCtx.mappings.has(term) &&\n      activeCtx.mappings.get(term) &&\n      activeCtx.mappings.get(term)['@id'] === value['@id']) {\n      // prefer @vocab\n      prefs.push.apply(prefs, ['@vocab', '@id']);\n    } else {\n      // prefer @id\n      prefs.push.apply(prefs, ['@id', '@vocab']);\n    }\n  } else {\n    prefs.push(typeOrLanguageValue);\n  }\n  prefs.push('@none');\n\n  const containerMap = activeCtx.inverse[iri];\n  for(let ci = 0; ci < containers.length; ++ci) {\n    // if container not available in the map, continue\n    const container = containers[ci];\n    if(!(container in containerMap)) {\n      continue;\n    }\n\n    const typeOrLanguageValueMap = containerMap[container][typeOrLanguage];\n    for(let pi = 0; pi < prefs.length; ++pi) {\n      // if type/language option not available in the map, continue\n      const pref = prefs[pi];\n      if(!(pref in typeOrLanguageValueMap)) {\n        continue;\n      }\n\n      // select term\n      return typeOrLanguageValueMap[pref];\n    }\n  }\n\n  return null;\n}\n\n/**\n * The value of `@nest` in the term definition must either be `@nest`, or a term\n * which resolves to `@nest`.\n *\n * @param activeCtx the active context.\n * @param nestProperty a term in the active context or `@nest`.\n * @param {Object} [options] - processing options.\n */\nfunction _checkNestProperty(activeCtx, nestProperty, options) {\n  if(_expandIri(activeCtx, nestProperty, {vocab: true}, options) !== '@nest') {\n    throw new JsonLdError(\n      'JSON-LD compact error; nested property must have an @nest value ' +\n      'resolving to @nest.',\n      'jsonld.SyntaxError', {code: 'invalid @nest value'});\n  }\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {parseLinkHeader, buildHeaders} = require('../util');\nconst {LINK_HEADER_REL} = require('../constants');\nconst JsonLdError = require('../JsonLdError');\nconst RequestQueue = require('../RequestQueue');\n\n/**\n * Creates a built-in node document loader.\n *\n * @param options the options to use:\n *          secure: require all URLs to use HTTPS.\n *          strictSSL: true to require SSL certificates to be valid,\n *            false not to (default: true).\n *          maxRedirects: the maximum number of redirects to permit, none by\n *            default.\n *          request: the object which will make the request, default is\n *            provided by `https://www.npmjs.com/package/request`.\n *          headers: an object (map) of headers which will be passed as request\n *            headers for the requested document. Accept is not allowed.\n *\n * @return the node document loader.\n */\nmodule.exports = ({\n  secure,\n  strictSSL = true,\n  maxRedirects = -1,\n  request,\n  headers = {}\n} = {strictSSL: true, maxRedirects: -1, headers: {}}) => {\n  headers = buildHeaders(headers);\n  // TODO: use `r2`\n  request = request || require('request');\n  const http = require('http');\n  // TODO: disable cache until HTTP caching implemented\n  //const cache = new DocumentCache();\n\n  const queue = new RequestQueue();\n  return queue.wrapLoader(function(url) {\n    return loadDocument(url, []);\n  });\n\n  async function loadDocument(url, redirects) {\n    if(url.indexOf('http:') !== 0 && url.indexOf('https:') !== 0) {\n      throw new JsonLdError(\n        'URL could not be dereferenced; only \"http\" and \"https\" URLs are ' +\n        'supported.',\n        'jsonld.InvalidUrl', {code: 'loading document failed', url});\n    }\n    if(secure && url.indexOf('https') !== 0) {\n      throw new JsonLdError(\n        'URL could not be dereferenced; secure mode is enabled and ' +\n        'the URL\\'s scheme is not \"https\".',\n        'jsonld.InvalidUrl', {code: 'loading document failed', url});\n    }\n    // TODO: disable cache until HTTP caching implemented\n    let doc = null;//cache.get(url);\n    if(doc !== null) {\n      return doc;\n    }\n\n    let result;\n    try {\n      result = await _request(request, {\n        url,\n        headers,\n        strictSSL,\n        followRedirect: false\n      });\n    } catch(e) {\n      throw new JsonLdError(\n        'URL could not be dereferenced, an error occurred.',\n        'jsonld.LoadDocumentError',\n        {code: 'loading document failed', url, cause: e});\n    }\n\n    const {res, body} = result;\n\n    doc = {contextUrl: null, documentUrl: url, document: body || null};\n\n    // handle error\n    const statusText = http.STATUS_CODES[res.statusCode];\n    if(res.statusCode >= 400) {\n      throw new JsonLdError(\n        'URL could not be dereferenced: ' + statusText,\n        'jsonld.InvalidUrl', {\n          code: 'loading document failed',\n          url,\n          httpStatusCode: res.statusCode\n        });\n    }\n\n    // handle Link Header\n    if(res.headers.link &&\n      res.headers['content-type'] !== 'application/ld+json') {\n      // only 1 related link header permitted\n      const linkHeader = parseLinkHeader(res.headers.link)[LINK_HEADER_REL];\n      if(Array.isArray(linkHeader)) {\n        throw new JsonLdError(\n          'URL could not be dereferenced, it has more than one associated ' +\n          'HTTP Link Header.',\n          'jsonld.InvalidUrl',\n          {code: 'multiple context link headers', url});\n      }\n      if(linkHeader) {\n        doc.contextUrl = linkHeader.target;\n      }\n    }\n\n    // handle redirect\n    if(res.statusCode >= 300 && res.statusCode < 400 && res.headers.location) {\n      if(redirects.length === maxRedirects) {\n        throw new JsonLdError(\n          'URL could not be dereferenced; there were too many redirects.',\n          'jsonld.TooManyRedirects', {\n            code: 'loading document failed',\n            url,\n            httpStatusCode: res.statusCode,\n            redirects\n          });\n      }\n      if(redirects.indexOf(url) !== -1) {\n        throw new JsonLdError(\n          'URL could not be dereferenced; infinite redirection was detected.',\n          'jsonld.InfiniteRedirectDetected', {\n            code: 'recursive context inclusion',\n            url,\n            httpStatusCode: res.statusCode,\n            redirects\n          });\n      }\n      redirects.push(url);\n      return loadDocument(res.headers.location, redirects);\n    }\n\n    // cache for each redirected URL\n    redirects.push(url);\n    // TODO: disable cache until HTTP caching implemented\n    /*\n    for(let i = 0; i < redirects.length; ++i) {\n      cache.set(\n        redirects[i],\n        {contextUrl: null, documentUrl: redirects[i], document: body});\n    }\n    */\n\n    return doc;\n  }\n};\n\nfunction _request(request, options) {\n  return new Promise((resolve, reject) => {\n    request(options, (err, res, body) => {\n      if(err) {\n        reject(err);\n      } else {\n        resolve({res, body});\n      }\n    });\n  });\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst {parseLinkHeader, buildHeaders} = require('../util');\nconst {LINK_HEADER_REL} = require('../constants');\nconst JsonLdError = require('../JsonLdError');\nconst RequestQueue = require('../RequestQueue');\n\nconst REGEX_LINK_HEADER = /(^|(\\r\\n))link:/i;\n\n/**\n * Creates a built-in XMLHttpRequest document loader.\n *\n * @param options the options to use:\n *          secure: require all URLs to use HTTPS.\n *          headers: an object (map) of headers which will be passed as request\n *            headers for the requested document. Accept is not allowed.\n *          [xhr]: the XMLHttpRequest API to use.\n *\n * @return the XMLHttpRequest document loader.\n */\nmodule.exports = ({\n  secure,\n  headers = {},\n  xhr\n} = {headers: {}}) => {\n  headers = buildHeaders(headers);\n  const queue = new RequestQueue();\n  return queue.wrapLoader(loader);\n\n  async function loader(url) {\n    if(url.indexOf('http:') !== 0 && url.indexOf('https:') !== 0) {\n      throw new JsonLdError(\n        'URL could not be dereferenced; only \"http\" and \"https\" URLs are ' +\n        'supported.',\n        'jsonld.InvalidUrl', {code: 'loading document failed', url});\n    }\n    if(secure && url.indexOf('https') !== 0) {\n      throw new JsonLdError(\n        'URL could not be dereferenced; secure mode is enabled and ' +\n        'the URL\\'s scheme is not \"https\".',\n        'jsonld.InvalidUrl', {code: 'loading document failed', url});\n    }\n\n    let req;\n    try {\n      req = await _get(xhr, url, headers);\n    } catch(e) {\n      throw new JsonLdError(\n        'URL could not be dereferenced, an error occurred.',\n        'jsonld.LoadDocumentError',\n        {code: 'loading document failed', url, cause: e});\n    }\n\n    if(req.status >= 400) {\n      throw new JsonLdError(\n        'URL could not be dereferenced: ' + req.statusText,\n        'jsonld.LoadDocumentError', {\n          code: 'loading document failed',\n          url,\n          httpStatusCode: req.status\n        });\n    }\n\n    const doc = {contextUrl: null, documentUrl: url, document: req.response};\n\n    // handle Link Header (avoid unsafe header warning by existence testing)\n    const contentType = req.getResponseHeader('Content-Type');\n    let linkHeader;\n    if(REGEX_LINK_HEADER.test(req.getAllResponseHeaders())) {\n      linkHeader = req.getResponseHeader('Link');\n    }\n    if(linkHeader && contentType !== 'application/ld+json') {\n      // only 1 related link header permitted\n      linkHeader = parseLinkHeader(linkHeader)[LINK_HEADER_REL];\n      if(Array.isArray(linkHeader)) {\n        throw new JsonLdError(\n          'URL could not be dereferenced, it has more than one ' +\n          'associated HTTP Link Header.',\n          'jsonld.InvalidUrl',\n          {code: 'multiple context link headers', url});\n      }\n      if(linkHeader) {\n        doc.contextUrl = linkHeader.target;\n      }\n    }\n\n    return doc;\n  }\n};\n\nfunction _get(xhr, url, headers) {\n  xhr = xhr || XMLHttpRequest;\n  const req = new xhr();\n  return new Promise((resolve, reject) => {\n    req.onload = () => resolve(req);\n    req.onerror = err => reject(err);\n    req.open('GET', url, true);\n    for(const k in headers) {\n      req.setRequestHeader(k, headers[k]);\n    }\n    req.send();\n  });\n}\n","/*\n * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nmodule.exports = jsonld => {\n  class JsonLdProcessor {\n    toString() {\n      return '[object JsonLdProcessor]';\n    }\n  }\n  Object.defineProperty(JsonLdProcessor, 'prototype', {\n    writable: false,\n    enumerable: false\n  });\n  Object.defineProperty(JsonLdProcessor.prototype, 'constructor', {\n    writable: true,\n    enumerable: false,\n    configurable: true,\n    value: JsonLdProcessor\n  });\n\n  // The Web IDL test harness will check the number of parameters defined in\n  // the functions below. The number of parameters must exactly match the\n  // required (non-optional) parameters of the JsonLdProcessor interface as\n  // defined here:\n  // https://www.w3.org/TR/json-ld-api/#the-jsonldprocessor-interface\n\n  JsonLdProcessor.compact = function(input, ctx) {\n    if(arguments.length < 2) {\n      return Promise.reject(\n        new TypeError('Could not compact, too few arguments.'));\n    }\n    return jsonld.compact(input, ctx);\n  };\n  JsonLdProcessor.expand = function(input) {\n    if(arguments.length < 1) {\n      return Promise.reject(\n        new TypeError('Could not expand, too few arguments.'));\n    }\n    return jsonld.expand(input);\n  };\n  JsonLdProcessor.flatten = function(input) {\n    if(arguments.length < 1) {\n      return Promise.reject(\n        new TypeError('Could not flatten, too few arguments.'));\n    }\n    return jsonld.flatten(input);\n  };\n\n  return JsonLdProcessor;\n};\n","var BlankNode = require('./blank-node')\nvar DefaultGraph = require('./default-graph')\nvar Literal = require('./literal')\nvar NamedNode = require('./named-node')\nvar Quad = require('./quad')\nvar Variable = require('./variable')\n\nfunction DataFactory () {}\n\nDataFactory.namedNode = function (value) {\n  return new NamedNode(value)\n}\n\nDataFactory.blankNode = function (value) {\n  return new BlankNode(value)\n}\n\nDataFactory.literal = function (value, languageOrDatatype) {\n  if (typeof languageOrDatatype === 'string') {\n    if (languageOrDatatype.indexOf(':') === -1) {\n      return new Literal(value, languageOrDatatype)\n    }\n\n    return new Literal(value, null, DataFactory.namedNode(languageOrDatatype))\n  }\n\n  return new Literal(value, null, languageOrDatatype)\n}\n\nDataFactory.defaultGraph = function () {\n  return DataFactory.defaultGraphInstance\n}\n\nDataFactory.variable = function (value) {\n  return new Variable(value)\n}\n\nDataFactory.triple = function (subject, predicate, object) {\n  return DataFactory.quad(subject, predicate, object)\n}\n\nDataFactory.quad = function (subject, predicate, object, graph) {\n  return new Quad(subject, predicate, object, graph || DataFactory.defaultGraphInstance)\n}\n\nDataFactory.defaultGraphInstance = new DefaultGraph()\n\nmodule.exports = DataFactory\n","function BlankNode (id) {\n  this.value = id || ('b' + (++BlankNode.nextId))\n}\n\nBlankNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nBlankNode.prototype.termType = 'BlankNode'\n\nBlankNode.nextId = 0\n\nmodule.exports = BlankNode\n","var NamedNode = require('./named-node')\n\nfunction Literal (value, language, datatype) {\n  this.value = value\n  this.datatype = Literal.stringDatatype\n  this.language = ''\n\n  if (language) {\n    this.language = language\n    this.datatype = Literal.langStringDatatype\n  } else if (datatype) {\n    this.datatype = datatype\n  }\n}\n\nLiteral.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value &&\n    other.language === this.language && other.datatype.equals(this.datatype)\n}\n\nLiteral.prototype.termType = 'Literal'\nLiteral.langStringDatatype = new NamedNode('http://www.w3.org/1999/02/22-rdf-syntax-ns#langString')\nLiteral.stringDatatype = new NamedNode('http://www.w3.org/2001/XMLSchema#string')\n\nmodule.exports = Literal\n","var DefaultGraph = require('./default-graph')\n\nfunction Quad (subject, predicate, object, graph) {\n  this.subject = subject\n  this.predicate = predicate\n  this.object = object\n\n  if (graph) {\n    this.graph = graph\n  } else {\n    this.graph = new DefaultGraph()\n  }\n}\n\nQuad.prototype.equals = function (other) {\n  return !!other && other.subject.equals(this.subject) && other.predicate.equals(this.predicate) &&\n    other.object.equals(this.object) && other.graph.equals(this.graph)\n}\n\nmodule.exports = Quad\n","function Variable (name) {\n  this.value = name\n}\n\nVariable.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nVariable.prototype.termType = 'Variable'\n\nmodule.exports = Variable\n","var RDFaProcessor = require('rdfa-processor').RDFaProcessor;\nconst DataFactory = require('@rdfjs/data-model')\nmodule.exports = class {\n\n  constructor (options) {\n    this.documentIRI = options.documentIRI;\n    this.factory = options.factory || DataFactory;\n  }\n  \n  parse (document, callback) {\n    try {\n      var processor = new RDFaProcessor(null, this.factory);\n      processor.onTriple = function (triple) {\n        callback(null, triple);\n      }\n      processor.process(document, {baseURI: this.documentIRI});\n    } catch (e) {\n      callback(e);\n    }\n\n  }\n}\n","module.exports = function (string, base) {\n  var parser = new DOMParser();\n  var doc = parser.parseFromString(string, \"text/html\");\n  doc.URL = base;\n  doc.documentURI = base;\n  return doc;\n}\n","import { IEntity, ISemiEntity } from \"../common\";\nimport { IndexThingViewResult } from \"../results\";\nimport { IThingViewResult } from \"../results/common\";\nimport { ThingView } from \"./single\";\n\nexport class IndexThingView<T extends IEntity> extends ThingView<T> {\n    public createResultObject(): IThingViewResult<T> {\n        return new IndexThingViewResult();\n    }\n}\n","import { IEntity, IEntityMap } from \"../common\";\nimport { IThingViewResult } from \"./common\";\n\nexport class IndexThingViewResult<T extends IEntity> implements IThingViewResult<T> {\n    private contents: IEntityMap<T>;\n\n    constructor() {\n        this.contents = {};\n    }\n\n    public addEntity(entity: T) {\n        this.contents[entity.id] = entity;\n    }\n\n    public getContents(): IEntityMap<T> {\n        return this.contents;\n    }\n}\n","import { ISemiEntity } from \"../common\";\nimport { IThingViewResult } from \"./common\";\n\nexport class SingleThingViewResult<T extends ISemiEntity> implements IThingViewResult<T> {\n    private contents: T;\n    public addEntity(entity: T): void {\n        this.contents = entity;\n    }\n\n    public getContents(): T {\n        return this.contents;\n    }\n}\n","import { RoutableTileWay } from \"../tiles/way\";\nimport DynamicProfile from \"./DynamicProfile\";\n\nexport default class CharacteristicProfile extends DynamicProfile {\n    public static create(url: string): CharacteristicProfile {\n        return new CharacteristicProfile(url);\n    }\n\n    private accessCache: object;\n    private onewayCache: object;\n    private speedCache: object;\n    private priorityCache: object;\n\n    constructor(url: string) {\n        super(url);\n        this.accessCache = {};\n        this.onewayCache = {};\n        this.speedCache = {};\n        this.priorityCache = {};\n        this.id = url;\n    }\n\n    public getID(): string {\n        return this.id;\n    }\n\n    public isOneWay(way: RoutableTileWay): boolean {\n        const characteristic = this.getWayCharacteristic(way);\n        if (this.onewayCache[characteristic] !== undefined) {\n            return this.onewayCache[characteristic];\n        }\n\n        const result = super.isOneWay(way);\n        this.onewayCache[characteristic] = result;\n        return result;\n    }\n\n    public hasAccess(way: RoutableTileWay): boolean {\n        const characteristic = this.getWayCharacteristic(way);\n        if (this.accessCache[characteristic] !== undefined) {\n            return this.accessCache[characteristic];\n        }\n\n        const result = super.hasAccess(way);\n        this.accessCache[characteristic] = result;\n        return result;\n    }\n\n    public getSpeed(way: RoutableTileWay): number {\n        const characteristic = this.getWayCharacteristic(way);\n        if (this.speedCache[characteristic] !== undefined) {\n            return this.speedCache[characteristic];\n        }\n\n        const result = super.getSpeed(way);\n        this.speedCache[characteristic] = result;\n        return result;\n    }\n\n    public getMultiplier(way: RoutableTileWay): number {\n        const characteristic = this.getWayCharacteristic(way);\n        if (this.priorityCache[characteristic] !== undefined) {\n            return this.priorityCache[characteristic];\n        }\n\n        const result = super.getMultiplier(way);\n        this.priorityCache[characteristic] = result;\n        return result;\n    }\n\n    private getWayCharacteristic(way: RoutableTileWay) {\n        return way.reachable +\n            way.accessRestrictions +\n            way.bicycleAccessRestrictions +\n            way.constructionKind +\n            way.crossingKind +\n            way.cyclewayKind +\n            way.footwayKind +\n            way.highwayKind +\n            way.maxSpeed +\n            way.motorVehicleAccessRestrictions +\n            way.motorcarAccessRestrictions +\n            way.onewayBicycleKind +\n            way.onewayKind +\n            way.smoothnessKind +\n            way.surfaceKind +\n            way.trackType +\n            way.vehicleAccessRestrictions;\n    }\n}\n","import getOsmTagMapping from \"../../enums/OSMTags\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport Geo from \"../../util/Geo\";\nimport { RoutableTileNode } from \"../tiles/node\";\nimport { RoutableTileWay } from \"../tiles/way\";\nimport Profile from \"./Profile\";\nimport ProfileRule from \"./ProfileRule\";\n\nexport default class DynamicProfile extends Profile {\n    public static create(url: string): DynamicProfile {\n        return new DynamicProfile(url);\n    }\n\n    public id: string;\n    public accessRules: ProfileRule[];\n    public onewayRules: ProfileRule[];\n    public speedRules: ProfileRule[];\n    public priorityRules: ProfileRule[];\n    public obstacleRules: ProfileRule[];\n    public obstacleTimeRules: ProfileRule[];\n\n    public maxSpeed: number;\n    public usePublicTransport: boolean;\n\n    private mapping;\n\n    constructor(url: string) {\n        super();\n        this.id = url;\n        this.mapping = getOsmTagMapping();\n\n        this.accessRules = [];\n        this.onewayRules = [];\n        this.speedRules = [];\n        this.priorityRules = [];\n        this.obstacleRules = [];\n        this.obstacleTimeRules = [];\n\n        this.maxSpeed = 10;\n        this.usePublicTransport = true;\n    }\n\n    public getID(): string {\n        return this.id;\n    }\n\n    public isOneWay(way: RoutableTileWay): boolean {\n        // todo, reversed order\n        for (const rule of this.onewayRules) {\n            if (rule.conclusion.isOneway !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (way[field] === rule.condition.object) {\n                        return rule.conclusion.isOneway;\n                    }\n                } else {\n                    return rule.conclusion.isOneway;\n                }\n            }\n        }\n    }\n\n    public hasAccess(way: RoutableTileWay): boolean {\n        for (const rule of this.accessRules) {\n            if (rule.conclusion.hasAccess !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (way[field] === rule.condition.object) {\n                        return rule.conclusion.hasAccess;\n                    }\n                } else {\n                    return rule.conclusion.hasAccess;\n                }\n            }\n        }\n    }\n\n    public getDefaultSpeed() {\n        return 5;\n    }\n\n    public getMaxSpeed(): number {\n        return this.maxSpeed || 300;\n    }\n\n    public getSpeed(way: RoutableTileWay): number {\n        const speedLimit = Math.min(way.maxSpeed || Infinity, this.getMaxSpeed());\n\n        for (const rule of this.speedRules) {\n            if (rule.conclusion.speed !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (way[field] === rule.condition.object) {\n                        if (typeof (rule.conclusion.speed) === \"number\") {\n                            return Math.min(rule.conclusion.speed, speedLimit);\n                        }\n                    } else {\n                        if (typeof (rule.conclusion.speed) === \"number\") {\n                            return Math.min(rule.conclusion.speed, speedLimit);\n                        }\n                    }\n                }\n            }\n        }\n\n        return Math.min(speedLimit, this.getDefaultSpeed());\n    }\n\n    public getDistance(from: RoutableTileNode, to: RoutableTileNode, way: RoutableTileWay): DistanceM {\n        return Geo.getDistanceBetweenLocations(from, to);\n    }\n\n    public getDuration(from: RoutableTileNode, to: RoutableTileNode, way: RoutableTileWay): DurationMs {\n        const distance = this.getDistance(from, to, way) / 1000; // km\n        const speed = this.getSpeed(way);\n        const time = distance / speed; // h\n        return time * 60 * 60 * 1000; // ms\n    }\n\n    public getMultiplier(way: RoutableTileWay): number {\n        for (const rule of this.priorityRules) {\n            if (rule.conclusion.priority !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (way[field] === rule.condition.object) {\n                        return 1 - (rule.conclusion.priority - 1);\n                    }\n                } else {\n                    return 1 - (rule.conclusion.priority - 1);\n                }\n            }\n        }\n    }\n\n    public getCost(from: RoutableTileNode, to: RoutableTileNode, way: RoutableTileWay): number {\n        return this.getMultiplier(way) * (this.getDuration(from, to, way) + this.getObstacleTime(to));\n    }\n\n    public isObstacle(node: RoutableTileNode): boolean {\n        for (const rule of this.obstacleRules) {\n            if (rule.conclusion.isObstacle !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (node[field] === rule.condition.object) {\n                        return rule.conclusion.isObstacle;\n                    }\n                } else {\n                    return rule.conclusion.isObstacle;\n                }\n            }\n        }\n    }\n\n    public getObstacleTime(node: RoutableTileNode): DurationMs {\n        for (const rule of this.obstacleTimeRules) {\n            if (rule.conclusion.obstacleTime !== undefined) {\n                // should always be the case, but just in case\n                if (rule.condition !== undefined) {\n                    const field = this.mapping[rule.condition.predicate];\n                    if (node[field] && rule.condition.object === undefined) {\n                        return rule.conclusion.obstacleTime * 1000;\n                    }\n                    if (node[field] === rule.condition.object && rule.condition.object !== undefined) {\n                        return rule.conclusion.obstacleTime * 1000;\n                    }\n                } else {\n                    return rule.conclusion.obstacleTime * 1000;\n                }\n            }\n        }\n\n        return 0;\n    }\n}\n","import { OSM } from \"../uri/constants\";\nimport URI from \"../uri/uri\";\n\nexport default function getOsmTagMapping() {\n    const result = {};\n\n    result[URI.inNS(OSM, \"access\")] = \"accessRestrictions\";\n    result[URI.inNS(OSM, \"bicycle\")] = \"bicycleAccessRestrictions\";\n    result[URI.inNS(OSM, \"construction\")] = \"constructionKind\";\n    result[URI.inNS(OSM, \"crossing\")] = \"crossingKind\";\n    result[URI.inNS(OSM, \"cycleway\")] = \"cyclewayKind\";\n    result[URI.inNS(OSM, \"footway\")] = \"footwayKind\";\n    result[URI.inNS(OSM, \"highway\")] = \"highwayKind\";\n    result[URI.inNS(OSM, \"maxspeed\")] = \"maxSpeed\";\n    result[URI.inNS(OSM, \"motor_vehicle\")] = \"motorVehicleAccessRestrictions\";\n    result[URI.inNS(OSM, \"motorcar\")] = \"motorcarAccessRestrictions\";\n    result[URI.inNS(OSM, \"oneway_bicycle\")] = \"onewayBicycleKind\";\n    result[URI.inNS(OSM, \"oneway\")] = \"onewayKind\";\n    result[URI.inNS(OSM, \"smoothness\")] = \"smoothnessKind\";\n    result[URI.inNS(OSM, \"surface\")] = \"surfaceKind\";\n    result[URI.inNS(OSM, \"tracktype\")] = \"trackType\";\n    result[URI.inNS(OSM, \"vehicle\")] = \"vehicleAccessRestrictions\";\n\n    return result;\n}\n","var haversine = (function () {\n  var RADII = {\n    km:    6371,\n    mile:  3960,\n    meter: 6371000,\n    nmi:   3440\n  }\n\n  // convert to radians\n  var toRad = function (num) {\n    return num * Math.PI / 180\n  }\n\n  // convert coordinates to standard format based on the passed format option\n  var convertCoordinates = function (format, coordinates) {\n    switch (format) {\n    case '[lat,lon]':\n      return { latitude: coordinates[0], longitude: coordinates[1] }\n    case '[lon,lat]':\n      return { latitude: coordinates[1], longitude: coordinates[0] }\n    case '{lon,lat}':\n      return { latitude: coordinates.lat, longitude: coordinates.lon }\n    case '{lat,lng}':\n      return { latitude: coordinates.lat, longitude: coordinates.lng }\n    case 'geojson':\n      return { latitude: coordinates.geometry.coordinates[1], longitude: coordinates.geometry.coordinates[0] }\n    default:\n      return coordinates\n    }\n  }\n\n  return function haversine (startCoordinates, endCoordinates, options) {\n    options   = options || {}\n\n    var R = options.unit in RADII\n      ? RADII[options.unit]\n      : RADII.km\n\n    var start = convertCoordinates(options.format, startCoordinates)\n    var end = convertCoordinates(options.format, endCoordinates)\n\n    var dLat = toRad(end.latitude - start.latitude)\n    var dLon = toRad(end.longitude - start.longitude)\n    var lat1 = toRad(start.latitude)\n    var lat2 = toRad(end.latitude)\n\n    var a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n            Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2)\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))\n\n    if (options.threshold) {\n      return options.threshold > (R * c)\n    }\n\n    return R * c\n  }\n\n})()\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = haversine\n}\n","import ILocation from \"../../interfaces/ILocation\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport { RoutableTileNode } from \"../tiles/node\";\nimport { RoutableTileWay } from \"../tiles/way\";\n\nexport default abstract class Profile {\n    public abstract getID(): string;\n\n    public abstract isOneWay(way: RoutableTileWay): boolean;\n    public abstract hasAccess(way: RoutableTileWay): boolean;\n\n    public abstract getDefaultSpeed(): number;\n    public abstract getMaxSpeed(): number;\n    public abstract getSpeed(way: RoutableTileWay): number;\n\n    public abstract getDistance(from: ILocation, to: ILocation, way: RoutableTileWay): DistanceM;\n    public abstract getDuration(from: ILocation, to: ILocation, way: RoutableTileWay): DurationMs;\n\n    public abstract getMultiplier(way: RoutableTileWay): number;\n    public abstract getCost(from: ILocation, to: ILocation, way: RoutableTileWay): number;\n\n    public abstract isObstacle(node: RoutableTileNode): boolean;\n    public abstract getObstacleTime(node: RoutableTileNode): DurationMs;\n}\n","import { IEntity } from \"../../loader/common\";\nimport ProfileValueReference from \"./ProfileValueReference\";\n\nexport default class ProfileConclusion implements IEntity {\n    public static create(id: string): ProfileConclusion {\n        return new ProfileConclusion(id);\n    }\n\n    public id: string;\n    public hasAccess?: boolean;\n    public isOneway?: boolean;\n    public isReversed?: boolean;\n    public speed?: number | ProfileValueReference;\n    public isObstacle?: boolean;\n    public priority?: number;\n    public obstacleTime?: number;\n\n    constructor(id: string) {\n        this.id = id;\n    }\n\n    public getID(): string {\n        return this.id;\n    }\n}\n","import { IEntity } from \"../../loader/common\";\n\nexport default class ProfileCondition implements IEntity {\n    public static create(id: string): ProfileCondition {\n        return new ProfileCondition(id);\n    }\n\n    public id: string;\n    public predicate: string;\n    public object: string;\n\n    constructor(id: string) {\n        this.id = id;\n    }\n\n    public getID(): string {\n        return this.id;\n    }\n}\n","import { IEntity } from \"../../loader/common\";\nimport ProfileConclusion from \"./ProfileConclusion\";\nimport ProfileCondition from \"./ProfileCondition\";\n\nexport default class ProfileRule implements IEntity {\n    public static create(id: string): ProfileRule {\n        return new ProfileRule(id);\n    }\n\n    public id: string;\n    public conclusion: ProfileConclusion;\n    public condition: ProfileCondition;\n    public order: number;\n\n    constructor(id: string) {\n        this.id = id;\n    }\n\n    public getID(): string {\n        return this.id;\n    }\n}\n","import { inject, injectable } from \"inversify\";\nimport LDFetch from \"ldfetch\";\nimport { Triple } from \"rdf-js\";\nimport TYPES from \"../../../types\";\nimport Rdf from \"../../../util/Rdf\";\nimport IStop from \"../IStop\";\nimport IStopsFetcher from \"../IStopsFetcher\";\n\ninterface IPartialStopMap {\n  [stopId: string]: Partial<IStop>;\n}\n\ninterface IStopMap {\n  [stopId: string]: IStop;\n}\n\n@injectable()\nexport default class StopsFetcherLDFetch implements IStopsFetcher {\n\n  private accessUrl: string;\n\n  private ldFetch: LDFetch;\n  private loadPromise: Promise<any>;\n  private stops: IStopMap;\n\n  constructor(\n    @inject(TYPES.LDFetch) ldFetch: LDFetch,\n  ) {\n    this.ldFetch = ldFetch;\n    // FIXME does this ever do something?\n    this.loadStops();\n  }\n\n  public setAccessUrl(accessUrl: string) {\n    this.accessUrl = accessUrl;\n  }\n\n  public prefetchStops(): void {\n    this.ensureStopsLoaded();\n  }\n\n  public async getStopById(stopId: string): Promise<IStop> {\n    await this.ensureStopsLoaded();\n\n    return this.stops[stopId];\n  }\n\n  public async getAllStops(): Promise<IStop[]> {\n    await this.ensureStopsLoaded();\n\n    return Object.values(this.stops);\n  }\n\n  private async ensureStopsLoaded() {\n    if (!this.loadPromise && !this.stops) {\n      this.loadStops();\n    }\n\n    if (this.loadPromise) {\n      await this.loadPromise;\n    }\n  }\n\n  private loadStops() {\n    if (this.accessUrl) {\n\n      this.loadPromise = this.ldFetch\n        .get(this.accessUrl)\n        .then((response) => {\n          this.stops = this.parseTriples(response.triples);\n          this.loadPromise = null;\n        })\n        .catch((reason) => {\n          console.log(reason);\n        });\n    }\n  }\n\n  private transformPredicate(triple: Triple): Triple {\n    return Rdf.transformPredicate({\n      \"http://xmlns.com/foaf/0.1/name\": \"name\",\n      \"http://www.w3.org/2003/01/geo/wgs84_pos#lat\": \"latitude\",\n      \"http://www.w3.org/2003/01/geo/wgs84_pos#long\": \"longitude\",\n    }, triple);\n  }\n\n  private parseTriples(triples: Triple[]): IStopMap {\n    return triples.reduce((stopMap: IPartialStopMap, triple: Triple) => {\n      triple = this.transformPredicate(triple);\n\n      const { subject: { value: subject }, predicate: { value: predicate }, object: { value: object } } = triple;\n\n      if (!(subject in stopMap)) {\n        stopMap[subject] = {\n          id: subject,\n        };\n      }\n\n      if (predicate === \"longitude\" || predicate === \"latitude\") {\n        stopMap[subject][predicate] = parseFloat(object);\n\n      } else {\n        stopMap[subject][predicate] = object;\n      }\n\n      return stopMap;\n    }, {}) as IStopMap;\n  }\n}\n","import { Triple } from \"rdf-js\";\n\n/**\n * Utility class with functions dealing with rdf triples\n */\nexport default class Rdf {\n\n  /**\n   * Creates a triple matcher callback function for use in e.g. an Array#filter() expression\n   *\n   * For example:\n   * ```\n   * tripleArray.filter(Rdf.matchesTriple('someSubject', null, null));\n   * ```\n   * @param subject can be null if not wanting to match by subject\n   * @param predicate can be null if not wanting to match by predicate\n   * @param object can be null if not wanting to match by object\n   */\n  public static matchesTriple(\n    subject: string | null,\n    predicate: string | null,\n    object: string | null,\n  ): (triple: Triple) => boolean {\n\n    return (triple: Triple) => {\n      if (subject && triple.subject.value !== subject) {\n        return false;\n      }\n\n      if (predicate && triple.predicate.value !== predicate) {\n        return false;\n      }\n\n      if (object && triple.object.value !== object) {\n        return false;\n      }\n\n      return true;\n    };\n  }\n\n  /**\n   * Rename the predicate of a triple based on a map with original predicates as keys and\n   * replacement predicates as values\n   *\n   * For example:\n   * ```\n   * const transformedTriple = Rdf.transformPredicate({\n   *   \"oldPredicate1\": \"newPredicate1\",\n   *   \"oldPredicate2\": \"newPredicate2\",\n   * }, someTriple));\n   * ```\n   */\n  public static transformPredicate(transformMap: { [oldPredicate: string]: string }, triple: Triple): Triple {\n    if (triple.predicate.value in transformMap) {\n      triple.predicate.value = transformMap[triple.predicate.value];\n    }\n    return triple;\n  }\n\n  /**\n   * Rename the object of a triple based on a map with original objects as keys and\n   * replacement objects as values\n   *\n   * For example:\n   * ```\n   * const transformedTriple = Rdf.transformObject({\n   *   \"oldObject1\": \"newObject1\",\n   *   \"oldObject2\": \"newObject2\",\n   * }, someTriple));\n   * ```\n   */\n  public static transformObject(transformMap: { [oldObject: string]: string }, triple: Triple): Triple {\n    if (triple.object.value in transformMap) {\n      triple.object.value = transformMap[triple.object.value];\n    }\n    return triple;\n  }\n\n  /**\n   * Log an array of triples to the console as a table with three columns: subject, predicate and object\n   */\n  public static logTripleTable(triples: Triple[]): void {\n    console.table(triples.map((triple: Triple) => ({\n      subject: triple.subject.value,\n      predicate: triple.predicate.value,\n      object: triple.object.value,\n    })));\n  }\n}\n","import Barrier from \"../../enums/Barrier\";\nimport Crossing from \"../../enums/Crossing\";\nimport Highway from \"../../enums/Highway\";\nimport ILocation from \"../../interfaces/ILocation\";\n\nexport class RoutableTileNode implements ILocation {\n    public static create(id: string) {\n        return new RoutableTileNode(id);\n    }\n\n    public latitude: number;\n    public longitude: number;\n    public id: string;\n\n    public barrierKind?: Barrier;\n    public highwayKind?: Highway;\n    public crossingKind?: Crossing;\n\n    constructor(id: string) {\n        this.id = id;\n    }\n}\n\nexport interface IRoutableTileNodeIndex {\n    [id: string]: RoutableTileNode;\n}\n","import Access from \"../../enums/Access\";\nimport Construction from \"../../enums/Construction\";\nimport Crossing from \"../../enums/Crossing\";\nimport Cycleway from \"../../enums/Cycleway\";\nimport Footway from \"../../enums/Footway\";\nimport Highway from \"../../enums/Highway\";\nimport Oneway from \"../../enums/Oneway\";\nimport Smoothness from \"../../enums/Smoothness\";\nimport Surface from \"../../enums/Surface\";\nimport TrackType from \"../../enums/TrackType\";\nimport Edge from \"./edge\";\n\nexport class RoutableTileWay {\n    public static create(id: string) {\n        return new RoutableTileWay(id);\n    }\n\n    public id: string;\n    public segments: string[][]; // ids of nodes that are part of this road\n    public weights?: number[][]; // distances between the nodes in the segments\n    public name: string;\n    public reachable?: boolean; // not part of OSM but a result of preprocessing, do not use this (yet)\n\n    public accessRestrictions?: Access;\n    public bicycleAccessRestrictions?: Access;\n    public constructionKind?: Construction;\n    public crossingKind?: Crossing;\n    public cyclewayKind?: Cycleway;\n    public footwayKind?: Footway;\n    public highwayKind: Highway;\n    public maxSpeed: number;\n    public motorVehicleAccessRestrictions?: Access;\n    public motorcarAccessRestrictions?: Access;\n    public onewayBicycleKind?: Oneway;\n    public onewayKind?: Oneway;\n    public smoothnessKind?: Smoothness;\n    public surfaceKind?: Surface;\n    public trackType?: TrackType;\n    public vehicleAccessRestrictions?: Access;\n\n    constructor(id: string) {\n        this.id = id;\n        this.weights = [[]];\n    }\n\n    public mergeDefinitions(other: RoutableTileWay): RoutableTileWay {\n        const result = new RoutableTileWay(this.id);\n        // copy data fields\n        Object.assign(result, this);\n        Object.assign(result, other);\n        // special cases\n        if (this.reachable === false || other.reachable === false) {\n            result.reachable = false;\n        }\n        // do not modify the existing objects, copy the lists\n        result.segments = [];\n        result.segments = result.segments.concat(this.segments);\n        result.segments = result.segments.concat(other.segments);\n\n        result.weights = [];\n        result.weights = result.weights.concat(this.weights);\n        result.weights = result.weights.concat(other.weights);\n        return result;\n    }\n\n    public getParts(): Edge[] {\n        const result: Edge[] = [];\n        for (let index = 0; index < this.segments.length; index++) {\n            const weights = this.weights[index];\n            const segment = this.segments[index];\n            for (let i = 0; i < segment.length - 1; i++) {\n                result.push({from: segment[i], to: segment[i + 1], distance: weights[i]});\n            }\n        }\n        return result;\n    }\n}\n\nexport interface IRoutableTileWayIndex {\n    [id: string]: RoutableTileWay;\n}\n","import { RoutableTile } from \"./tile\";\n\nexport class RoutableTileSet extends RoutableTile {\n    public tiles: RoutableTile[];\n\n    constructor(tiles: RoutableTile[], id?: string) {\n        let nodes = new Array();\n        let ways = new Array();\n\n        for (const tile of tiles) {\n            nodes = nodes.concat(...tile.getNodes());\n            ways = ways.concat(...tile.getWays());\n        }\n\n        super(id, new Set(nodes), new Set(ways));\n        this.tiles = tiles;\n    }\n}\n","import { injectable } from \"inversify\";\nimport TinyQueue from \"tinyqueue\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport PathfindingGraph from \"../graph\";\nimport { IPathTree, IShortestPathTreeInstance } from \"../pathfinder\";\n\ninterface IState {\n    position: number;\n    distance: DistanceM;\n    duration: DurationMs;\n    cost: number;\n}\n\n@injectable()\nexport default class DijkstraTreeInstance implements IShortestPathTreeInstance {\n    private nextQueue: IState[];\n    private costs: number[];\n    private previousNodes: number[];\n    private graph: PathfindingGraph;\n    private useWeightedCost: boolean;\n\n    constructor(graph: PathfindingGraph) {\n        this.graph = graph;\n        this.useWeightedCost = true;\n    }\n\n    public setUseWeightedCost(useWeightedCost: boolean) {\n        this.useWeightedCost = useWeightedCost;\n    }\n\n    public setBreakPoint(on: string, callback: (on: string) => Promise<void>): void {\n        this.graph.setBreakPoint(on, callback);\n    }\n\n    public removeBreakPoint(on: string): void {\n        this.graph.removeBreakPoint(on);\n    }\n\n    public async start(from: string, maxCost: number): Promise<IPathTree> {\n        this.costs = [...Array(this.graph.getAdjacencyList().length)].fill(Infinity);\n        this.previousNodes = [...Array(this.graph.getAdjacencyList().length)].fill(undefined);\n\n        const fromIndex = this.graph.getNodeIndex(from);\n        this.costs[fromIndex] = 0;\n        this.nextQueue = [{ distance: 0, duration: 0, cost: 0, position: fromIndex }];\n\n        return this.continue(maxCost);\n    }\n\n    public async continue(maxCost: number): Promise<IPathTree> {\n        const queue = new TinyQueue(this.nextQueue, (a, b) => a.duration - b.duration);\n        this.nextQueue = [];\n\n        while (queue.length) {\n            const { position, distance, duration, cost } = queue.pop();\n\n            if (duration > this.getCost(position)) {\n                // we have already found a better way\n                continue;\n            }\n\n            if (this.graph.getBreakPoint(position)) {\n                await this.graph.getBreakPoint(position)(this.graph.getLabel(position));\n            }\n\n            if (cost > maxCost) {\n                // remember this state for subsequent calls\n                this.nextQueue.push({ duration, distance, cost, position });\n            } else {\n                for (const edge of this.graph.getAdjacencyList()[position]) {\n                    const next = {\n                        distance: distance + edge.distance,\n                        duration: duration + edge.duration,\n                        cost: cost + edge.cost,\n                        position: edge.node,\n                        previousPosition: position,\n                    };\n\n                    if (next.duration < this.getCost(next.position)) {\n                        queue.push(next);\n                        this.costs[next.position] = next.duration;\n                        this.previousNodes[next.position] = position;\n\n                        if (this.graph.getBreakPoint(next.position)) {\n                            this.graph.getBreakPoint(next.position)(this.graph.getLabel(next.position));\n                        }\n                    }\n                }\n            }\n        }\n\n        const result: IPathTree = {};\n\n        for (const [position, cost] of this.costs.entries()) {\n            const label = this.graph.getLabel(position);\n            const previousLabel = this.graph.getLabel(this.previousNodes[position]);\n            result[label] = { duration: cost, previousNode: previousLabel };\n        }\n\n        return result;\n    }\n\n    private getCost(position: number): number {\n        if (position >= this.costs.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.costs.length;\n            this.costs = this.costs.concat([...Array(missingCosts)].fill(Infinity));\n            this.previousNodes = this.previousNodes.concat([...Array(missingCosts)].fill(undefined));\n        }\n        return this.costs[position];\n    }\n}\n","import { injectable } from \"inversify\";\nimport TinyQueue from \"tinyqueue\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport PathfindingGraph from \"../graph\";\nimport { IShortestPathInstance } from \"../pathfinder\";\n\ninterface IState {\n    position: number;\n    distance: DistanceM;\n    duration: DurationMs;\n    cost: number;\n}\n\n@injectable()\nexport class DijkstraInstance implements IShortestPathInstance {\n    private graph: PathfindingGraph;\n    private useWeightedCost: boolean;\n    private costs: number[];\n    private previousNodes: number[];\n\n    constructor(graph: PathfindingGraph) {\n        this.useWeightedCost = true;\n        this.graph = graph;\n    }\n\n    public setUseWeightedCost(useWeightedCost: boolean) {\n        this.useWeightedCost = useWeightedCost;\n    }\n\n    public setBreakPoint(on: string, callback: (on: string) => Promise<void>): void {\n        this.graph.setBreakPoint(on, callback);\n    }\n\n    public removeBreakPoint(on: string): void {\n        this.graph.removeBreakPoint(on);\n    }\n\n    public async queryPath(from: string, to: string, maxDistance = Infinity) {\n        let queue: TinyQueue<IState>;\n        if (this.useWeightedCost) {\n            queue = new TinyQueue([], (a, b) => a.cost - b.cost);\n        } else {\n            queue = new TinyQueue([], (a, b) => a.duration - b.duration);\n        }\n\n        this.costs = [...Array(this.graph.getAdjacencyList().length)].fill(Infinity);\n        this.previousNodes = [...Array(this.graph.getAdjacencyList().length)].fill(undefined);\n\n        const fromIndex = this.graph.getNodeIndex(from);\n        this.setCost(fromIndex, 0);\n        queue.push({ distance: 0, duration: 0, cost: 0, position: fromIndex });\n\n        const toIndex = this.graph.getNodeIndex(to);\n\n        while (queue.length) {\n            const { duration, distance, cost, position } = queue.pop();\n\n            if (distance > maxDistance) {\n                // avoid hopeless searches\n                break;\n            }\n\n            if (position === toIndex) {\n                // it is done, break the loop and start reconstructing the path\n                break;\n            }\n\n            if (cost > this.getCost(position)) {\n                // we have already found a better way\n                continue;\n            }\n\n            if (this.graph.getBreakPoint(position)) {\n                await this.graph.getBreakPoint(position)(this.graph.getLabel(position));\n            }\n\n            for (const edge of this.graph.getAdjacencyList()[position]) {\n                const next = {\n                    distance: distance + edge.distance,\n                    duration: duration + edge.duration,\n                    cost: cost + edge.cost,\n                    position: edge.node,\n                };\n\n                if (next.cost < this.getCost(next.position)) {\n                    this.setCost(next.position, next.cost);\n                    this.previousNodes[next.position] = position;\n                    queue.push(next);\n                }\n            }\n        }\n\n        let currentPosition = toIndex;\n        const steps = [];\n\n        // reconstruct the path\n        while (this.previousNodes[currentPosition]) {\n            let nextEdge;\n            let nextPositionCost = Infinity;\n\n            for (const edge of this.graph.getReverseAdjacencyList()[currentPosition]) {\n                if (this.getCost(edge.node) < nextPositionCost) {\n                    nextPositionCost = this.getCost(edge.node);\n                    nextEdge = edge;\n                }\n            }\n\n            if (!nextEdge) {\n                break;\n            }\n\n            steps.push({\n                from: this.graph.getLabel(nextEdge.node),\n                to: this.graph.getLabel(currentPosition),\n                distance: nextEdge.distance,\n                duration: nextEdge.duration,\n            });\n\n            currentPosition = nextEdge.node;\n        }\n\n        return steps.reverse();\n    }\n\n    private setCost(position: number, cost: number) {\n        if (position >= this.costs.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.costs.length;\n            this.costs = this.costs.concat([...Array(missingCosts)].fill(Infinity));\n            this.previousNodes = this.previousNodes.concat([...Array(missingCosts)].fill(undefined));\n        }\n        this.costs[position] = cost;\n    }\n\n    private getCost(position: number): number {\n        if (position >= this.costs.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.costs.length;\n            this.costs = this.costs.concat([...Array(missingCosts)].fill(Infinity));\n            this.previousNodes = this.previousNodes.concat([...Array(missingCosts)].fill(undefined));\n        }\n        return this.costs[position];\n    }\n}\n","enum PickupType {\n  Regular = \"gtfs:Regular\",\n  NotAvailable = \"gtfs:NotAvailable\",\n  MustPhone = \"gtfs:MustPhone\",\n  MustCoordinateWithDriver = \"gtfs:MustCoordinateWithDriver\",\n}\n\nexport default PickupType;\n","import { AsyncIterator } from \"asynciterator\";\nimport TinyQueue from \"tinyqueue\";\nimport IConnection from \"../../../entities/connections/connections\";\n\nexport default class FootpathQueue extends AsyncIterator<IConnection> {\n\n    private buffer: TinyQueue<IConnection>;\n    private shouldClose: boolean;\n\n    constructor(backwards = false) {\n        super();\n\n        if (backwards) {\n            this.buffer = new TinyQueue([], (a, b) => {\n                return b.departureTime - a.departureTime;\n            });\n        } else {\n            this.buffer = new TinyQueue([], (a, b) => {\n                return a.departureTime - b.departureTime;\n            });\n        }\n\n        this.readable = true;\n        this.shouldClose = false;\n    }\n\n    public read(): IConnection {\n        let item;\n\n        if (this.buffer.length) {\n            item = this.buffer.pop();\n        } else {\n            item = null;\n        }\n\n        if (this.shouldClose) {\n            this.close();\n        }\n\n        return item;\n    }\n\n    public write(item: IConnection): void {\n        if (!this.shouldClose) {\n            this.buffer.push(item);\n            this.readable = true;\n        }\n    }\n\n    public closeAfterFlush(): void {\n        this.shouldClose = true;\n    }\n}\n","import { AsyncIterator, EmptyIterator, SingletonIterator } from \"asynciterator\";\nimport { inject, injectable } from \"inversify\";\nimport IPath from \"../../interfaces/IPath\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Leg from \"../Leg\";\nimport Path from \"../Path\";\nimport Step from \"../Step\";\nimport IProfileByStop from \"./CSA/data-structure/stops/IProfileByStop\";\nimport ITransferProfile from \"./CSA/data-structure/stops/ITransferProfile\";\nimport IJourneyExtractor from \"./IJourneyExtractor\";\n\n@injectable()\nexport default class JourneyExtractorEarliestArrival implements IJourneyExtractor {\n  private readonly locationResolver: ILocationResolver;\n\n  constructor(\n    @inject(TYPES.LocationResolver) locationResolver: ILocationResolver,\n  ) {\n    this.locationResolver = locationResolver;\n  }\n\n  public async extractJourneys(\n    profilesByStop: IProfileByStop,\n    query: IResolvedQuery,\n  ): Promise<AsyncIterator<IPath>> {\n    const path: Path = Path.create();\n\n    const departureStopId: string = query.from[0].id;\n    let currentStopId: string = query.to[0].id;\n\n    while (currentStopId !== departureStopId &&\n      profilesByStop[currentStopId] &&\n      profilesByStop[currentStopId].exitConnection) {\n\n      const currentProfile: ITransferProfile = profilesByStop[currentStopId];\n      const { enterConnection, exitConnection } = currentProfile;\n      const promises = [\n        this.locationResolver.resolve(enterConnection.departureStop),\n        this.locationResolver.resolve(exitConnection.arrivalStop),\n      ];\n      const [enterLocation, exitLocation] = await Promise.all(promises);\n\n      const arrivalTime = exitConnection.arrivalTime;\n      const departureTime = enterConnection.departureTime;\n      const duration = arrivalTime.getTime() - departureTime.getTime();\n\n      const step = new Step(\n        enterLocation,\n        exitLocation,\n        { average: duration },\n        departureTime,\n        arrivalTime,\n        undefined,\n        enterConnection.id,\n        exitConnection.id,\n      );\n\n      const leg = new Leg(exitConnection.travelMode, [step]);\n\n      path.prependLeg(leg);\n      currentStopId = enterConnection.departureStop;\n    }\n\n    if (!path.legs.length) {\n      return new EmptyIterator();\n    }\n\n    return new SingletonIterator<IPath>(path);\n  }\n\n}\n","import IConnection from \"../../../../entities/connections/connections\";\nimport DropOffType from \"../../../../enums/DropOffType\";\nimport { DurationMs } from \"../../../../interfaces/units\";\nimport IArrivalTimeByTransfers from \"../data-structure/IArrivalTimeByTransfers\";\nimport IProfilesByStop from \"../data-structure/stops/IProfilesByStop\";\n\n/**\n * Utility functions that can be used on the CSA profiles [[IProfilesByStop]].\n */\nexport default class ProfileUtil {\n\n  public static filterInfinity(profilesByStop: IProfilesByStop): IProfilesByStop {\n    const result = {};\n\n    for (const stop in profilesByStop) {\n      if (profilesByStop.hasOwnProperty(stop)) {\n        result[stop] = profilesByStop[stop].filter((profile) =>\n          profile.departureTime !== Infinity,\n        );\n\n        if (result[stop].length === 0) {\n          delete result[stop];\n        }\n      }\n    }\n    return result;\n  }\n\n  public static getTransferTimes(\n    profilesByStop: IProfilesByStop,\n    connection: IConnection,\n    maxLegs: number,\n    minimumTransferDuration: DurationMs,\n    maximumTransferDuration: DurationMs,\n  ): IArrivalTimeByTransfers {\n    const { arrivalStop, arrivalTime } = connection;\n    const trip: string = connection.tripId;\n\n    if (connection[\"gtfs:dropOffType\"] !== DropOffType.NotAvailable) {\n\n      let profileIndex: number = profilesByStop[arrivalStop].length - 1;\n      while (profileIndex >= 0) {\n\n        const departure: number = profilesByStop[arrivalStop][profileIndex].departureTime;\n        const arrival: number = arrivalTime.getTime();\n\n        const transferDuration: DurationMs = departure - arrival;\n\n        if (transferDuration >= minimumTransferDuration && transferDuration <= maximumTransferDuration) {\n          const arrivalTimeByTransfers = profilesByStop[arrivalStop][profileIndex].getArrivalTimeByTransfers(trip);\n          return arrivalTimeByTransfers.slice() as IArrivalTimeByTransfers;\n        }\n        profileIndex--;\n      }\n\n    }\n\n    return Array(maxLegs + 1).fill({\n      arrivalTime: Infinity,\n      tripId: trip,\n    });\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst asynciterator_1 = require(\"asynciterator\");\n/**\n * A {@link TransformIterator} that allows the source to be set through a lazy Promise.\n * The provided getter will only be called from the moment that this proxy iterator is being read.\n *\n * Rejections of the promise will be emitted as error event.\n */\nclass PromiseProxyIterator extends asynciterator_1.TransformIterator {\n    constructor(sourceGetter, options) {\n        super(options || { autoStart: false });\n        this.sourceGetter = sourceGetter;\n    }\n    _read(count, done) {\n        if (!this.source) {\n            this.sourceGetter().then((source) => {\n                this.source = source;\n                super._read(count, done);\n            }).catch((error) => this.emit('error', error));\n        }\n        else {\n            super._read(count, done);\n        }\n    }\n}\nexports.PromiseProxyIterator = PromiseProxyIterator;\n//# sourceMappingURL=PromiseProxyIterator.js.map","import { AsyncIterator, SimpleTransformIterator } from \"asynciterator\";\n\n/**\n * An AsyncIterator that emits only the unique items emitted by a source iterator.\n *\n * Uniqueness is determined by a comparator callback function\n *\n * Note: All (unique) items get stored in an array internally\n */\nexport default class FilterUniqueIterator<T> extends SimpleTransformIterator<T, T> {\n\n  private readonly comparator: (object: T, otherObject: T) => boolean;\n  private store: T[];\n\n  constructor(source: AsyncIterator<T>, comparator: (object: T, otherObject: T) => boolean) {\n    super(source, {\n      maxBufferSize: 1,\n      autoStart: false,\n    });\n\n    this.comparator = comparator;\n    this.store = [];\n  }\n\n  public _filter(object: T): boolean {\n\n    const isUnique = !this.store\n      .some((storedObject: T) => this.comparator(object, storedObject));\n\n    if (isUnique) {\n      this.store.push(object);\n    }\n\n    return isUnique;\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\n\n/**\n * This AsyncIterator maps every item of a query AsyncIterator to a result AsyncIterator by passing it through a\n * `run` function. All result AsyncIterator get concatenated to form the FlatMapIterator\n *\n * ```javascript\n *                  +-----+                     +-----+\n *   queryIterator  |0 & 9| +---+             + |1 & 8| +---+             + ...\n *                  +-----+     |               +-----+     |\n *                              v                           v\n *                  +-----------------------+   +-----------------------+\n * resultIterators  |01|02|04|05|06|07|08|09| + |11|12|13|14|15|16|17|18| + ...\n *                  +-----------------------+   +-----------------------+\n *\n *                  +-----------------------------------------------+\n * FlatMapIterator  |01|02|04|05|06|07|08|09|11|12|13|14|15|16|17|18| ...\n *                  +-----------------------------------------------+\n * ```\n */\nexport default class FlatMapIterator<Q, R> extends AsyncIterator<R> {\n  private queryIterator: AsyncIterator<Q>;\n  private callback: (query: Q) => AsyncIterator<R>;\n\n  private currentResultIterator: AsyncIterator<R>;\n  private isLastResultIterator = false;\n\n  constructor(queryIterator: AsyncIterator<Q>, run: (query: Q) => AsyncIterator<R>) {\n    super();\n\n    this.queryIterator = queryIterator;\n    this.callback = run;\n\n    this.queryIterator.once(\"end\", () => {\n      this.isLastResultIterator = true;\n    });\n\n    this.readable = true;\n  }\n\n  public read(): R {\n    if (this.closed) {\n      return null;\n    }\n\n    if (!this.currentResultIterator) {\n      const query: Q = this.queryIterator.read();\n\n      if (query) {\n        this.runQuery(query);\n\n      } else {\n        this.readable = false;\n        this.queryIterator.once(\"readable\", () => {\n          this.readable = true;\n        });\n      }\n    }\n\n    if (this.currentResultIterator) {\n      const item = this.currentResultIterator.read();\n\n      if (!item) {\n        this.readable = false;\n      }\n\n      return item;\n    }\n\n    return null;\n  }\n\n  private runQuery(query: Q) {\n    this.currentResultIterator = this.callback(query);\n    this.readable = this.currentResultIterator.readable;\n\n    this.currentResultIterator.on(\"readable\", () => {\n      this.readable = true;\n    });\n\n    this.currentResultIterator.on(\"end\", () => {\n      if (this.isLastResultIterator) {\n        this.close();\n      }\n\n      this.currentResultIterator = null;\n      this.readable = true;\n    });\n  }\n}\n","import { AsyncIterator } from \"asynciterator\";\nimport { DurationMs } from \"../../interfaces/units\";\nimport IResolvedQuery from \"../IResolvedQuery\";\n\n/**\n * This AsyncIterator emits [[IResolvedQuery]] instances with exponentially increasing `maximumArrivalTime`.\n * For each emitted query, the time frame gets doubled (x2).\n */\nexport default class ExponentialQueryIterator extends AsyncIterator<IResolvedQuery> {\n  private readonly baseQuery: IResolvedQuery;\n  private timespan: DurationMs;\n\n  constructor(baseQuery: IResolvedQuery, initialTimespan: DurationMs) {\n    super();\n\n    this.baseQuery = baseQuery;\n    this.timespan = initialTimespan;\n\n    this.readable = true;\n  }\n\n  public read(): IResolvedQuery {\n    if (this.closed) {\n      return null;\n    }\n\n    const {minimumDepartureTime} = this.baseQuery;\n    const maximumArrivalTime = new Date(minimumDepartureTime.getTime() + this.timespan);\n\n    this.timespan *= 2;\n\n    if (this.timespan > 2 * 24 * 60 * 60 * 1000) {\n      this.close();\n    }\n\n    return Object.assign({}, this.baseQuery, {maximumArrivalTime});\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport LocationResolverError from \"../errors/LocationResolverError\";\nimport IStop from \"../fetcher/stops/IStop\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport ILocation from \"../interfaces/ILocation\";\nimport TYPES from \"../types\";\nimport ILocationResolver from \"./ILocationResolver\";\n\n/**\n * This default location resolver resolves [[ILocation]] instances by their `id` (`http(s)://...`)\n *\n * If only an `id` string is passed, it returns an [[ILocation]] with all available information.\n *\n * If an incomplete [[ILocation]] (but with an `id`) is passed, it gets supplemented as well.\n */\n@injectable()\nexport default class LocationResolverDefault implements ILocationResolver {\n  private readonly stopsProvider: IStopsProvider;\n  private readonly tileRegistry: RoutableTileRegistry;\n\n  constructor(\n    @inject(TYPES.StopsProvider) stopsProvider: IStopsProvider,\n    @inject(TYPES.RoutableTileRegistry) tileRegistry: RoutableTileRegistry,\n  ) {\n    this.stopsProvider = stopsProvider;\n    this.tileRegistry = tileRegistry;\n  }\n\n  public async resolve(input: ILocation | IStop | string): Promise<ILocation> {\n\n    if (typeof input === \"string\") {\n\n      if (this.isId(input)) {\n        return this.resolveById(input);\n      }\n\n      return Promise.reject(new LocationResolverError(`Location \"${input}\" is a string, but not an ID`));\n    }\n\n    const location: ILocation = input;\n    const hasId = \"id\" in location;\n    const hasCoords = \"latitude\" in location && \"longitude\" in location;\n\n    if (hasId) {\n      const resolvedLocation = await this.resolveById(location.id);\n\n      return Object.assign({}, location, resolvedLocation);\n    }\n\n    if (!hasCoords) {\n      return Promise.reject(\n        new LocationResolverError(`Location \"${JSON.stringify(input)}\" should have latitude and longitude`),\n      );\n    }\n\n    return location;\n  }\n\n  private async resolveById(id: string): Promise<ILocation> {\n    const node = this.tileRegistry.getNode(id);\n    if (node) {\n      return node;\n    }\n\n    const stop: IStop = await this.stopsProvider.getStopById(id);\n    if (stop) {\n      return stop;\n    }\n\n    return Promise.reject(new LocationResolverError(`No fetcher for id ${id}`));\n  }\n\n  private isId(testString: string): boolean {\n    return testString.indexOf(\"http://\") === 0 || testString.indexOf(\"https://\") === 0;\n  }\n}\n","import concaveman = require(\"concaveman\");\nimport { Delaunay } from \"d3-delaunay\";\nimport { RoutableTileNode } from \"../../entities/tiles/node\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport { IPathTree } from \"../../pathfinding/pathfinder\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport Geo from \"../../util/Geo\";\nimport UnionFind from \"../../util/UnionFind\";\nimport { pointsOfTriangle } from \"./util\";\n\n// we make extensive use of the Delaunator library which uses indexes for everything\n// we'll need this to get the corresponding RoutableTileNode for a given index\ntype NodeList = RoutableTileNode[];\n\n// a list of boolean values, indicating whether or not the node with a given index has a specific label\ntype NodeLabelList = boolean[];\n\n// A cluster of routable tile nodes\ntype NodeCluster = Set<number>;\n\n// A ring is a list of connected geographical points.\ntype Ring = ILocation[];\n\n// A polygon is represented as a list of rings.\n// The first being the outer ring, the others being holes.\ntype Polygon = Ring[];\n\nexport async function visualizeConcaveIsochrone(\n    pathTree: IPathTree,\n    maxCost: number,\n    registry: RoutableTileRegistry,\n) {\n    const locations = [];\n    for (const node of registry.getNodes()) {\n        const branch = pathTree[node.id];\n        if (branch) {\n            const { duration } = branch;\n            if (duration < maxCost) {\n                locations.push([node.longitude, node.latitude]);\n            }\n        }\n    }\n\n    let isochrones = [];\n    if (locations.length > 0) {\n        const shell = concaveman(locations, 2);\n        isochrones = [[shell.map((point) => {\n            return { longitude: point[0], latitude: point[1] };\n        })]];\n    }\n\n    return {\n        isochrones,\n    };\n}\n\nexport function visualizeIsochrone(registry: RoutableTileRegistry, pathTree: IPathTree, maxCost: number) {\n    /**\n     * Isochrones are generated by applying a delaunay triangulisation to the road network nodes,\n     * Union-Find (= disjoint set) is used to find clusters of external/internal nodes.\n     * Each cluster will form one ring in the isochrone.\n     */\n\n    const nodes: NodeList = [];\n    const costs = {};\n    for (const [id, branch] of Object.entries(pathTree)) {\n        const { duration } = branch;\n        const node = registry.getNode(id);\n        if (node && duration !== Infinity) {\n            nodes.push(node);\n            costs[node.id] = duration;\n        }\n    }\n\n    nodes.push({ latitude: 90, longitude: 180, id: \"1\" });\n    nodes.push({ latitude: -90, longitude: 180, id: \"2\" });\n    nodes.push({ latitude: 90, longitude: -180, id: \"3\" });\n    nodes.push({ latitude: -90, longitude: -180, id: \"4\" });\n\n    costs[\"1\"] = Infinity;\n    costs[\"2\"] = Infinity;\n    costs[\"3\"] = Infinity;\n    costs[\"4\"] = Infinity;\n\n    const delaunay = createTriangulation(nodes);\n    const internalNodes: NodeLabelList = nodes.map((node) => costs[node.id] < maxCost);\n    const externalNodes: NodeLabelList = internalNodes.map((v) => !v);\n\n    const internalClusters = clusterNodes(nodes, internalNodes, delaunay);\n    const externalClusters = clusterNodes(nodes, externalNodes, delaunay);\n\n    const polygons: Polygon[] = internalClusters\n        .filter((cluster) => cluster.size > 1)\n        .map((internalCluster) =>\n            createPolygon(costs, maxCost, nodes, internalCluster, externalClusters, delaunay),\n        );\n\n    return {\n        isochrones: polygons.filter((p) => p.length > 0),\n    };\n}\n\nfunction createTriangulation(nodes: ILocation[]): Delaunay {\n    function getX(p: ILocation) {\n        return p.longitude;\n    }\n\n    function getY(p: ILocation) {\n        return p.latitude;\n    }\n\n    return Delaunay.from(nodes, getX, getY);\n}\n\nfunction clusterNodes(allNodes: NodeList, relevantNodes: NodeLabelList, delaunay: Delaunay): NodeCluster[] {\n    /**\n     * Uses Union-Find to cluster the given (relevant) nodes based on the Delaunay triangulisation of all nodes.\n     * Returns an array of clusters.\n     */\n    const forest = new UnionFind(allNodes.length);\n\n    for (const nodeIndex of Array(allNodes.length).keys()) {\n        if (relevantNodes[nodeIndex]) {\n            const neighbors = delaunay.neighbors(nodeIndex);\n            for (const neighbor of neighbors) {\n                if (relevantNodes[neighbor]) {\n                    forest.union(nodeIndex, neighbor);\n                }\n            }\n        }\n    }\n\n    const clusters = forest.getClusters();\n\n    for (const key of Object.keys(clusters)) {\n        if (!relevantNodes[key]) {\n            delete clusters[key];\n        }\n    }\n\n    return Object.values(clusters);\n}\n\nfunction createPolygon(\n    costs,\n    maxCost: number,\n    nodes: NodeList,\n    internalNodes: NodeCluster,\n    externalClusters: NodeCluster[],\n    delaunay: Delaunay,\n): Polygon {\n    /**\n     * Creates a polygon for the given cluster of nodes that lie in an isochrone.\n     */\n    const rings = [];\n\n    // each cluster of external nodes yields a single ring.\n    // there's exactly one on the outside of the internal nodes cluster (because union-find)\n    // the others will form holes\n    for (const externalNodes of externalClusters) {\n        const borderLocations: ILocation[] = [];\n        const borderNodeIds = new Set();\n        for (const nodeIndex of Array(nodes.length).keys()) {\n            if (!externalNodes.has(nodeIndex) && internalNodes.has(nodeIndex)) {\n                for (const neighbor of delaunay.neighbors(nodeIndex)) {\n                    if (externalNodes.has(neighbor)) {\n                        const point = pointBetween(nodes[nodeIndex], nodes[neighbor], costs, maxCost);\n                        if (point) {\n                            borderLocations.push(point);\n                        }\n                    }\n                }\n            }\n        }\n\n        if (borderLocations.length > 0) {\n            const triangulation = createTriangulation(borderLocations);\n            const firstNode = triangulation.hull;\n            const ring = [borderLocations[firstNode.i]];\n            let currentNode = firstNode.next;\n            while (currentNode.i !== firstNode.i) {\n                ring.push(borderLocations[currentNode.i]);\n                currentNode = currentNode.next;\n            }\n            rings.push(ring);\n        }\n    }\n\n    // FIXME, the ring with the most nodes might not always be the outer ring\n    return rings\n        .filter((r) => r.length > 0)\n        .sort((a, b) => b.length - a.length);\n}\n\nfunction pointBetween(node1: RoutableTileNode, node2: RoutableTileNode, costs, maxCost): ILocation {\n    const nodeCost1 = costs[node1.id];\n    const nodeCost2 = costs[node2.id];\n\n    if (nodeCost1 === Infinity && nodeCost2 === Infinity) {\n        return null;\n    } else if (nodeCost1 === Infinity) {\n        return node2;\n    } else if (nodeCost2 === Infinity) {\n        return node1;\n    }\n\n    const costDifference1 = Math.abs(nodeCost1 - maxCost);\n    const costDifference2 = Math.abs(nodeCost2 - maxCost);\n    const relDifference1 = 1 - costDifference1 / (costDifference1 + costDifference2);\n    const relDifference2 = 1 - costDifference2 / (costDifference1 + costDifference2);\n\n    const weight = relDifference1 + relDifference2;\n    const latitude = (node1.latitude * relDifference1 + node2.latitude * relDifference2) / weight;\n    const longitude = (node1.longitude * relDifference1 + node2.longitude * relDifference2) / weight;\n\n    if (isNaN(latitude) || isNaN(longitude)) {\n        return null;\n    }\n\n    return { latitude, longitude };\n}\n","'use strict';\n\nvar rbush = require('rbush');\nvar convexHull = require('monotone-convex-hull-2d');\nvar Queue = require('tinyqueue');\nvar pointInPolygon = require('point-in-polygon');\nvar orient = require('robust-orientation')[3];\n\nmodule.exports = concaveman;\nmodule.exports.default = concaveman;\n\nfunction concaveman(points, concavity, lengthThreshold) {\n    // a relative measure of concavity; higher value means simpler hull\n    concavity = Math.max(0, concavity === undefined ? 2 : concavity);\n\n    // when a segment goes below this length threshold, it won't be drilled down further\n    lengthThreshold = lengthThreshold || 0;\n\n    // start with a convex hull of the points\n    var hull = fastConvexHull(points);\n\n    // index the points with an R-tree\n    var tree = rbush(16, ['[0]', '[1]', '[0]', '[1]']).load(points);\n\n    // turn the convex hull into a linked list and populate the initial edge queue with the nodes\n    var queue = [];\n    for (var i = 0, last; i < hull.length; i++) {\n        var p = hull[i];\n        tree.remove(p);\n        last = insertNode(p, last);\n        queue.push(last);\n    }\n\n    // index the segments with an R-tree (for intersection checks)\n    var segTree = rbush(16);\n    for (i = 0; i < queue.length; i++) segTree.insert(updateBBox(queue[i]));\n\n    var sqConcavity = concavity * concavity;\n    var sqLenThreshold = lengthThreshold * lengthThreshold;\n\n    // process edges one by one\n    while (queue.length) {\n        var node = queue.shift();\n        var a = node.p;\n        var b = node.next.p;\n\n        // skip the edge if it's already short enough\n        var sqLen = getSqDist(a, b);\n        if (sqLen < sqLenThreshold) continue;\n\n        var maxSqLen = sqLen / sqConcavity;\n\n        // find the best connection point for the current edge to flex inward to\n        p = findCandidate(tree, node.prev.p, a, b, node.next.next.p, maxSqLen, segTree);\n\n        // if we found a connection and it satisfies our concavity measure\n        if (p && Math.min(getSqDist(p, a), getSqDist(p, b)) <= maxSqLen) {\n            // connect the edge endpoints through this point and add 2 new edges to the queue\n            queue.push(node);\n            queue.push(insertNode(p, node));\n\n            // update point and segment indexes\n            tree.remove(p);\n            segTree.remove(node);\n            segTree.insert(updateBBox(node));\n            segTree.insert(updateBBox(node.next));\n        }\n    }\n\n    // convert the resulting hull linked list to an array of points\n    node = last;\n    var concave = [];\n    do {\n        concave.push(node.p);\n        node = node.next;\n    } while (node !== last);\n\n    concave.push(node.p);\n\n    return concave;\n}\n\nfunction findCandidate(tree, a, b, c, d, maxDist, segTree) {\n    var queue = new Queue(null, compareDist);\n    var node = tree.data;\n\n    // search through the point R-tree with a depth-first search using a priority queue\n    // in the order of distance to the edge (b, c)\n    while (node) {\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n\n            var dist = node.leaf ? sqSegDist(child, b, c) : sqSegBoxDist(b, c, child);\n            if (dist > maxDist) continue; // skip the node if it's farther than we ever need\n\n            queue.push({\n                node: child,\n                dist: dist\n            });\n        }\n\n        while (queue.length && !queue.peek().node.children) {\n            var item = queue.pop();\n            var p = item.node;\n\n            // skip all points that are as close to adjacent edges (a,b) and (c,d),\n            // and points that would introduce self-intersections when connected\n            var d0 = sqSegDist(p, a, b);\n            var d1 = sqSegDist(p, c, d);\n            if (item.dist < d0 && item.dist < d1 &&\n                noIntersections(b, p, segTree) &&\n                noIntersections(c, p, segTree)) return p;\n        }\n\n        node = queue.pop();\n        if (node) node = node.node;\n    }\n\n    return null;\n}\n\nfunction compareDist(a, b) {\n    return a.dist - b.dist;\n}\n\n// square distance from a segment bounding box to the given one\nfunction sqSegBoxDist(a, b, bbox) {\n    if (inside(a, bbox) || inside(b, bbox)) return 0;\n    var d1 = sqSegSegDist(a[0], a[1], b[0], b[1], bbox.minX, bbox.minY, bbox.maxX, bbox.minY);\n    if (d1 === 0) return 0;\n    var d2 = sqSegSegDist(a[0], a[1], b[0], b[1], bbox.minX, bbox.minY, bbox.minX, bbox.maxY);\n    if (d2 === 0) return 0;\n    var d3 = sqSegSegDist(a[0], a[1], b[0], b[1], bbox.maxX, bbox.minY, bbox.maxX, bbox.maxY);\n    if (d3 === 0) return 0;\n    var d4 = sqSegSegDist(a[0], a[1], b[0], b[1], bbox.minX, bbox.maxY, bbox.maxX, bbox.maxY);\n    if (d4 === 0) return 0;\n    return Math.min(d1, d2, d3, d4);\n}\n\nfunction inside(a, bbox) {\n    return a[0] >= bbox.minX &&\n           a[0] <= bbox.maxX &&\n           a[1] >= bbox.minY &&\n           a[1] <= bbox.maxY;\n}\n\n// check if the edge (a,b) doesn't intersect any other edges\nfunction noIntersections(a, b, segTree) {\n    var minX = Math.min(a[0], b[0]);\n    var minY = Math.min(a[1], b[1]);\n    var maxX = Math.max(a[0], b[0]);\n    var maxY = Math.max(a[1], b[1]);\n\n    var edges = segTree.search({minX: minX, minY: minY, maxX: maxX, maxY: maxY});\n    for (var i = 0; i < edges.length; i++) {\n        if (intersects(edges[i].p, edges[i].next.p, a, b)) return false;\n    }\n    return true;\n}\n\n// check if the edges (p1,q1) and (p2,q2) intersect\nfunction intersects(p1, q1, p2, q2) {\n    return p1 !== q2 && q1 !== p2 &&\n        orient(p1, q1, p2) > 0 !== orient(p1, q1, q2) > 0 &&\n        orient(p2, q2, p1) > 0 !== orient(p2, q2, q1) > 0;\n}\n\n// update the bounding box of a node's edge\nfunction updateBBox(node) {\n    var p1 = node.p;\n    var p2 = node.next.p;\n    node.minX = Math.min(p1[0], p2[0]);\n    node.minY = Math.min(p1[1], p2[1]);\n    node.maxX = Math.max(p1[0], p2[0]);\n    node.maxY = Math.max(p1[1], p2[1]);\n    return node;\n}\n\n// speed up convex hull by filtering out points inside quadrilateral formed by 4 extreme points\nfunction fastConvexHull(points) {\n    var left = points[0];\n    var top = points[0];\n    var right = points[0];\n    var bottom = points[0];\n\n    // find the leftmost, rightmost, topmost and bottommost points\n    for (var i = 0; i < points.length; i++) {\n        var p = points[i];\n        if (p[0] < left[0]) left = p;\n        if (p[0] > right[0]) right = p;\n        if (p[1] < top[1]) top = p;\n        if (p[1] > bottom[1]) bottom = p;\n    }\n\n    // filter out points that are inside the resulting quadrilateral\n    var cull = [left, top, right, bottom];\n    var filtered = cull.slice();\n    for (i = 0; i < points.length; i++) {\n        if (!pointInPolygon(points[i], cull)) filtered.push(points[i]);\n    }\n\n    // get convex hull around the filtered points\n    var indices = convexHull(filtered);\n\n    // return the hull as array of points (rather than indices)\n    var hull = [];\n    for (i = 0; i < indices.length; i++) hull.push(filtered[indices[i]]);\n    return hull;\n}\n\n// create a new node in a doubly linked list\nfunction insertNode(p, prev) {\n    var node = {\n        p: p,\n        prev: null,\n        next: null,\n        minX: 0,\n        minY: 0,\n        maxX: 0,\n        maxY: 0\n    };\n\n    if (!prev) {\n        node.prev = node;\n        node.next = node;\n\n    } else {\n        node.next = prev.next;\n        node.prev = prev;\n        prev.next.prev = node;\n        prev.next = node;\n    }\n    return node;\n}\n\n// square distance between 2 points\nfunction getSqDist(p1, p2) {\n\n    var dx = p1[0] - p2[0],\n        dy = p1[1] - p2[1];\n\n    return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction sqSegDist(p, p1, p2) {\n\n    var x = p1[0],\n        y = p1[1],\n        dx = p2[0] - x,\n        dy = p2[1] - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = p2[0];\n            y = p2[1];\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = p[0] - x;\n    dy = p[1] - y;\n\n    return dx * dx + dy * dy;\n}\n\n// segment to segment distance, ported from http://geomalgorithms.com/a07-_distance.html by Dan Sunday\nfunction sqSegSegDist(x0, y0, x1, y1, x2, y2, x3, y3) {\n    var ux = x1 - x0;\n    var uy = y1 - y0;\n    var vx = x3 - x2;\n    var vy = y3 - y2;\n    var wx = x0 - x2;\n    var wy = y0 - y2;\n    var a = ux * ux + uy * uy;\n    var b = ux * vx + uy * vy;\n    var c = vx * vx + vy * vy;\n    var d = ux * wx + uy * wy;\n    var e = vx * wx + vy * wy;\n    var D = a * c - b * b;\n\n    var sc, sN, tc, tN;\n    var sD = D;\n    var tD = D;\n\n    if (D === 0) {\n        sN = 0;\n        sD = 1;\n        tN = e;\n        tD = c;\n    } else {\n        sN = b * e - c * d;\n        tN = a * e - b * d;\n        if (sN < 0) {\n            sN = 0;\n            tN = e;\n            tD = c;\n        } else if (sN > sD) {\n            sN = sD;\n            tN = e + b;\n            tD = c;\n        }\n    }\n\n    if (tN < 0.0) {\n        tN = 0.0;\n        if (-d < 0.0) sN = 0.0;\n        else if (-d > a) sN = sD;\n        else {\n            sN = -d;\n            sD = a;\n        }\n    } else if (tN > tD) {\n        tN = tD;\n        if ((-d + b) < 0.0) sN = 0;\n        else if (-d + b > a) sN = sD;\n        else {\n            sN = -d + b;\n            sD = a;\n        }\n    }\n\n    sc = sN === 0 ? 0 : sN / sD;\n    tc = tN === 0 ? 0 : tN / tD;\n\n    var cx = (1 - sc) * x0 + sc * x1;\n    var cy = (1 - sc) * y0 + sc * y1;\n    var cx2 = (1 - tc) * x2 + tc * x3;\n    var cy2 = (1 - tc) * y2 + tc * y3;\n    var dx = cx2 - cx;\n    var dy = cy2 - cy;\n\n    return dx * dx + dy * dy;\n}\n","'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","'use strict'\n\nmodule.exports = monotoneConvexHull2D\n\nvar orient = require('robust-orientation')[3]\n\nfunction monotoneConvexHull2D(points) {\n  var n = points.length\n\n  if(n < 3) {\n    var result = new Array(n)\n    for(var i=0; i<n; ++i) {\n      result[i] = i\n    }\n\n    if(n === 2 &&\n       points[0][0] === points[1][0] &&\n       points[0][1] === points[1][1]) {\n      return [0]\n    }\n\n    return result\n  }\n\n  //Sort point indices along x-axis\n  var sorted = new Array(n)\n  for(var i=0; i<n; ++i) {\n    sorted[i] = i\n  }\n  sorted.sort(function(a,b) {\n    var d = points[a][0]-points[b][0]\n    if(d) {\n      return d\n    }\n    return points[a][1] - points[b][1]\n  })\n\n  //Construct upper and lower hulls\n  var lower = [sorted[0], sorted[1]]\n  var upper = [sorted[0], sorted[1]]\n\n  for(var i=2; i<n; ++i) {\n    var idx = sorted[i]\n    var p   = points[idx]\n\n    //Insert into lower list\n    var m = lower.length\n    while(m > 1 && orient(\n        points[lower[m-2]], \n        points[lower[m-1]], \n        p) <= 0) {\n      m -= 1\n      lower.pop()\n    }\n    lower.push(idx)\n\n    //Insert into upper list\n    m = upper.length\n    while(m > 1 && orient(\n        points[upper[m-2]], \n        points[upper[m-1]], \n        p) >= 0) {\n      m -= 1\n      upper.pop()\n    }\n    upper.push(idx)\n  }\n\n  //Merge lists together\n  var result = new Array(upper.length + lower.length - 2)\n  var ptr    = 0\n  for(var i=0, nl=lower.length; i<nl; ++i) {\n    result[ptr++] = lower[i]\n  }\n  for(var j=upper.length-2; j>0; --j) {\n    result[ptr++] = upper[j]\n  }\n\n  //Return result\n  return result\n}","\"use strict\"\n\nmodule.exports = linearExpansionSum\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction linearExpansionSum(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar twoSum = require(\"two-sum\")\n\nmodule.exports = scaleLinearExpansion\n\nfunction scaleLinearExpansion(e, scale) {\n  var n = e.length\n  if(n === 1) {\n    var ts = twoProduct(e[0], scale)\n    if(ts[0]) {\n      return ts\n    }\n    return [ ts[1] ]\n  }\n  var g = new Array(2 * n)\n  var q = [0.1, 0.1]\n  var t = [0.1, 0.1]\n  var count = 0\n  twoProduct(e[0], scale, q)\n  if(q[0]) {\n    g[count++] = q[0]\n  }\n  for(var i=1; i<n; ++i) {\n    twoProduct(e[i], scale, t)\n    var pq = q[1]\n    twoSum(pq, t[0], q)\n    if(q[0]) {\n      g[count++] = q[0]\n    }\n    var a = t[1]\n    var b = q[1]\n    var x = a + b\n    var bv = x - a\n    var y = b - bv\n    q[1] = x\n    if(y) {\n      g[count++] = y\n    }\n  }\n  if(q[1]) {\n    g[count++] = q[1]\n  }\n  if(count === 0) {\n    g[count++] = 0.0\n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nmodule.exports = fastTwoSum\n\nfunction fastTwoSum(a, b, result) {\n\tvar x = a + b\n\tvar bv = x - a\n\tvar av = x - bv\n\tvar br = b - bv\n\tvar ar = a - av\n\tif(result) {\n\t\tresult[0] = ar + br\n\t\tresult[1] = x\n\t\treturn result\n\t}\n\treturn [ar+br, x]\n}","\"use strict\"\n\nmodule.exports = robustSubtract\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction robustSubtract(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], -f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = -f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = -f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","'use strict';\n\nmodule.exports = TinyQueue;\nmodule.exports.default = TinyQueue;\n\nfunction TinyQueue(data, compare) {\n    if (!(this instanceof TinyQueue)) return new TinyQueue(data, compare);\n\n    this.data = data || [];\n    this.length = this.data.length;\n    this.compare = compare || defaultCompare;\n\n    if (this.length > 0) {\n        for (var i = (this.length >> 1) - 1; i >= 0; i--) this._down(i);\n    }\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nTinyQueue.prototype = {\n\n    push: function (item) {\n        this.data.push(item);\n        this.length++;\n        this._up(this.length - 1);\n    },\n\n    pop: function () {\n        if (this.length === 0) return undefined;\n\n        var top = this.data[0];\n        this.length--;\n\n        if (this.length > 0) {\n            this.data[0] = this.data[this.length];\n            this._down(0);\n        }\n        this.data.pop();\n\n        return top;\n    },\n\n    peek: function () {\n        return this.data[0];\n    },\n\n    _up: function (pos) {\n        var data = this.data;\n        var compare = this.compare;\n        var item = data[pos];\n\n        while (pos > 0) {\n            var parent = (pos - 1) >> 1;\n            var current = data[parent];\n            if (compare(item, current) >= 0) break;\n            data[pos] = current;\n            pos = parent;\n        }\n\n        data[pos] = item;\n    },\n\n    _down: function (pos) {\n        var data = this.data;\n        var compare = this.compare;\n        var halfLength = this.length >> 1;\n        var item = data[pos];\n\n        while (pos < halfLength) {\n            var left = (pos << 1) + 1;\n            var right = left + 1;\n            var best = data[left];\n\n            if (right < this.length && compare(data[right], best) < 0) {\n                left = right;\n                best = data[right];\n            }\n            if (compare(best, item) >= 0) break;\n\n            data[pos] = best;\n            pos = left;\n        }\n\n        data[pos] = item;\n    }\n};\n","module.exports = function (point, vs) {\n    // ray-casting algorithm based on\n    // http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n    \n    var x = point[0], y = point[1];\n    \n    var inside = false;\n    for (var i = 0, j = vs.length - 1; i < vs.length; j = i++) {\n        var xi = vs[i][0], yi = vs[i][1];\n        var xj = vs[j][0], yj = vs[j][1];\n        \n        var intersect = ((yi > y) != (yj > y))\n            && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n        if (intersect) inside = !inside;\n    }\n    \n    return inside;\n};\n","export default class UnionFind {\n  private ranks: number[];\n  private connections: number[];\n\n  constructor(size: number) {\n    this.connections = [...Array(size).keys()];\n    this.ranks = [...Array(size).keys()];\n  }\n\n  public union(x: number, y: number) {\n    let xRoot = this.find(x);\n    let yRoot = this.find(y);\n\n    if (xRoot === yRoot) {\n      return;\n    }\n\n    if (this.ranks[xRoot] < this.ranks[yRoot]) {\n      [xRoot, yRoot] = [yRoot, xRoot];\n    }\n\n    this.connections[yRoot] = xRoot;\n    if (this.ranks[xRoot] === this.ranks[yRoot]) {\n      this.ranks[xRoot] += 1;\n    }\n  }\n\n  public find(val: number) {\n    if (this.connections[val] !== val) {\n      this.connections[val] = this.find(this.connections[val]);\n    }\n\n    return this.connections[val];\n  }\n\n  public getClusters() {\n    const result = {};\n\n    for (const [index, connection] of this.connections.entries()) {\n      if (index === connection) {\n        result[index] = new Set();\n      }\n    }\n\n    for (const index of this.connections.keys()) {\n      const cluster = this.find(index);\n      result[cluster].add(index);\n    }\n\n    return result;\n  }\n}\n","import { Container, interfaces } from \"inversify\";\nimport Catalog from \"../Catalog\";\nimport catalogNmbs from \"../catalog.nmbs\";\nimport Context from \"../Context\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport ReachableStopsSearchPhase from \"../enums/ReachableStopsSearchPhase\";\nimport RoutingPhase from \"../enums/RoutingPhase\";\nimport TravelMode from \"../enums/TravelMode\";\nimport ConnectionsFetcherRaw from \"../fetcher/connections/ConnectionsFetcherRaw\";\nimport ConnectionsProviderDefault from \"../fetcher/connections/ConnectionsProviderDefault\";\nimport IConnectionsFetcher from \"../fetcher/connections/IConnectionsFetcher\";\nimport IConnectionsProvider from \"../fetcher/connections/IConnectionsProvider\";\nimport LDFetch from \"../fetcher/LDFetch\";\nimport IProfileFetcher from \"../fetcher/profiles/IProfileFetcher\";\nimport IProfileProvider from \"../fetcher/profiles/IProfileProvider\";\nimport ProfileFetcherDefault from \"../fetcher/profiles/ProfileFetcherDefault\";\nimport ProfileProviderDefault from \"../fetcher/profiles/ProfileProviderDefault\";\nimport IStopsFetcher from \"../fetcher/stops/IStopsFetcher\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport StopsFetcherRaw from \"../fetcher/stops/StopsFetcherRaw\";\nimport StopsProviderDefault from \"../fetcher/stops/StopsProviderDefault\";\nimport IRoutableTileFetcher from \"../fetcher/tiles/IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"../fetcher/tiles/IRoutableTileProvider\";\nimport RoutableTileFetcherRaw from \"../fetcher/tiles/RoutableTileFetcherRaw\";\nimport RoutableTileProviderDefault from \"../fetcher/tiles/RoutableTileProviderDefault\";\nimport RoutableTileProviderTransit from \"../fetcher/tiles/RoutableTileProviderTransit\";\n\nimport { LDLoader } from \"../loader/ldloader\";\nimport { BidirDijkstra } from \"../pathfinding/bidirdijkstra/BidirDijkstra\";\nimport DijkstraTree from \"../pathfinding/dijkstra-tree/DijkstraTree\";\nimport { IShortestPathAlgorithm, IShortestPathTreeAlgorithm } from \"../pathfinding/pathfinder\";\nimport PathfinderProvider from \"../pathfinding/PathfinderProvider\";\nimport CSAEarliestArrival from \"../planner/public-transport/CSAEarliestArrival\";\nimport IJourneyExtractor from \"../planner/public-transport/IJourneyExtractor\";\nimport IPublicTransportPlanner from \"../planner/public-transport/IPublicTransportPlanner\";\nimport JourneyExtractorProfile from \"../planner/public-transport/JourneyExtractorProfile\";\nimport IRoadPlanner from \"../planner/road/IRoadPlanner\";\nimport RoadPlannerPathfinding from \"../planner/road/RoadPlannerPathfinding\";\nimport IReachableStopsFinder from \"../planner/stops/IReachableStopsFinder\";\nimport ReachableStopsFinderDelaunay from \"../planner/stops/ReachableStopsFinderDelaunay\";\nimport ReachableStopsFinderOnlySelf from \"../planner/stops/ReachableStopsFinderOnlySelf\";\nimport ILocationResolver from \"../query-runner/ILocationResolver\";\nimport IQueryRunner from \"../query-runner/IQueryRunner\";\nimport LocationResolverConvenience from \"../query-runner/LocationResolverConvenience\";\nimport QueryRunnerDefault from \"../query-runner/QueryRunnerDefault\";\nimport TYPES from \"../types\";\n\nconst container = new Container();\ncontainer.bind<Context>(TYPES.Context).to(Context).inSingletonScope();\ncontainer.bind<IQueryRunner>(TYPES.QueryRunner).to(QueryRunnerDefault);\ncontainer.bind<ILocationResolver>(TYPES.LocationResolver).to(LocationResolverConvenience);\n\n// TODO, make this a fixed property of the planner itself\ncontainer.bind<IJourneyExtractor>(TYPES.JourneyExtractor)\n  .to(JourneyExtractorProfile);\n\ncontainer.bind<IPublicTransportPlanner>(TYPES.PublicTransportPlanner)\n  .to(CSAEarliestArrival);\ncontainer.bind<interfaces.Factory<IPublicTransportPlanner>>(TYPES.PublicTransportPlannerFactory)\n  .toAutoFactory<IPublicTransportPlanner>(TYPES.PublicTransportPlanner);\n\ncontainer.bind<IRoadPlanner>(TYPES.RoadPlanner)\n  .to(RoadPlannerPathfinding);\n\ncontainer.bind<IShortestPathTreeAlgorithm>(TYPES.ShortestPathTreeAlgorithm).to(DijkstraTree).inSingletonScope();\ncontainer.bind<IShortestPathAlgorithm>(TYPES.ShortestPathAlgorithm).to(BidirDijkstra).inSingletonScope();\ncontainer.bind<PathfinderProvider>(TYPES.PathfinderProvider).to(PathfinderProvider).inSingletonScope();\ncontainer.bind<IProfileFetcher>(TYPES.ProfileFetcher).to(ProfileFetcherDefault).inSingletonScope();\ncontainer.bind<IProfileProvider>(TYPES.ProfileProvider).to(ProfileProviderDefault).inSingletonScope();\n\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Initial);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderOnlySelf).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Transfer);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Final);\n\ncontainer.bind<IConnectionsProvider>(TYPES.ConnectionsProvider).to(ConnectionsProviderDefault).inSingletonScope();\ncontainer.bind<IConnectionsFetcher>(TYPES.ConnectionsFetcher).to(ConnectionsFetcherRaw);\ncontainer.bind<interfaces.Factory<IConnectionsFetcher>>(TYPES.ConnectionsFetcherFactory)\n  .toFactory<IConnectionsFetcher>(\n    (context: interfaces.Context) =>\n      (travelMode: TravelMode) => {\n        const fetcher = context.container.get<IConnectionsFetcher>(TYPES.ConnectionsFetcher);\n\n        fetcher.setTravelMode(travelMode);\n\n        return fetcher;\n      },\n  );\n\ncontainer.bind<IStopsProvider>(TYPES.StopsProvider).to(StopsProviderDefault).inSingletonScope();\ncontainer.bind<IStopsFetcher>(TYPES.StopsFetcher).to(StopsFetcherRaw);\ncontainer.bind<interfaces.Factory<IStopsFetcher>>(TYPES.StopsFetcherFactory)\n  .toFactory<IStopsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string) => {\n        const fetcher = context.container.get<StopsFetcherRaw>(TYPES.StopsFetcher);\n        fetcher.setAccessUrl(accessUrl);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<RoutableTileRegistry>(TYPES.RoutableTileRegistry).to(RoutableTileRegistry).inSingletonScope();\ncontainer.bind<IRoutableTileFetcher>(TYPES.RoutableTileFetcher).to(RoutableTileFetcherRaw).inSingletonScope();\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderDefault).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Base);\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderTransit).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Transit);\n\n// Bind catalog\ncontainer.bind<Catalog>(TYPES.Catalog).toConstantValue(catalogNmbs);\n\n// Init LDFetch\ncontainer.bind<LDFetch>(TYPES.LDFetch).to(LDFetch).inSingletonScope();\n\ncontainer.bind<LDLoader>(TYPES.LDLoader).to(LDLoader);\n\nexport default container;\n","import { injectable } from \"inversify\";\nimport TinyQueue from \"tinyqueue\";\nimport { DistanceM, DurationMs } from \"../../interfaces/units\";\nimport PathfindingGraph from \"../graph\";\nimport { IShortestPathInstance } from \"../pathfinder\";\n\ninterface IState {\n    position: number;\n    distance: DistanceM;\n    duration: DurationMs;\n    cost: number;\n}\n\nenum StepResultKind {\n    Continue,\n    Break,\n    NodeHandled,\n}\n\ntype IStepResult = IContinueStep | IBreakStep | INodeHandledStep;\n\ninterface IContinueStep {\n    kind: StepResultKind.Continue;\n}\n\ninterface IBreakStep {\n    kind: StepResultKind.Break;\n}\n\ninterface INodeHandledStep {\n    kind: StepResultKind.NodeHandled;\n    nodeId: number;\n}\n\n@injectable()\nexport class BidirDijkstraInstance implements IShortestPathInstance {\n    private graph: PathfindingGraph;\n    private useWeightedCost: boolean;\n\n    private forwardCosts: number[];\n    private backwardCosts: number[];\n    private forwardParents: number[];\n    private backwardParents: number[];\n\n    constructor(graph: PathfindingGraph) {\n        this.useWeightedCost = true;\n        this.graph = graph;\n    }\n\n    public setUseWeightedCost(useWeightedCost: boolean) {\n        this.useWeightedCost = useWeightedCost;\n    }\n\n    public setBreakPoint(on: string, callback: (on: string) => Promise<void>): void {\n        this.graph.setBreakPoint(on, callback);\n    }\n\n    public removeBreakPoint(on: string): void {\n        this.graph.removeBreakPoint(on);\n    }\n\n    public async queryPath(from: string, to: string, maxDistance = Infinity) {\n        let forwardQueue: TinyQueue<IState>;\n        let backwardQueue: TinyQueue<IState>;\n        if (this.useWeightedCost) {\n            forwardQueue = new TinyQueue([], (a, b) => a.cost - b.cost);\n            backwardQueue = new TinyQueue([], (a, b) => a.cost - b.cost);\n        } else {\n            forwardQueue = new TinyQueue([], (a, b) => a.duration - b.duration);\n            backwardQueue = new TinyQueue([], (a, b) => a.duration - b.duration);\n        }\n\n        this.forwardCosts = [...Array(this.graph.getAdjacencyList().length)].fill(Infinity);\n        this.forwardParents = [...Array(this.graph.getAdjacencyList().length)].fill(undefined);\n        this.backwardCosts = [...Array(this.graph.getAdjacencyList().length)].fill(Infinity);\n        this.backwardParents = [...Array(this.graph.getAdjacencyList().length)].fill(undefined);\n\n        const fromIndex = this.graph.getNodeIndex(from);\n        const toIndex = this.graph.getNodeIndex(to);\n        this.setForwardCost(fromIndex, 0);\n        this.setBackwardCost(toIndex, 0);\n        forwardQueue.push({ distance: 0, duration: 0, cost: 0, position: fromIndex });\n        backwardQueue.push({ distance: 0, duration: 0, cost: 0, position: toIndex });\n\n        while (forwardQueue.length && backwardQueue.length) {\n            const [forwardResult, backwardResult] = await Promise.all([\n                this.forwardStep(forwardQueue, toIndex, maxDistance),\n                this.backwardStep(backwardQueue, fromIndex, maxDistance),\n            ]);\n\n            if (forwardResult.kind === StepResultKind.Break || backwardResult.kind === StepResultKind.Break) {\n                // failed to find a path\n                return [];\n            }\n\n            if (forwardResult.kind === StepResultKind.NodeHandled) {\n                if (this.backwardCosts[forwardResult.nodeId] < Infinity) {\n                    // shortest path has been found\n                    // note that it doesn't necessarily contain the handled node\n                    return this.constructPath(forwardResult.nodeId);\n                }\n            }\n\n            if (backwardResult.kind === StepResultKind.NodeHandled) {\n                if (this.forwardCosts[backwardResult.nodeId] < Infinity) {\n                    return this.constructPath(backwardResult.nodeId);\n                }\n            }\n        }\n\n        // no path found\n        return [];\n    }\n\n    private constructPath(toIndex: number) {\n        let currentPosition = toIndex;\n        const forwardSteps = [];\n        const backwardSteps = [];\n\n        // reconstruct forward part of the path\n        while (this.backwardParents[currentPosition]) {\n            let nextEdge;\n            let nextPositionCost = Infinity;\n\n            for (const edge of this.graph.getAdjacencyList()[currentPosition]) {\n                if (this.getBackwardCost(edge.node) < nextPositionCost) {\n                    nextPositionCost = this.getBackwardCost(edge.node);\n                    nextEdge = edge;\n                }\n            }\n\n            if (!nextEdge) {\n                break;\n            }\n\n            backwardSteps.push({\n                from: this.graph.getLabel(nextEdge.node),\n                to: this.graph.getLabel(currentPosition),\n                distance: nextEdge.distance,\n                duration: nextEdge.duration,\n            });\n\n            currentPosition = nextEdge.node;\n        }\n\n        currentPosition = toIndex;\n        while (this.forwardParents[currentPosition]) {\n            let nextEdge;\n            let nextPositionCost = Infinity;\n\n            for (const edge of this.graph.getReverseAdjacencyList()[currentPosition]) {\n                if (this.getForwardCost(edge.node) < nextPositionCost) {\n                    nextPositionCost = this.getForwardCost(edge.node);\n                    nextEdge = edge;\n                }\n            }\n\n            if (!nextEdge) {\n                break;\n            }\n\n            forwardSteps.push({\n                from: this.graph.getLabel(nextEdge.node),\n                to: this.graph.getLabel(currentPosition),\n                distance: nextEdge.distance,\n                duration: nextEdge.duration,\n            });\n\n            currentPosition = nextEdge.node;\n        }\n\n        return forwardSteps.reverse().concat(backwardSteps);\n    }\n\n    private async forwardStep(queue: TinyQueue<IState>, toIndex: number, maxDistance): Promise<IStepResult> {\n        if (!queue.length) {\n            return { kind: StepResultKind.Break };\n        }\n\n        const { duration, distance, cost, position } = queue.pop();\n\n        if (distance > maxDistance) {\n            // avoid hopeless searches\n            return { kind: StepResultKind.Break };\n        }\n\n        if (position === toIndex) {\n            // it is done, break the loop and start reconstructing the path\n            return { kind: StepResultKind.Break };\n        }\n\n        if (cost > this.getForwardCost(position)) {\n            // we have already found a better way\n            return { kind: StepResultKind.Continue };\n        }\n\n        if (this.graph.getBreakPoint(position)) {\n            await this.graph.getBreakPoint(position)(this.graph.getLabel(position));\n        }\n\n        for (const edge of this.graph.getAdjacencyList()[position]) {\n            const next = {\n                distance: distance + edge.distance,\n                duration: duration + edge.duration,\n                cost: cost + edge.cost,\n                position: edge.node,\n            };\n\n            if (next.cost < this.getForwardCost(next.position)) {\n                this.setForwardCost(next.position, next.cost);\n                this.forwardParents[next.position] = position;\n                queue.push(next);\n            }\n        }\n\n        return {\n            kind: StepResultKind.NodeHandled,\n            nodeId: position,\n        };\n    }\n\n    private async backwardStep(queue: TinyQueue<IState>, toIndex: number, maxDistance): Promise<IStepResult> {\n        if (!queue.length) {\n            return { kind: StepResultKind.Break };\n        }\n\n        const { duration, distance, cost, position } = queue.pop();\n\n        if (distance > maxDistance) {\n            // avoid hopeless searches\n            return { kind: StepResultKind.Break };\n        }\n\n        if (position === toIndex) {\n            // it is done, break the loop and start reconstructing the path\n            return { kind: StepResultKind.Break };\n        }\n\n        if (cost > this.getBackwardCost(position)) {\n            // we have already found a better way\n            return { kind: StepResultKind.Continue };\n        }\n\n        if (this.graph.getBreakPoint(position)) {\n            await this.graph.getBreakPoint(position)(this.graph.getLabel(position));\n        }\n\n        for (const edge of this.graph.getReverseAdjacencyList()[position]) {\n            const next = {\n                distance: distance + edge.distance,\n                duration: duration + edge.duration,\n                cost: cost + edge.cost,\n                position: edge.node,\n            };\n\n            if (next.cost < this.getBackwardCost(next.position)) {\n                this.setBackwardCost(next.position, next.cost);\n                this.backwardParents[next.position] = position;\n                queue.push(next);\n            }\n        }\n\n        return {\n            kind: StepResultKind.NodeHandled,\n            nodeId: position,\n        };\n    }\n\n    private setForwardCost(position: number, cost: number) {\n        if (position >= this.forwardCosts.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.forwardCosts.length;\n            this.forwardCosts = this.forwardCosts.concat([...Array(missingCosts)].fill(Infinity));\n            this.forwardParents = this.forwardParents.concat([...Array(missingCosts)].fill(undefined));\n        }\n        this.forwardCosts[position] = cost;\n    }\n\n    private getForwardCost(position: number): number {\n        if (position >= this.forwardCosts.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.forwardCosts.length;\n            this.forwardCosts = this.forwardCosts.concat([...Array(missingCosts)].fill(Infinity));\n            this.forwardParents = this.forwardParents.concat([...Array(missingCosts)].fill(undefined));\n        }\n        return this.forwardCosts[position];\n    }\n\n    private setBackwardCost(position: number, cost: number) {\n        if (position >= this.backwardCosts.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.backwardCosts.length;\n            this.backwardCosts = this.backwardCosts.concat([...Array(missingCosts)].fill(Infinity));\n            this.backwardParents = this.backwardParents.concat([...Array(missingCosts)].fill(undefined));\n        }\n        this.backwardCosts[position] = cost;\n    }\n\n    private getBackwardCost(position: number): number {\n        if (position >= this.backwardCosts.length) {\n            const missingCosts = this.graph.getAdjacencyList().length - this.backwardCosts.length;\n            this.backwardCosts = this.backwardCosts.concat([...Array(missingCosts)].fill(Infinity));\n            this.backwardParents = this.backwardParents.concat([...Array(missingCosts)].fill(undefined));\n        }\n        return this.backwardCosts[position];\n    }\n}\n","import { Container, interfaces } from \"inversify\";\nimport Catalog from \"../Catalog\";\nimport catalogOVl from \"../catalog.delijn.oostvlaanderen\";\nimport catalogMivb from \"../catalog.mivb\";\nimport catalogNmbs from \"../catalog.nmbs\";\nimport Context from \"../Context\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport ReachableStopsSearchPhase from \"../enums/ReachableStopsSearchPhase\";\nimport RoutingPhase from \"../enums/RoutingPhase\";\nimport TravelMode from \"../enums/TravelMode\";\nimport ConnectionsFetcherRaw from \"../fetcher/connections/ConnectionsFetcherRaw\";\nimport ConnectionsProviderMerge from \"../fetcher/connections/ConnectionsProviderMerge\";\nimport IConnectionsFetcher from \"../fetcher/connections/IConnectionsFetcher\";\nimport IConnectionsProvider from \"../fetcher/connections/IConnectionsProvider\";\nimport FootpathsProviderRaw from \"../fetcher/footpaths/FootpathsProviderRaw\";\nimport IFootpathsFetcher from \"../fetcher/footpaths/IFootpathsProvider\";\nimport LDFetch from \"../fetcher/LDFetch\";\nimport IProfileFetcher from \"../fetcher/profiles/IProfileFetcher\";\nimport IProfileProvider from \"../fetcher/profiles/IProfileProvider\";\nimport ProfileFetcherDefault from \"../fetcher/profiles/ProfileFetcherDefault\";\nimport ProfileProviderDefault from \"../fetcher/profiles/ProfileProviderDefault\";\nimport IStopsFetcher from \"../fetcher/stops/IStopsFetcher\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport StopsFetcherRaw from \"../fetcher/stops/StopsFetcherRaw\";\nimport StopsProviderDefault from \"../fetcher/stops/StopsProviderDefault\";\nimport IRoutableTileFetcher from \"../fetcher/tiles/IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"../fetcher/tiles/IRoutableTileProvider\";\nimport RoutableTileFetcherRaw from \"../fetcher/tiles/RoutableTileFetcherRaw\";\nimport RoutableTileProviderDefault from \"../fetcher/tiles/RoutableTileProviderDefault\";\nimport RoutableTileProviderTransit from \"../fetcher/tiles/RoutableTileProviderTransit\";\n\nimport { LDLoader } from \"../loader/ldloader\";\nimport { BidirDijkstra } from \"../pathfinding/bidirdijkstra/BidirDijkstra\";\nimport DijkstraTree from \"../pathfinding/dijkstra-tree/DijkstraTree\";\nimport { IShortestPathAlgorithm, IShortestPathTreeAlgorithm } from \"../pathfinding/pathfinder\";\nimport PathfinderProvider from \"../pathfinding/PathfinderProvider\";\nimport CSAEarliestArrival from \"../planner/public-transport/CSAEarliestArrival\";\nimport IJourneyExtractor from \"../planner/public-transport/IJourneyExtractor\";\nimport IPublicTransportPlanner from \"../planner/public-transport/IPublicTransportPlanner\";\nimport JourneyExtractorProfile from \"../planner/public-transport/JourneyExtractorProfile\";\nimport IRoadPlanner from \"../planner/road/IRoadPlanner\";\nimport RoadPlannerPathfinding from \"../planner/road/RoadPlannerPathfinding\";\nimport IReachableStopsFinder from \"../planner/stops/IReachableStopsFinder\";\nimport ReachableStopsFinderDelaunay from \"../planner/stops/ReachableStopsFinderDelaunay\";\nimport ReachableStopsFinderFootpaths from \"../planner/stops/ReachableStopsFinderFootpaths\";\nimport ILocationResolver from \"../query-runner/ILocationResolver\";\nimport IQueryRunner from \"../query-runner/IQueryRunner\";\nimport LocationResolverConvenience from \"../query-runner/LocationResolverConvenience\";\nimport QueryRunnerDefault from \"../query-runner/QueryRunnerDefault\";\nimport TYPES from \"../types\";\n\nconst container = new Container();\ncontainer.bind<Context>(TYPES.Context).to(Context).inSingletonScope();\ncontainer.bind<IQueryRunner>(TYPES.QueryRunner).to(QueryRunnerDefault);\ncontainer.bind<ILocationResolver>(TYPES.LocationResolver).to(LocationResolverConvenience);\n\n// TODO, make this a fixed property of the planner itself\ncontainer.bind<IJourneyExtractor>(TYPES.JourneyExtractor)\n  .to(JourneyExtractorProfile);\n\ncontainer.bind<IPublicTransportPlanner>(TYPES.PublicTransportPlanner)\n  .to(CSAEarliestArrival);\ncontainer.bind<interfaces.Factory<IPublicTransportPlanner>>(TYPES.PublicTransportPlannerFactory)\n  .toAutoFactory<IPublicTransportPlanner>(TYPES.PublicTransportPlanner);\n\ncontainer.bind<IRoadPlanner>(TYPES.RoadPlanner)\n  .to(RoadPlannerPathfinding);\n\ncontainer.bind<IShortestPathTreeAlgorithm>(TYPES.ShortestPathTreeAlgorithm).to(DijkstraTree).inSingletonScope();\ncontainer.bind<IShortestPathAlgorithm>(TYPES.ShortestPathAlgorithm).to(BidirDijkstra).inSingletonScope();\ncontainer.bind<PathfinderProvider>(TYPES.PathfinderProvider).to(PathfinderProvider).inSingletonScope();\ncontainer.bind<IProfileFetcher>(TYPES.ProfileFetcher).to(ProfileFetcherDefault).inSingletonScope();\ncontainer.bind<IProfileProvider>(TYPES.ProfileProvider).to(ProfileProviderDefault).inSingletonScope();\n\ncontainer.bind<IFootpathsFetcher>(TYPES.FootpathsProvider).to(FootpathsProviderRaw).inSingletonScope();\n\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Initial);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderFootpaths).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Transfer);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Final);\n\ncontainer.bind<IConnectionsProvider>(TYPES.ConnectionsProvider).to(ConnectionsProviderMerge).inSingletonScope();\ncontainer.bind<IConnectionsFetcher>(TYPES.ConnectionsFetcher).to(ConnectionsFetcherRaw);\ncontainer.bind<interfaces.Factory<IConnectionsFetcher>>(TYPES.ConnectionsFetcherFactory)\n  .toFactory<IConnectionsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string, travelMode: TravelMode) => {\n        const fetcher = context.container.get<IConnectionsFetcher>(TYPES.ConnectionsFetcher);\n\n        fetcher.setTravelMode(travelMode);\n\n        return fetcher;\n      },\n  );\n\ncontainer.bind<IStopsProvider>(TYPES.StopsProvider).to(StopsProviderDefault).inSingletonScope();\ncontainer.bind<IStopsFetcher>(TYPES.StopsFetcher).to(StopsFetcherRaw);\ncontainer.bind<interfaces.Factory<IStopsFetcher>>(TYPES.StopsFetcherFactory)\n  .toFactory<IStopsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string) => {\n        const fetcher = context.container.get<StopsFetcherRaw>(TYPES.StopsFetcher);\n        fetcher.setAccessUrl(accessUrl);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<RoutableTileRegistry>(TYPES.RoutableTileRegistry).to(RoutableTileRegistry).inSingletonScope();\ncontainer.bind<IRoutableTileFetcher>(TYPES.RoutableTileFetcher).to(RoutableTileFetcherRaw).inSingletonScope();\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderDefault).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Base);\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderTransit).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Transit);\n\n// Bind catalog\nconst combined = Catalog.combine(catalogMivb, catalogNmbs, catalogOVl);\ncontainer.bind<Catalog>(TYPES.Catalog).toConstantValue(combined);\n\n// Init LDFetch\ncontainer.bind<LDFetch>(TYPES.LDFetch).to(LDFetch).inSingletonScope();\n\ncontainer.bind<LDLoader>(TYPES.LDLoader).to(LDLoader);\n\nexport default container;\n","import Catalog from \"./Catalog\";\nimport TravelMode from \"./enums/TravelMode\";\n\n/* tslint:disable:max-line-length */\n\nconst catalogDeLijn = new Catalog();\n\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Antwerpen/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Limburg/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Vlaams-Brabant/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/West-Vlaanderen/stops\");\n\ncatalogDeLijn.addConnectionsSource(\"https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/connections\", TravelMode.Bus);\n\nexport default catalogDeLijn;\n","import Catalog from \"./Catalog\";\nimport TravelMode from \"./enums/TravelMode\";\n\nconst catalogMivb = new Catalog();\n\ncatalogMivb.addStopsSource(\"https://openplanner.ilabt.imec.be/mivb/stops\");\ncatalogMivb.addStopsSource(\"https://openplanner.ilabt.imec.be/mivb/connections\");\n\nexport default catalogMivb;\n","import { Container, interfaces } from \"inversify\";\nimport Catalog from \"../Catalog\";\nimport catalogNmbs from \"../catalog.nmbs\";\nimport Context from \"../Context\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport ReachableStopsSearchPhase from \"../enums/ReachableStopsSearchPhase\";\nimport RoutingPhase from \"../enums/RoutingPhase\";\nimport TravelMode from \"../enums/TravelMode\";\nimport ConnectionsFetcherRaw from \"../fetcher/connections/ConnectionsFetcherRaw\";\nimport ConnectionsProviderDefault from \"../fetcher/connections/ConnectionsProviderDefault\";\nimport IConnectionsFetcher from \"../fetcher/connections/IConnectionsFetcher\";\nimport IConnectionsProvider from \"../fetcher/connections/IConnectionsProvider\";\nimport FootpathsProviderDefault from \"../fetcher/footpaths/FootpathsProviderDefault\";\nimport IFootpathsFetcher from \"../fetcher/footpaths/IFootpathsProvider\";\nimport LDFetch from \"../fetcher/LDFetch\";\nimport IProfileFetcher from \"../fetcher/profiles/IProfileFetcher\";\nimport IProfileProvider from \"../fetcher/profiles/IProfileProvider\";\nimport ProfileFetcherDefault from \"../fetcher/profiles/ProfileFetcherDefault\";\nimport ProfileProviderDefault from \"../fetcher/profiles/ProfileProviderDefault\";\nimport IStopsFetcher from \"../fetcher/stops/IStopsFetcher\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport StopsFetcherRaw from \"../fetcher/stops/StopsFetcherRaw\";\nimport StopsProviderDefault from \"../fetcher/stops/StopsProviderDefault\";\nimport IRoutableTileFetcher from \"../fetcher/tiles/IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"../fetcher/tiles/IRoutableTileProvider\";\nimport RoutableTileFetcherRaw from \"../fetcher/tiles/RoutableTileFetcherRaw\";\nimport RoutableTileProviderDefault from \"../fetcher/tiles/RoutableTileProviderDefault\";\nimport RoutableTileProviderTransit from \"../fetcher/tiles/RoutableTileProviderTransit\";\n\nimport { LDLoader } from \"../loader/ldloader\";\nimport DijkstraTree from \"../pathfinding/dijkstra-tree/DijkstraTree\";\nimport { Dijkstra } from \"../pathfinding/dijkstra/Dijkstra\";\nimport { IShortestPathAlgorithm, IShortestPathTreeAlgorithm } from \"../pathfinding/pathfinder\";\nimport PathfinderProvider from \"../pathfinding/PathfinderProvider\";\nimport CSAEarliestArrival from \"../planner/public-transport/CSAEarliestArrival\";\nimport IJourneyExtractor from \"../planner/public-transport/IJourneyExtractor\";\nimport IPublicTransportPlanner from \"../planner/public-transport/IPublicTransportPlanner\";\nimport JourneyExtractorProfile from \"../planner/public-transport/JourneyExtractorProfile\";\nimport IRoadPlanner from \"../planner/road/IRoadPlanner\";\nimport RoadPlannerPathfindingExperimental from \"../planner/road/RoadPlannerPathfindingExperimental\";\nimport IReachableStopsFinder from \"../planner/stops/IReachableStopsFinder\";\nimport ReachableStopsFinderDelaunay from \"../planner/stops/ReachableStopsFinderDelaunay\";\nimport ReachableStopsFinderOnlySelf from \"../planner/stops/ReachableStopsFinderOnlySelf\";\nimport QueryRunnerExponential from \"../query-runner/exponential/QueryRunnerExponential\";\nimport ILocationResolver from \"../query-runner/ILocationResolver\";\nimport IQueryRunner from \"../query-runner/IQueryRunner\";\nimport LocationResolverConvenience from \"../query-runner/LocationResolverConvenience\";\nimport TYPES from \"../types\";\n\nconst container = new Container();\ncontainer.bind<Context>(TYPES.Context).to(Context).inSingletonScope();\ncontainer.bind<IQueryRunner>(TYPES.QueryRunner).to(QueryRunnerExponential);\ncontainer.bind<ILocationResolver>(TYPES.LocationResolver).to(LocationResolverConvenience);\n\n// TODO, make this a fixed property of the planner itself\ncontainer.bind<IJourneyExtractor>(TYPES.JourneyExtractor)\n  .to(JourneyExtractorProfile);\n\ncontainer.bind<IPublicTransportPlanner>(TYPES.PublicTransportPlanner)\n  .to(CSAEarliestArrival);\ncontainer.bind<interfaces.Factory<IPublicTransportPlanner>>(TYPES.PublicTransportPlannerFactory)\n  .toAutoFactory<IPublicTransportPlanner>(TYPES.PublicTransportPlanner);\n\ncontainer.bind<IRoadPlanner>(TYPES.RoadPlanner)\n  .to(RoadPlannerPathfindingExperimental);\n\ncontainer.bind<IShortestPathTreeAlgorithm>(TYPES.ShortestPathTreeAlgorithm).to(DijkstraTree).inSingletonScope();\ncontainer.bind<IShortestPathAlgorithm>(TYPES.ShortestPathAlgorithm).to(Dijkstra).inSingletonScope();\ncontainer.bind<PathfinderProvider>(TYPES.PathfinderProvider).to(PathfinderProvider).inSingletonScope();\ncontainer.bind<IProfileFetcher>(TYPES.ProfileFetcher).to(ProfileFetcherDefault).inSingletonScope();\ncontainer.bind<IProfileProvider>(TYPES.ProfileProvider).to(ProfileProviderDefault).inSingletonScope();\n\ncontainer.bind<IFootpathsFetcher>(TYPES.FootpathsProvider).to(FootpathsProviderDefault).inSingletonScope();\n\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Initial);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderOnlySelf).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Transfer);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Final);\n\ncontainer.bind<IConnectionsProvider>(TYPES.ConnectionsProvider).to(ConnectionsProviderDefault).inSingletonScope();\ncontainer.bind<IConnectionsFetcher>(TYPES.ConnectionsFetcher).to(ConnectionsFetcherRaw);\ncontainer.bind<interfaces.Factory<IConnectionsFetcher>>(TYPES.ConnectionsFetcherFactory)\n  .toFactory<IConnectionsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string, travelMode: TravelMode) => {\n        const fetcher = context.container.get<IConnectionsFetcher>(TYPES.ConnectionsFetcher);\n\n        fetcher.setTravelMode(travelMode);\n\n        return fetcher;\n      },\n  );\n\ncontainer.bind<IStopsProvider>(TYPES.StopsProvider).to(StopsProviderDefault).inSingletonScope();\ncontainer.bind<IStopsFetcher>(TYPES.StopsFetcher).to(StopsFetcherRaw);\ncontainer.bind<interfaces.Factory<IStopsFetcher>>(TYPES.StopsFetcherFactory)\n  .toFactory<IStopsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string) => {\n        const fetcher = context.container.get<StopsFetcherRaw>(TYPES.StopsFetcher);\n        fetcher.setAccessUrl(accessUrl);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<RoutableTileRegistry>(TYPES.RoutableTileRegistry).to(RoutableTileRegistry).inSingletonScope();\ncontainer.bind<IRoutableTileFetcher>(TYPES.RoutableTileFetcher).to(RoutableTileFetcherRaw).inSingletonScope();\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderDefault).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Base);\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderTransit).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Transit);\n\n// Bind catalog\ncontainer.bind<Catalog>(TYPES.Catalog).toConstantValue(catalogNmbs);\n\n// Init LDFetch\ncontainer.bind<LDFetch>(TYPES.LDFetch).to(LDFetch).inSingletonScope();\n\ncontainer.bind<LDLoader>(TYPES.LDLoader).to(LDLoader);\n\nexport default container;\n","import { ArrayIterator, AsyncIterator } from \"asynciterator\";\nimport { EventEmitter } from \"events\";\nimport { inject, injectable, tagged } from \"inversify\";\nimport inBBox from \"tiles-in-bbox\";\nimport Profile from \"../../entities/profile/Profile\";\nimport { RoutableTileCoordinate } from \"../../entities/tiles/coordinate\";\nimport { RoutableTileNode } from \"../../entities/tiles/node\";\nimport RoutableTileRegistry from \"../../entities/tiles/registry\";\nimport { RoutableTile } from \"../../entities/tiles/tile\";\nimport RoutingPhase from \"../../enums/RoutingPhase\";\nimport TravelMode from \"../../enums/TravelMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IProfileProvider from \"../../fetcher/profiles/IProfileProvider\";\nimport IRoutableTileProvider from \"../../fetcher/tiles/IRoutableTileProvider\";\nimport ILocation from \"../../interfaces/ILocation\";\nimport IPath from \"../../interfaces/IPath\";\nimport IStep from \"../../interfaces/IStep\";\nimport PathfinderProvider from \"../../pathfinding/PathfinderProvider\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport Geo from \"../../util/Geo\";\nimport { toTileCoordinate } from \"../../util/Tiles\";\nimport Leg from \"../Leg\";\nimport Path from \"../Path\";\nimport IRoadPlanner from \"./IRoadPlanner\";\n\n@injectable()\nexport default class RoadPlannerPathfindingExperimental implements IRoadPlanner {\n    private baseTileProvider: IRoutableTileProvider;\n    private transitTileProvider: IRoutableTileProvider;\n    private pathfinderProvider: PathfinderProvider;\n    private profileProvider: IProfileProvider;\n    private locationResolver: ILocationResolver;\n    private registry: RoutableTileRegistry;\n    private eventBus: EventEmitter;\n\n    // STATEFUL!\n    // will misbehave when processing several queries concurrently\n    private reachedTiles: Set<string>;\n    private localTiles: RoutableTileCoordinate[];\n\n    constructor(\n        @inject(TYPES.RoutableTileProvider)\n        @tagged(\"phase\", RoutingPhase.Base)\n        baseTileProvider: IRoutableTileProvider,\n        @inject(TYPES.RoutableTileProvider)\n        @tagged(\"phase\", RoutingPhase.Transit)\n        transitTileProvider: IRoutableTileProvider,\n        @inject(TYPES.PathfinderProvider) pathfinderProvider: PathfinderProvider,\n        @inject(TYPES.ProfileProvider) profileProvider: IProfileProvider,\n        @inject(TYPES.LocationResolver) locationResolver: ILocationResolver,\n        @inject(TYPES.RoutableTileRegistry) registry: RoutableTileRegistry,\n    ) {\n        this.baseTileProvider = baseTileProvider;\n        this.transitTileProvider = transitTileProvider;\n        this.pathfinderProvider = pathfinderProvider;\n        this.profileProvider = profileProvider;\n        this.locationResolver = locationResolver;\n        this.registry = registry;\n        this.eventBus = EventBus.getInstance();\n        this.reachedTiles = new Set();\n    }\n\n    public async plan(query: IResolvedQuery): Promise<AsyncIterator<IPath>> {\n        const {\n            from: fromLocations,\n            to: toLocations,\n            profileID,\n        } = query;\n\n        const paths = [];\n        const profile = await this.profileProvider.getProfile(profileID);\n\n        if (fromLocations && toLocations && fromLocations.length && toLocations.length) {\n\n            for (const from of fromLocations) {\n                for (const to of toLocations) {\n\n                    const newPath = await this.getPathBetweenLocations(\n                        from,\n                        to,\n                        profile,\n                    );\n\n                    if (newPath) {\n                        paths.push(newPath);\n                    }\n                }\n            }\n        }\n\n        return new ArrayIterator<IPath>(paths);\n    }\n\n    private async getPathBetweenLocations(\n        from: ILocation,\n        to: ILocation,\n        profile: Profile,\n    ): Promise<IPath> {\n        this.localTiles = [\n            toTileCoordinate(from.latitude, from.longitude),\n            toTileCoordinate(to.latitude, to.longitude),\n        ];\n\n        await Promise.all([\n            this.embedLocation(from),\n            this.embedLocation(to, true),\n        ]);\n\n        return this._innerPath(from, to, profile);\n    }\n\n    private async _innerPath(\n        start: ILocation,\n        stop: ILocation,\n        profile: Profile,\n    ): Promise<IPath> {\n        const pathfinder = await this.pathfinderProvider.getShortestPathAlgorithm(profile);\n        const maxDistance = Geo.getDistanceBetweenLocations(start, stop) * 5;\n        const path = await pathfinder.queryPath(Geo.getId(start), Geo.getId(stop), maxDistance);\n\n        const steps: IStep[] = [];\n        for (const step of path) {\n            const to = await this.locationResolver.resolve(step.to);\n            const from = await this.locationResolver.resolve(step.from);\n            steps.push({\n                startLocation: from,\n                stopLocation: to,\n                duration: { average: step.duration },\n                distance: step.distance,\n            });\n        }\n\n        const leg = new Leg(TravelMode.Profile, steps);\n        return new Path([leg]);\n    }\n\n    private pickTile(node: RoutableTileNode) {\n        let coordinate: RoutableTileCoordinate;\n        for (let zoom = 8; zoom < 15; zoom++) {\n            coordinate = toTileCoordinate(node.latitude, node.longitude, zoom);\n            let ok = true;\n            for (const localTile of this.localTiles) {\n                if (coordinate.contains(localTile)) {\n                    ok = false;\n                    break;\n                }\n            }\n            if (ok) {\n                return coordinate;\n            }\n        }\n        return coordinate;\n    }\n\n    private async fetchTile(coordinate: RoutableTileCoordinate) {\n        let local = false;\n        for (const localTile of this.localTiles) {\n            if (coordinate.x === localTile.x && coordinate.y === localTile.y && coordinate.zoom === localTile.zoom) {\n                local = true;\n                break;\n            }\n        }\n\n        const baseTileId = this.baseTileProvider.getIdForTileCoords(coordinate);\n        const transitTileId = this.transitTileProvider.getIdForTileCoords(coordinate);\n\n        if (!this.reachedTiles.has(transitTileId) && !this.reachedTiles.has(baseTileId)) {\n            this.eventBus.emit(EventType.FetchTile, coordinate);\n            let tile: RoutableTile;\n            if (local) {\n                tile = await this.baseTileProvider.getByTileCoords(coordinate);\n                this.reachedTiles.add(baseTileId);\n                this.reachedTiles.add(transitTileId);\n            } else {\n                tile = await this.transitTileProvider.getByTileCoords(coordinate);\n                this.reachedTiles.add(transitTileId);\n            }\n            const boundaryNodes: Set<string> = new Set();\n\n            for (const nodeId of tile.getNodes()) {\n                const node = this.registry.getNode(nodeId);\n                if (!tile.contains(node)) {\n                    boundaryNodes.add(nodeId);\n                }\n            }\n\n            const self = this;\n            for (const profile of await this.profileProvider.getProfiles()) {\n                const graph = this.pathfinderProvider.getGraphForProfile(profile);\n\n                for (const nodeId of boundaryNodes) {\n                    graph.setBreakPoint(nodeId, async (on: string) => {\n                        const node = self.registry.getNode(on);\n                        const boundaryTileCoordinate = this.pickTile(node);\n                        await self.fetchTile(boundaryTileCoordinate);\n                    });\n                }\n            }\n        }\n    }\n\n    private async embedLocation(from: ILocation, invert = false) {\n        const zoom = 14;\n        const padding = 0.005;\n\n        const fromBBox = {\n            top: from.latitude + padding,\n            bottom: from.latitude - padding,\n            left: from.longitude - padding,\n            right: from.longitude + padding,\n        };\n\n        const fromTileCoords = inBBox.tilesInBbox(fromBBox, zoom).map((obj) => {\n            const coordinate = new RoutableTileCoordinate(zoom, obj.x, obj.y);\n            this.fetchTile(coordinate);\n            return coordinate;\n        });\n\n        // this won't download anything new\n        // but we need the tile data to embed the starting location\n        const fromTileset = await this.baseTileProvider.getMultipleByTileCoords(fromTileCoords);\n        await this.pathfinderProvider.embedLocation(from, fromTileset, invert);\n    }\n}\n","import { Container, interfaces } from \"inversify\";\nimport Catalog from \"../Catalog\";\nimport catalogDeLijn from \"../catalog.delijn.vlaenderen\";\nimport catalogNmbs from \"../catalog.nmbs\";\nimport Context from \"../Context\";\nimport RoutableTileRegistry from \"../entities/tiles/registry\";\nimport ReachableStopsSearchPhase from \"../enums/ReachableStopsSearchPhase\";\nimport RoutingPhase from \"../enums/RoutingPhase\";\nimport TravelMode from \"../enums/TravelMode\";\nimport ConnectionsFetcherRaw from \"../fetcher/connections/ConnectionsFetcherRaw\";\nimport ConnectionsProviderMerge from \"../fetcher/connections/ConnectionsProviderMerge\";\nimport IConnectionsFetcher from \"../fetcher/connections/IConnectionsFetcher\";\nimport IConnectionsProvider from \"../fetcher/connections/IConnectionsProvider\";\nimport FootpathsProviderRaw from \"../fetcher/footpaths/FootpathsProviderRaw\";\nimport IFootpathsFetcher from \"../fetcher/footpaths/IFootpathsProvider\";\nimport LDFetch from \"../fetcher/LDFetch\";\nimport IProfileFetcher from \"../fetcher/profiles/IProfileFetcher\";\nimport IProfileProvider from \"../fetcher/profiles/IProfileProvider\";\nimport ProfileFetcherDefault from \"../fetcher/profiles/ProfileFetcherDefault\";\nimport ProfileProviderDefault from \"../fetcher/profiles/ProfileProviderDefault\";\nimport IStopsFetcher from \"../fetcher/stops/IStopsFetcher\";\nimport IStopsProvider from \"../fetcher/stops/IStopsProvider\";\nimport StopsFetcherRaw from \"../fetcher/stops/StopsFetcherRaw\";\nimport StopsProviderDefault from \"../fetcher/stops/StopsProviderDefault\";\nimport IRoutableTileFetcher from \"../fetcher/tiles/IRoutableTileFetcher\";\nimport IRoutableTileProvider from \"../fetcher/tiles/IRoutableTileProvider\";\nimport RoutableTileFetcherRaw from \"../fetcher/tiles/RoutableTileFetcherRaw\";\nimport RoutableTileProviderDefault from \"../fetcher/tiles/RoutableTileProviderDefault\";\nimport RoutableTileProviderTransit from \"../fetcher/tiles/RoutableTileProviderTransit\";\n\nimport { LDLoader } from \"../loader/ldloader\";\nimport { BidirDijkstra } from \"../pathfinding/bidirdijkstra/BidirDijkstra\";\nimport DijkstraTree from \"../pathfinding/dijkstra-tree/DijkstraTree\";\nimport { IShortestPathAlgorithm, IShortestPathTreeAlgorithm } from \"../pathfinding/pathfinder\";\nimport PathfinderProvider from \"../pathfinding/PathfinderProvider\";\nimport CSAEarliestArrivalVerbose from \"../planner/public-transport/CSAEarliestArrivalVerbose\";\nimport IJourneyExtractor from \"../planner/public-transport/IJourneyExtractor\";\nimport IPublicTransportPlanner from \"../planner/public-transport/IPublicTransportPlanner\";\nimport JourneyExtractorProfile from \"../planner/public-transport/JourneyExtractorProfile\";\nimport IRoadPlanner from \"../planner/road/IRoadPlanner\";\nimport RoadPlannerPathfinding from \"../planner/road/RoadPlannerPathfinding\";\nimport IReachableStopsFinder from \"../planner/stops/IReachableStopsFinder\";\nimport ReachableStopsFinderDelaunay from \"../planner/stops/ReachableStopsFinderDelaunay\";\nimport ReachableStopsFinderFootpathsVerbose from \"../planner/stops/ReachableStopsFinderFootpathsVerbose\";\nimport ILocationResolver from \"../query-runner/ILocationResolver\";\nimport IQueryRunner from \"../query-runner/IQueryRunner\";\nimport LocationResolverConvenience from \"../query-runner/LocationResolverConvenience\";\nimport QueryRunnerDefault from \"../query-runner/QueryRunnerDefault\";\nimport TYPES from \"../types\";\n\nconst container = new Container();\ncontainer.bind<Context>(TYPES.Context).to(Context).inSingletonScope();\ncontainer.bind<IQueryRunner>(TYPES.QueryRunner).to(QueryRunnerDefault);\ncontainer.bind<ILocationResolver>(TYPES.LocationResolver).to(LocationResolverConvenience);\n\n// TODO, make this a fixed property of the planner itself\ncontainer.bind<IJourneyExtractor>(TYPES.JourneyExtractor)\n  .to(JourneyExtractorProfile);\n\ncontainer.bind<IPublicTransportPlanner>(TYPES.PublicTransportPlanner)\n  .to(CSAEarliestArrivalVerbose);\ncontainer.bind<interfaces.Factory<IPublicTransportPlanner>>(TYPES.PublicTransportPlannerFactory)\n  .toAutoFactory<IPublicTransportPlanner>(TYPES.PublicTransportPlanner);\n\ncontainer.bind<IRoadPlanner>(TYPES.RoadPlanner)\n  .to(RoadPlannerPathfinding);\n\ncontainer.bind<IShortestPathTreeAlgorithm>(TYPES.ShortestPathTreeAlgorithm).to(DijkstraTree).inSingletonScope();\ncontainer.bind<IShortestPathAlgorithm>(TYPES.ShortestPathAlgorithm).to(BidirDijkstra).inSingletonScope();\ncontainer.bind<PathfinderProvider>(TYPES.PathfinderProvider).to(PathfinderProvider).inSingletonScope();\ncontainer.bind<IProfileFetcher>(TYPES.ProfileFetcher).to(ProfileFetcherDefault).inSingletonScope();\ncontainer.bind<IProfileProvider>(TYPES.ProfileProvider).to(ProfileProviderDefault).inSingletonScope();\n\ncontainer.bind<IFootpathsFetcher>(TYPES.FootpathsProvider).to(FootpathsProviderRaw).inSingletonScope();\n\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Initial);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderFootpathsVerbose).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Transfer);\ncontainer.bind<IReachableStopsFinder>(TYPES.ReachableStopsFinder)\n  .to(ReachableStopsFinderDelaunay).whenTargetTagged(\"phase\", ReachableStopsSearchPhase.Final);\n\ncontainer.bind<IConnectionsProvider>(TYPES.ConnectionsProvider).to(ConnectionsProviderMerge).inSingletonScope();\ncontainer.bind<IConnectionsFetcher>(TYPES.ConnectionsFetcher).to(ConnectionsFetcherRaw);\ncontainer.bind<interfaces.Factory<IConnectionsFetcher>>(TYPES.ConnectionsFetcherFactory)\n  .toFactory<IConnectionsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string, travelMode: TravelMode) => {\n        const fetcher = context.container.get<IConnectionsFetcher>(TYPES.ConnectionsFetcher);\n\n        fetcher.setTravelMode(travelMode);\n\n        return fetcher;\n      },\n  );\n\ncontainer.bind<IStopsProvider>(TYPES.StopsProvider).to(StopsProviderDefault).inSingletonScope();\ncontainer.bind<IStopsFetcher>(TYPES.StopsFetcher).to(StopsFetcherRaw);\ncontainer.bind<interfaces.Factory<IStopsFetcher>>(TYPES.StopsFetcherFactory)\n  .toFactory<IStopsFetcher>(\n    (context: interfaces.Context) =>\n      (accessUrl: string) => {\n        const fetcher = context.container.get<StopsFetcherRaw>(TYPES.StopsFetcher);\n        fetcher.setAccessUrl(accessUrl);\n        return fetcher;\n      },\n  );\n\ncontainer.bind<RoutableTileRegistry>(TYPES.RoutableTileRegistry).to(RoutableTileRegistry).inSingletonScope();\ncontainer.bind<IRoutableTileFetcher>(TYPES.RoutableTileFetcher).to(RoutableTileFetcherRaw).inSingletonScope();\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderDefault).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Base);\ncontainer.bind<IRoutableTileProvider>(TYPES.RoutableTileProvider)\n  .to(RoutableTileProviderTransit).inSingletonScope().whenTargetTagged(\"phase\", RoutingPhase.Transit);\n\n// Bind catalog\nconst combined = Catalog.combine(catalogNmbs, catalogDeLijn);\ncontainer.bind<Catalog>(TYPES.Catalog).toConstantValue(combined);\n\n// Init LDFetch\ncontainer.bind<LDFetch>(TYPES.LDFetch).to(LDFetch).inSingletonScope();\n\ncontainer.bind<LDLoader>(TYPES.LDLoader).to(LDLoader);\n\nexport default container;\n","import Catalog from \"./Catalog\";\nimport TravelMode from \"./enums/TravelMode\";\n\n/* tslint:disable:max-line-length */\n\nconst catalogDeLijn = new Catalog();\n\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Antwerpen/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Limburg/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/Vlaams-Brabant/stops\");\ncatalogDeLijn.addStopsSource(\"https://openplanner.ilabt.imec.be/delijn/West-Vlaanderen/stops\");\n\ncatalogDeLijn.addConnectionsSource(\"https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/connections\", TravelMode.Bus);\ncatalogDeLijn.addConnectionsSource(\"https://openplanner.ilabt.imec.be/delijn/West-Vlaanderen/connections\", TravelMode.Bus);\n\nexport default catalogDeLijn;\n","import { inject, injectable, tagged } from \"inversify\";\nimport IConnection from \"../../entities/connections/connections\";\nimport ReachableStopsSearchPhase from \"../../enums/ReachableStopsSearchPhase\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IConnectionsProvider from \"../../fetcher/connections/IConnectionsProvider\";\nimport ILocationResolver from \"../../query-runner/ILocationResolver\";\nimport IResolvedQuery from \"../../query-runner/IResolvedQuery\";\nimport TYPES from \"../../types\";\nimport IReachableStopsFinder from \"../stops/IReachableStopsFinder\";\nimport CSAEarliestArrival from \"./CSAEarliestArrival\";\n\n@injectable()\nexport default class CSAEarliestArrivalVerbose extends CSAEarliestArrival {\n    constructor(\n        @inject(TYPES.ConnectionsProvider)\n        connectionsProvider: IConnectionsProvider,\n        @inject(TYPES.LocationResolver)\n        locationResolver: ILocationResolver,\n        @inject(TYPES.ReachableStopsFinder)\n        @tagged(\"phase\", ReachableStopsSearchPhase.Transfer)\n        transferReachableStopsFinder: IReachableStopsFinder,\n        @inject(TYPES.ReachableStopsFinder)\n        @tagged(\"phase\", ReachableStopsSearchPhase.Initial)\n        initialReachableStopsFinder: IReachableStopsFinder,\n        @inject(TYPES.ReachableStopsFinder)\n        @tagged(\"phase\", ReachableStopsSearchPhase.Final)\n        finalReachableStopsFinder: IReachableStopsFinder,\n    ) {\n        super(connectionsProvider, locationResolver, transferReachableStopsFinder,\n            initialReachableStopsFinder, finalReachableStopsFinder);\n    }\n\n    protected updateProfile(query: IResolvedQuery, connection: IConnection) {\n        super.updateProfile(query, connection);\n        EventBus.getInstance().emit(EventType.PointReached, this.locationResolver.resolve(connection.arrivalStop));\n    }\n}\n","import { inject, injectable } from \"inversify\";\nimport ReachableStopsFinderMode from \"../../enums/ReachableStopsFinderMode\";\nimport EventBus from \"../../events/EventBus\";\nimport EventType from \"../../events/EventType\";\nimport IFootpathsProvider from \"../../fetcher/footpaths/IFootpathsProvider\";\nimport IStop from \"../../fetcher/stops/IStop\";\nimport IStopsProvider from \"../../fetcher/stops/IStopsProvider\";\nimport { DurationMs, SpeedKmH } from \"../../interfaces/units\";\nimport TYPES from \"../../types\";\nimport { IReachableStop } from \"./IReachableStopsFinder\";\nimport ReachableStopsFinderFootpaths from \"./ReachableStopsFinderFootpaths\";\n\n@injectable()\nexport default class ReachableStopsFinderFootpathsVerbose extends ReachableStopsFinderFootpaths {\n  private done: Set<string>;\n\n  constructor(\n    @inject(TYPES.StopsProvider) stopsProvider: IStopsProvider,\n    @inject(TYPES.FootpathsProvider) footpathsProvider: IFootpathsProvider,\n  ) {\n    super(stopsProvider, footpathsProvider);\n    this.done = new Set();\n  }\n\n  public async findReachableStops(\n    sourceOrTargetStop: IStop,\n    mode: ReachableStopsFinderMode,\n    maximumDuration: DurationMs,\n    minimumSpeed: SpeedKmH,\n  ): Promise<IReachableStop[]> {\n    const result = await super.findReachableStops(sourceOrTargetStop, mode, maximumDuration, minimumSpeed);\n\n    if (!this.done.has(sourceOrTargetStop.id)) {\n      this.done.add(sourceOrTargetStop.id);\n      for (const reachableStop of result) {\n        EventBus.getInstance().emit(EventType.ReachableStop, sourceOrTargetStop, reachableStop.stop);\n      }\n    }\n\n    return result;\n  }\n}\n"],"sourceRoot":""}